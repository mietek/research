{-# OPTIONS --rewriting #-}

module VecLemmas where

open import Prelude
open import Fin
open import FinLemmas
open import Vec


--------------------------------------------------------------------------------
{-

                              idâŠ‡ âˆ˜âŠ‡ Î· â‰¡ Î·                                      lid-âˆ˜âŠ‡
                              Î· âˆ˜âŠ‡ idâŠ‡ â‰¡ Î·                                      rid-âˆ˜âŠ‡
                      (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) âˆ˜âŠ‡ Î·â‚ƒ â‰¡ Î·â‚ âˆ˜âŠ‡ (Î·â‚‚ âˆ˜âŠ‡ Î·â‚ƒ)                       assoc-âˆ˜âŠ‡

                            renâˆ‹ idâŠ‡ ğ’¾ â‰¡ ğ’¾                                      id-renâˆ‹
                     renâˆ‹ (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) ğ’¾ â‰¡ renâˆ‹ Î·â‚‚ (renâˆ‹ Î·â‚ ğ’¾)                    comp-renâˆ‹

-}
--------------------------------------------------------------------------------


{-# REWRITE lid-âˆ˜â‰¥ #-}
lid-âˆ˜âŠ‡ : âˆ€ {X n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²}
                      â†’ (Î· : Îâ€² âŠ‡âŸ¨ e âŸ© Î)
                      â†’ idâŠ‡ âˆ˜âŠ‡ Î· â‰¡ Î·
lid-âˆ˜âŠ‡ done     = refl
lid-âˆ˜âŠ‡ (drop Î·) = drop & lid-âˆ˜âŠ‡ Î·
lid-âˆ˜âŠ‡ (keep Î·) = keep & lid-âˆ˜âŠ‡ Î·


{-# REWRITE rid-âˆ˜â‰¥ #-}
rid-âˆ˜âŠ‡ : âˆ€ {X n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²}
                      â†’ (Î· : Îâ€² âŠ‡âŸ¨ e âŸ© Î)
                      â†’ Î· âˆ˜âŠ‡ idâŠ‡ â‰¡ Î·
rid-âˆ˜âŠ‡ done     = refl
rid-âˆ˜âŠ‡ (drop Î·) = drop & rid-âˆ˜âŠ‡ Î·
rid-âˆ˜âŠ‡ (keep Î·) = keep & rid-âˆ˜âŠ‡ Î·


{-# REWRITE assoc-âˆ˜â‰¥ #-}
assoc-âˆ˜âŠ‡ : âˆ€ {X n nâ€² nâ€³ nâ€´ eâ‚ eâ‚‚ eâ‚ƒ} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²} {Îâ€³ : Vec X nâ€³} {Îâ€´ : Vec X nâ€´}
                                     â†’ (Î·â‚ : Îâ€² âŠ‡âŸ¨ eâ‚ âŸ© Î) (Î·â‚‚ : Îâ€³ âŠ‡âŸ¨ eâ‚‚ âŸ© Îâ€²) (Î·â‚ƒ : Îâ€´ âŠ‡âŸ¨ eâ‚ƒ âŸ© Îâ€³)
                                     â†’ (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) âˆ˜âŠ‡ Î·â‚ƒ â‰¡ Î·â‚ âˆ˜âŠ‡ (Î·â‚‚ âˆ˜âŠ‡ Î·â‚ƒ)
assoc-âˆ˜âŠ‡ Î·â‚        Î·â‚‚        done      = refl
assoc-âˆ˜âŠ‡ Î·â‚        Î·â‚‚        (drop Î·â‚ƒ) = drop & assoc-âˆ˜âŠ‡ Î·â‚ Î·â‚‚ Î·â‚ƒ
assoc-âˆ˜âŠ‡ Î·â‚        (drop Î·â‚‚) (keep Î·â‚ƒ) = drop & assoc-âˆ˜âŠ‡ Î·â‚ Î·â‚‚ Î·â‚ƒ
assoc-âˆ˜âŠ‡ (drop Î·â‚) (keep Î·â‚‚) (keep Î·â‚ƒ) = drop & assoc-âˆ˜âŠ‡ Î·â‚ Î·â‚‚ Î·â‚ƒ
assoc-âˆ˜âŠ‡ (keep Î·â‚) (keep Î·â‚‚) (keep Î·â‚ƒ) = keep & assoc-âˆ˜âŠ‡ Î·â‚ Î·â‚‚ Î·â‚ƒ


--------------------------------------------------------------------------------


{-# REWRITE id-renF #-}
id-renâˆ‹ : âˆ€ {X A n i} â†’ {Î : Vec X n}
                      â†’ (ğ’¾ : Î âˆ‹âŸ¨ i âŸ© A)
                      â†’ renâˆ‹ idâŠ‡ ğ’¾ â‰¡ ğ’¾
id-renâˆ‹ zero    = refl
id-renâˆ‹ (suc ğ’¾) = suc & id-renâˆ‹ ğ’¾


{-# REWRITE comp-renF #-}
comp-renâˆ‹ : âˆ€ {X A n nâ€² nâ€³ eâ‚ eâ‚‚ i} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²} {Îâ€³ : Vec X nâ€³}
                                    â†’ (Î·â‚ : Îâ€² âŠ‡âŸ¨ eâ‚ âŸ© Î) (Î·â‚‚ : Îâ€³ âŠ‡âŸ¨ eâ‚‚ âŸ© Îâ€²) (ğ’¾ : Î âˆ‹âŸ¨ i âŸ© A)
                                    â†’ renâˆ‹ (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) ğ’¾ â‰¡ renâˆ‹ Î·â‚‚ (renâˆ‹ Î·â‚ ğ’¾) 
comp-renâˆ‹ Î·â‚        done      ğ’¾       = refl
comp-renâˆ‹ Î·â‚        (drop Î·â‚‚) ğ’¾       = suc & comp-renâˆ‹ Î·â‚ Î·â‚‚ ğ’¾
comp-renâˆ‹ (drop Î·â‚) (keep Î·â‚‚) ğ’¾       = suc & comp-renâˆ‹ Î·â‚ Î·â‚‚ ğ’¾
comp-renâˆ‹ (keep Î·â‚) (keep Î·â‚‚) zero    = refl
comp-renâˆ‹ (keep Î·â‚) (keep Î·â‚‚) (suc ğ’¾) = suc & comp-renâˆ‹ Î·â‚ Î·â‚‚ ğ’¾


--------------------------------------------------------------------------------
