<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201801.CMTTIsomorphismWithCML</title><link rel="stylesheet" href="AgdaPP.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201801.CMTTIsomorphismWithCML.html" class="Module">A201801.CMTTIsomorphismWithCML</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="103" class="Keyword">open</a> <a id="108" class="Keyword">import</a> <a id="115" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="A201801.List.html" class="Module">A201801.List</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="A201801.AllList.html" class="Module">A201801.AllList</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="234" class="Keyword">open</a> <a id="239" class="Keyword">import</a> <a id="246" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>
<a id="261" class="Keyword">open</a> <a id="266" class="Keyword">import</a> <a id="273" href="A201801.AllVecLemmas.html" class="Module">A201801.AllVecLemmas</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="A201801.CMTTScopes.html" class="Module">A201801.CMTTScopes</a>
<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="A201801.CMTTTypes.html" class="Module">A201801.CMTTTypes</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="A201801.CMTTTerms.html" class="Module">A201801.CMTTTerms</a>
<a id="385" class="Keyword">open</a> <a id="390" class="Keyword">import</a> <a id="397" href="A201801.CMTTDerivations.html" class="Module">A201801.CMTTDerivations</a>
<a id="421" class="Keyword">import</a> <a id="428" href="A201801.CMLPropositions.html" class="Module">A201801.CMLPropositions</a> <a id="452" class="Symbol">as</a> <a id="455" class="Module">CML</a>
<a id="459" class="Comment">-- import CMLDerivations as CML</a>


<a id="493" class="Comment">--------------------------------------------------------------------------------</a>


<a id="576" class="Keyword">mutual</a>
  <a id="â†“â‚š"></a><a id="585" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="588" class="Symbol">:</a> <a id="590" href="A201801.CMTTTypes.html#286" class="Datatype">Type</a> <a id="595" class="Symbol">â†’</a> <a id="597" href="A201801.CMLPropositions.html#224" class="Datatype">CML.Form</a>
  <a id="608" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="611" class="Symbol">(</a><a id="612" href="A201801.CMTTTypes.html#313" class="InductiveConstructor Operator">Î¹</a> <a id="614" href="A201801.CMTTIsomorphismWithCML.html#614" class="Bound">P</a><a id="615" class="Symbol">)</a>     <a id="621" class="Symbol">=</a> <a id="623" href="A201801.CMLPropositions.html#247" class="InductiveConstructor Operator">CML.Î¹</a> <a id="629" href="A201801.CMTTIsomorphismWithCML.html#614" class="Bound">P</a>
  <a id="633" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="636" class="Symbol">(</a><a id="637" href="A201801.CMTTIsomorphismWithCML.html#637" class="Bound">A</a> <a id="639" href="A201801.CMTTTypes.html#340" class="InductiveConstructor Operator">âŠƒ</a> <a id="641" href="A201801.CMTTIsomorphismWithCML.html#641" class="Bound">B</a><a id="642" class="Symbol">)</a>   <a id="646" class="Symbol">=</a> <a id="648" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="651" href="A201801.CMTTIsomorphismWithCML.html#637" class="Bound">A</a> <a id="653" href="A201801.CMLPropositions.html#272" class="InductiveConstructor Operator">CML.âŠƒ</a> <a id="659" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="662" href="A201801.CMTTIsomorphismWithCML.html#641" class="Bound">B</a>
  <a id="666" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="669" class="Symbol">(</a><a id="670" href="A201801.CMTTTypes.html#372" class="InductiveConstructor Operator">[</a> <a id="672" href="A201801.CMTTIsomorphismWithCML.html#672" class="Bound">Î¨</a> <a id="674" href="A201801.CMTTTypes.html#372" class="InductiveConstructor Operator">]</a> <a id="676" href="A201801.CMTTIsomorphismWithCML.html#676" class="Bound">A</a><a id="677" class="Symbol">)</a> <a id="679" class="Symbol">=</a> <a id="681" href="A201801.CMLPropositions.html#302" class="InductiveConstructor Operator">CML.[</a> <a id="687" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="691" href="A201801.CMTTIsomorphismWithCML.html#672" class="Bound">Î¨</a> <a id="693" href="A201801.CMLPropositions.html#302" class="InductiveConstructor Operator">]</a> <a id="695" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="698" href="A201801.CMTTIsomorphismWithCML.html#676" class="Bound">A</a>

  <a id="â†“â‚šâ‚›"></a><a id="703" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="707" class="Symbol">:</a> <a id="709" class="Symbol">âˆ€</a> <a id="711" class="Symbol">{</a><a id="712" href="A201801.CMTTIsomorphismWithCML.html#712" class="Bound">n</a><a id="713" class="Symbol">}</a> <a id="715" class="Symbol">â†’</a> <a id="717" href="A201801.CMTTTypes.html#413" class="Function">Types</a> <a id="723" href="A201801.CMTTIsomorphismWithCML.html#712" class="Bound">n</a> <a id="725" class="Symbol">â†’</a> <a id="727" href="A201801.List.html#199" class="Datatype">List</a> <a id="732" href="A201801.CMLPropositions.html#224" class="Datatype">CML.Form</a>
  <a id="743" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="747" href="A201801.Vec.html#266" class="InductiveConstructor">âˆ™</a>       <a id="755" class="Symbol">=</a> <a id="757" href="A201801.List.html#232" class="InductiveConstructor">âˆ™</a>
  <a id="761" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="765" class="Symbol">(</a><a id="766" href="A201801.CMTTIsomorphismWithCML.html#766" class="Bound">Î</a> <a id="768" href="A201801.Vec.html#287" class="InductiveConstructor Operator">,</a> <a id="770" href="A201801.CMTTIsomorphismWithCML.html#770" class="Bound">A</a><a id="771" class="Symbol">)</a> <a id="773" class="Symbol">=</a> <a id="775" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="779" href="A201801.CMTTIsomorphismWithCML.html#766" class="Bound">Î</a> <a id="781" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="783" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="786" href="A201801.CMTTIsomorphismWithCML.html#770" class="Bound">A</a>


<a id="â†“â‚"></a><a id="790" href="A201801.CMTTIsomorphismWithCML.html#790" class="Function">â†“â‚</a> <a id="793" class="Symbol">:</a> <a id="795" class="Symbol">âˆ€</a> <a id="797" class="Symbol">{</a><a id="798" href="A201801.CMTTIsomorphismWithCML.html#798" class="Bound">g</a><a id="799" class="Symbol">}</a> <a id="801" class="Symbol">â†’</a> <a id="803" href="A201801.CMTTTypes.html#674" class="Record">Assert</a> <a id="810" href="A201801.CMTTIsomorphismWithCML.html#798" class="Bound">g</a>
           <a id="823" class="Symbol">â†’</a> <a id="825" href="A201801.CMLPropositions.html#553" class="Record">CML.Assert</a>
<a id="836" href="A201801.CMTTIsomorphismWithCML.html#790" class="Function">â†“â‚</a> <a id="839" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŸª</a> <a id="841" href="A201801.CMTTIsomorphismWithCML.html#841" class="Bound">Î“</a> <a id="843" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŠ«</a> <a id="845" href="A201801.CMTTIsomorphismWithCML.html#845" class="Bound">A</a> <a id="847" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŸ«</a> <a id="849" class="Symbol">=</a> <a id="851" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">CML.âŸª</a> <a id="857" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="861" href="A201801.CMTTIsomorphismWithCML.html#841" class="Bound">Î“</a> <a id="863" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">âŠ«</a> <a id="865" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="868" href="A201801.CMTTIsomorphismWithCML.html#845" class="Bound">A</a> <a id="870" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">âŸ«</a>


<a id="â†“â‚â‚›"></a><a id="874" href="A201801.CMTTIsomorphismWithCML.html#874" class="Function">â†“â‚â‚›</a> <a id="878" class="Symbol">:</a> <a id="880" class="Symbol">âˆ€</a> <a id="882" class="Symbol">{</a><a id="883" href="A201801.CMTTIsomorphismWithCML.html#883" class="Bound">d</a><a id="884" class="Symbol">}</a> <a id="886" class="Symbol">â†’</a> <a id="888" class="Symbol">{</a><a id="889" href="A201801.CMTTIsomorphismWithCML.html#889" class="Bound">Ïƒ</a> <a id="891" class="Symbol">:</a> <a id="893" href="A201801.CMTTScopes.html#171" class="Function">Scopes</a> <a id="900" href="A201801.CMTTIsomorphismWithCML.html#883" class="Bound">d</a><a id="901" class="Symbol">}</a>
            <a id="915" class="Symbol">â†’</a> <a id="917" href="A201801.CMTTTypes.html#772" class="Function">Asserts</a> <a id="925" href="A201801.CMTTIsomorphismWithCML.html#889" class="Bound">Ïƒ</a>
            <a id="939" class="Symbol">â†’</a> <a id="941" href="A201801.List.html#199" class="Datatype">List</a> <a id="946" href="A201801.CMLPropositions.html#553" class="Record">CML.Assert</a>
<a id="957" href="A201801.CMTTIsomorphismWithCML.html#874" class="Function">â†“â‚â‚›</a> <a id="961" href="A201801.AllVec.html#230" class="InductiveConstructor">âˆ™</a>                <a id="978" class="Symbol">=</a> <a id="980" href="A201801.List.html#232" class="InductiveConstructor">âˆ™</a>
<a id="982" href="A201801.CMTTIsomorphismWithCML.html#874" class="Function">â†“â‚â‚›</a> <a id="986" class="Symbol">(</a><a id="987" href="A201801.CMTTIsomorphismWithCML.html#987" class="Bound">Î”</a> <a id="989" href="A201801.AllVec.html#248" class="InductiveConstructor Operator">,</a> <a id="991" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŸª</a> <a id="993" href="A201801.CMTTIsomorphismWithCML.html#993" class="Bound">Î“</a> <a id="995" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŠ«</a> <a id="997" href="A201801.CMTTIsomorphismWithCML.html#997" class="Bound">A</a> <a id="999" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŸ«</a><a id="1000" class="Symbol">)</a> <a id="1002" class="Symbol">=</a> <a id="1004" href="A201801.CMTTIsomorphismWithCML.html#874" class="Function">â†“â‚â‚›</a> <a id="1008" href="A201801.CMTTIsomorphismWithCML.html#987" class="Bound">Î”</a> <a id="1010" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="1012" href="A201801.CMTTIsomorphismWithCML.html#790" class="Function">â†“â‚</a> <a id="1015" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŸª</a> <a id="1017" href="A201801.CMTTIsomorphismWithCML.html#993" class="Bound">Î“</a> <a id="1019" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŠ«</a> <a id="1021" href="A201801.CMTTIsomorphismWithCML.html#997" class="Bound">A</a> <a id="1023" href="A201801.CMTTTypes.html#721" class="InductiveConstructor Operator">âŸ«</a>


<a id="â†“âˆ‹â‚š"></a><a id="1027" href="A201801.CMTTIsomorphismWithCML.html#1027" class="Function">â†“âˆ‹â‚š</a> <a id="1031" class="Symbol">:</a> <a id="1033" class="Symbol">âˆ€</a> <a id="1035" class="Symbol">{</a><a id="1036" href="A201801.CMTTIsomorphismWithCML.html#1036" class="Bound">g</a> <a id="1038" href="A201801.CMTTIsomorphismWithCML.html#1038" class="Bound">I</a> <a id="1040" href="A201801.CMTTIsomorphismWithCML.html#1040" class="Bound">A</a><a id="1041" class="Symbol">}</a> <a id="1043" class="Symbol">â†’</a> <a id="1045" class="Symbol">{</a><a id="1046" href="A201801.CMTTIsomorphismWithCML.html#1046" class="Bound">Î“</a> <a id="1048" class="Symbol">:</a> <a id="1050" href="A201801.CMTTTypes.html#413" class="Function">Types</a> <a id="1056" href="A201801.CMTTIsomorphismWithCML.html#1036" class="Bound">g</a><a id="1057" class="Symbol">}</a>
                <a id="1075" class="Symbol">â†’</a> <a id="1077" href="A201801.CMTTIsomorphismWithCML.html#1046" class="Bound">Î“</a> <a id="1079" href="A201801.Vec.html#2295" class="Datatype Operator">âˆ‹âŸ¨</a> <a id="1082" href="A201801.CMTTIsomorphismWithCML.html#1038" class="Bound">I</a> <a id="1084" href="A201801.Vec.html#2295" class="Datatype Operator">âŸ©</a> <a id="1086" href="A201801.CMTTIsomorphismWithCML.html#1040" class="Bound">A</a>
                <a id="1104" class="Symbol">â†’</a> <a id="1106" href="A201801.CMTTIsomorphismWithCML.html#703" class="Function">â†“â‚šâ‚›</a> <a id="1110" href="A201801.CMTTIsomorphismWithCML.html#1046" class="Bound">Î“</a> <a id="1112" href="A201801.List.html#2340" class="Datatype Operator">âˆ‹</a> <a id="1114" href="A201801.CMTTIsomorphismWithCML.html#585" class="Function">â†“â‚š</a> <a id="1117" href="A201801.CMTTIsomorphismWithCML.html#1040" class="Bound">A</a>
<a id="1119" href="A201801.CMTTIsomorphismWithCML.html#1027" class="Function">â†“âˆ‹â‚š</a> <a id="1123" href="A201801.Vec.html#2354" class="InductiveConstructor">zero</a>    <a id="1131" class="Symbol">=</a> <a id="1133" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>
<a id="1138" href="A201801.CMTTIsomorphismWithCML.html#1027" class="Function">â†“âˆ‹â‚š</a> <a id="1142" class="Symbol">(</a><a id="1143" href="A201801.Vec.html#2429" class="InductiveConstructor">suc</a> <a id="1147" href="A201801.CMTTIsomorphismWithCML.html#1147" class="Bound">i</a><a id="1148" class="Symbol">)</a> <a id="1150" class="Symbol">=</a> <a id="1152" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1156" class="Symbol">(</a><a id="1157" href="A201801.CMTTIsomorphismWithCML.html#1027" class="Function">â†“âˆ‹â‚š</a> <a id="1161" href="A201801.CMTTIsomorphismWithCML.html#1147" class="Bound">i</a><a id="1162" class="Symbol">)</a>


<a id="1166" class="Comment">-- TODO: something broke</a>
<a id="1191" class="Comment">-- â†“âˆ‹â‚ : âˆ€ {d m I A} â†’ {Ïƒ : Scopes d} {i : Ïƒ âˆ‹âŸ¨ I âŸ© m}</a>
<a id="1246" class="Comment">--                      {Î” : Asserts Ïƒ} {Î¨ : Types m}</a>
<a id="1300" class="Comment">--                   â†’ Î” AllVec.âˆ‹â—‡âŸ¨ i âŸ© âŸª Î¨ âŠ« A âŸ«</a>
<a id="1350" class="Comment">--                   â†’ â†“â‚â‚› Î” âˆ‹ â†“â‚ âŸª Î¨ âŠ« A âŸ«</a>
<a id="1394" class="Comment">-- â†“âˆ‹â‚ zero    = zero</a>
<a id="1416" class="Comment">-- â†“âˆ‹â‚ (suc i) = suc (â†“âˆ‹â‚ i)</a>


<a id="1447" class="Comment">--------------------------------------------------------------------------------</a>

<a id="1529" class="Comment">-- TODO: unfinished</a>
<a id="1549" class="Comment">-- mutual</a>
<a id="1559" class="Comment">--   infix 3 _âŠ¢_â¦‚_match[_]_</a>
<a id="1587" class="Comment">--   data _âŠ¢_â¦‚_match[_]_ : âˆ€ {d g} â†’ {Ïƒ : Scopes d}</a>
<a id="1639" class="Comment">--                                  â†’ (Î” : Asserts Ïƒ) â†’ Term Ïƒ g â†’ (A : Type) (Î“ : Types g)</a>
<a id="1731" class="Comment">--                                  â†’ â†“â‚â‚› Î” CML.âŠ¢ â†“â‚š A valid[ â†“â‚šâ‚› Î“ ] â†’ Set</a>
<a id="1807" class="Comment">--     where</a>
<a id="1820" class="Comment">--       var : âˆ€ {A d g I} â†’ {Ïƒ : Scopes d}</a>
<a id="1864" class="Comment">--                            {Î” : Asserts Ïƒ} {Î“ : Types g}</a>
<a id="1924" class="Comment">--                         â†’ (i : Î“ âˆ‹âŸ¨ I âŸ© A)</a>
<a id="1970" class="Comment">--                         â†’ Î” âŠ¢ VAR I â¦‚ A match[ Î“ ] CML.var (â†“âˆ‹â‚š i)</a>

<a id="2041" class="Comment">--       lam : âˆ€ {A B d g} â†’ {Ïƒ : Scopes d}</a>
<a id="2085" class="Comment">--                            {Î” : Asserts Ïƒ} {Î“ : Types g}</a>
<a id="2145" class="Comment">--                            {M : Term Ïƒ (suc g)}</a>
<a id="2196" class="Comment">--                            {ğ’Ÿ : _}</a>
<a id="2234" class="Comment">--                         â†’ Î” âŠ¢ M â¦‚ B match[ Î“ , A ] ğ’Ÿ</a>
<a id="2290" class="Comment">--                         â†’ Î” âŠ¢ LAM M â¦‚ A âŠƒ B match[ Î“ ] CML.lam ğ’Ÿ</a>

<a id="2359" class="Comment">--       app : âˆ€ {A B d g} â†’ {Ïƒ : Scopes d}</a>
<a id="2403" class="Comment">--                            {Î” : Asserts Ïƒ} {Î“ : Types g}</a>
<a id="2463" class="Comment">--                            {M N : Term Ïƒ g}</a>
<a id="2510" class="Comment">--                            {ğ’Ÿ : _} {â„° : _}</a>
<a id="2556" class="Comment">--                         â†’ Î” âŠ¢ M â¦‚ A âŠƒ B match[ Î“ ] ğ’Ÿ â†’ Î” âŠ¢ N â¦‚ A match[ Î“ ] â„°</a>
<a id="2637" class="Comment">--                         â†’ Î” âŠ¢ APP M N â¦‚ B match[ Î“ ] CML.app ğ’Ÿ â„°</a>

<a id="2706" class="Comment">--       mvar : âˆ€ {A m d g I} â†’ {Ïƒ : Scopes d}</a>
<a id="2753" class="Comment">--                               {Î¨ : Types m} {Î” : Asserts Ïƒ} {Î“ : Types g}</a>
<a id="2830" class="Comment">--                               {i : Ïƒ âˆ‹âŸ¨ I âŸ© m} {Ï… : Terms Ïƒ g m}</a>
<a id="2898" class="Comment">--                            â†’ Î” AllVec.âˆ‹â—‡âŸ¨ i âŸ© âŸª Î¨ âŠ« A âŸ« â†’ Î” âŠ¢ Ï… â¦‚ Î¨ allmatch[ Î“ ] {!!}</a>
<a id="2988" class="Comment">--                            â†’ Î” âŠ¢ MVAR i Ï… â¦‚ A match[ Î“ ] CML.mvar {!i!} {!!}</a>

<a id="3069" class="Comment">--       box : âˆ€ {A m d g} â†’ {Ïƒ : Scopes d}</a>
<a id="3113" class="Comment">--                            {Î¨ : Types m} {Î” : Asserts Ïƒ} {Î“ : Types g}</a>
<a id="3187" class="Comment">--                            {M : Term Ïƒ m}</a>
<a id="3232" class="Comment">--                            {ğ’Ÿ : _}</a>
<a id="3270" class="Comment">--                         â†’ Î” âŠ¢ M â¦‚ A match[ Î¨ ] ğ’Ÿ</a>
<a id="3322" class="Comment">--                         â†’ Î” âŠ¢ BOX M â¦‚ [ Î¨ ] A match[ Î“ ] CML.box ğ’Ÿ</a>

<a id="3393" class="Comment">--       letbox : âˆ€ {A B m d g} â†’ {Ïƒ : Scopes d}</a>
<a id="3442" class="Comment">--                                 {Î¨ : Types m} {Î” : Asserts Ïƒ} {Î“ : Types g}</a>
<a id="3521" class="Comment">--                                 {M : Term Ïƒ g} {N : Term (Ïƒ , m) g}</a>
<a id="3592" class="Comment">--                                 {ğ’Ÿ : _} {â„° : _}</a>
<a id="3643" class="Comment">--                              â†’ Î” âŠ¢ M â¦‚ [ Î¨ ] A match[ Î“ ] ğ’Ÿ â†’ Î” , âŸª Î¨ âŠ« A âŸ« âŠ¢ N â¦‚ B match[ Î“ ] â„°</a>
<a id="3743" class="Comment">--                              â†’ Î” âŠ¢ LETBOX M N â¦‚ B match[ Î“ ] CML.letbox ğ’Ÿ â„°</a>

<a id="3823" class="Comment">--   infix 3 _âŠ¢_â¦‚_allmatch[_]_</a>
<a id="3854" class="Comment">--   _âŠ¢_â¦‚_allmatch[_]_ : âˆ€ {d g n} â†’ {Ïƒ : Scopes d}</a>
<a id="3906" class="Comment">--                                  â†’ (Î” : Asserts Ïƒ) â†’ Terms Ïƒ g n â†’ (Î : Types n) (Î“ : Types g)</a>
<a id="4004" class="Comment">--                                  â†’ â†“â‚â‚› Î” CML.âŠ¢ â†“â‚šâ‚› Î allvalid[ â†“â‚šâ‚› Î“ ] â†’ Set</a>
<a id="4084" class="Comment">--   Î” âŠ¢ âˆ™     â¦‚ âˆ™       allmatch[ Î“ ] âˆ™       = ğŸ™</a>
<a id="4135" class="Comment">--   Î” âŠ¢ Ï„ , M â¦‚ (Î , A) allmatch[ Î“ ] (Î¾ , ğ’Ÿ) = Î” âŠ¢ Ï„ â¦‚ Î allmatch[ Î“ ] Î¾ Ã— Î” âŠ¢ M â¦‚ A match[ Î“ ] ğ’Ÿ</a>




<a id="4239" class="Comment">-- --     var : âˆ€ {A d g Î” Î“ i} â†’ (I : Fin g)</a>
<a id="4285" class="Comment">-- --                           â†’ Î” âŠ¢ VAR {d} (toFin i) â¦‚ A match[ Î“ ] CML.var i</a>

<a id="4367" class="Comment">-- --     lam : âˆ€ {A B d g Î” Î“ ğ’Ÿ} â†’ {M : Term d (suc g)}</a>
<a id="4424" class="Comment">-- --                             â†’ Î” âŠ¢ M â¦‚ B match[ Î“ , A ] ğ’Ÿ</a>
<a id="4487" class="Comment">-- --                             â†’ Î” âŠ¢ LAM M â¦‚ A âŠƒ B match[ Î“ ] CML.lam ğ’Ÿ</a>

<a id="4563" class="Comment">-- --     app : âˆ€ {A B d g Î” Î“ ğ’Ÿ â„°} â†’ {M N : Term d g}</a>
<a id="4618" class="Comment">-- --                               â†’ Î” âŠ¢ M â¦‚ A âŠƒ B match[ Î“ ] ğ’Ÿ â†’ Î” âŠ¢ N â¦‚ A match[ Î“ ] â„°</a>
<a id="4708" class="Comment">-- --                               â†’ Î” âŠ¢ APP M N â¦‚ B match[ Î“ ] CML.app ğ’Ÿ â„°</a>

<a id="4786" class="Comment">-- --     mvar : âˆ€ {A d g Î” Î“ i} â†’ (I : Fin d)</a>
<a id="4833" class="Comment">-- --                            â†’ Î” âŠ¢ MVAR {g = g} (toFin i) â¦‚ A match[ Î“ ] CML.mvar i</a>

<a id="4922" class="Comment">-- -- --     box : âˆ€ {A d g Î” Î“ ğ’Ÿ} â†’ {M : Term d zero}</a>
<a id="4977" class="Comment">-- -- --                           â†’ Î” âŠ¢ M â¦‚ A match[ âˆ™ ] ğ’Ÿ</a>
<a id="5037" class="Comment">-- -- --                           â†’ Î” âŠ¢ BOX {g = g} M â¦‚ â–¡ A match[ Î“ ] CML.box ğ’Ÿ</a>

<a id="5120" class="Comment">-- -- --     letbox : âˆ€ {A B d g Î” Î“ ğ’Ÿ â„°} â†’ {M : Term d g} {N : Term (suc d) g}</a>
<a id="5200" class="Comment">-- -- --                                  â†’ Î” âŠ¢ M â¦‚ â–¡ A match[ Î“ ] ğ’Ÿ â†’ Î” , âŸªâŠ« A âŸ« âŠ¢ N â¦‚ B match[ Î“ ] â„°</a>
<a id="5303" class="Comment">-- -- --                                  â†’ Î” âŠ¢ LETBOX M N â¦‚ B match[ Î“ ] CML.letbox ğ’Ÿ â„°</a>


<a id="5394" class="Comment">-- -- -- -- --------------------------------------------------------------------------------</a>


<a id="5489" class="Comment">-- -- -- -- toTerm : âˆ€ {Î” Î“ A} â†’ Î” CML.âŠ¢ A valid[ Î“ ]</a>
<a id="5543" class="Comment">-- -- -- --                    â†’ Term (len Î”) (len Î“)</a>
<a id="5597" class="Comment">-- -- -- -- toTerm (CML.var i)      = VAR (toFin i)</a>
<a id="5649" class="Comment">-- -- -- -- toTerm (CML.lam ğ’Ÿ)      = LAM (toTerm ğ’Ÿ)</a>
<a id="5702" class="Comment">-- -- -- -- toTerm (CML.app ğ’Ÿ â„°)    = APP (toTerm ğ’Ÿ) (toTerm â„°)</a>
<a id="5766" class="Comment">-- -- -- -- toTerm (CML.mvar i)     = MVAR (toFin i)</a>
<a id="5819" class="Comment">-- -- -- -- toTerm (CML.box ğ’Ÿ)      = BOX (toTerm ğ’Ÿ)</a>
<a id="5872" class="Comment">-- -- -- -- toTerm (CML.letbox ğ’Ÿ â„°) = LETBOX (toTerm ğ’Ÿ) (toTerm â„°)</a>


<a id="5941" class="Comment">-- -- -- -- instance</a>
<a id="5962" class="Comment">-- -- -- --   match-toTerm : âˆ€ {Î” Î“ A} â†’ (ğ’Ÿ : Î” CML.âŠ¢ A valid[ Î“ ])</a>
<a id="6030" class="Comment">-- -- -- --                            â†’ Î” âŠ¢ toTerm ğ’Ÿ â¦‚ A match[ Î“ ] ğ’Ÿ</a>
<a id="6101" class="Comment">-- -- -- --   match-toTerm (CML.var i)      = var (toFin i)</a>
<a id="6161" class="Comment">-- -- -- --   match-toTerm (CML.lam ğ’Ÿ)      = lam (match-toTerm ğ’Ÿ)</a>
<a id="6228" class="Comment">-- -- -- --   match-toTerm (CML.app ğ’Ÿ â„°)    = app (match-toTerm ğ’Ÿ) (match-toTerm â„°)</a>
<a id="6312" class="Comment">-- -- -- --   match-toTerm (CML.mvar i)     = mvar (toFin i)</a>
<a id="6373" class="Comment">-- -- -- --   match-toTerm (CML.box ğ’Ÿ)      = box (match-toTerm ğ’Ÿ)</a>
<a id="6440" class="Comment">-- -- -- --   match-toTerm (CML.letbox ğ’Ÿ â„°) = letbox (match-toTerm ğ’Ÿ) (match-toTerm â„°)</a>


<a id="6529" class="Comment">-- -- -- -- --------------------------------------------------------------------------------</a>


<a id="6624" class="Comment">-- -- -- -- â†“ : âˆ€ {d g M A} â†’ {Î” : Asserts d} {Î“ : Types g}</a>
<a id="6684" class="Comment">-- -- -- --                 â†’ Î” âŠ¢ M â¦‚ A valid[ Î“ ]</a>
<a id="6735" class="Comment">-- -- -- --                 â†’ toList Î” CML.âŠ¢ A valid[ toList Î“ ]</a>
<a id="6800" class="Comment">-- -- -- -- â†“ (var i)      = CML.var (toâˆ‹ i)</a>
<a id="6845" class="Comment">-- -- -- -- â†“ (lam ğ’Ÿ)      = CML.lam (â†“ ğ’Ÿ)</a>
<a id="6888" class="Comment">-- -- -- -- â†“ (app ğ’Ÿ â„°)    = CML.app (â†“ ğ’Ÿ) (â†“ â„°)</a>
<a id="6937" class="Comment">-- -- -- -- â†“ (mvar i)     = CML.mvar (toâˆ‹ i)</a>
<a id="6983" class="Comment">-- -- -- -- â†“ (box ğ’Ÿ)      = CML.box (â†“ ğ’Ÿ)</a>
<a id="7026" class="Comment">-- -- -- -- â†“ (letbox ğ’Ÿ â„°) = CML.letbox (â†“ ğ’Ÿ) (â†“ â„°)</a>


<a id="7080" class="Comment">-- -- -- -- instance</a>
<a id="7101" class="Comment">-- -- -- --   matchâ†“ : âˆ€ {d g M A} â†’ {Î” : Asserts d} {Î“ : Types g}</a>
<a id="7168" class="Comment">-- -- -- --                        â†’ (ğ’Ÿ : Î” âŠ¢ M â¦‚ A valid[ Î“ ])</a>
<a id="7232" class="Comment">-- -- -- --                        â†’ toList Î” âŠ¢ M â¦‚ A match[ toList Î“ ] â†“ ğ’Ÿ</a>
<a id="7308" class="Comment">-- -- -- --   matchâ†“ (var {I = I} i)  = var I</a>
<a id="7354" class="Comment">-- -- -- --   matchâ†“ (lam ğ’Ÿ)          = lam (matchâ†“ ğ’Ÿ)</a>
<a id="7409" class="Comment">-- -- -- --   matchâ†“ (app ğ’Ÿ â„°)        = app (matchâ†“ ğ’Ÿ) (matchâ†“ â„°)</a>
<a id="7475" class="Comment">-- -- -- --   matchâ†“ (mvar {I = I} i) = mvar I</a>
<a id="7522" class="Comment">-- -- -- --   matchâ†“ (box ğ’Ÿ)          = box (matchâ†“ ğ’Ÿ)</a>
<a id="7577" class="Comment">-- -- -- --   matchâ†“ (letbox ğ’Ÿ â„°)     = letbox (matchâ†“ ğ’Ÿ) (matchâ†“ â„°)</a>


<a id="7648" class="Comment">-- -- -- -- â†‘ : âˆ€ {Î” Î“ M A} â†’ (ğ’Ÿ : Î” CML.âŠ¢ A valid[ Î“ ]) {{p : Î” âŠ¢ M â¦‚ A match[ Î“ ] ğ’Ÿ}}</a>
<a id="7736" class="Comment">-- -- -- --                 â†’ fromList Î” âŠ¢ M â¦‚ A valid[ fromList Î“ ]</a>
<a id="7805" class="Comment">-- -- -- -- â†‘ (CML.var i)      {{var I}}      = var (fromâˆ‹ i)</a>
<a id="7867" class="Comment">-- -- -- -- â†‘ (CML.lam ğ’Ÿ)      {{lam p}}      = lam (â†‘ ğ’Ÿ {{p}})</a>
<a id="7931" class="Comment">-- -- -- -- â†‘ (CML.app ğ’Ÿ â„°)    {{app p q}}    = app (â†‘ ğ’Ÿ {{p}}) (â†‘ â„° {{q}})</a>
<a id="8007" class="Comment">-- -- -- -- â†‘ (CML.mvar i)     {{mvar I}}     = mvar (fromâˆ‹ i)</a>
<a id="8070" class="Comment">-- -- -- -- â†‘ (CML.box ğ’Ÿ)      {{box p}}      = box (â†‘ ğ’Ÿ {{p}})</a>
<a id="8134" class="Comment">-- -- -- -- â†‘ (CML.letbox ğ’Ÿ â„°) {{letbox p q}} = letbox (â†‘ ğ’Ÿ {{p}}) (â†‘ â„° {{q}})</a>


<a id="8215" class="Comment">-- -- -- -- --------------------------------------------------------------------------------</a>


<a id="8310" class="Comment">-- -- -- -- gen-idâ†“â†‘ : âˆ€ {Î” Î“ M A} â†’ (ğ’Ÿ : Î” CML.âŠ¢ A valid[ Î“ ]) {{p : Î” âŠ¢ M â¦‚ A match[ Î“ ] ğ’Ÿ}}</a>
<a id="8405" class="Comment">-- -- -- --                        â†’ â†“ (â†‘ ğ’Ÿ {{p}}) â‰¡ ğ’Ÿ</a>
<a id="8460" class="Comment">-- -- -- -- gen-idâ†“â†‘ (CML.var i)      {{var I}}      = refl</a>
<a id="8520" class="Comment">-- -- -- -- gen-idâ†“â†‘ (CML.lam ğ’Ÿ)      {{lam p}}      = CML.lam &amp; gen-idâ†“â†‘ ğ’Ÿ {{p}}</a>
<a id="8602" class="Comment">-- -- -- -- gen-idâ†“â†‘ (CML.app ğ’Ÿ â„°)    {{app p q}}    = CML.app &amp; gen-idâ†“â†‘ ğ’Ÿ {{p}} âŠ— gen-idâ†“â†‘ â„° {{q}}</a>
<a id="8703" class="Comment">-- -- -- -- gen-idâ†“â†‘ (CML.mvar i)     {{mvar I}}     = refl</a>
<a id="8763" class="Comment">-- -- -- -- gen-idâ†“â†‘ (CML.box ğ’Ÿ)      {{box p}}      = CML.box &amp; gen-idâ†“â†‘ ğ’Ÿ {{p}}</a>
<a id="8845" class="Comment">-- -- -- -- gen-idâ†“â†‘ (CML.letbox ğ’Ÿ â„°) {{letbox p q}} = CML.letbox &amp; gen-idâ†“â†‘ ğ’Ÿ {{p}} âŠ— gen-idâ†“â†‘ â„° {{q}}</a>


<a id="8951" class="Comment">-- -- -- -- idâ†“â†‘ : âˆ€ {Î” Î“ A} â†’ (ğ’Ÿ : Î” CML.âŠ¢ A valid[ Î“ ])</a>
<a id="9009" class="Comment">-- -- -- --                  â†’ â†“ (â†‘ ğ’Ÿ) â‰¡ ğ’Ÿ</a>
<a id="9052" class="Comment">-- -- -- -- idâ†“â†‘ ğ’Ÿ = gen-idâ†“â†‘ ğ’Ÿ {{match-toTerm ğ’Ÿ}}</a>


<a id="9105" class="Comment">-- -- -- -- gen-idâ†‘â†“ : âˆ€ {d g M A} â†’ {Î” : Asserts d} {Î“ : Types g}</a>
<a id="9172" class="Comment">-- -- -- --                        â†’ (ğ’Ÿ : Î” âŠ¢ M â¦‚ A valid[ Î“ ]) {{p : toList Î” âŠ¢ M â¦‚ A match[ toList Î“ ] â†“ ğ’Ÿ}}</a>
<a id="9283" class="Comment">-- -- -- --                        â†’ â†‘ (â†“ ğ’Ÿ) {{p}} â‰¡ ğ’Ÿ</a>
<a id="9338" class="Comment">-- -- -- -- gen-idâ†‘â†“ (var i)      {{var I}}      = refl</a>
<a id="9394" class="Comment">-- -- -- -- gen-idâ†‘â†“ (lam ğ’Ÿ)      {{lam p}}      = lam &amp; gen-idâ†‘â†“ ğ’Ÿ {{p}}</a>
<a id="9468" class="Comment">-- -- -- -- gen-idâ†‘â†“ (app ğ’Ÿ â„°)    {{app p q}}    = app &amp; gen-idâ†‘â†“ ğ’Ÿ {{p}} âŠ— gen-idâ†‘â†“ â„° {{q}}</a>
<a id="9561" class="Comment">-- -- -- -- gen-idâ†‘â†“ (mvar i)     {{mvar I}}     = refl</a>
<a id="9617" class="Comment">-- -- -- -- gen-idâ†‘â†“ (box ğ’Ÿ)      {{box p}}      = box &amp; gen-idâ†‘â†“ ğ’Ÿ {{p}}</a>
<a id="9691" class="Comment">-- -- -- -- gen-idâ†‘â†“ (letbox ğ’Ÿ â„°) {{letbox p q}} = letbox &amp; gen-idâ†‘â†“ ğ’Ÿ {{p}} âŠ— gen-idâ†‘â†“ â„° {{q}}</a>


<a id="9789" class="Comment">-- -- -- -- idâ†‘â†“ : âˆ€ {d g M A} â†’ {Î” : Asserts d} {Î“ : Types g}</a>
<a id="9852" class="Comment">-- -- -- --                    â†’ (ğ’Ÿ : Î” âŠ¢ M â¦‚ A valid[ Î“ ])</a>
<a id="9912" class="Comment">-- -- -- --                    â†’ â†‘ (â†“ ğ’Ÿ) â‰¡ ğ’Ÿ</a>
<a id="9957" class="Comment">-- -- -- -- idâ†‘â†“ ğ’Ÿ = gen-idâ†‘â†“ ğ’Ÿ {{matchâ†“ ğ’Ÿ}}</a>


<a id="10004" class="Comment">-- -- -- -- --------------------------------------------------------------------------------</a>
</pre></body></html>