<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201706.IMCLP</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201706.IMCLP.html" class="Module">A201706.IMCLP</a> <a id="51" class="Keyword">where</a>

<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="A201706.PreludeVec.html" class="Module">A201706.PreludeVec</a> <a id="89" class="Keyword">public</a>


<a id="98" class="Comment">-- Terms.</a>

<a id="109" class="Keyword">mutual</a>
  <a id="118" class="Keyword">data</a> <a id="Tm"></a><a id="123" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="126" class="Symbol">(</a><a id="127" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="129" href="A201706.IMCLP.html#129" class="Bound">g</a> <a id="131" class="Symbol">:</a> <a id="133" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a><a id="136" class="Symbol">)</a> <a id="138" class="Symbol">:</a> <a id="140" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="144" class="Keyword">where</a>
    <a id="Tm.VAR"></a><a id="154" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a>   <a id="160" class="Symbol">:</a> <a id="162" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="166" href="A201706.IMCLP.html#129" class="Bound">g</a> <a id="168" class="Symbol">→</a> <a id="170" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="173" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="175" href="A201706.IMCLP.html#129" class="Bound">g</a>
    <a id="Tm.MVAR"></a><a id="181" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a>  <a id="187" class="Symbol">:</a> <a id="189" class="Symbol">∀</a> <a id="191" class="Symbol">{</a><a id="192" href="A201706.IMCLP.html#192" class="Bound">`d</a><a id="194" class="Symbol">}</a> <a id="196" class="Symbol">→</a> <a id="198" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="202" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="204" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="209" href="A201706.IMCLP.html#192" class="Bound">`d</a> <a id="212" class="Symbol">→</a> <a id="214" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="218" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="220" class="Symbol">→</a> <a id="222" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="225" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="227" href="A201706.IMCLP.html#129" class="Bound">g</a>
    <a id="Tm.LAM"></a><a id="233" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a>   <a id="239" class="Symbol">:</a> <a id="241" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="244" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="246" class="Symbol">(</a><a id="247" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="251" href="A201706.IMCLP.html#129" class="Bound">g</a><a id="252" class="Symbol">)</a> <a id="254" class="Symbol">→</a> <a id="256" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="259" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="261" href="A201706.IMCLP.html#129" class="Bound">g</a>
    <a id="Tm.APP"></a><a id="267" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a>   <a id="273" class="Symbol">:</a> <a id="275" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="278" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="280" href="A201706.IMCLP.html#129" class="Bound">g</a> <a id="282" class="Symbol">→</a> <a id="284" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="287" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="289" href="A201706.IMCLP.html#129" class="Bound">g</a> <a id="291" class="Symbol">→</a> <a id="293" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="296" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="298" href="A201706.IMCLP.html#129" class="Bound">g</a>
    <a id="Tm.BOX"></a><a id="304" href="A201706.IMCLP.html#304" class="InductiveConstructor">BOX</a>   <a id="310" class="Symbol">:</a> <a id="312" class="Symbol">∀</a> <a id="314" class="Symbol">{</a><a id="315" href="A201706.IMCLP.html#315" class="Bound">`d</a><a id="317" class="Symbol">}</a> <a id="319" class="Symbol">→</a> <a id="321" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="324" href="A201706.IMCLP.html#315" class="Bound">`d</a> <a id="327" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="332" class="Symbol">→</a> <a id="334" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="337" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="339" href="A201706.IMCLP.html#129" class="Bound">g</a>
    <a id="Tm.UNBOX"></a><a id="345" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="351" class="Symbol">:</a> <a id="353" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="356" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="358" href="A201706.IMCLP.html#129" class="Bound">g</a> <a id="360" class="Symbol">→</a> <a id="362" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="365" class="Symbol">(</a><a id="366" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="370" href="A201706.IMCLP.html#127" class="Bound">d</a><a id="371" class="Symbol">)</a> <a id="373" href="A201706.IMCLP.html#129" class="Bound">g</a> <a id="375" class="Symbol">→</a> <a id="377" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="380" href="A201706.IMCLP.html#127" class="Bound">d</a> <a id="382" href="A201706.IMCLP.html#129" class="Bound">g</a>

  <a id="Tm⋆"></a><a id="387" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="391" class="Symbol">:</a> <a id="393" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="397" class="Symbol">→</a> <a id="399" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="403" class="Symbol">→</a> <a id="405" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="409" class="Symbol">→</a> <a id="411" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="417" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="421" href="A201706.IMCLP.html#421" class="Bound">d</a> <a id="423" href="A201706.IMCLP.html#423" class="Bound">g</a> <a id="425" href="A201706.IMCLP.html#425" class="Bound">n</a> <a id="427" class="Symbol">=</a> <a id="429" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="433" class="Symbol">(</a><a id="434" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="437" href="A201706.IMCLP.html#421" class="Bound">d</a> <a id="439" href="A201706.IMCLP.html#423" class="Bound">g</a><a id="440" class="Symbol">)</a> <a id="442" href="A201706.IMCLP.html#425" class="Bound">n</a>

<a id="445" class="Keyword">mutual</a>
  <a id="monoTm"></a><a id="454" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="461" class="Symbol">:</a> <a id="463" class="Symbol">∀</a> <a id="465" class="Symbol">{</a><a id="466" href="A201706.IMCLP.html#466" class="Bound">d</a> <a id="468" href="A201706.IMCLP.html#468" class="Bound">g</a> <a id="470" href="A201706.IMCLP.html#470" class="Bound">d′</a> <a id="473" href="A201706.IMCLP.html#473" class="Bound">g′</a><a id="475" class="Symbol">}</a> <a id="477" class="Symbol">→</a> <a id="479" href="A201706.IMCLP.html#470" class="Bound">d′</a> <a id="482" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="484" href="A201706.IMCLP.html#466" class="Bound">d</a> <a id="486" class="Symbol">→</a> <a id="488" href="A201706.IMCLP.html#473" class="Bound">g′</a> <a id="491" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="493" href="A201706.IMCLP.html#468" class="Bound">g</a> <a id="495" class="Symbol">→</a> <a id="497" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="500" href="A201706.IMCLP.html#466" class="Bound">d</a> <a id="502" href="A201706.IMCLP.html#468" class="Bound">g</a> <a id="504" class="Symbol">→</a> <a id="506" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="509" href="A201706.IMCLP.html#470" class="Bound">d′</a> <a id="512" href="A201706.IMCLP.html#473" class="Bound">g′</a>
  <a id="517" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="524" href="A201706.IMCLP.html#524" class="Bound">z</a> <a id="526" href="A201706.IMCLP.html#526" class="Bound">e</a> <a id="528" class="Symbol">(</a><a id="529" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="533" href="A201706.IMCLP.html#533" class="Bound">i</a><a id="534" class="Symbol">)</a>     <a id="540" class="Symbol">=</a> <a id="542" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="546" class="Symbol">(</a><a id="547" href="A201706.Prelude.html#9177" class="Function">monoFin</a> <a id="555" href="A201706.IMCLP.html#526" class="Bound">e</a> <a id="557" href="A201706.IMCLP.html#533" class="Bound">i</a><a id="558" class="Symbol">)</a>
  <a id="562" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="569" href="A201706.IMCLP.html#569" class="Bound">z</a> <a id="571" href="A201706.IMCLP.html#571" class="Bound">e</a> <a id="573" class="Symbol">(</a><a id="574" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a> <a id="579" href="A201706.IMCLP.html#579" class="Bound">q</a> <a id="581" href="A201706.IMCLP.html#581" class="Bound">i</a><a id="582" class="Symbol">)</a>  <a id="585" class="Symbol">=</a> <a id="587" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a> <a id="592" class="Symbol">(</a><a id="593" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="601" href="A201706.IMCLP.html#569" class="Bound">z</a> <a id="603" href="A201706.Prelude.html#6658" class="InductiveConstructor">done</a> <a id="608" href="A201706.IMCLP.html#579" class="Bound">q</a><a id="609" class="Symbol">)</a> <a id="611" class="Symbol">(</a><a id="612" href="A201706.Prelude.html#9177" class="Function">monoFin</a> <a id="620" href="A201706.IMCLP.html#569" class="Bound">z</a> <a id="622" href="A201706.IMCLP.html#581" class="Bound">i</a><a id="623" class="Symbol">)</a>
  <a id="627" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="634" href="A201706.IMCLP.html#634" class="Bound">z</a> <a id="636" href="A201706.IMCLP.html#636" class="Bound">e</a> <a id="638" class="Symbol">(</a><a id="639" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a> <a id="643" href="A201706.IMCLP.html#643" class="Bound">M</a><a id="644" class="Symbol">)</a>     <a id="650" class="Symbol">=</a> <a id="652" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a> <a id="656" class="Symbol">(</a><a id="657" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="664" href="A201706.IMCLP.html#634" class="Bound">z</a> <a id="666" class="Symbol">(</a><a id="667" href="A201706.Prelude.html#6719" class="InductiveConstructor">lift</a> <a id="672" href="A201706.IMCLP.html#636" class="Bound">e</a><a id="673" class="Symbol">)</a> <a id="675" href="A201706.IMCLP.html#643" class="Bound">M</a><a id="676" class="Symbol">)</a>
  <a id="680" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="687" href="A201706.IMCLP.html#687" class="Bound">z</a> <a id="689" href="A201706.IMCLP.html#689" class="Bound">e</a> <a id="691" class="Symbol">(</a><a id="692" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a> <a id="696" href="A201706.IMCLP.html#696" class="Bound">M</a> <a id="698" href="A201706.IMCLP.html#698" class="Bound">N</a><a id="699" class="Symbol">)</a>   <a id="703" class="Symbol">=</a> <a id="705" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a> <a id="709" class="Symbol">(</a><a id="710" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="717" href="A201706.IMCLP.html#687" class="Bound">z</a> <a id="719" href="A201706.IMCLP.html#689" class="Bound">e</a> <a id="721" href="A201706.IMCLP.html#696" class="Bound">M</a><a id="722" class="Symbol">)</a> <a id="724" class="Symbol">(</a><a id="725" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="732" href="A201706.IMCLP.html#687" class="Bound">z</a> <a id="734" href="A201706.IMCLP.html#689" class="Bound">e</a> <a id="736" href="A201706.IMCLP.html#698" class="Bound">N</a><a id="737" class="Symbol">)</a>
  <a id="741" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="748" href="A201706.IMCLP.html#748" class="Bound">z</a> <a id="750" href="A201706.IMCLP.html#750" class="Bound">e</a> <a id="752" class="Symbol">(</a><a id="753" href="A201706.IMCLP.html#304" class="InductiveConstructor">BOX</a> <a id="757" href="A201706.IMCLP.html#757" class="Bound">M</a><a id="758" class="Symbol">)</a>     <a id="764" class="Symbol">=</a> <a id="766" href="A201706.IMCLP.html#304" class="InductiveConstructor">BOX</a> <a id="770" href="A201706.IMCLP.html#757" class="Bound">M</a>
  <a id="774" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="781" href="A201706.IMCLP.html#781" class="Bound">z</a> <a id="783" href="A201706.IMCLP.html#783" class="Bound">e</a> <a id="785" class="Symbol">(</a><a id="786" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="792" href="A201706.IMCLP.html#792" class="Bound">M</a> <a id="794" href="A201706.IMCLP.html#794" class="Bound">N</a><a id="795" class="Symbol">)</a> <a id="797" class="Symbol">=</a> <a id="799" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="805" class="Symbol">(</a><a id="806" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="813" href="A201706.IMCLP.html#781" class="Bound">z</a> <a id="815" href="A201706.IMCLP.html#783" class="Bound">e</a> <a id="817" href="A201706.IMCLP.html#792" class="Bound">M</a><a id="818" class="Symbol">)</a> <a id="820" class="Symbol">(</a><a id="821" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="828" class="Symbol">(</a><a id="829" href="A201706.Prelude.html#6719" class="InductiveConstructor">lift</a> <a id="834" href="A201706.IMCLP.html#781" class="Bound">z</a><a id="835" class="Symbol">)</a> <a id="837" href="A201706.IMCLP.html#783" class="Bound">e</a> <a id="839" href="A201706.IMCLP.html#794" class="Bound">N</a><a id="840" class="Symbol">)</a>

  <a id="monoTm⋆"></a><a id="845" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="853" class="Symbol">:</a> <a id="855" class="Symbol">∀</a> <a id="857" class="Symbol">{</a><a id="858" href="A201706.IMCLP.html#858" class="Bound">d</a> <a id="860" href="A201706.IMCLP.html#860" class="Bound">g</a> <a id="862" href="A201706.IMCLP.html#862" class="Bound">d′</a> <a id="865" href="A201706.IMCLP.html#865" class="Bound">g′</a> <a id="868" href="A201706.IMCLP.html#868" class="Bound">n</a><a id="869" class="Symbol">}</a> <a id="871" class="Symbol">→</a> <a id="873" href="A201706.IMCLP.html#862" class="Bound">d′</a> <a id="876" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="878" href="A201706.IMCLP.html#858" class="Bound">d</a> <a id="880" class="Symbol">→</a> <a id="882" href="A201706.IMCLP.html#865" class="Bound">g′</a> <a id="885" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="887" href="A201706.IMCLP.html#860" class="Bound">g</a> <a id="889" class="Symbol">→</a> <a id="891" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="895" href="A201706.IMCLP.html#858" class="Bound">d</a> <a id="897" href="A201706.IMCLP.html#860" class="Bound">g</a> <a id="899" href="A201706.IMCLP.html#868" class="Bound">n</a> <a id="901" class="Symbol">→</a> <a id="903" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="907" href="A201706.IMCLP.html#862" class="Bound">d′</a> <a id="910" href="A201706.IMCLP.html#865" class="Bound">g′</a> <a id="913" href="A201706.IMCLP.html#868" class="Bound">n</a>
  <a id="917" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="925" href="A201706.IMCLP.html#925" class="Bound">z</a> <a id="927" href="A201706.IMCLP.html#927" class="Bound">e</a> <a id="929" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="937" class="Symbol">=</a> <a id="939" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
  <a id="943" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="951" href="A201706.IMCLP.html#951" class="Bound">z</a> <a id="953" href="A201706.IMCLP.html#953" class="Bound">e</a> <a id="955" class="Symbol">(</a><a id="956" href="A201706.IMCLP.html#956" class="Bound">x</a> <a id="958" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="960" href="A201706.IMCLP.html#960" class="Bound">M</a><a id="961" class="Symbol">)</a> <a id="963" class="Symbol">=</a> <a id="965" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="973" href="A201706.IMCLP.html#951" class="Bound">z</a> <a id="975" href="A201706.IMCLP.html#953" class="Bound">e</a> <a id="977" href="A201706.IMCLP.html#956" class="Bound">x</a> <a id="979" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="981" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="988" href="A201706.IMCLP.html#951" class="Bound">z</a> <a id="990" href="A201706.IMCLP.html#953" class="Bound">e</a> <a id="992" href="A201706.IMCLP.html#960" class="Bound">M</a>
  <a id="996" class="Comment">-- NOTE: Equivalent, but does not pass termination check.</a>
  <a id="1056" class="Comment">-- monoTm⋆ z e x = map (monoTm z e) x</a>

<a id="1095" class="Keyword">mutual</a>
  <a id="idmonoTm"></a><a id="1104" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1113" class="Symbol">:</a> <a id="1115" class="Symbol">∀</a> <a id="1117" class="Symbol">{</a><a id="1118" href="A201706.IMCLP.html#1118" class="Bound">d</a> <a id="1120" href="A201706.IMCLP.html#1120" class="Bound">g</a><a id="1121" class="Symbol">}</a> <a id="1123" class="Symbol">→</a> <a id="1125" class="Symbol">(</a><a id="1126" href="A201706.IMCLP.html#1126" class="Bound">M</a> <a id="1128" class="Symbol">:</a> <a id="1130" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="1133" href="A201706.IMCLP.html#1118" class="Bound">d</a> <a id="1135" href="A201706.IMCLP.html#1120" class="Bound">g</a><a id="1136" class="Symbol">)</a> <a id="1138" class="Symbol">→</a> <a id="1140" href="A201706.IMCLP.html#454" class="Function">monoTm</a> <a id="1147" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1153" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1159" href="A201706.IMCLP.html#1126" class="Bound">M</a> <a id="1161" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1163" href="A201706.IMCLP.html#1126" class="Bound">M</a>
  <a id="1167" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1176" class="Symbol">(</a><a id="1177" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="1181" href="A201706.IMCLP.html#1181" class="Bound">i</a><a id="1182" class="Symbol">)</a>     <a id="1188" class="Symbol">=</a> <a id="1190" href="A201706.Prelude.html#1240" class="Function">cong</a> <a id="1195" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="1199" class="Symbol">(</a><a id="1200" href="A201706.Prelude.html#9785" class="Function">idmonoFin</a> <a id="1210" href="A201706.IMCLP.html#1181" class="Bound">i</a><a id="1211" class="Symbol">)</a>
  <a id="1215" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1224" class="Symbol">(</a><a id="1225" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a> <a id="1230" href="A201706.IMCLP.html#1230" class="Bound">q</a> <a id="1232" href="A201706.IMCLP.html#1232" class="Bound">i</a><a id="1233" class="Symbol">)</a>  <a id="1236" class="Symbol">=</a> <a id="1238" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1244" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a> <a id="1249" class="Symbol">(</a><a id="1250" href="A201706.IMCLP.html#1481" class="Function">idmonoTm⋆</a> <a id="1260" href="A201706.IMCLP.html#1230" class="Bound">q</a><a id="1261" class="Symbol">)</a> <a id="1263" class="Symbol">(</a><a id="1264" href="A201706.Prelude.html#9785" class="Function">idmonoFin</a> <a id="1274" href="A201706.IMCLP.html#1232" class="Bound">i</a><a id="1275" class="Symbol">)</a>
  <a id="1279" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1288" class="Symbol">(</a><a id="1289" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a> <a id="1293" href="A201706.IMCLP.html#1293" class="Bound">M</a><a id="1294" class="Symbol">)</a>     <a id="1300" class="Symbol">=</a> <a id="1302" href="A201706.Prelude.html#1240" class="Function">cong</a> <a id="1307" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a> <a id="1311" class="Symbol">(</a><a id="1312" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1321" href="A201706.IMCLP.html#1293" class="Bound">M</a><a id="1322" class="Symbol">)</a>
  <a id="1326" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1335" class="Symbol">(</a><a id="1336" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a> <a id="1340" href="A201706.IMCLP.html#1340" class="Bound">M</a> <a id="1342" href="A201706.IMCLP.html#1342" class="Bound">N</a><a id="1343" class="Symbol">)</a>   <a id="1347" class="Symbol">=</a> <a id="1349" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1355" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a> <a id="1359" class="Symbol">(</a><a id="1360" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1369" href="A201706.IMCLP.html#1340" class="Bound">M</a><a id="1370" class="Symbol">)</a> <a id="1372" class="Symbol">(</a><a id="1373" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1382" href="A201706.IMCLP.html#1342" class="Bound">N</a><a id="1383" class="Symbol">)</a>
  <a id="1387" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1396" class="Symbol">(</a><a id="1397" href="A201706.IMCLP.html#304" class="InductiveConstructor">BOX</a> <a id="1401" href="A201706.IMCLP.html#1401" class="Bound">M</a><a id="1402" class="Symbol">)</a>     <a id="1408" class="Symbol">=</a> <a id="1410" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1417" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1426" class="Symbol">(</a><a id="1427" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="1433" href="A201706.IMCLP.html#1433" class="Bound">M</a> <a id="1435" href="A201706.IMCLP.html#1435" class="Bound">N</a><a id="1436" class="Symbol">)</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1446" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="1452" class="Symbol">(</a><a id="1453" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1462" href="A201706.IMCLP.html#1433" class="Bound">M</a><a id="1463" class="Symbol">)</a> <a id="1465" class="Symbol">(</a><a id="1466" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1475" href="A201706.IMCLP.html#1435" class="Bound">N</a><a id="1476" class="Symbol">)</a>

  <a id="idmonoTm⋆"></a><a id="1481" href="A201706.IMCLP.html#1481" class="Function">idmonoTm⋆</a> <a id="1491" class="Symbol">:</a> <a id="1493" class="Symbol">∀</a> <a id="1495" class="Symbol">{</a><a id="1496" href="A201706.IMCLP.html#1496" class="Bound">d</a> <a id="1498" href="A201706.IMCLP.html#1498" class="Bound">g</a> <a id="1500" href="A201706.IMCLP.html#1500" class="Bound">n</a><a id="1501" class="Symbol">}</a> <a id="1503" class="Symbol">→</a> <a id="1505" class="Symbol">(</a><a id="1506" href="A201706.IMCLP.html#1506" class="Bound">x</a> <a id="1508" class="Symbol">:</a> <a id="1510" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="1514" href="A201706.IMCLP.html#1496" class="Bound">d</a> <a id="1516" href="A201706.IMCLP.html#1498" class="Bound">g</a> <a id="1518" href="A201706.IMCLP.html#1500" class="Bound">n</a><a id="1519" class="Symbol">)</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="1531" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1537" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1543" href="A201706.IMCLP.html#1506" class="Bound">x</a> <a id="1545" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1547" href="A201706.IMCLP.html#1506" class="Bound">x</a>
  <a id="1551" href="A201706.IMCLP.html#1481" class="Function">idmonoTm⋆</a> <a id="1561" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="1569" class="Symbol">=</a> <a id="1571" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1578" href="A201706.IMCLP.html#1481" class="Function">idmonoTm⋆</a> <a id="1588" class="Symbol">(</a><a id="1589" href="A201706.IMCLP.html#1589" class="Bound">x</a> <a id="1591" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1593" href="A201706.IMCLP.html#1593" class="Bound">M</a><a id="1594" class="Symbol">)</a> <a id="1596" class="Symbol">=</a> <a id="1598" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1604" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">_,_</a> <a id="1608" class="Symbol">(</a><a id="1609" href="A201706.IMCLP.html#1481" class="Function">idmonoTm⋆</a> <a id="1619" href="A201706.IMCLP.html#1589" class="Bound">x</a><a id="1620" class="Symbol">)</a> <a id="1622" class="Symbol">(</a><a id="1623" href="A201706.IMCLP.html#1104" class="Function">idmonoTm</a> <a id="1632" href="A201706.IMCLP.html#1593" class="Bound">M</a><a id="1633" class="Symbol">)</a>

<a id="reflTm⋆"></a><a id="1636" href="A201706.IMCLP.html#1636" class="Function">reflTm⋆</a> <a id="1644" class="Symbol">:</a> <a id="1646" class="Symbol">∀</a> <a id="1648" class="Symbol">{</a><a id="1649" href="A201706.IMCLP.html#1649" class="Bound">d</a> <a id="1651" href="A201706.IMCLP.html#1651" class="Bound">g</a><a id="1652" class="Symbol">}</a> <a id="1654" class="Symbol">→</a> <a id="1656" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="1660" href="A201706.IMCLP.html#1649" class="Bound">d</a> <a id="1662" href="A201706.IMCLP.html#1651" class="Bound">g</a> <a id="1664" href="A201706.IMCLP.html#1651" class="Bound">g</a>
<a id="1666" href="A201706.IMCLP.html#1636" class="Function">reflTm⋆</a> <a id="1674" class="Symbol">{</a><a id="1675" class="Argument">g</a> <a id="1677" class="Symbol">=</a> <a id="1679" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="1683" class="Symbol">}</a>  <a id="1686" class="Symbol">=</a> <a id="1688" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
<a id="1690" href="A201706.IMCLP.html#1636" class="Function">reflTm⋆</a> <a id="1698" class="Symbol">{</a><a id="1699" class="Argument">g</a> <a id="1701" class="Symbol">=</a> <a id="1703" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1707" href="A201706.IMCLP.html#1707" class="Bound">g</a><a id="1708" class="Symbol">}</a> <a id="1710" class="Symbol">=</a> <a id="1712" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="1720" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1726" class="Symbol">(</a><a id="1727" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="1732" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="1737" class="Symbol">)</a> <a id="1739" href="A201706.IMCLP.html#1636" class="Function">reflTm⋆</a> <a id="1747" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1749" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="1753" href="A201706.Prelude.html#8767" class="InductiveConstructor">zero</a>

<a id="1759" class="Comment">-- TODO: What is going on here?</a>
<a id="1791" class="Comment">-- mreflTm⋆ : ∀ {d g} → Tm⋆ d g d</a>
<a id="1825" class="Comment">-- mreflTm⋆ {zero}  = ∅</a>
<a id="1849" class="Comment">-- mreflTm⋆ {suc d} =</a>
<a id="1871" class="Comment">--   monoTm⋆ (weak refl≥) refl≥ mreflTm⋆ ,</a>
<a id="1914" class="Comment">--   MVAR (monoTm⋆ (weak refl≥) done {!!}) zero</a>

<a id="lookupTm"></a><a id="1963" href="A201706.IMCLP.html#1963" class="Function">lookupTm</a> <a id="1972" class="Symbol">:</a> <a id="1974" class="Symbol">∀</a> <a id="1976" class="Symbol">{</a><a id="1977" href="A201706.IMCLP.html#1977" class="Bound">d</a> <a id="1979" href="A201706.IMCLP.html#1979" class="Bound">g</a> <a id="1981" href="A201706.IMCLP.html#1981" class="Bound">n</a><a id="1982" class="Symbol">}</a> <a id="1984" class="Symbol">→</a> <a id="1986" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="1990" href="A201706.IMCLP.html#1977" class="Bound">d</a> <a id="1992" href="A201706.IMCLP.html#1979" class="Bound">g</a> <a id="1994" href="A201706.IMCLP.html#1981" class="Bound">n</a> <a id="1996" class="Symbol">→</a> <a id="1998" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="2002" href="A201706.IMCLP.html#1981" class="Bound">n</a> <a id="2004" class="Symbol">→</a> <a id="2006" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="2009" href="A201706.IMCLP.html#1977" class="Bound">d</a> <a id="2011" href="A201706.IMCLP.html#1979" class="Bound">g</a>
<a id="2013" href="A201706.IMCLP.html#1963" class="Function">lookupTm</a> <a id="2022" href="A201706.IMCLP.html#2022" class="Bound">x</a> <a id="2024" href="A201706.IMCLP.html#2024" class="Bound">i</a> <a id="2026" class="Symbol">=</a> <a id="2028" href="A201706.PreludeVec.html#291" class="Function">lookup</a> <a id="2035" href="A201706.IMCLP.html#2022" class="Bound">x</a> <a id="2037" href="A201706.IMCLP.html#2024" class="Bound">i</a>

<a id="graftTm"></a><a id="2040" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2048" class="Symbol">:</a> <a id="2050" class="Symbol">∀</a> <a id="2052" class="Symbol">{</a><a id="2053" href="A201706.IMCLP.html#2053" class="Bound">d</a> <a id="2055" href="A201706.IMCLP.html#2055" class="Bound">g</a> <a id="2057" href="A201706.IMCLP.html#2057" class="Bound">`g</a><a id="2059" class="Symbol">}</a> <a id="2061" class="Symbol">→</a> <a id="2063" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2067" href="A201706.IMCLP.html#2053" class="Bound">d</a> <a id="2069" href="A201706.IMCLP.html#2055" class="Bound">g</a> <a id="2071" href="A201706.IMCLP.html#2057" class="Bound">`g</a> <a id="2074" class="Symbol">→</a> <a id="2076" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="2079" href="A201706.IMCLP.html#2053" class="Bound">d</a> <a id="2081" href="A201706.IMCLP.html#2057" class="Bound">`g</a> <a id="2084" class="Symbol">→</a> <a id="2086" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="2089" href="A201706.IMCLP.html#2053" class="Bound">d</a> <a id="2091" href="A201706.IMCLP.html#2055" class="Bound">g</a>
<a id="2093" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2101" href="A201706.IMCLP.html#2101" class="Bound">p</a> <a id="2103" class="Symbol">(</a><a id="2104" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="2108" href="A201706.IMCLP.html#2108" class="Bound">i</a><a id="2109" class="Symbol">)</a>     <a id="2115" class="Symbol">=</a> <a id="2117" href="A201706.IMCLP.html#1963" class="Function">lookupTm</a> <a id="2126" href="A201706.IMCLP.html#2101" class="Bound">p</a> <a id="2128" href="A201706.IMCLP.html#2108" class="Bound">i</a>
<a id="2130" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2138" href="A201706.IMCLP.html#2138" class="Bound">p</a> <a id="2140" class="Symbol">(</a><a id="2141" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a> <a id="2146" href="A201706.IMCLP.html#2146" class="Bound">q</a> <a id="2148" href="A201706.IMCLP.html#2148" class="Bound">i</a><a id="2149" class="Symbol">)</a>  <a id="2152" class="Symbol">=</a> <a id="2154" href="A201706.IMCLP.html#181" class="InductiveConstructor">MVAR</a> <a id="2159" href="A201706.IMCLP.html#2146" class="Bound">q</a> <a id="2161" href="A201706.IMCLP.html#2148" class="Bound">i</a>
<a id="2163" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2171" href="A201706.IMCLP.html#2171" class="Bound">p</a> <a id="2173" class="Symbol">(</a><a id="2174" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a> <a id="2178" href="A201706.IMCLP.html#2178" class="Bound">M</a><a id="2179" class="Symbol">)</a>     <a id="2185" class="Symbol">=</a> <a id="2187" href="A201706.IMCLP.html#233" class="InductiveConstructor">LAM</a> <a id="2191" class="Symbol">(</a><a id="2192" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2200" class="Symbol">(</a><a id="2201" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="2209" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="2215" class="Symbol">(</a><a id="2216" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="2221" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="2226" class="Symbol">)</a> <a id="2228" href="A201706.IMCLP.html#2171" class="Bound">p</a> <a id="2230" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="2232" href="A201706.IMCLP.html#154" class="InductiveConstructor">VAR</a> <a id="2236" href="A201706.Prelude.html#8767" class="InductiveConstructor">zero</a><a id="2240" class="Symbol">)</a> <a id="2242" href="A201706.IMCLP.html#2178" class="Bound">M</a><a id="2243" class="Symbol">)</a>
<a id="2245" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2253" href="A201706.IMCLP.html#2253" class="Bound">p</a> <a id="2255" class="Symbol">(</a><a id="2256" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a> <a id="2260" href="A201706.IMCLP.html#2260" class="Bound">M</a> <a id="2262" href="A201706.IMCLP.html#2262" class="Bound">N</a><a id="2263" class="Symbol">)</a>   <a id="2267" class="Symbol">=</a> <a id="2269" href="A201706.IMCLP.html#267" class="InductiveConstructor">APP</a> <a id="2273" class="Symbol">(</a><a id="2274" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2282" href="A201706.IMCLP.html#2253" class="Bound">p</a> <a id="2284" href="A201706.IMCLP.html#2260" class="Bound">M</a><a id="2285" class="Symbol">)</a> <a id="2287" class="Symbol">(</a><a id="2288" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2296" href="A201706.IMCLP.html#2253" class="Bound">p</a> <a id="2298" href="A201706.IMCLP.html#2262" class="Bound">N</a><a id="2299" class="Symbol">)</a>
<a id="2301" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2309" href="A201706.IMCLP.html#2309" class="Bound">p</a> <a id="2311" class="Symbol">(</a><a id="2312" href="A201706.IMCLP.html#304" class="InductiveConstructor">BOX</a> <a id="2316" href="A201706.IMCLP.html#2316" class="Bound">M</a><a id="2317" class="Symbol">)</a>     <a id="2323" class="Symbol">=</a> <a id="2325" href="A201706.IMCLP.html#304" class="InductiveConstructor">BOX</a> <a id="2329" href="A201706.IMCLP.html#2316" class="Bound">M</a>
<a id="2331" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2339" href="A201706.IMCLP.html#2339" class="Bound">p</a> <a id="2341" class="Symbol">(</a><a id="2342" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="2348" href="A201706.IMCLP.html#2348" class="Bound">M</a> <a id="2350" href="A201706.IMCLP.html#2350" class="Bound">N</a><a id="2351" class="Symbol">)</a> <a id="2353" class="Symbol">=</a> <a id="2355" href="A201706.IMCLP.html#345" class="InductiveConstructor">UNBOX</a> <a id="2361" class="Symbol">(</a><a id="2362" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2370" href="A201706.IMCLP.html#2339" class="Bound">p</a> <a id="2372" href="A201706.IMCLP.html#2348" class="Bound">M</a><a id="2373" class="Symbol">)</a> <a id="2375" class="Symbol">(</a><a id="2376" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2384" class="Symbol">(</a><a id="2385" href="A201706.IMCLP.html#845" class="Function">monoTm⋆</a> <a id="2393" class="Symbol">(</a><a id="2394" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="2399" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="2404" class="Symbol">)</a> <a id="2406" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="2412" href="A201706.IMCLP.html#2339" class="Bound">p</a><a id="2413" class="Symbol">)</a> <a id="2415" href="A201706.IMCLP.html#2350" class="Bound">N</a><a id="2416" class="Symbol">)</a>

<a id="graftTm⋆"></a><a id="2419" href="A201706.IMCLP.html#2419" class="Function">graftTm⋆</a> <a id="2428" class="Symbol">:</a> <a id="2430" class="Symbol">∀</a> <a id="2432" class="Symbol">{</a><a id="2433" href="A201706.IMCLP.html#2433" class="Bound">d</a> <a id="2435" href="A201706.IMCLP.html#2435" class="Bound">g</a> <a id="2437" href="A201706.IMCLP.html#2437" class="Bound">`g</a> <a id="2440" href="A201706.IMCLP.html#2440" class="Bound">n</a><a id="2441" class="Symbol">}</a> <a id="2443" class="Symbol">→</a> <a id="2445" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2449" href="A201706.IMCLP.html#2433" class="Bound">d</a> <a id="2451" href="A201706.IMCLP.html#2435" class="Bound">g</a> <a id="2453" href="A201706.IMCLP.html#2437" class="Bound">`g</a> <a id="2456" class="Symbol">→</a> <a id="2458" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2462" href="A201706.IMCLP.html#2433" class="Bound">d</a> <a id="2464" href="A201706.IMCLP.html#2437" class="Bound">`g</a> <a id="2467" href="A201706.IMCLP.html#2440" class="Bound">n</a> <a id="2469" class="Symbol">→</a> <a id="2471" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2475" href="A201706.IMCLP.html#2433" class="Bound">d</a> <a id="2477" href="A201706.IMCLP.html#2435" class="Bound">g</a> <a id="2479" href="A201706.IMCLP.html#2440" class="Bound">n</a>
<a id="2481" href="A201706.IMCLP.html#2419" class="Function">graftTm⋆</a> <a id="2490" href="A201706.IMCLP.html#2490" class="Bound">p</a> <a id="2492" href="A201706.IMCLP.html#2492" class="Bound">x</a> <a id="2494" class="Symbol">=</a> <a id="2496" href="A201706.PreludeVec.html#426" class="Function">map</a> <a id="2500" class="Symbol">(</a><a id="2501" href="A201706.IMCLP.html#2040" class="Function">graftTm</a> <a id="2509" href="A201706.IMCLP.html#2490" class="Bound">p</a><a id="2510" class="Symbol">)</a> <a id="2512" href="A201706.IMCLP.html#2492" class="Bound">x</a>

<a id="transTm"></a><a id="2515" href="A201706.IMCLP.html#2515" class="Function">transTm</a> <a id="2523" class="Symbol">:</a> <a id="2525" class="Symbol">∀</a> <a id="2527" class="Symbol">{</a><a id="2528" href="A201706.IMCLP.html#2528" class="Bound">d</a> <a id="2530" href="A201706.IMCLP.html#2530" class="Bound">g</a> <a id="2532" href="A201706.IMCLP.html#2532" class="Bound">g′</a> <a id="2535" href="A201706.IMCLP.html#2535" class="Bound">g″</a><a id="2537" class="Symbol">}</a> <a id="2539" class="Symbol">→</a> <a id="2541" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2545" href="A201706.IMCLP.html#2528" class="Bound">d</a> <a id="2547" href="A201706.IMCLP.html#2535" class="Bound">g″</a> <a id="2550" href="A201706.IMCLP.html#2532" class="Bound">g′</a> <a id="2553" class="Symbol">→</a> <a id="2555" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2559" href="A201706.IMCLP.html#2528" class="Bound">d</a> <a id="2561" href="A201706.IMCLP.html#2532" class="Bound">g′</a> <a id="2564" href="A201706.IMCLP.html#2530" class="Bound">g</a> <a id="2566" class="Symbol">→</a> <a id="2568" href="A201706.IMCLP.html#387" class="Function">Tm⋆</a> <a id="2572" href="A201706.IMCLP.html#2528" class="Bound">d</a> <a id="2574" href="A201706.IMCLP.html#2535" class="Bound">g″</a> <a id="2577" href="A201706.IMCLP.html#2530" class="Bound">g</a>
<a id="2579" href="A201706.IMCLP.html#2515" class="Function">transTm</a> <a id="2587" class="Symbol">=</a> <a id="2589" href="A201706.IMCLP.html#2419" class="Function">graftTm⋆</a>

<a id="2599" class="Comment">-- TODO: What is going on here?</a>
<a id="2631" class="Comment">-- mutual</a>
<a id="2641" class="Comment">--   mgraftTm : ∀ {d g `d} → Tm⋆ d zero `d → Tm `d g → Tm d g</a>
<a id="2703" class="Comment">--   mgraftTm q (VAR i)     = VAR i</a>
<a id="2739" class="Comment">--   mgraftTm q (MVAR q′ i) = UNBOX (monoTm refl≥ inf≥ (lookupTm q i))</a>
<a id="2810" class="Comment">--                                  (MVAR (mgraftTm⋆ (monoTm⋆ (weak refl≥) refl≥ q) q′) zero)</a>
<a id="2904" class="Comment">--   mgraftTm q (LAM M)     = LAM (mgraftTm q M)</a>
<a id="2953" class="Comment">--   mgraftTm q (APP M N)   = APP (mgraftTm q M) (mgraftTm q N)</a>
<a id="3017" class="Comment">--   mgraftTm q (BOX M)     = BOX M</a>
<a id="3053" class="Comment">--   mgraftTm q (UNBOX M N) =</a>
<a id="3083" class="Comment">--     UNBOX (mgraftTm q M)</a>
<a id="3111" class="Comment">--           (mgraftTm (monoTm⋆ (weak refl≥) refl≥ q ,</a>
<a id="3166" class="Comment">--                      BOX (MVAR {!!} zero)) N)</a>
<a id="3215" class="Comment">--</a>
<a id="3218" class="Comment">--   mgraftTm⋆ : ∀ {d g `d n} → Tm⋆ d zero `d → Tm⋆ `d g n → Tm⋆ d g n</a>
<a id="3289" class="Comment">--   mgraftTm⋆ q ∅       = ∅</a>
<a id="3318" class="Comment">--   mgraftTm⋆ q (x , M) = mgraftTm⋆ q x , mgraftTm q M</a>
<a id="3374" class="Comment">--</a>
<a id="3377" class="Comment">-- mtransTm⋆ : ∀ {d d′ d″} → Tm⋆ d″ zero d′ → Tm⋆ d′ zero d → Tm⋆ d″ zero d</a>
<a id="3453" class="Comment">-- mtransTm⋆ = mgraftTm⋆</a>


<a id="3480" class="Comment">-- Types and vectors of types.</a>

<a id="3512" class="Keyword">mutual</a>
  <a id="3521" class="Keyword">infixr</a> <a id="3528" class="Number">7</a> <a id="3530" href="A201706.IMCLP.html#3576" class="InductiveConstructor Operator">_⇒_</a>
  <a id="3536" class="Keyword">data</a> <a id="Ty"></a><a id="3541" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a> <a id="3544" class="Symbol">:</a> <a id="3546" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3550" class="Keyword">where</a>
    <a id="Ty.•"></a><a id="3560" href="A201706.IMCLP.html#3560" class="InductiveConstructor">•</a>      <a id="3567" class="Symbol">:</a> <a id="3569" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a>
    <a id="Ty._⇒_"></a><a id="3576" href="A201706.IMCLP.html#3576" class="InductiveConstructor Operator">_⇒_</a>   <a id="3582" class="Symbol">:</a> <a id="3584" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a> <a id="3587" class="Symbol">→</a> <a id="3589" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a> <a id="3592" class="Symbol">→</a> <a id="3594" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a>
    <a id="Ty.[_⊦_]_"></a><a id="3601" href="A201706.IMCLP.html#3601" class="InductiveConstructor Operator">[_⊦_]_</a> <a id="3608" class="Symbol">:</a> <a id="3610" class="Symbol">∀</a> <a id="3612" class="Symbol">{</a><a id="3613" href="A201706.IMCLP.html#3613" class="Bound">d</a><a id="3614" class="Symbol">}</a> <a id="3616" class="Symbol">→</a> <a id="3618" href="A201706.IMCLP.html#3839" class="Function">BoxTy⋆</a> <a id="3625" href="A201706.IMCLP.html#3613" class="Bound">d</a> <a id="3627" class="Symbol">→</a> <a id="3629" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="3632" href="A201706.IMCLP.html#3613" class="Bound">d</a> <a id="3634" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="3639" class="Symbol">→</a> <a id="3641" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a> <a id="3644" class="Symbol">→</a> <a id="3646" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a>

  <a id="3652" class="Keyword">record</a> <a id="BoxTy"></a><a id="3659" href="A201706.IMCLP.html#3659" class="Record">BoxTy</a> <a id="3665" class="Symbol">:</a> <a id="3667" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3671" class="Keyword">where</a>
    <a id="3681" class="Keyword">inductive</a>
    <a id="3695" class="Keyword">constructor</a> <a id="[_⊦_]_"></a><a id="3707" href="A201706.IMCLP.html#3707" class="InductiveConstructor Operator">[_⊦_]_</a>
    <a id="3718" class="Keyword">field</a>
      <a id="3730" class="Symbol">{</a><a id="BoxTy.d"></a><a id="3731" href="A201706.IMCLP.html#3731" class="Field">d</a><a id="3732" class="Symbol">}</a> <a id="3734" class="Symbol">:</a> <a id="3736" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
      <a id="BoxTy.Δ"></a><a id="3746" href="A201706.IMCLP.html#3746" class="Field">Δ</a>   <a id="3750" class="Symbol">:</a> <a id="3752" href="A201706.IMCLP.html#3839" class="Function">BoxTy⋆</a> <a id="3759" href="A201706.IMCLP.html#3731" class="Field">d</a>
      <a id="BoxTy.M"></a><a id="3767" href="A201706.IMCLP.html#3767" class="Field">M</a>   <a id="3771" class="Symbol">:</a> <a id="3773" href="A201706.IMCLP.html#123" class="Datatype">Tm</a> <a id="3776" href="A201706.IMCLP.html#3731" class="Field">d</a> <a id="3778" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>
      <a id="BoxTy.A"></a><a id="3789" href="A201706.IMCLP.html#3789" class="Field">A</a>   <a id="3793" class="Symbol">:</a> <a id="3795" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a>

  <a id="Ty⋆"></a><a id="3801" href="A201706.IMCLP.html#3801" class="Function">Ty⋆</a> <a id="3805" class="Symbol">:</a> <a id="3807" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="3811" class="Symbol">→</a> <a id="3813" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="3819" href="A201706.IMCLP.html#3801" class="Function">Ty⋆</a> <a id="3823" href="A201706.IMCLP.html#3823" class="Bound">g</a> <a id="3825" class="Symbol">=</a> <a id="3827" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="3831" href="A201706.IMCLP.html#3541" class="Datatype">Ty</a> <a id="3834" href="A201706.IMCLP.html#3823" class="Bound">g</a>

  <a id="BoxTy⋆"></a><a id="3839" href="A201706.IMCLP.html#3839" class="Function">BoxTy⋆</a> <a id="3846" class="Symbol">:</a> <a id="3848" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="3852" class="Symbol">→</a> <a id="3854" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="3860" href="A201706.IMCLP.html#3839" class="Function">BoxTy⋆</a> <a id="3867" href="A201706.IMCLP.html#3867" class="Bound">d</a> <a id="3869" class="Symbol">=</a> <a id="3871" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="3875" href="A201706.IMCLP.html#3659" class="Record">BoxTy</a> <a id="3881" href="A201706.IMCLP.html#3867" class="Bound">d</a>
</pre></body></html>