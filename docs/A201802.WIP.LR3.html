<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR3</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201802.WIP.LR3.html" class="Module">A201802.WIP.LR3</a> <a id="53" class="Keyword">where</a>

<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>

<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="A201802.LR0.html" class="Module">A201802.LR0</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="A201802.LR0Lemmas.html" class="Module">A201802.LR0Lemmas</a>
<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="A201802.LR1.html" class="Module">A201802.LR1</a>

<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="A201802.LR2.html" class="Module">A201802.LR2</a> <a id="356" class="Comment">-- TODO: which LR2?</a>



<a id="379" class="Keyword">postulate</a>
  <a id="oops"></a><a id="391" href="A201802.WIP.LR3.html#391" class="Postulate">oops</a> <a id="396" class="Symbol">:</a> <a id="398" class="Symbol">‚àÄ</a> <a id="400" class="Symbol">{</a><a id="401" href="A201802.WIP.LR3.html#401" class="Bound">‚Ñì</a><a id="402" class="Symbol">}</a> <a id="404" class="Symbol">‚Üí</a> <a id="406" class="Symbol">{</a><a id="407" href="A201802.WIP.LR3.html#407" class="Bound">X</a> <a id="409" class="Symbol">:</a> <a id="411" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="415" href="A201802.WIP.LR3.html#401" class="Bound">‚Ñì</a><a id="416" class="Symbol">}</a> <a id="418" class="Symbol">‚Üí</a> <a id="420" href="A201802.WIP.LR3.html#407" class="Bound">X</a>


<a id="424" class="Comment">--------------------------------------------------------------------------------</a>


<a id="507" class="Comment">-- `SN _ A` is the strong normalisation predicate on terms at type `A`.</a>
<a id="579" class="Keyword">mutual</a>
  <a id="SN"></a><a id="588" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="591" class="Symbol">:</a> <a id="593" href="A201802.LR0.html#576" class="Datatype">Term</a> <a id="598" class="Number">0</a> <a id="600" class="Symbol">‚Üí</a> <a id="602" href="A201802.LR0.html#294" class="Datatype">Type</a> <a id="607" class="Symbol">‚Üí</a> <a id="609" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="615" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="618" href="A201802.WIP.LR3.html#618" class="Bound">M</a> <a id="620" href="A201802.WIP.LR3.html#620" class="Bound">A</a> <a id="622" class="Symbol">=</a> <a id="624" href="A201801.Vec.html#295" class="InductiveConstructor">‚àô</a> <a id="626" href="A201802.LR1.html#377" class="Datatype Operator">‚ä¢</a> <a id="628" href="A201802.WIP.LR3.html#618" class="Bound">M</a> <a id="630" href="A201802.LR1.html#377" class="Datatype Operator">‚¶Ç</a> <a id="632" href="A201802.WIP.LR3.html#620" class="Bound">A</a> <a id="634" href="A201801.Prelude.html#4704" class="Function Operator">√ó</a> <a id="636" href="A201802.WIP.LR3.html#618" class="Bound">M</a> <a id="638" href="A201802.LR2.html#16099" class="Function Operator">‚áì</a> <a id="640" href="A201801.Prelude.html#4704" class="Function Operator">√ó</a> <a id="642" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="646" href="A201802.WIP.LR3.html#618" class="Bound">M</a> <a id="648" href="A201802.WIP.LR3.html#620" class="Bound">A</a>

  <a id="SN!"></a><a id="653" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="657" class="Symbol">:</a> <a id="659" href="A201802.LR0.html#576" class="Datatype">Term</a> <a id="664" class="Number">0</a> <a id="666" class="Symbol">‚Üí</a> <a id="668" href="A201802.LR0.html#294" class="Datatype">Type</a> <a id="673" class="Symbol">‚Üí</a> <a id="675" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="681" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="685" href="A201802.WIP.LR3.html#685" class="Bound">M</a> <a id="687" href="A201802.LR0.html#317" class="InductiveConstructor">ùîπ</a>       <a id="695" class="Symbol">=</a> <a id="697" href="Agda.Builtin.Unit.html#175" class="Record">‚ä§</a>
  <a id="701" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="705" href="A201802.WIP.LR3.html#705" class="Bound">M</a> <a id="707" class="Symbol">(</a><a id="708" href="A201802.WIP.LR3.html#708" class="Bound">A</a> <a id="710" href="A201802.LR0.html#332" class="InductiveConstructor Operator">‚à®</a> <a id="712" href="A201802.WIP.LR3.html#712" class="Bound">B</a><a id="713" class="Symbol">)</a> <a id="715" class="Symbol">=</a> <a id="717" href="A201802.WIP.LR3.html#391" class="Postulate">oops</a>
  <a id="724" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="728" href="A201802.WIP.LR3.html#728" class="Bound">M</a> <a id="730" href="A201802.LR0.html#361" class="InductiveConstructor">ùüò</a>       <a id="738" class="Symbol">=</a> <a id="740" href="A201801.Prelude.html#1126" class="Datatype">‚ä•</a>
  <a id="744" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="748" href="A201802.WIP.LR3.html#748" class="Bound">M</a> <a id="750" href="A201802.LR0.html#376" class="InductiveConstructor">ùüô</a>       <a id="758" class="Symbol">=</a> <a id="760" href="Agda.Builtin.Unit.html#175" class="Record">‚ä§</a>
  <a id="764" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="768" href="A201802.WIP.LR3.html#768" class="Bound">M</a> <a id="770" class="Symbol">(</a><a id="771" href="A201802.WIP.LR3.html#771" class="Bound">A</a> <a id="773" href="A201802.LR0.html#391" class="InductiveConstructor Operator">‚àß</a> <a id="775" href="A201802.WIP.LR3.html#775" class="Bound">B</a><a id="776" class="Symbol">)</a> <a id="778" class="Symbol">=</a> <a id="780" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="783" class="Symbol">(</a><a id="784" href="A201802.LR0.html#744" class="InductiveConstructor">FST</a> <a id="788" href="A201802.WIP.LR3.html#768" class="Bound">M</a><a id="789" class="Symbol">)</a> <a id="791" href="A201802.WIP.LR3.html#771" class="Bound">A</a> <a id="793" href="A201801.Prelude.html#4704" class="Function Operator">√ó</a> <a id="795" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="798" class="Symbol">(</a><a id="799" href="A201802.LR0.html#772" class="InductiveConstructor">SND</a> <a id="803" href="A201802.WIP.LR3.html#768" class="Bound">M</a><a id="804" class="Symbol">)</a> <a id="806" href="A201802.WIP.LR3.html#775" class="Bound">B</a>
  <a id="810" href="A201802.WIP.LR3.html#653" class="Function">SN!</a> <a id="814" href="A201802.WIP.LR3.html#814" class="Bound">M</a> <a id="816" class="Symbol">(</a><a id="817" href="A201802.WIP.LR3.html#817" class="Bound">A</a> <a id="819" href="A201802.LR0.html#420" class="InductiveConstructor Operator">‚äÉ</a> <a id="821" href="A201802.WIP.LR3.html#821" class="Bound">B</a><a id="822" class="Symbol">)</a> <a id="824" class="Symbol">=</a> <a id="826" class="Symbol">‚àÄ</a> <a id="828" class="Symbol">{</a><a id="829" href="A201802.WIP.LR3.html#829" class="Bound">N</a><a id="830" class="Symbol">}</a> <a id="832" class="Symbol">‚Üí</a> <a id="834" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="837" href="A201802.WIP.LR3.html#829" class="Bound">N</a> <a id="839" href="A201802.WIP.LR3.html#817" class="Bound">A</a> <a id="841" class="Symbol">‚Üí</a> <a id="843" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="846" class="Symbol">(</a><a id="847" href="A201802.LR0.html#670" class="InductiveConstructor">APP</a> <a id="851" href="A201802.WIP.LR3.html#814" class="Bound">M</a> <a id="853" href="A201802.WIP.LR3.html#829" class="Bound">N</a><a id="854" class="Symbol">)</a> <a id="856" href="A201802.WIP.LR3.html#821" class="Bound">B</a>


<a id="860" class="Comment">-- Every SN term is well-typed.</a>
<a id="derp"></a><a id="892" href="A201802.WIP.LR3.html#892" class="Function">derp</a> <a id="897" class="Symbol">:</a> <a id="899" class="Symbol">‚àÄ</a> <a id="901" class="Symbol">{</a><a id="902" href="A201802.WIP.LR3.html#902" class="Bound">A</a> <a id="904" href="A201802.WIP.LR3.html#904" class="Bound">M</a><a id="905" class="Symbol">}</a> <a id="907" class="Symbol">‚Üí</a> <a id="909" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="912" href="A201802.WIP.LR3.html#904" class="Bound">M</a> <a id="914" href="A201802.WIP.LR3.html#902" class="Bound">A</a>
               <a id="931" class="Symbol">‚Üí</a> <a id="933" class="InductiveConstructor">‚àô</a> <a id="935" href="A201802.LR1.html#377" class="Datatype Operator">‚ä¢</a> <a id="937" href="A201802.WIP.LR3.html#904" class="Bound">M</a> <a id="939" href="A201802.LR1.html#377" class="Datatype Operator">‚¶Ç</a> <a id="941" href="A201802.WIP.LR3.html#902" class="Bound">A</a>
<a id="943" href="A201802.WIP.LR3.html#892" class="Function">derp</a> <a id="948" class="Symbol">(</a><a id="949" href="A201802.WIP.LR3.html#949" class="Bound">ùíü</a> <a id="951" href="A201801.Prelude.html#4622" class="InductiveConstructor Operator">,</a> <a id="953" href="A201802.WIP.LR3.html#953" class="Bound">M‚áì</a> <a id="956" href="A201801.Prelude.html#4622" class="InductiveConstructor Operator">,</a> <a id="958" href="A201802.WIP.LR3.html#958" class="Bound">s!</a><a id="960" class="Symbol">)</a> <a id="962" class="Symbol">=</a> <a id="964" href="A201802.WIP.LR3.html#949" class="Bound">ùíü</a>


<a id="968" class="Comment">--------------------------------------------------------------------------------</a>


<a id="1051" class="Comment">-- `SNs _ Œì` is the strong normalisation predicate on substitutions at all types `Œì`.</a>
<a id="SNs"></a><a id="1137" href="A201802.WIP.LR3.html#1137" class="Function">SNs</a> <a id="1141" class="Symbol">:</a> <a id="1143" class="Symbol">‚àÄ</a> <a id="1145" class="Symbol">{</a><a id="1146" href="A201802.WIP.LR3.html#1146" class="Bound">g</a><a id="1147" class="Symbol">}</a> <a id="1149" class="Symbol">‚Üí</a> <a id="1151" class="Symbol">(</a><a id="1152" href="A201802.WIP.LR3.html#1152" class="Bound">œÑ</a> <a id="1154" class="Symbol">:</a> <a id="1156" href="A201802.LR0.html#1043" class="Function">Terms</a> <a id="1162" class="Number">0</a> <a id="1164" href="A201802.WIP.LR3.html#1146" class="Bound">g</a><a id="1165" class="Symbol">)</a> <a id="1167" class="Symbol">‚Üí</a> <a id="1169" href="A201802.LR0.html#447" class="Function">Types</a> <a id="1175" href="A201802.WIP.LR3.html#1146" class="Bound">g</a> <a id="1177" class="Symbol">‚Üí</a> <a id="1179" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1183" href="A201802.WIP.LR3.html#1137" class="Function">SNs</a> <a id="1187" href="A201802.WIP.LR3.html#1187" class="Bound">œÑ</a> <a id="1189" href="A201802.WIP.LR3.html#1189" class="Bound">Œì</a> <a id="1191" class="Symbol">=</a> <a id="1193" href="A201801.AllVec.html#201" class="Datatype">All</a> <a id="1197" class="Symbol">(\</a> <a id="1200" class="Symbol">{</a> <a id="1202" class="Symbol">(</a><a id="1203" href="A201802.WIP.LR3.html#1203" class="Bound">M</a> <a id="1205" href="A201801.Prelude.html#4622" class="InductiveConstructor Operator">,</a> <a id="1207" href="A201802.WIP.LR3.html#1207" class="Bound">A</a><a id="1208" class="Symbol">)</a> <a id="1210" class="Symbol">‚Üí</a> <a id="1212" href="A201802.WIP.LR3.html#588" class="Function">SN</a> <a id="1215" href="A201802.WIP.LR3.html#1203" class="Bound">M</a> <a id="1217" href="A201802.WIP.LR3.html#1207" class="Bound">A</a> <a id="1219" class="Symbol">})</a> <a id="1222" class="Symbol">(</a><a id="1223" href="A201801.Vec.html#3298" class="Function">zip</a> <a id="1227" href="A201802.WIP.LR3.html#1187" class="Bound">œÑ</a> <a id="1229" href="A201802.WIP.LR3.html#1189" class="Bound">Œì</a><a id="1230" class="Symbol">)</a>


<a id="1234" class="Comment">-- Every SN substitution is well-typed.</a>
<a id="derps"></a><a id="1274" href="A201802.WIP.LR3.html#1274" class="Function">derps</a> <a id="1280" class="Symbol">:</a> <a id="1282" class="Symbol">‚àÄ</a> <a id="1284" class="Symbol">{</a><a id="1285" href="A201802.WIP.LR3.html#1285" class="Bound">g</a><a id="1286" class="Symbol">}</a> <a id="1288" class="Symbol">‚Üí</a> <a id="1290" class="Symbol">{</a><a id="1291" href="A201802.WIP.LR3.html#1291" class="Bound">œÑ</a> <a id="1293" class="Symbol">:</a> <a id="1295" href="A201802.LR0.html#1043" class="Function">Terms</a> <a id="1301" class="Number">0</a> <a id="1303" href="A201802.WIP.LR3.html#1285" class="Bound">g</a><a id="1304" class="Symbol">}</a> <a id="1306" class="Symbol">{</a><a id="1307" href="A201802.WIP.LR3.html#1307" class="Bound">Œì</a> <a id="1309" class="Symbol">:</a> <a id="1311" href="A201802.LR0.html#447" class="Function">Types</a> <a id="1317" href="A201802.WIP.LR3.html#1285" class="Bound">g</a><a id="1318" class="Symbol">}</a>
              <a id="1334" class="Symbol">‚Üí</a> <a id="1336" href="A201802.WIP.LR3.html#1137" class="Function">SNs</a> <a id="1340" href="A201802.WIP.LR3.html#1291" class="Bound">œÑ</a> <a id="1342" href="A201802.WIP.LR3.html#1307" class="Bound">Œì</a>
              <a id="1358" class="Symbol">‚Üí</a> <a id="1360" class="InductiveConstructor">‚àô</a> <a id="1362" href="A201802.LR1.html#1448" class="Function Operator">‚ä¢</a> <a id="1364" href="A201802.WIP.LR3.html#1291" class="Bound">œÑ</a> <a id="1366" href="A201802.LR1.html#1448" class="Function Operator">‚¶Ç</a> <a id="1368" href="A201802.WIP.LR3.html#1307" class="Bound">Œì</a> <a id="1370" href="A201802.LR1.html#1448" class="Function Operator">all</a>
<a id="1374" href="A201802.WIP.LR3.html#1274" class="Function">derps</a> <a id="1380" href="A201802.WIP.LR3.html#1380" class="Bound">œÉ</a> <a id="1382" class="Symbol">=</a> <a id="1384" href="A201801.AllVec.html#331" class="Function">maps</a> <a id="1389" href="A201802.WIP.LR3.html#892" class="Function">derp</a> <a id="1394" href="A201802.WIP.LR3.html#1380" class="Bound">œÉ</a>


<a id="1398" class="Comment">--------------------------------------------------------------------------------</a>


<a id="1481" class="Comment">-- -- Small-step reduction IN REVERSE preserves SN.</a>
<a id="1533" class="Comment">-- mutual</a>
<a id="1543" class="Comment">--   snpr‚Ü¶ : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M‚Ä≤ A</a>
<a id="1598" class="Comment">--                       ‚Üí SN M A</a>
<a id="1632" class="Comment">--   snpr‚Ü¶ M‚Ü¶M‚Ä≤ ùíü (ùíü‚Ä≤ , M‚Ä≤‚áì , s!‚Ä≤) = ùíü , hpr‚Ü¶ M‚Ü¶M‚Ä≤ M‚Ä≤‚áì , sn!pr‚Ü¶ M‚Ü¶M‚Ä≤ ùíü s!‚Ä≤</a>

<a id="1708" class="Comment">--   sn!pr‚Ü¶ : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN! M‚Ä≤ A</a>
<a id="1765" class="Comment">--                        ‚Üí SN! M A</a>
<a id="1801" class="Comment">--   sn!pr‚Ü¶ {ùîπ}     M‚Ü¶M‚Ä≤ ùíü ‚àô         = ‚àô</a>
<a id="1842" class="Comment">--   sn!pr‚Ü¶ {A ‚à® B} M‚Ü¶M‚Ä≤ ùíü x         = oops</a>
<a id="1886" class="Comment">--   sn!pr‚Ü¶ {ùüò}     M‚Ü¶M‚Ä≤ ùíü ()</a>
<a id="1916" class="Comment">--   sn!pr‚Ü¶ {ùüô}     M‚Ü¶M‚Ä≤ ùíü ‚àô         = ‚àô</a>
<a id="1957" class="Comment">--   sn!pr‚Ü¶ {A ‚àß B} M‚Ü¶M‚Ä≤ ùíü (s‚ÇÅ , s‚ÇÇ) = snpr‚Ü¶ (cong-fst M‚Ü¶M‚Ä≤) (fst ùíü) s‚ÇÅ , snpr‚Ü¶ (cong-snd M‚Ü¶M‚Ä≤) (snd ùíü) s‚ÇÇ</a>
<a id="2064" class="Comment">--   sn!pr‚Ü¶ {A ‚äÉ B} M‚Ü¶M‚Ä≤ ùíü f s       = snpr‚Ü¶ (cong-app‚ÇÅ M‚Ü¶M‚Ä≤) (app ùíü (derp s)) (f s)</a>


<a id="2151" class="Comment">-- -- Iterated small-step reduction IN REVERSE preserves SN.</a>
<a id="2212" class="Comment">-- snpr‚§Ö : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚§Ö M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M‚Ä≤ A</a>
<a id="2265" class="Comment">--                     ‚Üí SN M A</a>
<a id="2297" class="Comment">-- snpr‚§Ö done                ùíü s = s</a>
<a id="2334" class="Comment">-- snpr‚§Ö (step M‚Ü¶M‚Ä≥ M‚Ä≥‚§ÖM‚Ä≤) ùíü s = snpr‚Ü¶ M‚Ü¶M‚Ä≥ ùíü (snpr‚§Ö M‚Ä≥‚§ÖM‚Ä≤ (tp‚Ü¶ M‚Ü¶M‚Ä≥ ùíü) s)</a>


<a id="2411" class="Comment">-- -- Big-step reduction IN REVERSE preserves SN.</a>
<a id="2461" class="Comment">-- snpr‚áì : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚áì M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M‚Ä≤ A</a>
<a id="2514" class="Comment">--                    ‚Üí SN M A</a>
<a id="2545" class="Comment">-- snpr‚áì (M‚§ÖM‚Ä≤ , VM‚Ä≤) ùíü s = snpr‚§Ö M‚§ÖM‚Ä≤ ùíü s</a>


<a id="2590" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2676" class="Comment">-- -- Small-step reduction preserves SN.</a>
<a id="2717" class="Comment">-- mutual</a>
<a id="2727" class="Comment">--   snp‚Ü¶ : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M A</a>
<a id="2780" class="Comment">--                      ‚Üí SN M‚Ä≤ A</a>
<a id="2814" class="Comment">--   snp‚Ü¶ M‚Ü¶M‚Ä≤ ùíü (_ , M‚áì , s!) = tp‚Ü¶ M‚Ü¶M‚Ä≤ ùíü , hp‚Ü¶ M‚Ü¶M‚Ä≤ M‚áì , sn!p‚Ü¶ M‚Ü¶M‚Ä≤ ùíü s!</a>

<a id="2891" class="Comment">--   sn!p‚Ü¶ : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN! M A</a>
<a id="2946" class="Comment">--                       ‚Üí SN! M‚Ä≤ A</a>
<a id="2982" class="Comment">--   sn!p‚Ü¶ {ùîπ}     M‚Ü¶M‚Ä≤ ùíü ‚àô         = ‚àô</a>
<a id="3022" class="Comment">--   sn!p‚Ü¶ {A ‚à® B} M‚Ü¶M‚Ä≤ ùíü x         = oops</a>
<a id="3065" class="Comment">--   sn!p‚Ü¶ {ùüò}     M‚Ü¶M‚Ä≤ ùíü ()</a>
<a id="3094" class="Comment">--   sn!p‚Ü¶ {ùüô}     M‚Ü¶M‚Ä≤ ùíü ‚àô         = ‚àô</a>
<a id="3134" class="Comment">--   sn!p‚Ü¶ {A ‚àß B} M‚Ü¶M‚Ä≤ ùíü (s‚ÇÅ , s‚ÇÇ) = snp‚Ü¶ (cong-fst M‚Ü¶M‚Ä≤) (fst ùíü) s‚ÇÅ , snp‚Ü¶ (cong-snd M‚Ü¶M‚Ä≤) (snd ùíü) s‚ÇÇ</a>
<a id="3238" class="Comment">--   sn!p‚Ü¶ {A ‚äÉ B} M‚Ü¶M‚Ä≤ ùíü f s       = snp‚Ü¶ (cong-app‚ÇÅ M‚Ü¶M‚Ä≤) (app ùíü (derp s)) (f s)</a>


<a id="3323" class="Comment">-- -- Iterated small-step reduction preserves SN.</a>
<a id="3373" class="Comment">-- snp‚§Ö : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚§Ö M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M A</a>
<a id="3424" class="Comment">--                    ‚Üí SN M‚Ä≤ A</a>
<a id="3456" class="Comment">-- snp‚§Ö done                ùíü s = s</a>
<a id="3492" class="Comment">-- snp‚§Ö (step M‚Ü¶M‚Ä≥ M‚Ä≥‚§ÖM‚Ä≤) ùíü s = snp‚§Ö M‚Ä≥‚§ÖM‚Ä≤ (tp‚Ü¶ M‚Ü¶M‚Ä≥ ùíü) (snp‚Ü¶ M‚Ü¶M‚Ä≥ ùíü s)</a>


<a id="3566" class="Comment">-- -- Big-step reduction preserves SN.</a>
<a id="3605" class="Comment">-- snp‚áì : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚áì M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M A</a>
<a id="3656" class="Comment">--                   ‚Üí SN M‚Ä≤ A</a>
<a id="3687" class="Comment">-- snp‚áì (M‚§ÖM‚Ä≤ , VM‚Ä≤) ùíü s = snp‚§Ö M‚§ÖM‚Ä≤ ùíü s</a>


<a id="3730" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3816" class="Comment">-- -- If `M` is SN at type `A ‚äÉ B` and `N` is SN at type `A`, then `APP M N` is SN at type `B`.</a>
<a id="3912" class="Comment">-- sn-app : ‚àÄ {A B M N} ‚Üí SN M (A ‚äÉ B) ‚Üí SN N A</a>
<a id="3960" class="Comment">--                      ‚Üí SN (APP M N) B</a>
<a id="4001" class="Comment">-- sn-app (ùíü , M‚áì , f) s = f s</a>


<a id="4034" class="Comment">-- -- If `M` is SN at type `A` and `N` is SN at type `B`, then `PAIR M N` is SN at type `A ‚àß B`.</a>
<a id="4131" class="Comment">-- sn-pair : ‚àÄ {A B M N} ‚Üí SN M A ‚Üí SN N B</a>
<a id="4174" class="Comment">--                       ‚Üí SN (PAIR M N) (A ‚àß B)</a>
<a id="4223" class="Comment">-- sn-pair s‚ÇÅ@(ùíü , M‚áì@(M‚Ä≤ , M‚áìM‚Ä≤@(M‚§ÖM‚Ä≤ , VM‚Ä≤)) , s!‚ÇÅ) s‚ÇÇ@(‚Ñ∞ , N‚áì@(N‚Ä≤ , N‚áìN‚Ä≤@(N‚§ÖN‚Ä≤ , VN‚Ä≤)) , s!‚ÇÇ)</a>
<a id="4320" class="Comment">--   = pair ùíü ‚Ñ∞ ,</a>
<a id="4338" class="Comment">--     halt-pair M‚áì N‚áì ,</a>
<a id="4363" class="Comment">--     snpr‚áì (big-red-fst-pair {{VM‚Ä≤}} {{VN‚Ä≤}} (congs-pair {{VM‚Ä≤}} {{VN‚Ä≤}} M‚§ÖM‚Ä≤ N‚§ÖN‚Ä≤)) (fst (pair ùíü ‚Ñ∞)) (snp‚§Ö M‚§ÖM‚Ä≤ ùíü s‚ÇÅ) ,</a>
<a id="4486" class="Comment">--     snpr‚áì (big-red-snd-pair {{VM‚Ä≤}} {{VN‚Ä≤}} ((congs-pair {{VM‚Ä≤}} {{VN‚Ä≤}} M‚§ÖM‚Ä≤ N‚§ÖN‚Ä≤))) (snd (pair ùíü ‚Ñ∞)) (snp‚§Ö N‚§ÖN‚Ä≤ ‚Ñ∞ s‚ÇÇ)</a>


<a id="4611" class="Comment">-- -- If `M` is SN at type `A ‚àß B`, then `FST M` is SN at type `A`.</a>
<a id="4679" class="Comment">-- mutual</a>
<a id="4689" class="Comment">--   sn-fst : ‚àÄ {A B M} ‚Üí SN M (A ‚àß B)</a>
<a id="4728" class="Comment">--                      ‚Üí SN (FST M) A</a>
<a id="4767" class="Comment">--   sn-fst (ùíü , M‚áì , s!) = fst ùíü , halt-fst ùíü M‚áì , sn!-fst s!</a>

<a id="4831" class="Comment">--   sn!-fst : ‚àÄ {A B M} ‚Üí SN! M (A ‚àß B)</a>
<a id="4872" class="Comment">--                       ‚Üí SN! (FST M) A</a>
<a id="4913" class="Comment">--   sn!-fst {ùîπ}       _                      = ‚àô</a>
<a id="4963" class="Comment">--   sn!-fst {A‚ÇÅ ‚à® A‚ÇÇ} x                      = oops</a>
<a id="5016" class="Comment">--   sn!-fst {ùüò}       ()</a>
<a id="5042" class="Comment">--   sn!-fst {ùüô}       _                      = ‚àô</a>
<a id="5092" class="Comment">--   sn!-fst {A‚ÇÅ ‚àß A‚ÇÇ} ((‚Ñ∞ , FST‚áì , s) , _)   = s</a>
<a id="5142" class="Comment">--   sn!-fst {A‚ÇÅ ‚äÉ A‚ÇÇ} ((‚Ñ∞ , FST‚áì , f) , _) s = f s</a>


<a id="5196" class="Comment">-- -- If `M` is SN at type `A ‚àß B`, then `SND M` is SN at type `B`.</a>
<a id="5264" class="Comment">-- mutual</a>
<a id="5274" class="Comment">--   sn-snd : ‚àÄ {A B M} ‚Üí SN M (A ‚àß B)</a>
<a id="5313" class="Comment">--                      ‚Üí SN (SND M) B</a>
<a id="5352" class="Comment">--   sn-snd (ùíü , M‚áì , s!) = snd ùíü , halt-snd ùíü M‚áì , sn!-snd s!</a>

<a id="5416" class="Comment">--   sn!-snd : ‚àÄ {B A M} ‚Üí SN! M (A ‚àß B)</a>
<a id="5457" class="Comment">--                       ‚Üí SN! (SND M) B</a>
<a id="5498" class="Comment">--   sn!-snd {ùîπ}       _                      = ‚àô</a>
<a id="5548" class="Comment">--   sn!-snd {B‚ÇÅ ‚à® B‚ÇÇ} x                      = oops</a>
<a id="5601" class="Comment">--   sn!-snd {ùüò}       ()</a>
<a id="5627" class="Comment">--   sn!-snd {ùüô}       _                      = ‚àô</a>
<a id="5677" class="Comment">--   sn!-snd {B‚ÇÅ ‚àß B‚ÇÇ} (_ , (‚Ñ∞ , SND‚áì , s))   = s</a>
<a id="5727" class="Comment">--   sn!-snd {B‚ÇÅ ‚äÉ B‚ÇÇ} (_ , (‚Ñ∞ , SND‚áì , f)) s = f s</a>


<a id="5781" class="Comment">-- -- If `M` is SN at type `ùüò`, then `ABORT M` is SN at type `C`.</a>
<a id="5847" class="Comment">-- mutual</a>
<a id="5857" class="Comment">--   sn-abort : ‚àÄ {C M} ‚Üí SN M ùüò</a>
<a id="5890" class="Comment">--                      ‚Üí SN (ABORT M) C</a>
<a id="5931" class="Comment">--   sn-abort {C} (ùíü , M‚áì , s!) = abort ùíü , halt-abort ùíü M‚áì , sn!-abort {C} s!</a>

<a id="6011" class="Comment">--   sn!-abort : ‚àÄ {C M} ‚Üí SN! M ùüò</a>
<a id="6046" class="Comment">--                       ‚Üí SN! (ABORT M) C</a>
<a id="6089" class="Comment">--   sn!-abort {ùîπ}     ()</a>
<a id="6115" class="Comment">--   sn!-abort {A ‚à® B} x  = oops</a>
<a id="6148" class="Comment">--   sn!-abort {ùüò}     ()</a>
<a id="6174" class="Comment">--   sn!-abort {ùüô}     ()</a>
<a id="6200" class="Comment">--   sn!-abort {A ‚àß B} ()</a>
<a id="6226" class="Comment">--   sn!-abort {A ‚äÉ B} () _</a>


<a id="6256" class="Comment">-- -- If `M` is SN at type `A`, then `LEFT M` is SN at type `A ‚à® B`.</a>
<a id="6325" class="Comment">-- sn-left : ‚àÄ {A B M} ‚Üí SN M A</a>
<a id="6357" class="Comment">--                     ‚Üí SN (LEFT M) (A ‚à® B)</a>
<a id="6402" class="Comment">-- sn-left s@(ùíü , M‚áì@(M‚Ä≤ , M‚áìM‚Ä≤@(M‚§ÖM‚Ä≤ , VM‚Ä≤)) , s!) = left ùíü , halt-left M‚áì , oops</a>


<a id="6487" class="Comment">-- -- If `M` is SN at type `B`, then `RIGHT M` is SN at type `A ‚à® B`.</a>
<a id="6557" class="Comment">-- sn-right : ‚àÄ {A B M} ‚Üí SN M B</a>
<a id="6590" class="Comment">--                      ‚Üí SN (RIGHT M) (A ‚à® B)</a>
<a id="6637" class="Comment">-- sn-right s@(ùíü , M‚áì@(M‚Ä≤ , M‚áìM‚Ä≤@(M‚§ÖM‚Ä≤ , VM‚Ä≤)) , s!) = right ùíü , halt-right M‚áì , oops</a>


<a id="6725" class="Comment">-- -- If `M` is SN at type `ùîπ` and `N` is SN at type `C` and `O` is SN at type `C`, then `IF M N O` is SN at type `C`.</a>
<a id="6844" class="Comment">-- mutual</a>
<a id="6854" class="Comment">--   sn-if : ‚àÄ {C M N O} ‚Üí SN M ùîπ ‚Üí SN N C ‚Üí SN O C</a>
<a id="6906" class="Comment">--                       ‚Üí SN (IF M N O) C</a>
<a id="6949" class="Comment">--   sn-if (ùíü , M‚áì@(M‚Ä≤       , M‚§ÖM‚Ä≤    , VM‚Ä≤)       , ‚àô) _              _              with tp‚§Ö M‚§ÖM‚Ä≤ ùíü</a>
<a id="7052" class="Comment">--   sn-if (ùíü , M‚áì@(LAM _    , _        , val-lam)   , ‚àô) _              _              | ()</a>
<a id="7145" class="Comment">--   sn-if (ùíü , M‚áì@(PAIR _ _ , _        , val-pair)  , ‚àô) _              _              | ()</a>
<a id="7238" class="Comment">--   sn-if (ùíü , M‚áì@(UNIT     , _        , val-unit)  , ‚àô) _              _              | ()</a>
<a id="7331" class="Comment">--   sn-if (ùíü , M‚áì@(LEFT _   , _        , val-left)  , ‚àô) _              _              | ()</a>
<a id="7424" class="Comment">--   sn-if (ùíü , M‚áì@(RIGHT _  , _        , val-right) , ‚àô) _              _              | ()</a>
<a id="7517" class="Comment">--   sn-if (ùíü , M‚áì@(TRUE     , M‚§ÖTRUE  , val-true)  , ‚àô) (‚Ñ∞ , N‚áì , s!‚ÇÅ) (‚Ñ± , O‚áì , s!‚ÇÇ) | true  = if ùíü ‚Ñ∞ ‚Ñ± , halt-if ùíü M‚áì N‚áì O‚áì , sn!-if-true M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± s!‚ÇÅ</a>
<a id="7675" class="Comment">--   sn-if (ùíü , M‚áì@(FALSE    , M‚§ÖFALSE , val-false) , ‚àô) (‚Ñ∞ , N‚áì , s!‚ÇÅ) (‚Ñ± , O‚áì , s!‚ÇÇ) | false = if ùíü ‚Ñ∞ ‚Ñ± , halt-if ùíü M‚áì N‚áì O‚áì , sn!-if-false M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± s!‚ÇÇ</a>

<a id="7836" class="Comment">--   sn!-if-true : ‚àÄ {C M N O} ‚Üí M ‚§Ö TRUE ‚Üí ‚àô ‚ä¢ M ‚¶Ç ùîπ ‚Üí ‚àô ‚ä¢ N ‚¶Ç C ‚Üí ‚àô ‚ä¢ O ‚¶Ç C ‚Üí SN! N C</a>
<a id="7924" class="Comment">--                             ‚Üí SN! (IF M N O) C</a>
<a id="7974" class="Comment">--   sn!-if-true {ùîπ}     M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± ‚àô         = ‚àô</a>
<a id="8026" class="Comment">--   sn!-if-true {A ‚à® B} M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± x         = oops</a>
<a id="8081" class="Comment">--   sn!-if-true {ùüò}     M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± ()</a>
<a id="8122" class="Comment">--   sn!-if-true {ùüô}     M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± ‚àô         = ‚àô</a>
<a id="8174" class="Comment">--   sn!-if-true {A ‚àß B} M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± (s‚ÇÅ , s‚ÇÇ) = snpr‚§Ö (congs-fst (reds-if-true M‚§ÖTRUE done)) (fst (if ùíü ‚Ñ∞ ‚Ñ±)) s‚ÇÅ ,</a>
<a id="8291" class="Comment">--                                                 snpr‚§Ö (congs-snd (reds-if-true M‚§ÖTRUE done)) (snd (if ùíü ‚Ñ∞ ‚Ñ±)) s‚ÇÇ</a>
<a id="8407" class="Comment">--   sn!-if-true {A ‚äÉ B} M‚§ÖTRUE ùíü ‚Ñ∞ ‚Ñ± f s       = snpr‚§Ö (congs-app‚ÇÅ (reds-if-true M‚§ÖTRUE done)) (app (if ùíü ‚Ñ∞ ‚Ñ±) (derp s)) (f s)</a>

<a id="8536" class="Comment">--   sn!-if-false : ‚àÄ {C M N O} ‚Üí M ‚§Ö FALSE ‚Üí ‚àô ‚ä¢ M ‚¶Ç ùîπ ‚Üí ‚àô ‚ä¢ N ‚¶Ç C ‚Üí ‚àô ‚ä¢ O ‚¶Ç C ‚Üí SN! O C</a>
<a id="8626" class="Comment">--                              ‚Üí SN! (IF M N O) C</a>
<a id="8677" class="Comment">--   sn!-if-false {ùîπ}     M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± ‚àô         = ‚àô</a>
<a id="8731" class="Comment">--   sn!-if-false {A ‚à® B} M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± x         = oops</a>
<a id="8788" class="Comment">--   sn!-if-false {ùüò}     M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± ()</a>
<a id="8831" class="Comment">--   sn!-if-false {ùüô}     M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± ‚àô         = ‚àô</a>
<a id="8885" class="Comment">--   sn!-if-false {A ‚àß B} M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± (s‚ÇÅ , s‚ÇÇ) = snpr‚§Ö (congs-fst (reds-if-false M‚§ÖFALSE done)) (fst (if ùíü ‚Ñ∞ ‚Ñ±)) s‚ÇÅ ,</a>
<a id="9006" class="Comment">--                                                   snpr‚§Ö (congs-snd (reds-if-false M‚§ÖFALSE done)) (snd (if ùíü ‚Ñ∞ ‚Ñ±)) s‚ÇÇ</a>
<a id="9126" class="Comment">--   sn!-if-false {A ‚äÉ B} M‚§ÖFALSE ùíü ‚Ñ∞ ‚Ñ± f s       = snpr‚§Ö (congs-app‚ÇÅ (reds-if-false M‚§ÖFALSE done)) (app (if ùíü ‚Ñ∞ ‚Ñ±) (derp s)) (f s)</a>


<a id="9260" class="Comment">-- -- XXX</a>
<a id="9270" class="Comment">-- mutual</a>
<a id="9280" class="Comment">--   sn-app-lam : ‚àÄ {B g M N A} ‚Üí {œÑ : Terms 0 g} ‚Üí {{_ : Vals œÑ}} {{_ : Val N}}</a>
<a id="9361" class="Comment">--                              ‚Üí ‚àô ‚ä¢ SUB œÑ (LAM M) ‚¶Ç A ‚äÉ B ‚Üí ‚àô ‚ä¢ N ‚¶Ç A ‚Üí SN (SUB (œÑ , N) M) B</a>
<a id="9456" class="Comment">--                              ‚Üí SN (APP (LAM (SUB (LIFTS œÑ) M)) N) B</a>
<a id="9527" class="Comment">--   sn-app-lam {M = M} ùíü ‚Ñ∞ (ùíü‚Ä≤ , SUB‚áì , s!) =</a>
<a id="9574" class="Comment">--     let ùíú = app ùíü ‚Ñ∞ in</a>
<a id="9600" class="Comment">--       ùíú , halt-app-lam {M = M} SUB‚áì , sn!-app-lam {M = M} ùíú s!</a>

<a id="9667" class="Comment">--   sn!-app-lam : ‚àÄ {B g M N} ‚Üí {œÑ : Terms 0 g} ‚Üí {{_ : Vals œÑ}} {{_ : Val N}}</a>
<a id="9747" class="Comment">--                             ‚Üí ‚àô ‚ä¢ APP (LAM (SUB (LIFTS œÑ) M)) N ‚¶Ç B ‚Üí SN! (SUB (œÑ , N) M) B</a>
<a id="9842" class="Comment">--                             ‚Üí SN! (APP (LAM (SUB (LIFTS œÑ) M)) N) B</a>
<a id="9913" class="Comment">--   sn!-app-lam {ùîπ}       {M = M} ùíú ‚àô         = ‚àô</a>
<a id="9964" class="Comment">--   sn!-app-lam {B‚ÇÅ ‚à® B‚ÇÇ} {M = M} ùíú x         = oops</a>
<a id="10018" class="Comment">--   sn!-app-lam {ùüò}       {M = M} ùíú ()</a>
<a id="10058" class="Comment">--   sn!-app-lam {ùüô}       {M = M} ùíú ‚àô         = ‚àô</a>
<a id="10109" class="Comment">--   sn!-app-lam {B‚ÇÅ ‚àß B‚ÇÇ} {M = M} ùíú (s‚ÇÅ , s‚ÇÇ) = snpr‚Ü¶ (cong-fst (red-app-lam {M = M})) (fst ùíú) s‚ÇÅ ,</a>
<a id="10210" class="Comment">--                                               snpr‚Ü¶ (cong-snd (red-app-lam {M = M})) (snd ùíú) s‚ÇÇ</a>
<a id="10309" class="Comment">--   sn!-app-lam {B‚ÇÅ ‚äÉ B‚ÇÇ} {M = M} ùíú f s       = snpr‚Ü¶ (cong-app‚ÇÅ (red-app-lam {M = M})) (app ùíú (derp s)) (f s)</a>


<a id="10423" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="10509" class="Comment">-- mutual</a>
<a id="10519" class="Comment">--   gen-sn : ‚àÄ {g M A} ‚Üí {œÑ : Terms 0 g} {Œì : Types g} ‚Üí {{_ : Vals œÑ}}</a>
<a id="10592" class="Comment">--                      ‚Üí SNs œÑ Œì ‚Üí Œì ‚ä¢ M ‚¶Ç A</a>
<a id="10638" class="Comment">--                      ‚Üí SN (SUB œÑ M) A</a>
<a id="10679" class="Comment">--   gen-sn œÉ (var i)      = get œÉ (zip‚àã‚ÇÇ i)</a>
<a id="10724" class="Comment">--   gen-sn œÉ (lam ùíü)      = gen-sn-lam œÉ ùíü</a>
<a id="10768" class="Comment">--   gen-sn œÉ (app ùíü ‚Ñ∞)    = sn-app (gen-sn œÉ ùíü) (gen-sn œÉ ‚Ñ∞)</a>
<a id="10830" class="Comment">--   gen-sn œÉ (pair ùíü ‚Ñ∞)   = sn-pair (gen-sn œÉ ùíü) (gen-sn œÉ ‚Ñ∞)</a>
<a id="10893" class="Comment">--   gen-sn œÉ (fst ùíü)      = sn-fst (gen-sn œÉ ùíü)</a>
<a id="10942" class="Comment">--   gen-sn œÉ (snd ùíü)      = sn-snd (gen-sn œÉ ùíü)</a>
<a id="10991" class="Comment">--   gen-sn œÉ unit         = unit , (UNIT , done , val-unit) , ‚àô</a>
<a id="11056" class="Comment">--   gen-sn œÉ (abort ùíü)    = sn-abort (gen-sn œÉ ùíü)</a>
<a id="11107" class="Comment">--   gen-sn œÉ (left ùíü)     = sn-left (gen-sn œÉ ùíü)</a>
<a id="11157" class="Comment">--   gen-sn œÉ (right ùíü)    = sn-right (gen-sn œÉ ùíü)</a>
<a id="11208" class="Comment">--   gen-sn œÉ (case ùíü ‚Ñ∞ ‚Ñ±) = gen-sn-case œÉ ùíü ‚Ñ∞ ‚Ñ±</a>
<a id="11257" class="Comment">--   gen-sn œÉ true         = true , (TRUE , done , val-true) , ‚àô</a>
<a id="11322" class="Comment">--   gen-sn œÉ false        = false , (FALSE , done , val-false) , ‚àô</a>
<a id="11390" class="Comment">--   gen-sn œÉ (if ùíü ‚Ñ∞ ‚Ñ±)   = sn-if (gen-sn œÉ ùíü) (gen-sn œÉ ‚Ñ∞) (gen-sn œÉ ‚Ñ±)</a>

<a id="11465" class="Comment">--   gen-sn-lam : ‚àÄ {g M A B} ‚Üí {œÑ : Terms 0 g} {Œì : Types g} ‚Üí {{_ : Vals œÑ}}</a>
<a id="11544" class="Comment">--                            ‚Üí SNs œÑ Œì ‚Üí Œì , A ‚ä¢ M ‚¶Ç B</a>
<a id="11600" class="Comment">--                            ‚Üí SN (LAM (SUB (LIFTS œÑ) M)) (A ‚äÉ B)</a>
<a id="11667" class="Comment">--   gen-sn-lam {M = M} {{VœÑ}} œÉ ùíü =</a>
<a id="11704" class="Comment">--     let ùíü‚Ä≤ = sub (derps œÉ) (lam ùíü) in</a>
<a id="11745" class="Comment">--       ùíü‚Ä≤ , (LAM _ , done , val-lam) , (\ { s@(‚Ñ∞ , (N‚Ä≤ , N‚áìN‚Ä≤@(N‚§ÖN‚Ä≤ , VN‚Ä≤)) , s!) ‚Üí</a>
<a id="11831" class="Comment">--         let s‚Ä≤@(‚Ñ∞‚Ä≤ , _ , _) = snp‚áì N‚áìN‚Ä≤ ‚Ñ∞ s in</a>
<a id="11881" class="Comment">--           snpr‚§Ö (congs-app‚ÇÇ N‚§ÖN‚Ä≤)</a>
<a id="11918" class="Comment">--                  (app ùíü‚Ä≤ ‚Ñ∞)</a>
<a id="11949" class="Comment">--                  (sn-app-lam {M = M} {{VœÑ}} {{VN‚Ä≤}}</a>
<a id="12004" class="Comment">--                    ùíü‚Ä≤ ‚Ñ∞‚Ä≤</a>
<a id="12032" class="Comment">--                    (gen-sn {{VœÑ , VN‚Ä≤}} (œÉ , s‚Ä≤) ùíü)) })</a>


<a id="12093" class="Comment">--   gen-sn-case : ‚àÄ {g M N O A B C} ‚Üí {œÑ : Terms 0 g} {Œì : Types g} ‚Üí {{_ : Vals œÑ}}</a>
<a id="12179" class="Comment">--                                   ‚Üí SNs œÑ Œì ‚Üí Œì ‚ä¢ M ‚¶Ç A ‚à® B ‚Üí Œì , A ‚ä¢ N ‚¶Ç C ‚Üí Œì , B ‚ä¢ O ‚¶Ç C</a>
<a id="12274" class="Comment">--                                   ‚Üí SN (CASE (SUB œÑ M) (SUB (LIFTS œÑ) N) (SUB (LIFTS œÑ) O)) C</a>
<a id="12371" class="Comment">--   gen-sn-case {N = N} {O} {{VœÑ}} œÉ ùíü ‚Ñ∞ ‚Ñ± with gen-sn œÉ ùíü</a>
<a id="12431" class="Comment">--   gen-sn-case {N = N} {O} {{VœÑ}} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (M‚Ä≤       , SUB‚§ÖM‚Ä≤    , VM‚Ä≤)       , s‚ÇÅ!) with tp‚§Ö SUB‚§ÖM‚Ä≤ ùíü‚Ä≤</a>
<a id="12547" class="Comment">--   gen-sn-case {N = N} {O} {{VœÑ}} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (LAM _    , _          , val-lam)   , s‚ÇÅ!) | ()</a>
<a id="12650" class="Comment">--   gen-sn-case {N = N} {O} {{VœÑ}} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (PAIR _ _ , _          , val-pair)  , s‚ÇÅ!) | ()</a>
<a id="12753" class="Comment">--   gen-sn-case {N = N} {O} {{VœÑ}} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (UNIT     , _          , val-unit)  , s‚ÇÅ!) | ()</a>
<a id="12856" class="Comment">--   gen-sn-case {N = N} {O} {{VœÑ}} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (LEFT M‚Ä≥  , SUB‚§ÖLEFT  , val-left {{VM‚Ä≥}})  , s‚ÇÅ!) | left _</a>
<a id="12970" class="Comment">--     = let step2 = gen-sn {M = N} {{VœÑ , VM‚Ä≥}} (œÉ , {!s‚ÇÅ!}) ‚Ñ∞ in {!!}</a>




<a id="13046" class="Comment">-- --    = -- let x = snp‚§Ö SUB‚§ÖLEFT {!!} {!!} in</a>
<a id="13095" class="Comment">-- --      let (‚Ñ∞‚Ä≤ , N‚áì@(N‚Ä≤ , N‚§ÖN‚Ä≤ , VN‚Ä≤) , s‚ÇÇ) = gen-sn (œÉ , {!s‚ÇÅ!}) ‚Ñ∞ in</a>
<a id="13170" class="Comment">-- --</a>
<a id="13176" class="Comment">-- --      snpr‚§Ö (congs-case SUB‚§ÖLEFT)</a>
<a id="13215" class="Comment">-- --             (case ùíü‚Ä≤ (sub (lifts (derps œÉ)) ‚Ñ∞) (sub (lifts (derps œÉ)) ‚Ñ±))</a>
<a id="13295" class="Comment">-- --             (case (left ùíü‚Ä≥) (sub (lifts (derps œÉ)) ‚Ñ∞) (sub (lifts (derps œÉ)) ‚Ñ±) ,</a>
<a id="13383" class="Comment">-- --               halt-case-left {N = N} {O} N‚áì , {!!})</a>
<a id="13441" class="Comment">-- --</a>
<a id="13447" class="Comment">-- --    -- = let (‚Ñ∞‚Ä≤ , N‚áì@(N‚Ä≤ , N‚§ÖN‚Ä≤ , VN‚Ä≤) , s‚ÇÇ) = gen-sn (œÉ , unsn-left (snp‚§Ö SUB‚§ÖLEFT ùíü‚Ä≤ s‚ÇÅ)) ‚Ñ∞ in</a>
<a id="13550" class="Comment">-- --    --     sub (derps œÉ) (case ùíü ‚Ñ∞ ‚Ñ±) , (N‚Ä≤ , {!!} , {!!}) , {!!}</a>
<a id="13621" class="Comment">--   gen-sn-case {N = N} {O} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (RIGHT _  , SUB‚§ÖRIGHT , val-right) , s!) | right ùíü‚Ä≥</a>
<a id="13721" class="Comment">--     = {!!}</a>



<a id="13738" class="Comment">-- --    = sub (derps œÉ) (case ùíü ‚Ñ∞ ‚Ñ±) , ({!!} , {!!} , {!!}) , {!!}</a>
<a id="13806" class="Comment">--   gen-sn-case {N = N} {O} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (TRUE     , _          , val-true)  , s!) | ()</a>
<a id="13901" class="Comment">--   gen-sn-case {N = N} {O} œÉ ùíü ‚Ñ∞ ‚Ñ± | s‚ÇÅ@(ùíü‚Ä≤ , (FALSE    , _          , val-false) , s!) | ()</a>

<a id="13997" class="Comment">-- --    let (ùíü‚Ä≤ , ‚áìM@(M‚Ä≤ , M‚§ÖM‚Ä≤ , VM‚Ä≤) , s!) = gen-sn œÉ ùíü in</a>
<a id="14059" class="Comment">-- --      sub (derps œÉ) (case ùíü ‚Ñ∞ ‚Ñ±) , {!!} , {!!}</a>


<a id="14113" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="14199" class="Comment">-- -- Every well-typed term is SN.</a>
<a id="14234" class="Comment">-- sn : ‚àÄ {A M} ‚Üí ‚àô ‚ä¢ M ‚¶Ç A</a>
<a id="14262" class="Comment">--              ‚Üí SN M A</a>
<a id="14287" class="Comment">-- sn {A} {M} ùíü = subst (\ M‚Ä≤ ‚Üí SN M‚Ä≤ A) (id-SUB M) (gen-sn ‚àô ùíü)</a>


<a id="14354" class="Comment">-- -- Every SN term terminates.</a>
<a id="14386" class="Comment">-- herp : ‚àÄ {A M} ‚Üí SN M A</a>
<a id="14413" class="Comment">--                ‚Üí M ‚áì</a>
<a id="14437" class="Comment">-- herp (ùíü , M‚áì , s!) = M‚áì</a>


<a id="14466" class="Comment">-- -- Every well-typed term terminates.</a>
<a id="14506" class="Comment">-- halt : ‚àÄ {A M} ‚Üí ‚àô ‚ä¢ M ‚¶Ç A</a>
<a id="14536" class="Comment">--                ‚Üí M ‚áì</a>
<a id="14560" class="Comment">-- halt {A} ùíü = herp {A} (sn ùíü)</a>


<a id="14594" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>