<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR3</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="A201802.WIP.LR3.html" class="Module">A201802.WIP.LR3</a> <a id="24" class="Keyword">where</a>

<a id="31" class="Keyword">open</a> <a id="36" class="Keyword">import</a> <a id="43" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="59" class="Keyword">open</a> <a id="64" class="Keyword">import</a> <a id="71" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="166" class="Keyword">open</a> <a id="171" class="Keyword">import</a> <a id="178" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>

<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="A201802.LR0.html" class="Module">A201802.LR0</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="A201802.LR0Lemmas.html" class="Module">A201802.LR0Lemmas</a>
<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="A201802.LR1.html" class="Module">A201802.LR1</a>

<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="A201802.LR2.html" class="Module">A201802.LR2</a> <a id="327" class="Comment">-- TODO: which LR2?</a>



<a id="350" class="Keyword">postulate</a>
  <a id="oops"></a><a id="362" href="A201802.WIP.LR3.html#362" class="Postulate">oops</a> <a id="367" class="Symbol">:</a> <a id="369" class="Symbol">âˆ€</a> <a id="371" class="Symbol">{</a><a id="372" href="A201802.WIP.LR3.html#372" class="Bound">â„“</a><a id="373" class="Symbol">}</a> <a id="375" class="Symbol">â†’</a> <a id="377" class="Symbol">{</a><a id="378" href="A201802.WIP.LR3.html#378" class="Bound">X</a> <a id="380" class="Symbol">:</a> <a id="382" class="PrimitiveType">Set</a> <a id="386" href="A201802.WIP.LR3.html#372" class="Bound">â„“</a><a id="387" class="Symbol">}</a> <a id="389" class="Symbol">â†’</a> <a id="391" href="A201802.WIP.LR3.html#378" class="Bound">X</a>


<a id="395" class="Comment">--------------------------------------------------------------------------------</a>


<a id="478" class="Comment">-- `SN _ A` is the strong normalisation predicate on terms at type `A`.</a>
<a id="550" class="Keyword">mutual</a>
  <a id="SN"></a><a id="559" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="562" class="Symbol">:</a> <a id="564" href="A201802.LR0.html#547" class="Datatype">Term</a> <a id="569" class="Number">0</a> <a id="571" class="Symbol">â†’</a> <a id="573" href="A201802.LR0.html#265" class="Datatype">Type</a> <a id="578" class="Symbol">â†’</a> <a id="580" class="PrimitiveType">Set</a>
  <a id="586" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="589" href="A201802.WIP.LR3.html#589" class="Bound">M</a> <a id="591" href="A201802.WIP.LR3.html#591" class="Bound">A</a> <a id="593" class="Symbol">=</a> <a id="595" href="A201801.Vec.html#266" class="InductiveConstructor">âˆ™</a> <a id="597" href="A201802.LR1.html#348" class="Datatype Operator">âŠ¢</a> <a id="599" href="A201802.WIP.LR3.html#589" class="Bound">M</a> <a id="601" href="A201802.LR1.html#348" class="Datatype Operator">â¦‚</a> <a id="603" href="A201802.WIP.LR3.html#591" class="Bound">A</a> <a id="605" href="A201801.Prelude.html#4704" class="Function Operator">Ã—</a> <a id="607" href="A201802.WIP.LR3.html#589" class="Bound">M</a> <a id="609" href="A201802.LR2.html#16072" class="Function Operator">â‡“</a> <a id="611" href="A201801.Prelude.html#4704" class="Function Operator">Ã—</a> <a id="613" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="617" href="A201802.WIP.LR3.html#589" class="Bound">M</a> <a id="619" href="A201802.WIP.LR3.html#591" class="Bound">A</a>

  <a id="SN!"></a><a id="624" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="628" class="Symbol">:</a> <a id="630" href="A201802.LR0.html#547" class="Datatype">Term</a> <a id="635" class="Number">0</a> <a id="637" class="Symbol">â†’</a> <a id="639" href="A201802.LR0.html#265" class="Datatype">Type</a> <a id="644" class="Symbol">â†’</a> <a id="646" class="PrimitiveType">Set</a>
  <a id="652" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="656" href="A201802.WIP.LR3.html#656" class="Bound">M</a> <a id="658" href="A201802.LR0.html#288" class="InductiveConstructor">ğ”¹</a>       <a id="666" class="Symbol">=</a> <a id="668" href="Agda.Builtin.Unit.html#137" class="Record">âŠ¤</a>
  <a id="672" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="676" href="A201802.WIP.LR3.html#676" class="Bound">M</a> <a id="678" class="Symbol">(</a><a id="679" href="A201802.WIP.LR3.html#679" class="Bound">A</a> <a id="681" href="A201802.LR0.html#303" class="InductiveConstructor Operator">âˆ¨</a> <a id="683" href="A201802.WIP.LR3.html#683" class="Bound">B</a><a id="684" class="Symbol">)</a> <a id="686" class="Symbol">=</a> <a id="688" href="A201802.WIP.LR3.html#362" class="Postulate">oops</a>
  <a id="695" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="699" href="A201802.WIP.LR3.html#699" class="Bound">M</a> <a id="701" href="A201802.LR0.html#332" class="InductiveConstructor">ğŸ˜</a>       <a id="709" class="Symbol">=</a> <a id="711" href="A201801.Prelude.html#1126" class="Datatype">âŠ¥</a>
  <a id="715" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="719" href="A201802.WIP.LR3.html#719" class="Bound">M</a> <a id="721" href="A201802.LR0.html#347" class="InductiveConstructor">ğŸ™</a>       <a id="729" class="Symbol">=</a> <a id="731" href="Agda.Builtin.Unit.html#137" class="Record">âŠ¤</a>
  <a id="735" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="739" href="A201802.WIP.LR3.html#739" class="Bound">M</a> <a id="741" class="Symbol">(</a><a id="742" href="A201802.WIP.LR3.html#742" class="Bound">A</a> <a id="744" href="A201802.LR0.html#362" class="InductiveConstructor Operator">âˆ§</a> <a id="746" href="A201802.WIP.LR3.html#746" class="Bound">B</a><a id="747" class="Symbol">)</a> <a id="749" class="Symbol">=</a> <a id="751" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="754" class="Symbol">(</a><a id="755" href="A201802.LR0.html#715" class="InductiveConstructor">FST</a> <a id="759" href="A201802.WIP.LR3.html#739" class="Bound">M</a><a id="760" class="Symbol">)</a> <a id="762" href="A201802.WIP.LR3.html#742" class="Bound">A</a> <a id="764" href="A201801.Prelude.html#4704" class="Function Operator">Ã—</a> <a id="766" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="769" class="Symbol">(</a><a id="770" href="A201802.LR0.html#743" class="InductiveConstructor">SND</a> <a id="774" href="A201802.WIP.LR3.html#739" class="Bound">M</a><a id="775" class="Symbol">)</a> <a id="777" href="A201802.WIP.LR3.html#746" class="Bound">B</a>
  <a id="781" href="A201802.WIP.LR3.html#624" class="Function">SN!</a> <a id="785" href="A201802.WIP.LR3.html#785" class="Bound">M</a> <a id="787" class="Symbol">(</a><a id="788" href="A201802.WIP.LR3.html#788" class="Bound">A</a> <a id="790" href="A201802.LR0.html#391" class="InductiveConstructor Operator">âŠƒ</a> <a id="792" href="A201802.WIP.LR3.html#792" class="Bound">B</a><a id="793" class="Symbol">)</a> <a id="795" class="Symbol">=</a> <a id="797" class="Symbol">âˆ€</a> <a id="799" class="Symbol">{</a><a id="800" href="A201802.WIP.LR3.html#800" class="Bound">N</a><a id="801" class="Symbol">}</a> <a id="803" class="Symbol">â†’</a> <a id="805" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="808" href="A201802.WIP.LR3.html#800" class="Bound">N</a> <a id="810" href="A201802.WIP.LR3.html#788" class="Bound">A</a> <a id="812" class="Symbol">â†’</a> <a id="814" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="817" class="Symbol">(</a><a id="818" href="A201802.LR0.html#641" class="InductiveConstructor">APP</a> <a id="822" href="A201802.WIP.LR3.html#785" class="Bound">M</a> <a id="824" href="A201802.WIP.LR3.html#800" class="Bound">N</a><a id="825" class="Symbol">)</a> <a id="827" href="A201802.WIP.LR3.html#792" class="Bound">B</a>


<a id="831" class="Comment">-- Every SN term is well-typed.</a>
<a id="derp"></a><a id="863" href="A201802.WIP.LR3.html#863" class="Function">derp</a> <a id="868" class="Symbol">:</a> <a id="870" class="Symbol">âˆ€</a> <a id="872" class="Symbol">{</a><a id="873" href="A201802.WIP.LR3.html#873" class="Bound">A</a> <a id="875" href="A201802.WIP.LR3.html#875" class="Bound">M</a><a id="876" class="Symbol">}</a> <a id="878" class="Symbol">â†’</a> <a id="880" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="883" href="A201802.WIP.LR3.html#875" class="Bound">M</a> <a id="885" href="A201802.WIP.LR3.html#873" class="Bound">A</a>
               <a id="902" class="Symbol">â†’</a> <a id="904" href="A201801.Vec.html#266" class="InductiveConstructor">âˆ™</a> <a id="906" href="A201802.LR1.html#348" class="Datatype Operator">âŠ¢</a> <a id="908" href="A201802.WIP.LR3.html#875" class="Bound">M</a> <a id="910" href="A201802.LR1.html#348" class="Datatype Operator">â¦‚</a> <a id="912" href="A201802.WIP.LR3.html#873" class="Bound">A</a>
<a id="914" href="A201802.WIP.LR3.html#863" class="Function">derp</a> <a id="919" class="Symbol">(</a><a id="920" href="A201802.WIP.LR3.html#920" class="Bound">ğ’Ÿ</a> <a id="922" href="A201801.Prelude.html#4622" class="InductiveConstructor Operator">,</a> <a id="924" href="A201802.WIP.LR3.html#924" class="Bound">Mâ‡“</a> <a id="927" href="A201801.Prelude.html#4622" class="InductiveConstructor Operator">,</a> <a id="929" href="A201802.WIP.LR3.html#929" class="Bound">s!</a><a id="931" class="Symbol">)</a> <a id="933" class="Symbol">=</a> <a id="935" href="A201802.WIP.LR3.html#920" class="Bound">ğ’Ÿ</a>


<a id="939" class="Comment">--------------------------------------------------------------------------------</a>


<a id="1022" class="Comment">-- `SNs _ Î“` is the strong normalisation predicate on substitutions at all types `Î“`.</a>
<a id="SNs"></a><a id="1108" href="A201802.WIP.LR3.html#1108" class="Function">SNs</a> <a id="1112" class="Symbol">:</a> <a id="1114" class="Symbol">âˆ€</a> <a id="1116" class="Symbol">{</a><a id="1117" href="A201802.WIP.LR3.html#1117" class="Bound">g</a><a id="1118" class="Symbol">}</a> <a id="1120" class="Symbol">â†’</a> <a id="1122" class="Symbol">(</a><a id="1123" href="A201802.WIP.LR3.html#1123" class="Bound">Ï„</a> <a id="1125" class="Symbol">:</a> <a id="1127" href="A201802.LR0.html#1014" class="Function">Terms</a> <a id="1133" class="Number">0</a> <a id="1135" href="A201802.WIP.LR3.html#1117" class="Bound">g</a><a id="1136" class="Symbol">)</a> <a id="1138" class="Symbol">â†’</a> <a id="1140" href="A201802.LR0.html#418" class="Function">Types</a> <a id="1146" href="A201802.WIP.LR3.html#1117" class="Bound">g</a> <a id="1148" class="Symbol">â†’</a> <a id="1150" class="PrimitiveType">Set</a>
<a id="1154" href="A201802.WIP.LR3.html#1108" class="Function">SNs</a> <a id="1158" href="A201802.WIP.LR3.html#1158" class="Bound">Ï„</a> <a id="1160" href="A201802.WIP.LR3.html#1160" class="Bound">Î“</a> <a id="1162" class="Symbol">=</a> <a id="1164" href="A201801.AllVec.html#172" class="Datatype">All</a> <a id="1168" class="Symbol">(\</a> <a id="1171" class="Symbol">{</a> <a id="1173" class="Symbol">(</a><a id="1174" href="A201802.WIP.LR3.html#1174" class="Bound">M</a> <a id="1176" href="A201801.Prelude.html#4622" class="InductiveConstructor Operator">,</a> <a id="1178" href="A201802.WIP.LR3.html#1178" class="Bound">A</a><a id="1179" class="Symbol">)</a> <a id="1181" class="Symbol">â†’</a> <a id="1183" href="A201802.WIP.LR3.html#559" class="Function">SN</a> <a id="1186" href="A201802.WIP.LR3.html#1174" class="Bound">M</a> <a id="1188" href="A201802.WIP.LR3.html#1178" class="Bound">A</a> <a id="1190" class="Symbol">})</a> <a id="1193" class="Symbol">(</a><a id="1194" href="A201801.Vec.html#3269" class="Function">zip</a> <a id="1198" href="A201802.WIP.LR3.html#1158" class="Bound">Ï„</a> <a id="1200" href="A201802.WIP.LR3.html#1160" class="Bound">Î“</a><a id="1201" class="Symbol">)</a>


<a id="1205" class="Comment">-- Every SN substitution is well-typed.</a>
<a id="derps"></a><a id="1245" href="A201802.WIP.LR3.html#1245" class="Function">derps</a> <a id="1251" class="Symbol">:</a> <a id="1253" class="Symbol">âˆ€</a> <a id="1255" class="Symbol">{</a><a id="1256" href="A201802.WIP.LR3.html#1256" class="Bound">g</a><a id="1257" class="Symbol">}</a> <a id="1259" class="Symbol">â†’</a> <a id="1261" class="Symbol">{</a><a id="1262" href="A201802.WIP.LR3.html#1262" class="Bound">Ï„</a> <a id="1264" class="Symbol">:</a> <a id="1266" href="A201802.LR0.html#1014" class="Function">Terms</a> <a id="1272" class="Number">0</a> <a id="1274" href="A201802.WIP.LR3.html#1256" class="Bound">g</a><a id="1275" class="Symbol">}</a> <a id="1277" class="Symbol">{</a><a id="1278" href="A201802.WIP.LR3.html#1278" class="Bound">Î“</a> <a id="1280" class="Symbol">:</a> <a id="1282" href="A201802.LR0.html#418" class="Function">Types</a> <a id="1288" href="A201802.WIP.LR3.html#1256" class="Bound">g</a><a id="1289" class="Symbol">}</a>
              <a id="1305" class="Symbol">â†’</a> <a id="1307" href="A201802.WIP.LR3.html#1108" class="Function">SNs</a> <a id="1311" href="A201802.WIP.LR3.html#1262" class="Bound">Ï„</a> <a id="1313" href="A201802.WIP.LR3.html#1278" class="Bound">Î“</a>
              <a id="1329" class="Symbol">â†’</a> <a id="1331" href="A201801.Vec.html#266" class="InductiveConstructor">âˆ™</a> <a id="1333" href="A201802.LR1.html#1419" class="Function Operator">âŠ¢</a> <a id="1335" href="A201802.WIP.LR3.html#1262" class="Bound">Ï„</a> <a id="1337" href="A201802.LR1.html#1419" class="Function Operator">â¦‚</a> <a id="1339" href="A201802.WIP.LR3.html#1278" class="Bound">Î“</a> <a id="1341" href="A201802.LR1.html#1419" class="Function Operator">all</a>
<a id="1345" href="A201802.WIP.LR3.html#1245" class="Function">derps</a> <a id="1351" href="A201802.WIP.LR3.html#1351" class="Bound">Ïƒ</a> <a id="1353" class="Symbol">=</a> <a id="1355" href="A201801.AllVec.html#302" class="Function">maps</a> <a id="1360" href="A201802.WIP.LR3.html#863" class="Function">derp</a> <a id="1365" href="A201802.WIP.LR3.html#1351" class="Bound">Ïƒ</a>


<a id="1369" class="Comment">--------------------------------------------------------------------------------</a>


<a id="1452" class="Comment">-- -- Small-step reduction IN REVERSE preserves SN.</a>
<a id="1504" class="Comment">-- mutual</a>
<a id="1514" class="Comment">--   snprâ†¦ : âˆ€ {A M Mâ€²} â†’ M â†¦ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1569" class="Comment">--                       â†’ SN M A</a>
<a id="1603" class="Comment">--   snprâ†¦ Mâ†¦Mâ€² ğ’Ÿ (ğ’Ÿâ€² , Mâ€²â‡“ , s!â€²) = ğ’Ÿ , hprâ†¦ Mâ†¦Mâ€² Mâ€²â‡“ , sn!prâ†¦ Mâ†¦Mâ€² ğ’Ÿ s!â€²</a>

<a id="1679" class="Comment">--   sn!prâ†¦ : âˆ€ {A M Mâ€²} â†’ M â†¦ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN! Mâ€² A</a>
<a id="1736" class="Comment">--                        â†’ SN! M A</a>
<a id="1772" class="Comment">--   sn!prâ†¦ {ğ”¹}     Mâ†¦Mâ€² ğ’Ÿ âˆ™         = âˆ™</a>
<a id="1813" class="Comment">--   sn!prâ†¦ {A âˆ¨ B} Mâ†¦Mâ€² ğ’Ÿ x         = oops</a>
<a id="1857" class="Comment">--   sn!prâ†¦ {ğŸ˜}     Mâ†¦Mâ€² ğ’Ÿ ()</a>
<a id="1887" class="Comment">--   sn!prâ†¦ {ğŸ™}     Mâ†¦Mâ€² ğ’Ÿ âˆ™         = âˆ™</a>
<a id="1928" class="Comment">--   sn!prâ†¦ {A âˆ§ B} Mâ†¦Mâ€² ğ’Ÿ (sâ‚ , sâ‚‚) = snprâ†¦ (cong-fst Mâ†¦Mâ€²) (fst ğ’Ÿ) sâ‚ , snprâ†¦ (cong-snd Mâ†¦Mâ€²) (snd ğ’Ÿ) sâ‚‚</a>
<a id="2035" class="Comment">--   sn!prâ†¦ {A âŠƒ B} Mâ†¦Mâ€² ğ’Ÿ f s       = snprâ†¦ (cong-appâ‚ Mâ†¦Mâ€²) (app ğ’Ÿ (derp s)) (f s)</a>


<a id="2122" class="Comment">-- -- Iterated small-step reduction IN REVERSE preserves SN.</a>
<a id="2183" class="Comment">-- snprâ¤… : âˆ€ {A M Mâ€²} â†’ M â¤… Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="2236" class="Comment">--                     â†’ SN M A</a>
<a id="2268" class="Comment">-- snprâ¤… done                ğ’Ÿ s = s</a>
<a id="2305" class="Comment">-- snprâ¤… (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) ğ’Ÿ s = snprâ†¦ Mâ†¦Mâ€³ ğ’Ÿ (snprâ¤… Mâ€³â¤…Mâ€² (tpâ†¦ Mâ†¦Mâ€³ ğ’Ÿ) s)</a>


<a id="2382" class="Comment">-- -- Big-step reduction IN REVERSE preserves SN.</a>
<a id="2432" class="Comment">-- snprâ‡“ : âˆ€ {A M Mâ€²} â†’ M â‡“ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="2485" class="Comment">--                    â†’ SN M A</a>
<a id="2516" class="Comment">-- snprâ‡“ (Mâ¤…Mâ€² , VMâ€²) ğ’Ÿ s = snprâ¤… Mâ¤…Mâ€² ğ’Ÿ s</a>


<a id="2561" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2647" class="Comment">-- -- Small-step reduction preserves SN.</a>
<a id="2688" class="Comment">-- mutual</a>
<a id="2698" class="Comment">--   snpâ†¦ : âˆ€ {A M Mâ€²} â†’ M â†¦ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="2751" class="Comment">--                      â†’ SN Mâ€² A</a>
<a id="2785" class="Comment">--   snpâ†¦ Mâ†¦Mâ€² ğ’Ÿ (_ , Mâ‡“ , s!) = tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ , hpâ†¦ Mâ†¦Mâ€² Mâ‡“ , sn!pâ†¦ Mâ†¦Mâ€² ğ’Ÿ s!</a>

<a id="2862" class="Comment">--   sn!pâ†¦ : âˆ€ {A M Mâ€²} â†’ M â†¦ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN! M A</a>
<a id="2917" class="Comment">--                       â†’ SN! Mâ€² A</a>
<a id="2953" class="Comment">--   sn!pâ†¦ {ğ”¹}     Mâ†¦Mâ€² ğ’Ÿ âˆ™         = âˆ™</a>
<a id="2993" class="Comment">--   sn!pâ†¦ {A âˆ¨ B} Mâ†¦Mâ€² ğ’Ÿ x         = oops</a>
<a id="3036" class="Comment">--   sn!pâ†¦ {ğŸ˜}     Mâ†¦Mâ€² ğ’Ÿ ()</a>
<a id="3065" class="Comment">--   sn!pâ†¦ {ğŸ™}     Mâ†¦Mâ€² ğ’Ÿ âˆ™         = âˆ™</a>
<a id="3105" class="Comment">--   sn!pâ†¦ {A âˆ§ B} Mâ†¦Mâ€² ğ’Ÿ (sâ‚ , sâ‚‚) = snpâ†¦ (cong-fst Mâ†¦Mâ€²) (fst ğ’Ÿ) sâ‚ , snpâ†¦ (cong-snd Mâ†¦Mâ€²) (snd ğ’Ÿ) sâ‚‚</a>
<a id="3209" class="Comment">--   sn!pâ†¦ {A âŠƒ B} Mâ†¦Mâ€² ğ’Ÿ f s       = snpâ†¦ (cong-appâ‚ Mâ†¦Mâ€²) (app ğ’Ÿ (derp s)) (f s)</a>


<a id="3294" class="Comment">-- -- Iterated small-step reduction preserves SN.</a>
<a id="3344" class="Comment">-- snpâ¤… : âˆ€ {A M Mâ€²} â†’ M â¤… Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="3395" class="Comment">--                    â†’ SN Mâ€² A</a>
<a id="3427" class="Comment">-- snpâ¤… done                ğ’Ÿ s = s</a>
<a id="3463" class="Comment">-- snpâ¤… (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) ğ’Ÿ s = snpâ¤… Mâ€³â¤…Mâ€² (tpâ†¦ Mâ†¦Mâ€³ ğ’Ÿ) (snpâ†¦ Mâ†¦Mâ€³ ğ’Ÿ s)</a>


<a id="3537" class="Comment">-- -- Big-step reduction preserves SN.</a>
<a id="3576" class="Comment">-- snpâ‡“ : âˆ€ {A M Mâ€²} â†’ M â‡“ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="3627" class="Comment">--                   â†’ SN Mâ€² A</a>
<a id="3658" class="Comment">-- snpâ‡“ (Mâ¤…Mâ€² , VMâ€²) ğ’Ÿ s = snpâ¤… Mâ¤…Mâ€² ğ’Ÿ s</a>


<a id="3701" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3787" class="Comment">-- -- If `M` is SN at type `A âŠƒ B` and `N` is SN at type `A`, then `APP M N` is SN at type `B`.</a>
<a id="3883" class="Comment">-- sn-app : âˆ€ {A B M N} â†’ SN M (A âŠƒ B) â†’ SN N A</a>
<a id="3931" class="Comment">--                      â†’ SN (APP M N) B</a>
<a id="3972" class="Comment">-- sn-app (ğ’Ÿ , Mâ‡“ , f) s = f s</a>


<a id="4005" class="Comment">-- -- If `M` is SN at type `A` and `N` is SN at type `B`, then `PAIR M N` is SN at type `A âˆ§ B`.</a>
<a id="4102" class="Comment">-- sn-pair : âˆ€ {A B M N} â†’ SN M A â†’ SN N B</a>
<a id="4145" class="Comment">--                       â†’ SN (PAIR M N) (A âˆ§ B)</a>
<a id="4194" class="Comment">-- sn-pair sâ‚@(ğ’Ÿ , Mâ‡“@(Mâ€² , Mâ‡“Mâ€²@(Mâ¤…Mâ€² , VMâ€²)) , s!â‚) sâ‚‚@(â„° , Nâ‡“@(Nâ€² , Nâ‡“Nâ€²@(Nâ¤…Nâ€² , VNâ€²)) , s!â‚‚)</a>
<a id="4291" class="Comment">--   = pair ğ’Ÿ â„° ,</a>
<a id="4309" class="Comment">--     halt-pair Mâ‡“ Nâ‡“ ,</a>
<a id="4334" class="Comment">--     snprâ‡“ (big-red-fst-pair {{VMâ€²}} {{VNâ€²}} (congs-pair {{VMâ€²}} {{VNâ€²}} Mâ¤…Mâ€² Nâ¤…Nâ€²)) (fst (pair ğ’Ÿ â„°)) (snpâ¤… Mâ¤…Mâ€² ğ’Ÿ sâ‚) ,</a>
<a id="4457" class="Comment">--     snprâ‡“ (big-red-snd-pair {{VMâ€²}} {{VNâ€²}} ((congs-pair {{VMâ€²}} {{VNâ€²}} Mâ¤…Mâ€² Nâ¤…Nâ€²))) (snd (pair ğ’Ÿ â„°)) (snpâ¤… Nâ¤…Nâ€² â„° sâ‚‚)</a>


<a id="4582" class="Comment">-- -- If `M` is SN at type `A âˆ§ B`, then `FST M` is SN at type `A`.</a>
<a id="4650" class="Comment">-- mutual</a>
<a id="4660" class="Comment">--   sn-fst : âˆ€ {A B M} â†’ SN M (A âˆ§ B)</a>
<a id="4699" class="Comment">--                      â†’ SN (FST M) A</a>
<a id="4738" class="Comment">--   sn-fst (ğ’Ÿ , Mâ‡“ , s!) = fst ğ’Ÿ , halt-fst ğ’Ÿ Mâ‡“ , sn!-fst s!</a>

<a id="4802" class="Comment">--   sn!-fst : âˆ€ {A B M} â†’ SN! M (A âˆ§ B)</a>
<a id="4843" class="Comment">--                       â†’ SN! (FST M) A</a>
<a id="4884" class="Comment">--   sn!-fst {ğ”¹}       _                      = âˆ™</a>
<a id="4934" class="Comment">--   sn!-fst {Aâ‚ âˆ¨ Aâ‚‚} x                      = oops</a>
<a id="4987" class="Comment">--   sn!-fst {ğŸ˜}       ()</a>
<a id="5013" class="Comment">--   sn!-fst {ğŸ™}       _                      = âˆ™</a>
<a id="5063" class="Comment">--   sn!-fst {Aâ‚ âˆ§ Aâ‚‚} ((â„° , FSTâ‡“ , s) , _)   = s</a>
<a id="5113" class="Comment">--   sn!-fst {Aâ‚ âŠƒ Aâ‚‚} ((â„° , FSTâ‡“ , f) , _) s = f s</a>


<a id="5167" class="Comment">-- -- If `M` is SN at type `A âˆ§ B`, then `SND M` is SN at type `B`.</a>
<a id="5235" class="Comment">-- mutual</a>
<a id="5245" class="Comment">--   sn-snd : âˆ€ {A B M} â†’ SN M (A âˆ§ B)</a>
<a id="5284" class="Comment">--                      â†’ SN (SND M) B</a>
<a id="5323" class="Comment">--   sn-snd (ğ’Ÿ , Mâ‡“ , s!) = snd ğ’Ÿ , halt-snd ğ’Ÿ Mâ‡“ , sn!-snd s!</a>

<a id="5387" class="Comment">--   sn!-snd : âˆ€ {B A M} â†’ SN! M (A âˆ§ B)</a>
<a id="5428" class="Comment">--                       â†’ SN! (SND M) B</a>
<a id="5469" class="Comment">--   sn!-snd {ğ”¹}       _                      = âˆ™</a>
<a id="5519" class="Comment">--   sn!-snd {Bâ‚ âˆ¨ Bâ‚‚} x                      = oops</a>
<a id="5572" class="Comment">--   sn!-snd {ğŸ˜}       ()</a>
<a id="5598" class="Comment">--   sn!-snd {ğŸ™}       _                      = âˆ™</a>
<a id="5648" class="Comment">--   sn!-snd {Bâ‚ âˆ§ Bâ‚‚} (_ , (â„° , SNDâ‡“ , s))   = s</a>
<a id="5698" class="Comment">--   sn!-snd {Bâ‚ âŠƒ Bâ‚‚} (_ , (â„° , SNDâ‡“ , f)) s = f s</a>


<a id="5752" class="Comment">-- -- If `M` is SN at type `ğŸ˜`, then `ABORT M` is SN at type `C`.</a>
<a id="5818" class="Comment">-- mutual</a>
<a id="5828" class="Comment">--   sn-abort : âˆ€ {C M} â†’ SN M ğŸ˜</a>
<a id="5861" class="Comment">--                      â†’ SN (ABORT M) C</a>
<a id="5902" class="Comment">--   sn-abort {C} (ğ’Ÿ , Mâ‡“ , s!) = abort ğ’Ÿ , halt-abort ğ’Ÿ Mâ‡“ , sn!-abort {C} s!</a>

<a id="5982" class="Comment">--   sn!-abort : âˆ€ {C M} â†’ SN! M ğŸ˜</a>
<a id="6017" class="Comment">--                       â†’ SN! (ABORT M) C</a>
<a id="6060" class="Comment">--   sn!-abort {ğ”¹}     ()</a>
<a id="6086" class="Comment">--   sn!-abort {A âˆ¨ B} x  = oops</a>
<a id="6119" class="Comment">--   sn!-abort {ğŸ˜}     ()</a>
<a id="6145" class="Comment">--   sn!-abort {ğŸ™}     ()</a>
<a id="6171" class="Comment">--   sn!-abort {A âˆ§ B} ()</a>
<a id="6197" class="Comment">--   sn!-abort {A âŠƒ B} () _</a>


<a id="6227" class="Comment">-- -- If `M` is SN at type `A`, then `LEFT M` is SN at type `A âˆ¨ B`.</a>
<a id="6296" class="Comment">-- sn-left : âˆ€ {A B M} â†’ SN M A</a>
<a id="6328" class="Comment">--                     â†’ SN (LEFT M) (A âˆ¨ B)</a>
<a id="6373" class="Comment">-- sn-left s@(ğ’Ÿ , Mâ‡“@(Mâ€² , Mâ‡“Mâ€²@(Mâ¤…Mâ€² , VMâ€²)) , s!) = left ğ’Ÿ , halt-left Mâ‡“ , oops</a>


<a id="6458" class="Comment">-- -- If `M` is SN at type `B`, then `RIGHT M` is SN at type `A âˆ¨ B`.</a>
<a id="6528" class="Comment">-- sn-right : âˆ€ {A B M} â†’ SN M B</a>
<a id="6561" class="Comment">--                      â†’ SN (RIGHT M) (A âˆ¨ B)</a>
<a id="6608" class="Comment">-- sn-right s@(ğ’Ÿ , Mâ‡“@(Mâ€² , Mâ‡“Mâ€²@(Mâ¤…Mâ€² , VMâ€²)) , s!) = right ğ’Ÿ , halt-right Mâ‡“ , oops</a>


<a id="6696" class="Comment">-- -- If `M` is SN at type `ğ”¹` and `N` is SN at type `C` and `O` is SN at type `C`, then `IF M N O` is SN at type `C`.</a>
<a id="6815" class="Comment">-- mutual</a>
<a id="6825" class="Comment">--   sn-if : âˆ€ {C M N O} â†’ SN M ğ”¹ â†’ SN N C â†’ SN O C</a>
<a id="6877" class="Comment">--                       â†’ SN (IF M N O) C</a>
<a id="6920" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(Mâ€²       , Mâ¤…Mâ€²    , VMâ€²)       , âˆ™) _              _              with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="7023" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(LAM _    , _        , val-lam)   , âˆ™) _              _              | ()</a>
<a id="7116" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(PAIR _ _ , _        , val-pair)  , âˆ™) _              _              | ()</a>
<a id="7209" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(UNIT     , _        , val-unit)  , âˆ™) _              _              | ()</a>
<a id="7302" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(LEFT _   , _        , val-left)  , âˆ™) _              _              | ()</a>
<a id="7395" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(RIGHT _  , _        , val-right) , âˆ™) _              _              | ()</a>
<a id="7488" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(TRUE     , Mâ¤…TRUE  , val-true)  , âˆ™) (â„° , Nâ‡“ , s!â‚) (â„± , Oâ‡“ , s!â‚‚) | true  = if ğ’Ÿ â„° â„± , halt-if ğ’Ÿ Mâ‡“ Nâ‡“ Oâ‡“ , sn!-if-true Mâ¤…TRUE ğ’Ÿ â„° â„± s!â‚</a>
<a id="7646" class="Comment">--   sn-if (ğ’Ÿ , Mâ‡“@(FALSE    , Mâ¤…FALSE , val-false) , âˆ™) (â„° , Nâ‡“ , s!â‚) (â„± , Oâ‡“ , s!â‚‚) | false = if ğ’Ÿ â„° â„± , halt-if ğ’Ÿ Mâ‡“ Nâ‡“ Oâ‡“ , sn!-if-false Mâ¤…FALSE ğ’Ÿ â„° â„± s!â‚‚</a>

<a id="7807" class="Comment">--   sn!-if-true : âˆ€ {C M N O} â†’ M â¤… TRUE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ âˆ™ âŠ¢ O â¦‚ C â†’ SN! N C</a>
<a id="7895" class="Comment">--                             â†’ SN! (IF M N O) C</a>
<a id="7945" class="Comment">--   sn!-if-true {ğ”¹}     Mâ¤…TRUE ğ’Ÿ â„° â„± âˆ™         = âˆ™</a>
<a id="7997" class="Comment">--   sn!-if-true {A âˆ¨ B} Mâ¤…TRUE ğ’Ÿ â„° â„± x         = oops</a>
<a id="8052" class="Comment">--   sn!-if-true {ğŸ˜}     Mâ¤…TRUE ğ’Ÿ â„° â„± ()</a>
<a id="8093" class="Comment">--   sn!-if-true {ğŸ™}     Mâ¤…TRUE ğ’Ÿ â„° â„± âˆ™         = âˆ™</a>
<a id="8145" class="Comment">--   sn!-if-true {A âˆ§ B} Mâ¤…TRUE ğ’Ÿ â„° â„± (sâ‚ , sâ‚‚) = snprâ¤… (congs-fst (reds-if-true Mâ¤…TRUE done)) (fst (if ğ’Ÿ â„° â„±)) sâ‚ ,</a>
<a id="8262" class="Comment">--                                                 snprâ¤… (congs-snd (reds-if-true Mâ¤…TRUE done)) (snd (if ğ’Ÿ â„° â„±)) sâ‚‚</a>
<a id="8378" class="Comment">--   sn!-if-true {A âŠƒ B} Mâ¤…TRUE ğ’Ÿ â„° â„± f s       = snprâ¤… (congs-appâ‚ (reds-if-true Mâ¤…TRUE done)) (app (if ğ’Ÿ â„° â„±) (derp s)) (f s)</a>

<a id="8507" class="Comment">--   sn!-if-false : âˆ€ {C M N O} â†’ M â¤… FALSE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ âˆ™ âŠ¢ O â¦‚ C â†’ SN! O C</a>
<a id="8597" class="Comment">--                              â†’ SN! (IF M N O) C</a>
<a id="8648" class="Comment">--   sn!-if-false {ğ”¹}     Mâ¤…FALSE ğ’Ÿ â„° â„± âˆ™         = âˆ™</a>
<a id="8702" class="Comment">--   sn!-if-false {A âˆ¨ B} Mâ¤…FALSE ğ’Ÿ â„° â„± x         = oops</a>
<a id="8759" class="Comment">--   sn!-if-false {ğŸ˜}     Mâ¤…FALSE ğ’Ÿ â„° â„± ()</a>
<a id="8802" class="Comment">--   sn!-if-false {ğŸ™}     Mâ¤…FALSE ğ’Ÿ â„° â„± âˆ™         = âˆ™</a>
<a id="8856" class="Comment">--   sn!-if-false {A âˆ§ B} Mâ¤…FALSE ğ’Ÿ â„° â„± (sâ‚ , sâ‚‚) = snprâ¤… (congs-fst (reds-if-false Mâ¤…FALSE done)) (fst (if ğ’Ÿ â„° â„±)) sâ‚ ,</a>
<a id="8977" class="Comment">--                                                   snprâ¤… (congs-snd (reds-if-false Mâ¤…FALSE done)) (snd (if ğ’Ÿ â„° â„±)) sâ‚‚</a>
<a id="9097" class="Comment">--   sn!-if-false {A âŠƒ B} Mâ¤…FALSE ğ’Ÿ â„° â„± f s       = snprâ¤… (congs-appâ‚ (reds-if-false Mâ¤…FALSE done)) (app (if ğ’Ÿ â„° â„±) (derp s)) (f s)</a>


<a id="9231" class="Comment">-- -- XXX</a>
<a id="9241" class="Comment">-- mutual</a>
<a id="9251" class="Comment">--   sn-app-lam : âˆ€ {B g M N A} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="9332" class="Comment">--                              â†’ âˆ™ âŠ¢ SUB Ï„ (LAM M) â¦‚ A âŠƒ B â†’ âˆ™ âŠ¢ N â¦‚ A â†’ SN (SUB (Ï„ , N) M) B</a>
<a id="9427" class="Comment">--                              â†’ SN (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="9498" class="Comment">--   sn-app-lam {M = M} ğ’Ÿ â„° (ğ’Ÿâ€² , SUBâ‡“ , s!) =</a>
<a id="9545" class="Comment">--     let ğ’œ = app ğ’Ÿ â„° in</a>
<a id="9571" class="Comment">--       ğ’œ , halt-app-lam {M = M} SUBâ‡“ , sn!-app-lam {M = M} ğ’œ s!</a>

<a id="9638" class="Comment">--   sn!-app-lam : âˆ€ {B g M N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="9718" class="Comment">--                             â†’ âˆ™ âŠ¢ APP (LAM (SUB (LIFTS Ï„) M)) N â¦‚ B â†’ SN! (SUB (Ï„ , N) M) B</a>
<a id="9813" class="Comment">--                             â†’ SN! (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="9884" class="Comment">--   sn!-app-lam {ğ”¹}       {M = M} ğ’œ âˆ™         = âˆ™</a>
<a id="9935" class="Comment">--   sn!-app-lam {Bâ‚ âˆ¨ Bâ‚‚} {M = M} ğ’œ x         = oops</a>
<a id="9989" class="Comment">--   sn!-app-lam {ğŸ˜}       {M = M} ğ’œ ()</a>
<a id="10029" class="Comment">--   sn!-app-lam {ğŸ™}       {M = M} ğ’œ âˆ™         = âˆ™</a>
<a id="10080" class="Comment">--   sn!-app-lam {Bâ‚ âˆ§ Bâ‚‚} {M = M} ğ’œ (sâ‚ , sâ‚‚) = snprâ†¦ (cong-fst (red-app-lam {M = M})) (fst ğ’œ) sâ‚ ,</a>
<a id="10181" class="Comment">--                                               snprâ†¦ (cong-snd (red-app-lam {M = M})) (snd ğ’œ) sâ‚‚</a>
<a id="10280" class="Comment">--   sn!-app-lam {Bâ‚ âŠƒ Bâ‚‚} {M = M} ğ’œ f s       = snprâ†¦ (cong-appâ‚ (red-app-lam {M = M})) (app ğ’œ (derp s)) (f s)</a>


<a id="10394" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="10480" class="Comment">-- mutual</a>
<a id="10490" class="Comment">--   gen-sn : âˆ€ {g M A} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="10563" class="Comment">--                      â†’ SNs Ï„ Î“ â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="10609" class="Comment">--                      â†’ SN (SUB Ï„ M) A</a>
<a id="10650" class="Comment">--   gen-sn Ïƒ (var i)      = get Ïƒ (zipâˆ‹â‚‚ i)</a>
<a id="10695" class="Comment">--   gen-sn Ïƒ (lam ğ’Ÿ)      = gen-sn-lam Ïƒ ğ’Ÿ</a>
<a id="10739" class="Comment">--   gen-sn Ïƒ (app ğ’Ÿ â„°)    = sn-app (gen-sn Ïƒ ğ’Ÿ) (gen-sn Ïƒ â„°)</a>
<a id="10801" class="Comment">--   gen-sn Ïƒ (pair ğ’Ÿ â„°)   = sn-pair (gen-sn Ïƒ ğ’Ÿ) (gen-sn Ïƒ â„°)</a>
<a id="10864" class="Comment">--   gen-sn Ïƒ (fst ğ’Ÿ)      = sn-fst (gen-sn Ïƒ ğ’Ÿ)</a>
<a id="10913" class="Comment">--   gen-sn Ïƒ (snd ğ’Ÿ)      = sn-snd (gen-sn Ïƒ ğ’Ÿ)</a>
<a id="10962" class="Comment">--   gen-sn Ïƒ unit         = unit , (UNIT , done , val-unit) , âˆ™</a>
<a id="11027" class="Comment">--   gen-sn Ïƒ (abort ğ’Ÿ)    = sn-abort (gen-sn Ïƒ ğ’Ÿ)</a>
<a id="11078" class="Comment">--   gen-sn Ïƒ (left ğ’Ÿ)     = sn-left (gen-sn Ïƒ ğ’Ÿ)</a>
<a id="11128" class="Comment">--   gen-sn Ïƒ (right ğ’Ÿ)    = sn-right (gen-sn Ïƒ ğ’Ÿ)</a>
<a id="11179" class="Comment">--   gen-sn Ïƒ (case ğ’Ÿ â„° â„±) = gen-sn-case Ïƒ ğ’Ÿ â„° â„±</a>
<a id="11228" class="Comment">--   gen-sn Ïƒ true         = true , (TRUE , done , val-true) , âˆ™</a>
<a id="11293" class="Comment">--   gen-sn Ïƒ false        = false , (FALSE , done , val-false) , âˆ™</a>
<a id="11361" class="Comment">--   gen-sn Ïƒ (if ğ’Ÿ â„° â„±)   = sn-if (gen-sn Ïƒ ğ’Ÿ) (gen-sn Ïƒ â„°) (gen-sn Ïƒ â„±)</a>

<a id="11436" class="Comment">--   gen-sn-lam : âˆ€ {g M A B} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="11515" class="Comment">--                            â†’ SNs Ï„ Î“ â†’ Î“ , A âŠ¢ M â¦‚ B</a>
<a id="11571" class="Comment">--                            â†’ SN (LAM (SUB (LIFTS Ï„) M)) (A âŠƒ B)</a>
<a id="11638" class="Comment">--   gen-sn-lam {M = M} {{VÏ„}} Ïƒ ğ’Ÿ =</a>
<a id="11675" class="Comment">--     let ğ’Ÿâ€² = sub (derps Ïƒ) (lam ğ’Ÿ) in</a>
<a id="11716" class="Comment">--       ğ’Ÿâ€² , (LAM _ , done , val-lam) , (\ { s@(â„° , (Nâ€² , Nâ‡“Nâ€²@(Nâ¤…Nâ€² , VNâ€²)) , s!) â†’</a>
<a id="11802" class="Comment">--         let sâ€²@(â„°â€² , _ , _) = snpâ‡“ Nâ‡“Nâ€² â„° s in</a>
<a id="11852" class="Comment">--           snprâ¤… (congs-appâ‚‚ Nâ¤…Nâ€²)</a>
<a id="11889" class="Comment">--                  (app ğ’Ÿâ€² â„°)</a>
<a id="11920" class="Comment">--                  (sn-app-lam {M = M} {{VÏ„}} {{VNâ€²}}</a>
<a id="11975" class="Comment">--                    ğ’Ÿâ€² â„°â€²</a>
<a id="12003" class="Comment">--                    (gen-sn {{VÏ„ , VNâ€²}} (Ïƒ , sâ€²) ğ’Ÿ)) })</a>


<a id="12064" class="Comment">--   gen-sn-case : âˆ€ {g M N O A B C} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="12150" class="Comment">--                                   â†’ SNs Ï„ Î“ â†’ Î“ âŠ¢ M â¦‚ A âˆ¨ B â†’ Î“ , A âŠ¢ N â¦‚ C â†’ Î“ , B âŠ¢ O â¦‚ C</a>
<a id="12245" class="Comment">--                                   â†’ SN (CASE (SUB Ï„ M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O)) C</a>
<a id="12342" class="Comment">--   gen-sn-case {N = N} {O} {{VÏ„}} Ïƒ ğ’Ÿ â„° â„± with gen-sn Ïƒ ğ’Ÿ</a>
<a id="12402" class="Comment">--   gen-sn-case {N = N} {O} {{VÏ„}} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (Mâ€²       , SUBâ¤…Mâ€²    , VMâ€²)       , sâ‚!) with tpâ¤… SUBâ¤…Mâ€² ğ’Ÿâ€²</a>
<a id="12518" class="Comment">--   gen-sn-case {N = N} {O} {{VÏ„}} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (LAM _    , _          , val-lam)   , sâ‚!) | ()</a>
<a id="12621" class="Comment">--   gen-sn-case {N = N} {O} {{VÏ„}} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (PAIR _ _ , _          , val-pair)  , sâ‚!) | ()</a>
<a id="12724" class="Comment">--   gen-sn-case {N = N} {O} {{VÏ„}} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (UNIT     , _          , val-unit)  , sâ‚!) | ()</a>
<a id="12827" class="Comment">--   gen-sn-case {N = N} {O} {{VÏ„}} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (LEFT Mâ€³  , SUBâ¤…LEFT  , val-left {{VMâ€³}})  , sâ‚!) | left _</a>
<a id="12941" class="Comment">--     = let step2 = gen-sn {M = N} {{VÏ„ , VMâ€³}} (Ïƒ , {!sâ‚!}) â„° in {!!}</a>




<a id="13017" class="Comment">-- --    = -- let x = snpâ¤… SUBâ¤…LEFT {!!} {!!} in</a>
<a id="13066" class="Comment">-- --      let (â„°â€² , Nâ‡“@(Nâ€² , Nâ¤…Nâ€² , VNâ€²) , sâ‚‚) = gen-sn (Ïƒ , {!sâ‚!}) â„° in</a>
<a id="13141" class="Comment">-- --</a>
<a id="13147" class="Comment">-- --      snprâ¤… (congs-case SUBâ¤…LEFT)</a>
<a id="13186" class="Comment">-- --             (case ğ’Ÿâ€² (sub (lifts (derps Ïƒ)) â„°) (sub (lifts (derps Ïƒ)) â„±))</a>
<a id="13266" class="Comment">-- --             (case (left ğ’Ÿâ€³) (sub (lifts (derps Ïƒ)) â„°) (sub (lifts (derps Ïƒ)) â„±) ,</a>
<a id="13354" class="Comment">-- --               halt-case-left {N = N} {O} Nâ‡“ , {!!})</a>
<a id="13412" class="Comment">-- --</a>
<a id="13418" class="Comment">-- --    -- = let (â„°â€² , Nâ‡“@(Nâ€² , Nâ¤…Nâ€² , VNâ€²) , sâ‚‚) = gen-sn (Ïƒ , unsn-left (snpâ¤… SUBâ¤…LEFT ğ’Ÿâ€² sâ‚)) â„° in</a>
<a id="13521" class="Comment">-- --    --     sub (derps Ïƒ) (case ğ’Ÿ â„° â„±) , (Nâ€² , {!!} , {!!}) , {!!}</a>
<a id="13592" class="Comment">--   gen-sn-case {N = N} {O} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (RIGHT _  , SUBâ¤…RIGHT , val-right) , s!) | right ğ’Ÿâ€³</a>
<a id="13692" class="Comment">--     = {!!}</a>



<a id="13709" class="Comment">-- --    = sub (derps Ïƒ) (case ğ’Ÿ â„° â„±) , ({!!} , {!!} , {!!}) , {!!}</a>
<a id="13777" class="Comment">--   gen-sn-case {N = N} {O} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (TRUE     , _          , val-true)  , s!) | ()</a>
<a id="13872" class="Comment">--   gen-sn-case {N = N} {O} Ïƒ ğ’Ÿ â„° â„± | sâ‚@(ğ’Ÿâ€² , (FALSE    , _          , val-false) , s!) | ()</a>

<a id="13968" class="Comment">-- --    let (ğ’Ÿâ€² , â‡“M@(Mâ€² , Mâ¤…Mâ€² , VMâ€²) , s!) = gen-sn Ïƒ ğ’Ÿ in</a>
<a id="14030" class="Comment">-- --      sub (derps Ïƒ) (case ğ’Ÿ â„° â„±) , {!!} , {!!}</a>


<a id="14084" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="14170" class="Comment">-- -- Every well-typed term is SN.</a>
<a id="14205" class="Comment">-- sn : âˆ€ {A M} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="14233" class="Comment">--              â†’ SN M A</a>
<a id="14258" class="Comment">-- sn {A} {M} ğ’Ÿ = subst (\ Mâ€² â†’ SN Mâ€² A) (id-SUB M) (gen-sn âˆ™ ğ’Ÿ)</a>


<a id="14325" class="Comment">-- -- Every SN term terminates.</a>
<a id="14357" class="Comment">-- herp : âˆ€ {A M} â†’ SN M A</a>
<a id="14384" class="Comment">--                â†’ M â‡“</a>
<a id="14408" class="Comment">-- herp (ğ’Ÿ , Mâ‡“ , s!) = Mâ‡“</a>


<a id="14437" class="Comment">-- -- Every well-typed term terminates.</a>
<a id="14477" class="Comment">-- halt : âˆ€ {A M} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="14507" class="Comment">--                â†’ M â‡“</a>
<a id="14531" class="Comment">-- halt {A} ğ’Ÿ = herp {A} (sn ğ’Ÿ)</a>


<a id="14565" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>