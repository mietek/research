<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201903.0-1-3-Prelude-ForeignHandleBuffering</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Pragma">--sized-types</a> <a id="41" class="Symbol">#-}</a>

<a id="46" class="Comment">---------------------------------------------------------------------------------------------------------------</a>
<a id="158" class="Comment">--</a>
<a id="161" class="Comment">-- Foreign-function interface to buffering modes for I/O handles</a>

<a id="227" class="Keyword">module</a> <a id="234" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html" class="Module">A201903.0-1-3-Prelude-ForeignHandleBuffering</a> <a id="279" class="Keyword">where</a>

<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="A201903.0-1-Prelude.html" class="Module">A201903.0-1-Prelude</a>
<a id="318" class="Keyword">import</a> <a id="325" href="IO.Primitive.Core.html" class="Module">IO.Primitive.Core</a> <a id="343" class="Symbol">as</a> <a id="346" class="Module">Prim</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="IO.html" class="Module">IO</a> <a id="366" class="Keyword">using</a> <a id="372" class="Symbol">(</a><a id="373" href="IO.Base.html#1201" class="Datatype">IO</a><a id="375" class="Symbol">)</a> <a id="377" class="Keyword">renaming</a> <a id="386" class="Symbol">(</a><a id="387" href="IO.Base.html#1294" class="InductiveConstructor">bind</a> <a id="392" class="Symbol">to</a> <a id="395" class="InductiveConstructor">_&gt;&gt;=_</a><a id="400" class="Symbol">)</a>


<a id="404" class="Comment">---------------------------------------------------------------------------------------------------------------</a>

<a id="517" class="Symbol">{-#</a> <a id="521" class="Keyword">FOREIGN</a> <a id="529" class="Pragma">GHC</a> <a id="533" class="Pragma">import</a> <a id="540" class="Pragma">qualified</a> <a id="550" class="Pragma">System.IO</a> <a id="560" class="Symbol">#-}</a>

<a id="565" class="Keyword">postulate</a> <a id="Int"></a><a id="575" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#575" class="Postulate">Int</a> <a id="579" class="Symbol">:</a> <a id="581" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="585" class="Symbol">{-#</a> <a id="589" class="Keyword">COMPILE</a> <a id="597" class="Keyword">GHC</a> <a id="601" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#575" class="Postulate">Int</a> <a id="605" class="Pragma">=</a> <a id="607" class="Pragma">type</a> <a id="612" class="Pragma">Int</a> <a id="616" class="Symbol">#-}</a>

<a id="621" class="Keyword">postulate</a> <a id="Handle"></a><a id="631" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#631" class="Postulate">Handle</a> <a id="638" class="Symbol">:</a> <a id="640" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="644" class="Symbol">{-#</a> <a id="648" class="Keyword">COMPILE</a> <a id="656" class="Keyword">GHC</a> <a id="660" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#631" class="Postulate">Handle</a> <a id="667" class="Pragma">=</a> <a id="669" class="Pragma">type</a> <a id="674" class="Pragma">System.IO.Handle</a> <a id="691" class="Symbol">#-}</a>

<a id="696" class="Keyword">data</a> <a id="BufferMode"></a><a id="701" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#701" class="Datatype">BufferMode</a> <a id="712" class="Symbol">:</a> <a id="714" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="718" class="Keyword">where</a>
  <a id="BufferMode.NoBuffering"></a><a id="726" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#726" class="InductiveConstructor">NoBuffering</a>    <a id="741" class="Symbol">:</a> <a id="743" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#701" class="Datatype">BufferMode</a>
  <a id="BufferMode.LineBuffering"></a><a id="756" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#756" class="InductiveConstructor">LineBuffering</a>  <a id="771" class="Symbol">:</a> <a id="773" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#701" class="Datatype">BufferMode</a>
  <a id="BufferMode.BlockBuffering"></a><a id="786" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#786" class="InductiveConstructor">BlockBuffering</a> <a id="801" class="Symbol">:</a> <a id="803" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="809" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#575" class="Postulate">Int</a> <a id="813" class="Symbol">→</a> <a id="815" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#701" class="Datatype">BufferMode</a>
<a id="826" class="Symbol">{-#</a> <a id="830" class="Keyword">COMPILE</a> <a id="838" class="Keyword">GHC</a> <a id="842" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#701" class="Datatype">BufferMode</a> <a id="853" class="Pragma">=</a> <a id="855" class="Pragma">data</a> <a id="860" class="Pragma">System.IO.BufferMode</a>
    <a id="885" class="Pragma">(System.IO.NoBuffering</a> <a id="908" class="Pragma">|</a> <a id="910" class="Pragma">System.IO.LineBuffering</a> <a id="934" class="Pragma">|</a> <a id="936" class="Pragma">System.IO.BlockBuffering)</a>  <a id="963" class="Symbol">#-}</a>

<a id="968" class="Keyword">postulate</a> <a id="hSetBuffering"></a><a id="978" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#978" class="Postulate">hSetBuffering</a> <a id="992" class="Symbol">:</a> <a id="994" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#631" class="Postulate">Handle</a> <a id="1001" class="Symbol">→</a> <a id="1003" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#701" class="Datatype">BufferMode</a> <a id="1014" class="Symbol">→</a> <a id="1016" href="Agda.Builtin.IO.html#137" class="Postulate">Prim.IO</a> <a id="1024" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1026" class="Symbol">{-#</a> <a id="1030" class="Keyword">COMPILE</a> <a id="1038" class="Keyword">GHC</a> <a id="1042" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#978" class="Postulate">hSetBuffering</a> <a id="1056" class="Pragma">=</a> <a id="1058" class="Pragma">System.IO.hSetBuffering</a> <a id="1082" class="Symbol">#-}</a>

<a id="1087" class="Keyword">postulate</a> <a id="stdout"></a><a id="1097" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1097" class="Postulate">stdout</a> <a id="1104" class="Symbol">:</a> <a id="1106" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#631" class="Postulate">Handle</a>
<a id="1113" class="Symbol">{-#</a> <a id="1117" class="Keyword">COMPILE</a> <a id="1125" class="Keyword">GHC</a> <a id="1129" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1097" class="Postulate">stdout</a> <a id="1136" class="Pragma">=</a> <a id="1138" class="Pragma">System.IO.stdout</a> <a id="1155" class="Symbol">#-}</a>

<a id="1160" class="Keyword">postulate</a> <a id="stderr"></a><a id="1170" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1170" class="Postulate">stderr</a> <a id="1177" class="Symbol">:</a> <a id="1179" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#631" class="Postulate">Handle</a>
<a id="1186" class="Symbol">{-#</a> <a id="1190" class="Keyword">COMPILE</a> <a id="1198" class="Keyword">GHC</a> <a id="1202" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1170" class="Postulate">stderr</a> <a id="1209" class="Pragma">=</a> <a id="1211" class="Pragma">System.IO.stderr</a> <a id="1228" class="Symbol">#-}</a>

<a id="1233" class="Keyword">postulate</a> <a id="hFlush"></a><a id="1243" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1243" class="Postulate">hFlush</a> <a id="1250" class="Symbol">:</a> <a id="1252" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#631" class="Postulate">Handle</a> <a id="1259" class="Symbol">→</a> <a id="1261" href="Agda.Builtin.IO.html#137" class="Postulate">Prim.IO</a> <a id="1269" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1271" class="Symbol">{-#</a> <a id="1275" class="Keyword">COMPILE</a> <a id="1283" class="Keyword">GHC</a> <a id="1287" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1243" class="Postulate">hFlush</a> <a id="1294" class="Pragma">=</a> <a id="1296" class="Pragma">System.IO.hFlush</a> <a id="1313" class="Symbol">#-}</a>


<a id="1319" class="Comment">---------------------------------------------------------------------------------------------------------------</a>

<a id="disableBuffering"></a><a id="1432" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1432" class="Function">disableBuffering</a> <a id="1449" class="Symbol">:</a> <a id="1451" href="IO.Base.html#1201" class="Datatype">IO</a> <a id="1454" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1456" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1432" class="Function">disableBuffering</a> <a id="1473" class="Symbol">=</a> <a id="1475" class="Keyword">do</a> <a id="1478" class="Symbol">_</a> <a id="1480" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#395" class="InductiveConstructor Operator">←</a> <a id="1482" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="1484" href="IO.Base.html#1238" class="InductiveConstructor">IO.lift</a> <a id="1492" class="Symbol">(</a><a id="1493" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#978" class="Postulate">hSetBuffering</a> <a id="1507" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1097" class="Postulate">stdout</a> <a id="1514" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#726" class="InductiveConstructor">NoBuffering</a><a id="1525" class="Symbol">)</a>
                      <a id="1549" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="1551" class="Keyword">do</a> <a id="1554" class="Symbol">_</a> <a id="1556" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#395" class="InductiveConstructor Operator">←</a> <a id="1558" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="1560" href="IO.Base.html#1238" class="InductiveConstructor">IO.lift</a> <a id="1568" class="Symbol">(</a><a id="1569" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#978" class="Postulate">hSetBuffering</a> <a id="1583" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1170" class="Postulate">stderr</a> <a id="1590" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#726" class="InductiveConstructor">NoBuffering</a><a id="1601" class="Symbol">)</a>
                           <a id="1630" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="1632" class="Keyword">do</a> <a id="1635" class="Symbol">_</a> <a id="1637" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#395" class="InductiveConstructor Operator">←</a> <a id="1639" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="1641" href="IO.Base.html#1238" class="InductiveConstructor">IO.lift</a> <a id="1649" class="Symbol">(</a><a id="1650" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1243" class="Postulate">hFlush</a> <a id="1657" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1097" class="Postulate">stdout</a><a id="1663" class="Symbol">)</a>
                                <a id="1697" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="1699" href="IO.Base.html#1238" class="InductiveConstructor">IO.lift</a> <a id="1707" class="Symbol">(</a><a id="1708" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1243" class="Postulate">hFlush</a> <a id="1715" href="A201903.0-1-3-Prelude-ForeignHandleBuffering.html#1170" class="Postulate">stderr</a><a id="1721" class="Symbol">)</a>


<a id="1725" class="Comment">---------------------------------------------------------------------------------------------------------------</a>
</pre></body></html>