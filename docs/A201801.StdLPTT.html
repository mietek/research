<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201801.StdLPTT</title><link rel="stylesheet" href="AgdaPP.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201801.StdLPTT.html" class="Module">A201801.StdLPTT</a> <a id="53" class="Keyword">where</a>

<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="225" class="Comment">-- open import A201801.StdS4TTTerms</a>
<a id="261" class="Comment">-- open import A201801.StdS4TTTermsLemmas</a>


<a id="305" class="Comment">--------------------------------------------------------------------------------</a>


<a id="388" class="Comment">-- TODO: unfinished</a>
<a id="408" class="Comment">-- infixr 8 _âŠƒ_</a>
<a id="424" class="Comment">-- data Form : Nat â†’ Set</a>
<a id="449" class="Comment">--   where</a>
<a id="460" class="Comment">--     BASE : âˆ€ {d} â†’ Form d</a>
<a id="489" class="Comment">--     _âŠƒ_  : âˆ€ {d} â†’ Form d â†’ Form d â†’ Form d</a>
<a id="536" class="Comment">--     [_]_ : âˆ€ {d} â†’ Termâ‚ d â†’ Form d â†’ Form d</a>


<a id="586" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="672" class="Comment">-- MRENâ‚š : âˆ€ {d dâ€²} â†’ dâ€² â‰¥ d â†’ Form d</a>
<a id="710" class="Comment">--                  â†’ Form dâ€²</a>
<a id="740" class="Comment">-- MRENâ‚š e BASE      = BASE</a>
<a id="768" class="Comment">-- MRENâ‚š e (A âŠƒ B)   = MRENâ‚š e A âŠƒ MRENâ‚š e B</a>
<a id="813" class="Comment">-- MRENâ‚š e ([ M ] A) = [ MREN e M ] MRENâ‚š e A</a>


<a id="861" class="Comment">-- MWKâ‚š : âˆ€ {d} â†’ Form d</a>
<a id="886" class="Comment">--              â†’ Form (suc d)</a>
<a id="917" class="Comment">-- MWKâ‚š A = MRENâ‚š (drop idâ‰¥) A</a>


<a id="950" class="Comment">-- MSUBâ‚š : âˆ€ {d n} â†’ Termsâ‚ d n â†’ Form n</a>
<a id="991" class="Comment">--                 â†’ Form d</a>
<a id="1019" class="Comment">-- MSUBâ‚š x BASE      = BASE</a>
<a id="1047" class="Comment">-- MSUBâ‚š x (A âŠƒ B)   = MSUBâ‚š x A âŠƒ MSUBâ‚š x B</a>
<a id="1092" class="Comment">-- MSUBâ‚š x ([ M ] A) = [ MSUB x M ] MSUBâ‚š x A</a>


<a id="1140" class="Comment">-- MCUTâ‚š : âˆ€ {d} â†’ Termâ‚ d â†’ Form (suc d)</a>
<a id="1182" class="Comment">--               â†’ Form d</a>
<a id="1208" class="Comment">-- MCUTâ‚š M A = MSUBâ‚š (MIDSâ‚ , M) A</a>


<a id="1245" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1331" class="Comment">-- id-MRENâ‚š : âˆ€ {d} â†’ (A : Form d)</a>
<a id="1366" class="Comment">--                  â†’ MRENâ‚š idâ‰¥ A â‰¡ A</a>
<a id="1404" class="Comment">-- id-MRENâ‚š BASE      = refl</a>
<a id="1433" class="Comment">-- id-MRENâ‚š (A âŠƒ B)   = _âŠƒ_ &amp; id-MRENâ‚š A âŠ— id-MRENâ‚š B</a>
<a id="1487" class="Comment">-- id-MRENâ‚š ([ M ] A) = [_]_ &amp; id-MREN M âŠ— id-MRENâ‚š A</a>


<a id="1543" class="Comment">-- comp-MRENâ‚š : âˆ€ {d dâ€² dâ€³} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (A : Form d)</a>
<a id="1615" class="Comment">--                          â†’ MRENâ‚š (eâ‚ âˆ˜â‰¥ eâ‚‚) A â‰¡ MRENâ‚š eâ‚‚ (MRENâ‚š eâ‚ A)</a>
<a id="1688" class="Comment">-- comp-MRENâ‚š eâ‚ eâ‚‚ BASE      = refl</a>
<a id="1725" class="Comment">-- comp-MRENâ‚š eâ‚ eâ‚‚ (A âŠƒ B)   = _âŠƒ_ &amp; comp-MRENâ‚š eâ‚ eâ‚‚ A âŠ— comp-MRENâ‚š eâ‚ eâ‚‚ B</a>
<a id="1803" class="Comment">-- comp-MRENâ‚š eâ‚ eâ‚‚ ([ M ] A) = [_]_ &amp; comp-MREN eâ‚ eâ‚‚ M âŠ— comp-MRENâ‚š eâ‚ eâ‚‚ A</a>


<a id="1883" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1969" class="Comment">-- infix 7 _true</a>
<a id="1986" class="Comment">-- record Truth (d : Nat) : Set</a>
<a id="2018" class="Comment">--   where</a>
<a id="2029" class="Comment">--     constructor _true</a>
<a id="2054" class="Comment">--     field</a>
<a id="2067" class="Comment">--       A : Form d</a>


<a id="2089" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2175" class="Comment">-- MRENâ‚œ : âˆ€ {d dâ€²} â†’ dâ€² â‰¥ d â†’ Truth d</a>
<a id="2214" class="Comment">--                  â†’ Truth dâ€²</a>
<a id="2245" class="Comment">-- MRENâ‚œ e (A true) = MRENâ‚š e A true</a>


<a id="2284" class="Comment">-- MWKâ‚œ : âˆ€ {d} â†’ Truth d</a>
<a id="2310" class="Comment">--              â†’ Truth (suc d)</a>
<a id="2342" class="Comment">-- MWKâ‚œ (A true) = MWKâ‚š A true</a>


<a id="2375" class="Comment">-- MSUBâ‚œ : âˆ€ {d n} â†’ Termsâ‚ d n â†’ Truth n</a>
<a id="2417" class="Comment">--                 â†’ Truth d</a>
<a id="2446" class="Comment">-- MSUBâ‚œ x (A true) = MSUBâ‚š x A true</a>


<a id="2485" class="Comment">-- MCUTâ‚œ : âˆ€ {d} â†’ Termâ‚ d â†’ Truth (suc d)</a>
<a id="2528" class="Comment">--               â†’ Truth d</a>
<a id="2555" class="Comment">-- MCUTâ‚œ M (A true) = MCUTâ‚š M A true</a>


<a id="2594" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2680" class="Comment">-- id-MRENâ‚œ : âˆ€ {d} â†’ (Aâ‚œ : Truth d)</a>
<a id="2717" class="Comment">--                  â†’ MRENâ‚œ idâ‰¥ Aâ‚œ â‰¡ Aâ‚œ</a>
<a id="2757" class="Comment">-- id-MRENâ‚œ (A true) = _true &amp; id-MRENâ‚š A</a>


<a id="2801" class="Comment">-- comp-MRENâ‚œ : âˆ€ {d dâ€² dâ€³} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (Aâ‚œ : Truth d)</a>
<a id="2875" class="Comment">--                          â†’ MRENâ‚œ (eâ‚ âˆ˜â‰¥ eâ‚‚) Aâ‚œ â‰¡ MRENâ‚œ eâ‚‚ (MRENâ‚œ eâ‚ Aâ‚œ)</a>
<a id="2950" class="Comment">-- comp-MRENâ‚œ eâ‚ eâ‚‚ (A true) = _true &amp; comp-MRENâ‚š eâ‚ eâ‚‚ A</a>


<a id="3010" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3096" class="Comment">-- Truths : Nat â†’ Nat â†’ Set</a>
<a id="3124" class="Comment">-- Truths d g = Vec (Truth d) g</a>


<a id="3158" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3244" class="Comment">-- MRENSâ‚œ : âˆ€ {d dâ€² g} â†’ dâ€² â‰¥ d â†’ Truths d g</a>
<a id="3289" class="Comment">--                     â†’ Truths dâ€² g</a>
<a id="3326" class="Comment">-- MRENSâ‚œ e Î“ = MAPS (MRENâ‚œ e) Î“</a>


<a id="3361" class="Comment">-- MWKSâ‚œ : âˆ€ {d g} â†’ Truths d g</a>
<a id="3393" class="Comment">--                 â†’ Truths (suc d) g</a>
<a id="3431" class="Comment">-- MWKSâ‚œ Î“ = MAPS MWKâ‚œ Î“</a>


<a id="3458" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3544" class="Comment">-- id-MRENSâ‚œ : âˆ€ {d g} â†’ (Î“ : Truths d g)</a>
<a id="3586" class="Comment">--                     â†’ MRENSâ‚œ idâ‰¥ Î“ â‰¡ Î“</a>
<a id="3628" class="Comment">-- id-MRENSâ‚œ âˆ™        = refl</a>
<a id="3657" class="Comment">-- id-MRENSâ‚œ (Î“ , Aâ‚œ) = _,_ &amp; id-MRENSâ‚œ Î“ âŠ— id-MRENâ‚œ Aâ‚œ</a>


<a id="3715" class="Comment">-- comp-MRENSâ‚œ : âˆ€ {d dâ€² dâ€³ g} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (Î“ : Truths d g)</a>
<a id="3794" class="Comment">--                             â†’ MRENSâ‚œ (eâ‚ âˆ˜â‰¥ eâ‚‚) Î“ â‰¡ MRENSâ‚œ eâ‚‚ (MRENSâ‚œ eâ‚ Î“)</a>
<a id="3873" class="Comment">-- comp-MRENSâ‚œ eâ‚ eâ‚‚ âˆ™        = refl</a>
<a id="3910" class="Comment">-- comp-MRENSâ‚œ eâ‚ eâ‚‚ (Î“ , Aâ‚œ) = _,_ &amp; comp-MRENSâ‚œ eâ‚ eâ‚‚ Î“ âŠ— comp-MRENâ‚œ eâ‚ eâ‚‚ Aâ‚œ</a>


<a id="3992" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ : âˆ€ {d dâ€² g gâ€² eâ‚‚} â†’ {Î“ : Truths d g} {Î“â€² : Truths d gâ€²}</a>
<a id="4066" class="Comment">--                                  â†’ (eâ‚ : dâ€² â‰¥ d) â†’ Î“â€² âŠ‡âŸ¨ eâ‚‚ âŸ© Î“</a>
<a id="4133" class="Comment">--                                  â†’ MRENSâ‚œ eâ‚ Î“â€² âŠ‡âŸ¨ eâ‚‚ âŸ© MRENSâ‚œ eâ‚ Î“</a>
<a id="4204" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ eâ‚ done     = done</a>
<a id="4240" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ eâ‚ (drop Î·) = resp-MRENSâ‚œ-âŠ‡ eâ‚ Î· âˆ˜âŠ‡ drop idâŠ‡</a>
<a id="4302" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ eâ‚ (keep Î·) = keep (resp-MRENSâ‚œ-âŠ‡ eâ‚ Î·)</a>


<a id="4361" class="Comment">-- resp-MWKSâ‚œ-âŠ‡ : âˆ€ {d g gâ€² e} â†’ {Î“ : Truths d g} {Î“â€² : Truths d gâ€²}</a>
<a id="4430" class="Comment">--                             â†’ Î“â€² âŠ‡âŸ¨ e âŸ© Î“</a>
<a id="4475" class="Comment">--                             â†’ MWKSâ‚œ Î“â€² âŠ‡âŸ¨ e âŸ© MWKSâ‚œ Î“</a>
<a id="4532" class="Comment">-- resp-MWKSâ‚œ-âŠ‡ Î· = resp-MRENSâ‚œ-âŠ‡ (drop idâ‰¥) Î·</a>


<a id="4581" class="Comment">-- resp-MRENSâ‚œ-âˆ‹ : âˆ€ {d dâ€² g i} â†’ {Î“ : Truths d g} {A : Form d}</a>
<a id="4645" class="Comment">--                              â†’ (e : dâ€² â‰¥ d) â†’ Î“ âˆ‹âŸ¨ i âŸ© A true</a>
<a id="4710" class="Comment">--                              â†’ MRENSâ‚œ e Î“ âˆ‹âŸ¨ i âŸ© MRENâ‚š e A true</a>
<a id="4777" class="Comment">-- resp-MRENSâ‚œ-âˆ‹ e zero    = zero</a>
<a id="4811" class="Comment">-- resp-MRENSâ‚œ-âˆ‹ e (suc ğ’¾) = suc (resp-MRENSâ‚œ-âˆ‹ e ğ’¾)</a>


<a id="4866" class="Comment">-- resp-MWKSâ‚œ-âˆ‹ : âˆ€ {d g i} â†’ {Î“ : Truths d g} {A : Form d}</a>
<a id="4926" class="Comment">--                          â†’ Î“ âˆ‹âŸ¨ i âŸ© A true</a>
<a id="4972" class="Comment">--                          â†’ MWKSâ‚œ Î“ âˆ‹âŸ¨ i âŸ© MWKâ‚š A true</a>
<a id="5029" class="Comment">-- resp-MWKSâ‚œ-âˆ‹ ğ’¾ = resp-MRENSâ‚œ-âˆ‹ (drop idâ‰¥) ğ’¾</a>


<a id="5078" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5164" class="Comment">-- infix 7 _valid</a>
<a id="5182" class="Comment">-- record Validity (d : Nat) : Set</a>
<a id="5217" class="Comment">--   where</a>
<a id="5228" class="Comment">--     constructor _valid</a>
<a id="5254" class="Comment">--     field</a>
<a id="5267" class="Comment">--       A : Form d</a>


<a id="5289" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5375" class="Comment">-- MRENáµ¥ : âˆ€ {d dâ€²} â†’ dâ€² â‰¥ d â†’ Validity d</a>
<a id="5417" class="Comment">--                  â†’ Validity dâ€²</a>
<a id="5451" class="Comment">-- MRENáµ¥ e (A valid) = MRENâ‚š e A valid</a>


<a id="5492" class="Comment">-- MWKáµ¥ : âˆ€ {d} â†’ Validity d</a>
<a id="5521" class="Comment">--              â†’ Validity (suc d)</a>
<a id="5556" class="Comment">-- MWKáµ¥ (A valid) = MWKâ‚š A valid</a>


<a id="5591" class="Comment">-- MSUBáµ¥ : âˆ€ {d n} â†’ Termsâ‚ d n â†’ Validity n</a>
<a id="5636" class="Comment">--                 â†’ Validity d</a>
<a id="5668" class="Comment">-- MSUBáµ¥ x (A valid) = MSUBâ‚š x A valid</a>


<a id="5709" class="Comment">-- MCUTáµ¥ : âˆ€ {d} â†’ Termâ‚ d â†’ Validity (suc d)</a>
<a id="5755" class="Comment">--               â†’ Validity d</a>
<a id="5785" class="Comment">-- MCUTáµ¥ M (A valid) = MCUTâ‚š M A valid</a>


<a id="5826" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5912" class="Comment">-- id-MRENáµ¥ : âˆ€ {d} â†’ (Aáµ¥ : Validity d)</a>
<a id="5952" class="Comment">--                  â†’ MRENáµ¥ idâ‰¥ Aáµ¥ â‰¡ Aáµ¥</a>
<a id="5992" class="Comment">-- id-MRENáµ¥ (A valid) = _valid &amp; id-MRENâ‚š A</a>


<a id="6038" class="Comment">-- comp-MRENáµ¥ : âˆ€ {d dâ€² dâ€³} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (Aáµ¥ : Validity d)</a>
<a id="6115" class="Comment">--                          â†’ MRENáµ¥ (eâ‚ âˆ˜â‰¥ eâ‚‚) Aáµ¥ â‰¡ MRENáµ¥ eâ‚‚ (MRENáµ¥ eâ‚ Aáµ¥)</a>
<a id="6190" class="Comment">-- comp-MRENáµ¥ eâ‚ eâ‚‚ (A valid) = _valid &amp; comp-MRENâ‚š eâ‚ eâ‚‚ A</a>


<a id="6252" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6338" class="Comment">-- data Validities : Nat â†’ Set</a>
<a id="6369" class="Comment">--   where</a>
<a id="6380" class="Comment">--     âˆ™ : Validities zero</a>

<a id="6408" class="Comment">--     _,_ : âˆ€ {d} â†’ Validities d â†’ Validity d</a>
<a id="6455" class="Comment">--                 â†’ Validities (suc d)</a>


<a id="6497" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6583" class="Comment">-- infix 4 _âŠ‡âŸª_âŸ«_</a>
<a id="6601" class="Comment">-- data _âŠ‡âŸª_âŸ«_ : âˆ€ {d dâ€²} â†’ Validities dâ€² â†’ dâ€² â‰¥ d â†’ Validities d â†’ Set</a>
<a id="6673" class="Comment">--   where</a>
<a id="6684" class="Comment">--     done : âˆ™ âŠ‡âŸª done âŸ« âˆ™</a>

<a id="6713" class="Comment">--     drop : âˆ€ {d dâ€² e} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Aáµ¥ : Validity dâ€²}</a>
<a id="6799" class="Comment">--                       â†’ Î”â€² âŠ‡âŸª e âŸ« Î”</a>
<a id="6838" class="Comment">--                       â†’ Î”â€² , Aáµ¥ âŠ‡âŸª drop e âŸ« Î”</a>

<a id="6888" class="Comment">--     keep : âˆ€ {d dâ€² e} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Aáµ¥ : Validity d}</a>
<a id="6973" class="Comment">--                          {Aáµ¥Â° : Validity dâ€²} {{_ : MRENáµ¥ e Aáµ¥ â‰¡ Aáµ¥Â°}}</a>
<a id="7046" class="Comment">--                       â†’ Î”â€² âŠ‡âŸª e âŸ« Î”</a>
<a id="7085" class="Comment">--                       â†’ Î”â€² , Aáµ¥Â° âŠ‡âŸª keep e âŸ« Î” , Aáµ¥</a>


<a id="7142" class="Comment">-- idâŠ‡â—ˆ : âˆ€ {d} â†’ {Î” : Validities d}</a>
<a id="7179" class="Comment">--              â†’ Î” âŠ‡âŸª idâ‰¥ âŸ« Î”</a>
<a id="7210" class="Comment">-- idâŠ‡â—ˆ {Î” = âˆ™}      = done</a>
<a id="7238" class="Comment">-- idâŠ‡â—ˆ {Î” = Î” , Aáµ¥} = keep {{id-MRENáµ¥ Aáµ¥}} idâŠ‡â—ˆ</a>


<a id="7289" class="Comment">-- _âˆ˜âŠ‡â—ˆ_ : âˆ€ {d dâ€² dâ€³ eâ‚ eâ‚‚} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Î”â€³ : Validities dâ€³}</a>
<a id="7381" class="Comment">--                           â†’ Î”â€² âŠ‡âŸª eâ‚ âŸ« Î” â†’ Î”â€³ âŠ‡âŸª eâ‚‚ âŸ« Î”â€²</a>
<a id="7441" class="Comment">--                           â†’ Î”â€³ âŠ‡âŸª eâ‚ âˆ˜â‰¥ eâ‚‚ âŸ« Î”</a>
<a id="7491" class="Comment">-- Î·â‚      âˆ˜âŠ‡â—ˆ done    = Î·â‚</a>
<a id="7519" class="Comment">-- Î·â‚      âˆ˜âŠ‡â—ˆ drop Î·â‚‚ = drop (Î·â‚ âˆ˜âŠ‡â—ˆ Î·â‚‚)</a>
<a id="7561" class="Comment">-- drop Î·â‚ âˆ˜âŠ‡â—ˆ keep Î·â‚‚ = drop (Î·â‚ âˆ˜âŠ‡â—ˆ Î·â‚‚)</a>
<a id="7603" class="Comment">-- keep {e = eâ‚} {Aáµ¥ = Aáµ¥} {{refl}} Î·â‚ âˆ˜âŠ‡â—ˆ keep {e = eâ‚‚} {{refl}} Î·â‚‚</a>
<a id="7672" class="Comment">--   = keep {{comp-MRENáµ¥ eâ‚ eâ‚‚ Aáµ¥}} (Î·â‚ âˆ˜âŠ‡â—ˆ Î·â‚‚)</a>


<a id="7722" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="7808" class="Comment">-- infix 4 _âˆ‹âŸª_âŸ«_</a>
<a id="7826" class="Comment">-- data _âˆ‹âŸª_âŸ«_ : âˆ€ {d} â†’ Validities d â†’ Fin d â†’ Validity d â†’ Set</a>
<a id="7891" class="Comment">--   where</a>
<a id="7902" class="Comment">--     zero : âˆ€ {d} â†’ {Î” : Validities d} {Aáµ¥ : Validity d}</a>
<a id="7961" class="Comment">--                     {Aáµ¥Â° : Validity (suc d)} {{_ : MWKáµ¥ Aáµ¥ â‰¡ Aáµ¥Â°}}</a>
<a id="8031" class="Comment">--                  â†’ Î” , Aáµ¥ âˆ‹âŸª zero âŸ« Aáµ¥Â°</a>

<a id="8075" class="Comment">--     suc : âˆ€ {d i} â†’ {Î” : Validities d} {Aáµ¥ : Validity d} {Báµ¥ : Validity d}</a>
<a id="8153" class="Comment">--                      {Aáµ¥Â° : Validity (suc d)} {{_ : MWKáµ¥ Aáµ¥ â‰¡ Aáµ¥Â°}}</a>
<a id="8224" class="Comment">--                   â†’ Î” âˆ‹âŸª i âŸ« Aáµ¥</a>
<a id="8259" class="Comment">--                   â†’ Î” , Báµ¥ âˆ‹âŸª suc i âŸ« Aáµ¥Â°</a>


<a id="8306" class="Comment">-- renâˆ‹â—ˆ : âˆ€ {d dâ€² e i} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Aáµ¥ : Validity d}</a>
<a id="8390" class="Comment">--                      â†’ Î”â€² âŠ‡âŸª e âŸ« Î” â†’ Î” âˆ‹âŸª i âŸ« Aáµ¥</a>
<a id="8442" class="Comment">--                      â†’ Î”â€² âˆ‹âŸª RENâˆ‹ e i âŸ« MRENáµ¥ e Aáµ¥</a>
<a id="8496" class="Comment">-- renâˆ‹â—ˆ {i = i} {Aáµ¥ = Aáµ¥} done ğ’¾             = coerce ğ’¾ ((\ Aáµ¥â€² â†’ âˆ™ âˆ‹âŸª i âŸ« Aáµ¥â€²) &amp; id-MRENáµ¥ Aáµ¥ â»Â¹)</a>
<a id="8595" class="Comment">-- renâˆ‹â—ˆ         {Aáµ¥ = Aáµ¥} (drop {e = e} Î·) ğ’¾ = suc {{comp-MRENáµ¥ e (drop idâ‰¥) Aáµ¥ â»Â¹}} (renâˆ‹â—ˆ Î· ğ’¾)</a>
<a id="8693" class="Comment">-- renâˆ‹â—ˆ                   (keep {e = e} {Aáµ¥ = Aáµ¥} {{refl}} Î·) (zero {{refl}})</a>
<a id="8772" class="Comment">--   = zero {{ comp-MRENáµ¥ e (drop idâ‰¥) Aáµ¥ â»Â¹</a>
<a id="8817" class="Comment">--           â‹® comp-MRENáµ¥ (drop idâ‰¥) (keep e) Aáµ¥</a>
<a id="8866" class="Comment">--          }}</a>
<a id="8881" class="Comment">-- renâˆ‹â—ˆ                   (keep {e = e} {{refl}} Î·) (suc {Aáµ¥ = Aáµ¥} {{refl}} ğ’¾)</a>
<a id="8961" class="Comment">--   = suc {{ comp-MRENáµ¥ e (drop idâ‰¥) Aáµ¥ â»Â¹</a>
<a id="9005" class="Comment">--          â‹® comp-MRENáµ¥ (drop idâ‰¥) (keep e) Aáµ¥</a>
<a id="9053" class="Comment">--         }} (renâˆ‹â—ˆ Î· ğ’¾)</a>


<a id="9081" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="9167" class="Comment">-- infix 4 _âŠ¢_â¦‚_</a>
<a id="9184" class="Comment">-- record Derivation (d : Nat) : Set</a>
<a id="9221" class="Comment">--   where</a>
<a id="9232" class="Comment">--     constructor _âŠ¢_â¦‚_</a>
<a id="9257" class="Comment">--     field</a>
<a id="9270" class="Comment">--       {g} : Nat</a>
<a id="9289" class="Comment">--       Î“   : Truths d g</a>
<a id="9315" class="Comment">--       M   : Term d g</a>
<a id="9339" class="Comment">--       Aâ‚œ  : Truth d</a>


<a id="9364" class="Comment">-- infix 3 _â¨¾_</a>
<a id="9379" class="Comment">-- data _â¨¾_ : âˆ€ {d} â†’ Validities d â†’ Derivation d â†’ Set</a>
<a id="9435" class="Comment">--   where</a>
<a id="9446" class="Comment">--     var : âˆ€ {d g i} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="9507" class="Comment">--                        {A : Form d}</a>
<a id="9546" class="Comment">--                     â†’ Î“ âˆ‹âŸ¨ i âŸ© A true</a>
<a id="9587" class="Comment">--                     â†’ Î” â¨¾ Î“ âŠ¢ VAR i â¦‚ A true</a>

<a id="9636" class="Comment">--     lam : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="9697" class="Comment">--                        {A B : Form d}</a>
<a id="9738" class="Comment">--                     â†’ Î” â¨¾ Î“ , A true âŠ¢ M â¦‚ B true</a>
<a id="9791" class="Comment">--                     â†’ Î” â¨¾ Î“ âŠ¢ LAM M â¦‚ A âŠƒ B true</a>

<a id="9844" class="Comment">--     app : âˆ€ {d g M N} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="9907" class="Comment">--                          {A B : Form d}</a>
<a id="9950" class="Comment">--                       â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A âŠƒ B true â†’ Î” â¨¾ Î“ âŠ¢ N â¦‚ A true</a>
<a id="10021" class="Comment">--                       â†’ Î” â¨¾ Î“ âŠ¢ APP M N â¦‚ B true</a>

<a id="10074" class="Comment">--     mvar : âˆ€ {d g i} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="10136" class="Comment">--                         {A : Form d}</a>
<a id="10176" class="Comment">--                      â†’ Î” âˆ‹âŸª i âŸ« A valid</a>
<a id="10219" class="Comment">--                      â†’ Î” â¨¾ Î“ âŠ¢ MVAR i â¦‚ A true</a>

<a id="10270" class="Comment">--     box : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="10331" class="Comment">--                        {A : Form d}</a>
<a id="10370" class="Comment">--                     â†’ Î” â¨¾ âˆ™ âŠ¢ M â¦‚ A true</a>
<a id="10414" class="Comment">--                     â†’ Î” â¨¾ Î“ âŠ¢ BOX M â¦‚ [ M ] A true</a>

<a id="10469" class="Comment">--     letbox : âˆ€ {d g M N O} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="10537" class="Comment">--                               {A : Form d} {B : Form (suc d)}</a>
<a id="10602" class="Comment">--                               {Î“Â° : Truths (suc d) g} {{_ : Î“Â° â‰¡ MWKSâ‚œ Î“}}</a>
<a id="10680" class="Comment">--                               {BÂ° : Form d} {{_ : BÂ° â‰¡ MCUTâ‚š O B}}</a>
<a id="10750" class="Comment">--                            â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ [ O ] A true â†’ Î” , A valid â¨¾ Î“Â° âŠ¢ N â¦‚ B true</a>
<a id="10839" class="Comment">--                            â†’ Î” â¨¾ Î“ âŠ¢ LETBOX M N â¦‚ BÂ° true</a>


<a id="10902" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="10988" class="Comment">-- ren : âˆ€ {d g gâ€² e M} â†’ {Î” : Validities d} {Î“ : Truths d g} {Î“â€² : Truths d gâ€²}</a>
<a id="11069" class="Comment">--                         {A : Form d}</a>
<a id="11109" class="Comment">--                      â†’ Î“â€² âŠ‡âŸ¨ e âŸ© Î“ â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="11168" class="Comment">--                      â†’ Î” â¨¾ Î“â€² âŠ¢ REN e M â¦‚ A true</a>
<a id="11220" class="Comment">-- ren Î· (var ğ’¾)   = var (renâˆ‹ Î· ğ’¾)</a>
<a id="11256" class="Comment">-- ren Î· (lam ğ’Ÿ)   = lam (ren (keep Î·) ğ’Ÿ)</a>
<a id="11298" class="Comment">-- ren Î· (app ğ’Ÿ â„°) = app (ren Î· ğ’Ÿ) (ren Î· â„°)</a>
<a id="11343" class="Comment">-- ren Î· (mvar ğ’¾)  = mvar ğ’¾</a>
<a id="11371" class="Comment">-- ren Î· (box ğ’Ÿ)   = box ğ’Ÿ</a>
<a id="11398" class="Comment">-- ren Î· (letbox {{refl}} {{refl}} ğ’Ÿ â„°)</a>
<a id="11438" class="Comment">--   = letbox {{refl}} {{refl}} (ren Î· ğ’Ÿ) (ren (resp-MWKSâ‚œ-âŠ‡ Î·) â„°)</a>


<a id="11507" class="Comment">-- wk : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="11563" class="Comment">--                   {A B : Form d}</a>
<a id="11599" class="Comment">--                â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="11638" class="Comment">--                â†’ Î” â¨¾ Î“ , B true âŠ¢ WK M â¦‚ A true</a>
<a id="11689" class="Comment">-- wk ğ’Ÿ = ren (drop idâŠ‡) ğ’Ÿ</a>


<a id="11718" class="Comment">-- vz : âˆ€ {d g} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="11772" class="Comment">--                 {A : Form d}</a>
<a id="11804" class="Comment">--              â†’ Î” â¨¾ Î“ , A true âŠ¢ VZ â¦‚ A true</a>
<a id="11851" class="Comment">-- vz = var zero</a>


<a id="11870" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="11956" class="Comment">-- comp-MWKâ‚š-MRENâ‚š-keep : âˆ€ {d dâ€²} â†’ (e : dâ€² â‰¥ d) (A : Form d)</a>
<a id="12019" class="Comment">--                                 â†’ (MRENâ‚š (keep e) âˆ˜ MWKâ‚š) A â‰¡ (MWKâ‚š âˆ˜ MRENâ‚š e) A</a>
<a id="12103" class="Comment">-- comp-MWKâ‚š-MRENâ‚š-keep e A = comp-MRENâ‚š (drop idâ‰¥) (keep e) A â»Â¹</a>
<a id="12169" class="Comment">--                          â‹® (\ eâ€² â†’ MRENâ‚š (drop eâ€²) A) &amp; (lidâˆ˜ e â‹® ridâˆ˜ e â»Â¹)</a>
<a id="12249" class="Comment">--                          â‹® comp-MRENâ‚š e (drop idâ‰¥) A</a>


<a id="12307" class="Comment">-- comp-MWKSâ‚œ-MRENSâ‚œ-keep : âˆ€ {d dâ€² g} â†’ (e : dâ€² â‰¥ d) (Î“ : Truths d g)</a>
<a id="12378" class="Comment">--                                     â†’ (MRENSâ‚œ (keep e) âˆ˜ MWKSâ‚œ) Î“ â‰¡ (MWKSâ‚œ âˆ˜ MRENSâ‚œ e) Î“</a>
<a id="12470" class="Comment">-- comp-MWKSâ‚œ-MRENSâ‚œ-keep e âˆ™            = refl</a>
<a id="12518" class="Comment">-- comp-MWKSâ‚œ-MRENSâ‚œ-keep e (Î“ , A true) = _,_ &amp; comp-MWKSâ‚œ-MRENSâ‚œ-keep e Î“</a>
<a id="12594" class="Comment">--                                             âŠ— _true &amp; comp-MWKâ‚š-MRENâ‚š-keep e A</a>


<a id="12678" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š : âˆ€ {d dâ€² n} â†’ (e : dâ€² â‰¥ d) (x : Termsâ‚ d n) (A : Form n)</a>
<a id="12756" class="Comment">--                               â†’ MSUBâ‚š (MRENSâ‚ e x) A â‰¡ (MRENâ‚š e âˆ˜ MSUBâ‚š x) A</a>
<a id="12836" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š e x BASE      = refl</a>
<a id="12877" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š e x (A âŠƒ B)   = _âŠƒ_ &amp; comp-MRENâ‚š-MSUBâ‚š e x A âŠ— comp-MRENâ‚š-MSUBâ‚š e x B</a>
<a id="12967" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š e x ([ M ] A) = [_]_ &amp; comp-MREN-MSUB e x M âŠ— comp-MRENâ‚š-MSUBâ‚š e x A</a>


<a id="13058" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š : âˆ€ {d n nâ€²} â†’ (x : Termsâ‚ d nâ€²) (e : nâ€² â‰¥ n) (A : Form n)</a>
<a id="13137" class="Comment">--                               â†’ MSUBâ‚š (GETS x e) A â‰¡ (MSUBâ‚š x âˆ˜ MRENâ‚š e) A</a>
<a id="13215" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š x e BASE      = refl</a>
<a id="13256" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š x e (A âŠƒ B)   = _âŠƒ_ &amp; comp-MSUBâ‚š-MRENâ‚š x e A âŠ— comp-MSUBâ‚š-MRENâ‚š x e B</a>
<a id="13346" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š x e ([ M ] A) = [_]_ &amp; comp-MSUB-MREN x e M âŠ— comp-MSUBâ‚š-MRENâ‚š x e A</a>


<a id="13437" class="Comment">-- oops : âˆ€ {d dâ€²} â†’ (e : dâ€² â‰¥ d)</a>
<a id="13471" class="Comment">--                 â†’ MRENS e MIDSâ‚ â‰¡ GETS MIDSâ‚ e</a>
<a id="13521" class="Comment">-- oops done     = refl</a>
<a id="13545" class="Comment">-- oops (drop e) = comp-MRENS e (drop idâ‰¥) MIDSâ‚</a>
<a id="13594" class="Comment">--               â‹® MWKS &amp; oops e</a>
<a id="13627" class="Comment">--               â‹® comp-MRENS-GETS (drop idâ‰¥) MIDSâ‚ e â»Â¹</a>
<a id="13684" class="Comment">-- oops (keep e) = (_, MVZ) &amp; ( comp-MWKS-MRENS-keep e MIDSâ‚</a>
<a id="13745" class="Comment">--                            â‹® MWKS &amp; oops e</a>
<a id="13791" class="Comment">--                            â‹® comp-MRENS-GETS (drop idâ‰¥) MIDSâ‚ e â»Â¹</a>
<a id="13861" class="Comment">--                            )</a>


<a id="13895" class="Comment">-- mren : âˆ€ {d dâ€² g e M} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Î“ : Truths d g}</a>
<a id="13979" class="Comment">--                          {A : Form d}</a>
<a id="14020" class="Comment">--                       â†’ Î”â€² âŠ‡âŸª e âŸ« Î” â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="14080" class="Comment">--                       â†’ Î”â€² â¨¾ MRENSâ‚œ e Î“ âŠ¢ MREN e M â¦‚ MRENâ‚š e A true</a>
<a id="14151" class="Comment">-- mren Î· (var ğ’¾)   = var (resp-MRENSâ‚œ-âˆ‹ _ ğ’¾)</a>
<a id="14197" class="Comment">-- mren Î· (lam ğ’Ÿ)   = lam (mren Î· ğ’Ÿ)</a>
<a id="14234" class="Comment">-- mren Î· (app ğ’Ÿ â„°) = app (mren Î· ğ’Ÿ) (mren Î· â„°)</a>
<a id="14282" class="Comment">-- mren Î· (mvar ğ’¾)  = mvar (renâˆ‹â—ˆ Î· ğ’¾)</a>
<a id="14321" class="Comment">-- mren Î· (box ğ’Ÿ)   = box (mren Î· ğ’Ÿ)</a>
<a id="14358" class="Comment">-- mren {e = e} Î· (letbox {O = O} {Î“ = Î“} {A = A} {B} {{refl}} {{refl}} ğ’Ÿ â„°)</a>
<a id="14435" class="Comment">--   = letbox</a>
<a id="14449" class="Comment">--       {{comp-MWKSâ‚œ-MRENSâ‚œ-keep e Î“}}</a>
<a id="14489" class="Comment">--       {{( comp-MRENâ‚š-MSUBâ‚š e (MIDSâ‚ , O) B â»Â¹</a>
<a id="14538" class="Comment">--         â‹® (\ xâ€² â†’ MSUBâ‚š (xâ€² , MREN e O) B) &amp; oops e</a>
<a id="14593" class="Comment">--         â‹® comp-MSUBâ‚š-MRENâ‚š (MIDSâ‚ , MREN e O) (keep e) B</a>
<a id="14653" class="Comment">--         )}}</a>
<a id="14668" class="Comment">--       (mren Î· ğ’Ÿ)</a>
<a id="14688" class="Comment">--       (mren (keep {{refl}} Î·) â„°)</a>


<a id="14726" class="Comment">-- mwk : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="14783" class="Comment">--                    {A B : Form d}</a>
<a id="14820" class="Comment">--                 â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="14860" class="Comment">--                 â†’ Î” , B valid â¨¾ MWKSâ‚œ Î“ âŠ¢ MWK M â¦‚ MWKâ‚š A true</a>
<a id="14925" class="Comment">-- mwk ğ’Ÿ = mren (drop idâŠ‡â—ˆ) ğ’Ÿ</a>


<a id="14957" class="Comment">-- mvz : âˆ€ {d g} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="15012" class="Comment">--                  {A : Form d}</a>
<a id="15045" class="Comment">--               â†’ Î” , A valid â¨¾ MWKSâ‚œ Î“ âŠ¢ MVZ â¦‚ MWKâ‚š A true</a>
<a id="15106" class="Comment">-- mvz = mvar zero</a>


<a id="15127" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>