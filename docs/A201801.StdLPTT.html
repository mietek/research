<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201801.StdLPTT</title><link rel="stylesheet" href="AgdaPP.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201801.StdLPTT.html" class="Module">A201801.StdLPTT</a> <a id="53" class="Keyword">where</a>

<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="A201801.S4TTTerms.html" class="Module">A201801.S4TTTerms</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="A201801.S4TTTermsLemmas.html" class="Module">A201801.S4TTTermsLemmas</a>


<a id="293" class="Comment">--------------------------------------------------------------------------------</a>


<a id="376" class="Comment">-- TODO: unfinished</a>
<a id="396" class="Comment">-- infixr 8 _âŠƒ_</a>
<a id="412" class="Comment">-- data Form : Nat â†’ Set</a>
<a id="437" class="Comment">--   where</a>
<a id="448" class="Comment">--     BASE : âˆ€ {d} â†’ Form d</a>
<a id="477" class="Comment">--     _âŠƒ_  : âˆ€ {d} â†’ Form d â†’ Form d â†’ Form d</a>
<a id="524" class="Comment">--     [_]_ : âˆ€ {d} â†’ Termâ‚ d â†’ Form d â†’ Form d</a>


<a id="574" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="660" class="Comment">-- MRENâ‚š : âˆ€ {d dâ€²} â†’ dâ€² â‰¥ d â†’ Form d</a>
<a id="698" class="Comment">--                  â†’ Form dâ€²</a>
<a id="728" class="Comment">-- MRENâ‚š e BASE      = BASE</a>
<a id="756" class="Comment">-- MRENâ‚š e (A âŠƒ B)   = MRENâ‚š e A âŠƒ MRENâ‚š e B</a>
<a id="801" class="Comment">-- MRENâ‚š e ([ M ] A) = [ MREN e M ] MRENâ‚š e A</a>


<a id="849" class="Comment">-- MWKâ‚š : âˆ€ {d} â†’ Form d</a>
<a id="874" class="Comment">--              â†’ Form (suc d)</a>
<a id="905" class="Comment">-- MWKâ‚š A = MRENâ‚š (drop idâ‰¥) A</a>


<a id="938" class="Comment">-- MSUBâ‚š : âˆ€ {d n} â†’ Termsâ‚ d n â†’ Form n</a>
<a id="979" class="Comment">--                 â†’ Form d</a>
<a id="1007" class="Comment">-- MSUBâ‚š x BASE      = BASE</a>
<a id="1035" class="Comment">-- MSUBâ‚š x (A âŠƒ B)   = MSUBâ‚š x A âŠƒ MSUBâ‚š x B</a>
<a id="1080" class="Comment">-- MSUBâ‚š x ([ M ] A) = [ MSUB x M ] MSUBâ‚š x A</a>


<a id="1128" class="Comment">-- MCUTâ‚š : âˆ€ {d} â†’ Termâ‚ d â†’ Form (suc d)</a>
<a id="1170" class="Comment">--               â†’ Form d</a>
<a id="1196" class="Comment">-- MCUTâ‚š M A = MSUBâ‚š (MIDSâ‚ , M) A</a>


<a id="1233" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1319" class="Comment">-- id-MRENâ‚š : âˆ€ {d} â†’ (A : Form d)</a>
<a id="1354" class="Comment">--                  â†’ MRENâ‚š idâ‰¥ A â‰¡ A</a>
<a id="1392" class="Comment">-- id-MRENâ‚š BASE      = refl</a>
<a id="1421" class="Comment">-- id-MRENâ‚š (A âŠƒ B)   = _âŠƒ_ &amp; id-MRENâ‚š A âŠ— id-MRENâ‚š B</a>
<a id="1475" class="Comment">-- id-MRENâ‚š ([ M ] A) = [_]_ &amp; id-MREN M âŠ— id-MRENâ‚š A</a>


<a id="1531" class="Comment">-- comp-MRENâ‚š : âˆ€ {d dâ€² dâ€³} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (A : Form d)</a>
<a id="1603" class="Comment">--                          â†’ MRENâ‚š (eâ‚ âˆ˜â‰¥ eâ‚‚) A â‰¡ MRENâ‚š eâ‚‚ (MRENâ‚š eâ‚ A)</a>
<a id="1676" class="Comment">-- comp-MRENâ‚š eâ‚ eâ‚‚ BASE      = refl</a>
<a id="1713" class="Comment">-- comp-MRENâ‚š eâ‚ eâ‚‚ (A âŠƒ B)   = _âŠƒ_ &amp; comp-MRENâ‚š eâ‚ eâ‚‚ A âŠ— comp-MRENâ‚š eâ‚ eâ‚‚ B</a>
<a id="1791" class="Comment">-- comp-MRENâ‚š eâ‚ eâ‚‚ ([ M ] A) = [_]_ &amp; comp-MREN eâ‚ eâ‚‚ M âŠ— comp-MRENâ‚š eâ‚ eâ‚‚ A</a>


<a id="1871" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1957" class="Comment">-- infix 7 _true</a>
<a id="1974" class="Comment">-- record Truth (d : Nat) : Set</a>
<a id="2006" class="Comment">--   where</a>
<a id="2017" class="Comment">--     constructor _true</a>
<a id="2042" class="Comment">--     field</a>
<a id="2055" class="Comment">--       A : Form d</a>


<a id="2077" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2163" class="Comment">-- MRENâ‚œ : âˆ€ {d dâ€²} â†’ dâ€² â‰¥ d â†’ Truth d</a>
<a id="2202" class="Comment">--                  â†’ Truth dâ€²</a>
<a id="2233" class="Comment">-- MRENâ‚œ e (A true) = MRENâ‚š e A true</a>


<a id="2272" class="Comment">-- MWKâ‚œ : âˆ€ {d} â†’ Truth d</a>
<a id="2298" class="Comment">--              â†’ Truth (suc d)</a>
<a id="2330" class="Comment">-- MWKâ‚œ (A true) = MWKâ‚š A true</a>


<a id="2363" class="Comment">-- MSUBâ‚œ : âˆ€ {d n} â†’ Termsâ‚ d n â†’ Truth n</a>
<a id="2405" class="Comment">--                 â†’ Truth d</a>
<a id="2434" class="Comment">-- MSUBâ‚œ x (A true) = MSUBâ‚š x A true</a>


<a id="2473" class="Comment">-- MCUTâ‚œ : âˆ€ {d} â†’ Termâ‚ d â†’ Truth (suc d)</a>
<a id="2516" class="Comment">--               â†’ Truth d</a>
<a id="2543" class="Comment">-- MCUTâ‚œ M (A true) = MCUTâ‚š M A true</a>


<a id="2582" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2668" class="Comment">-- id-MRENâ‚œ : âˆ€ {d} â†’ (Aâ‚œ : Truth d)</a>
<a id="2705" class="Comment">--                  â†’ MRENâ‚œ idâ‰¥ Aâ‚œ â‰¡ Aâ‚œ</a>
<a id="2745" class="Comment">-- id-MRENâ‚œ (A true) = _true &amp; id-MRENâ‚š A</a>


<a id="2789" class="Comment">-- comp-MRENâ‚œ : âˆ€ {d dâ€² dâ€³} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (Aâ‚œ : Truth d)</a>
<a id="2863" class="Comment">--                          â†’ MRENâ‚œ (eâ‚ âˆ˜â‰¥ eâ‚‚) Aâ‚œ â‰¡ MRENâ‚œ eâ‚‚ (MRENâ‚œ eâ‚ Aâ‚œ)</a>
<a id="2938" class="Comment">-- comp-MRENâ‚œ eâ‚ eâ‚‚ (A true) = _true &amp; comp-MRENâ‚š eâ‚ eâ‚‚ A</a>


<a id="2998" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3084" class="Comment">-- Truths : Nat â†’ Nat â†’ Set</a>
<a id="3112" class="Comment">-- Truths d g = Vec (Truth d) g</a>


<a id="3146" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3232" class="Comment">-- MRENSâ‚œ : âˆ€ {d dâ€² g} â†’ dâ€² â‰¥ d â†’ Truths d g</a>
<a id="3277" class="Comment">--                     â†’ Truths dâ€² g</a>
<a id="3314" class="Comment">-- MRENSâ‚œ e Î“ = MAPS (MRENâ‚œ e) Î“</a>


<a id="3349" class="Comment">-- MWKSâ‚œ : âˆ€ {d g} â†’ Truths d g</a>
<a id="3381" class="Comment">--                 â†’ Truths (suc d) g</a>
<a id="3419" class="Comment">-- MWKSâ‚œ Î“ = MAPS MWKâ‚œ Î“</a>


<a id="3446" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3532" class="Comment">-- id-MRENSâ‚œ : âˆ€ {d g} â†’ (Î“ : Truths d g)</a>
<a id="3574" class="Comment">--                     â†’ MRENSâ‚œ idâ‰¥ Î“ â‰¡ Î“</a>
<a id="3616" class="Comment">-- id-MRENSâ‚œ âˆ™        = refl</a>
<a id="3645" class="Comment">-- id-MRENSâ‚œ (Î“ , Aâ‚œ) = _,_ &amp; id-MRENSâ‚œ Î“ âŠ— id-MRENâ‚œ Aâ‚œ</a>


<a id="3703" class="Comment">-- comp-MRENSâ‚œ : âˆ€ {d dâ€² dâ€³ g} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (Î“ : Truths d g)</a>
<a id="3782" class="Comment">--                             â†’ MRENSâ‚œ (eâ‚ âˆ˜â‰¥ eâ‚‚) Î“ â‰¡ MRENSâ‚œ eâ‚‚ (MRENSâ‚œ eâ‚ Î“)</a>
<a id="3861" class="Comment">-- comp-MRENSâ‚œ eâ‚ eâ‚‚ âˆ™        = refl</a>
<a id="3898" class="Comment">-- comp-MRENSâ‚œ eâ‚ eâ‚‚ (Î“ , Aâ‚œ) = _,_ &amp; comp-MRENSâ‚œ eâ‚ eâ‚‚ Î“ âŠ— comp-MRENâ‚œ eâ‚ eâ‚‚ Aâ‚œ</a>


<a id="3980" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ : âˆ€ {d dâ€² g gâ€² eâ‚‚} â†’ {Î“ : Truths d g} {Î“â€² : Truths d gâ€²}</a>
<a id="4054" class="Comment">--                                  â†’ (eâ‚ : dâ€² â‰¥ d) â†’ Î“â€² âŠ‡âŸ¨ eâ‚‚ âŸ© Î“</a>
<a id="4121" class="Comment">--                                  â†’ MRENSâ‚œ eâ‚ Î“â€² âŠ‡âŸ¨ eâ‚‚ âŸ© MRENSâ‚œ eâ‚ Î“</a>
<a id="4192" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ eâ‚ done     = done</a>
<a id="4228" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ eâ‚ (drop Î·) = resp-MRENSâ‚œ-âŠ‡ eâ‚ Î· âˆ˜âŠ‡ drop idâŠ‡</a>
<a id="4290" class="Comment">-- resp-MRENSâ‚œ-âŠ‡ eâ‚ (keep Î·) = keep (resp-MRENSâ‚œ-âŠ‡ eâ‚ Î·)</a>


<a id="4349" class="Comment">-- resp-MWKSâ‚œ-âŠ‡ : âˆ€ {d g gâ€² e} â†’ {Î“ : Truths d g} {Î“â€² : Truths d gâ€²}</a>
<a id="4418" class="Comment">--                             â†’ Î“â€² âŠ‡âŸ¨ e âŸ© Î“</a>
<a id="4463" class="Comment">--                             â†’ MWKSâ‚œ Î“â€² âŠ‡âŸ¨ e âŸ© MWKSâ‚œ Î“</a>
<a id="4520" class="Comment">-- resp-MWKSâ‚œ-âŠ‡ Î· = resp-MRENSâ‚œ-âŠ‡ (drop idâ‰¥) Î·</a>


<a id="4569" class="Comment">-- resp-MRENSâ‚œ-âˆ‹ : âˆ€ {d dâ€² g i} â†’ {Î“ : Truths d g} {A : Form d}</a>
<a id="4633" class="Comment">--                              â†’ (e : dâ€² â‰¥ d) â†’ Î“ âˆ‹âŸ¨ i âŸ© A true</a>
<a id="4698" class="Comment">--                              â†’ MRENSâ‚œ e Î“ âˆ‹âŸ¨ i âŸ© MRENâ‚š e A true</a>
<a id="4765" class="Comment">-- resp-MRENSâ‚œ-âˆ‹ e zero    = zero</a>
<a id="4799" class="Comment">-- resp-MRENSâ‚œ-âˆ‹ e (suc ğ’¾) = suc (resp-MRENSâ‚œ-âˆ‹ e ğ’¾)</a>


<a id="4854" class="Comment">-- resp-MWKSâ‚œ-âˆ‹ : âˆ€ {d g i} â†’ {Î“ : Truths d g} {A : Form d}</a>
<a id="4914" class="Comment">--                          â†’ Î“ âˆ‹âŸ¨ i âŸ© A true</a>
<a id="4960" class="Comment">--                          â†’ MWKSâ‚œ Î“ âˆ‹âŸ¨ i âŸ© MWKâ‚š A true</a>
<a id="5017" class="Comment">-- resp-MWKSâ‚œ-âˆ‹ ğ’¾ = resp-MRENSâ‚œ-âˆ‹ (drop idâ‰¥) ğ’¾</a>


<a id="5066" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5152" class="Comment">-- infix 7 _valid</a>
<a id="5170" class="Comment">-- record Validity (d : Nat) : Set</a>
<a id="5205" class="Comment">--   where</a>
<a id="5216" class="Comment">--     constructor _valid</a>
<a id="5242" class="Comment">--     field</a>
<a id="5255" class="Comment">--       A : Form d</a>


<a id="5277" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5363" class="Comment">-- MRENáµ¥ : âˆ€ {d dâ€²} â†’ dâ€² â‰¥ d â†’ Validity d</a>
<a id="5405" class="Comment">--                  â†’ Validity dâ€²</a>
<a id="5439" class="Comment">-- MRENáµ¥ e (A valid) = MRENâ‚š e A valid</a>


<a id="5480" class="Comment">-- MWKáµ¥ : âˆ€ {d} â†’ Validity d</a>
<a id="5509" class="Comment">--              â†’ Validity (suc d)</a>
<a id="5544" class="Comment">-- MWKáµ¥ (A valid) = MWKâ‚š A valid</a>


<a id="5579" class="Comment">-- MSUBáµ¥ : âˆ€ {d n} â†’ Termsâ‚ d n â†’ Validity n</a>
<a id="5624" class="Comment">--                 â†’ Validity d</a>
<a id="5656" class="Comment">-- MSUBáµ¥ x (A valid) = MSUBâ‚š x A valid</a>


<a id="5697" class="Comment">-- MCUTáµ¥ : âˆ€ {d} â†’ Termâ‚ d â†’ Validity (suc d)</a>
<a id="5743" class="Comment">--               â†’ Validity d</a>
<a id="5773" class="Comment">-- MCUTáµ¥ M (A valid) = MCUTâ‚š M A valid</a>


<a id="5814" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5900" class="Comment">-- id-MRENáµ¥ : âˆ€ {d} â†’ (Aáµ¥ : Validity d)</a>
<a id="5940" class="Comment">--                  â†’ MRENáµ¥ idâ‰¥ Aáµ¥ â‰¡ Aáµ¥</a>
<a id="5980" class="Comment">-- id-MRENáµ¥ (A valid) = _valid &amp; id-MRENâ‚š A</a>


<a id="6026" class="Comment">-- comp-MRENáµ¥ : âˆ€ {d dâ€² dâ€³} â†’ (eâ‚ : dâ€² â‰¥ d) (eâ‚‚ : dâ€³ â‰¥ dâ€²) (Aáµ¥ : Validity d)</a>
<a id="6103" class="Comment">--                          â†’ MRENáµ¥ (eâ‚ âˆ˜â‰¥ eâ‚‚) Aáµ¥ â‰¡ MRENáµ¥ eâ‚‚ (MRENáµ¥ eâ‚ Aáµ¥)</a>
<a id="6178" class="Comment">-- comp-MRENáµ¥ eâ‚ eâ‚‚ (A valid) = _valid &amp; comp-MRENâ‚š eâ‚ eâ‚‚ A</a>


<a id="6240" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6326" class="Comment">-- data Validities : Nat â†’ Set</a>
<a id="6357" class="Comment">--   where</a>
<a id="6368" class="Comment">--     âˆ™ : Validities zero</a>

<a id="6396" class="Comment">--     _,_ : âˆ€ {d} â†’ Validities d â†’ Validity d</a>
<a id="6443" class="Comment">--                 â†’ Validities (suc d)</a>


<a id="6485" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6571" class="Comment">-- infix 4 _âŠ‡âŸª_âŸ«_</a>
<a id="6589" class="Comment">-- data _âŠ‡âŸª_âŸ«_ : âˆ€ {d dâ€²} â†’ Validities dâ€² â†’ dâ€² â‰¥ d â†’ Validities d â†’ Set</a>
<a id="6661" class="Comment">--   where</a>
<a id="6672" class="Comment">--     done : âˆ™ âŠ‡âŸª done âŸ« âˆ™</a>

<a id="6701" class="Comment">--     drop : âˆ€ {d dâ€² e} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Aáµ¥ : Validity dâ€²}</a>
<a id="6787" class="Comment">--                       â†’ Î”â€² âŠ‡âŸª e âŸ« Î”</a>
<a id="6826" class="Comment">--                       â†’ Î”â€² , Aáµ¥ âŠ‡âŸª drop e âŸ« Î”</a>

<a id="6876" class="Comment">--     keep : âˆ€ {d dâ€² e} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Aáµ¥ : Validity d}</a>
<a id="6961" class="Comment">--                          {Aáµ¥Â° : Validity dâ€²} {{_ : MRENáµ¥ e Aáµ¥ â‰¡ Aáµ¥Â°}}</a>
<a id="7034" class="Comment">--                       â†’ Î”â€² âŠ‡âŸª e âŸ« Î”</a>
<a id="7073" class="Comment">--                       â†’ Î”â€² , Aáµ¥Â° âŠ‡âŸª keep e âŸ« Î” , Aáµ¥</a>


<a id="7130" class="Comment">-- idâŠ‡â—ˆ : âˆ€ {d} â†’ {Î” : Validities d}</a>
<a id="7167" class="Comment">--              â†’ Î” âŠ‡âŸª idâ‰¥ âŸ« Î”</a>
<a id="7198" class="Comment">-- idâŠ‡â—ˆ {Î” = âˆ™}      = done</a>
<a id="7226" class="Comment">-- idâŠ‡â—ˆ {Î” = Î” , Aáµ¥} = keep {{id-MRENáµ¥ Aáµ¥}} idâŠ‡â—ˆ</a>


<a id="7277" class="Comment">-- _âˆ˜âŠ‡â—ˆ_ : âˆ€ {d dâ€² dâ€³ eâ‚ eâ‚‚} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Î”â€³ : Validities dâ€³}</a>
<a id="7369" class="Comment">--                           â†’ Î”â€² âŠ‡âŸª eâ‚ âŸ« Î” â†’ Î”â€³ âŠ‡âŸª eâ‚‚ âŸ« Î”â€²</a>
<a id="7429" class="Comment">--                           â†’ Î”â€³ âŠ‡âŸª eâ‚ âˆ˜â‰¥ eâ‚‚ âŸ« Î”</a>
<a id="7479" class="Comment">-- Î·â‚      âˆ˜âŠ‡â—ˆ done    = Î·â‚</a>
<a id="7507" class="Comment">-- Î·â‚      âˆ˜âŠ‡â—ˆ drop Î·â‚‚ = drop (Î·â‚ âˆ˜âŠ‡â—ˆ Î·â‚‚)</a>
<a id="7549" class="Comment">-- drop Î·â‚ âˆ˜âŠ‡â—ˆ keep Î·â‚‚ = drop (Î·â‚ âˆ˜âŠ‡â—ˆ Î·â‚‚)</a>
<a id="7591" class="Comment">-- keep {e = eâ‚} {Aáµ¥ = Aáµ¥} {{refl}} Î·â‚ âˆ˜âŠ‡â—ˆ keep {e = eâ‚‚} {{refl}} Î·â‚‚</a>
<a id="7660" class="Comment">--   = keep {{comp-MRENáµ¥ eâ‚ eâ‚‚ Aáµ¥}} (Î·â‚ âˆ˜âŠ‡â—ˆ Î·â‚‚)</a>


<a id="7710" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="7796" class="Comment">-- infix 4 _âˆ‹âŸª_âŸ«_</a>
<a id="7814" class="Comment">-- data _âˆ‹âŸª_âŸ«_ : âˆ€ {d} â†’ Validities d â†’ Fin d â†’ Validity d â†’ Set</a>
<a id="7879" class="Comment">--   where</a>
<a id="7890" class="Comment">--     zero : âˆ€ {d} â†’ {Î” : Validities d} {Aáµ¥ : Validity d}</a>
<a id="7949" class="Comment">--                     {Aáµ¥Â° : Validity (suc d)} {{_ : MWKáµ¥ Aáµ¥ â‰¡ Aáµ¥Â°}}</a>
<a id="8019" class="Comment">--                  â†’ Î” , Aáµ¥ âˆ‹âŸª zero âŸ« Aáµ¥Â°</a>

<a id="8063" class="Comment">--     suc : âˆ€ {d i} â†’ {Î” : Validities d} {Aáµ¥ : Validity d} {Báµ¥ : Validity d}</a>
<a id="8141" class="Comment">--                      {Aáµ¥Â° : Validity (suc d)} {{_ : MWKáµ¥ Aáµ¥ â‰¡ Aáµ¥Â°}}</a>
<a id="8212" class="Comment">--                   â†’ Î” âˆ‹âŸª i âŸ« Aáµ¥</a>
<a id="8247" class="Comment">--                   â†’ Î” , Báµ¥ âˆ‹âŸª suc i âŸ« Aáµ¥Â°</a>


<a id="8294" class="Comment">-- renâˆ‹â—ˆ : âˆ€ {d dâ€² e i} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Aáµ¥ : Validity d}</a>
<a id="8378" class="Comment">--                      â†’ Î”â€² âŠ‡âŸª e âŸ« Î” â†’ Î” âˆ‹âŸª i âŸ« Aáµ¥</a>
<a id="8430" class="Comment">--                      â†’ Î”â€² âˆ‹âŸª RENâˆ‹ e i âŸ« MRENáµ¥ e Aáµ¥</a>
<a id="8484" class="Comment">-- renâˆ‹â—ˆ {i = i} {Aáµ¥ = Aáµ¥} done ğ’¾             = coerce ğ’¾ ((\ Aáµ¥â€² â†’ âˆ™ âˆ‹âŸª i âŸ« Aáµ¥â€²) &amp; id-MRENáµ¥ Aáµ¥ â»Â¹)</a>
<a id="8583" class="Comment">-- renâˆ‹â—ˆ         {Aáµ¥ = Aáµ¥} (drop {e = e} Î·) ğ’¾ = suc {{comp-MRENáµ¥ e (drop idâ‰¥) Aáµ¥ â»Â¹}} (renâˆ‹â—ˆ Î· ğ’¾)</a>
<a id="8681" class="Comment">-- renâˆ‹â—ˆ                   (keep {e = e} {Aáµ¥ = Aáµ¥} {{refl}} Î·) (zero {{refl}})</a>
<a id="8760" class="Comment">--   = zero {{ comp-MRENáµ¥ e (drop idâ‰¥) Aáµ¥ â»Â¹</a>
<a id="8805" class="Comment">--           â‹® comp-MRENáµ¥ (drop idâ‰¥) (keep e) Aáµ¥</a>
<a id="8854" class="Comment">--          }}</a>
<a id="8869" class="Comment">-- renâˆ‹â—ˆ                   (keep {e = e} {{refl}} Î·) (suc {Aáµ¥ = Aáµ¥} {{refl}} ğ’¾)</a>
<a id="8949" class="Comment">--   = suc {{ comp-MRENáµ¥ e (drop idâ‰¥) Aáµ¥ â»Â¹</a>
<a id="8993" class="Comment">--          â‹® comp-MRENáµ¥ (drop idâ‰¥) (keep e) Aáµ¥</a>
<a id="9041" class="Comment">--         }} (renâˆ‹â—ˆ Î· ğ’¾)</a>


<a id="9069" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="9155" class="Comment">-- infix 4 _âŠ¢_â¦‚_</a>
<a id="9172" class="Comment">-- record Derivation (d : Nat) : Set</a>
<a id="9209" class="Comment">--   where</a>
<a id="9220" class="Comment">--     constructor _âŠ¢_â¦‚_</a>
<a id="9245" class="Comment">--     field</a>
<a id="9258" class="Comment">--       {g} : Nat</a>
<a id="9277" class="Comment">--       Î“   : Truths d g</a>
<a id="9303" class="Comment">--       M   : Term d g</a>
<a id="9327" class="Comment">--       Aâ‚œ  : Truth d</a>


<a id="9352" class="Comment">-- infix 3 _â¨¾_</a>
<a id="9367" class="Comment">-- data _â¨¾_ : âˆ€ {d} â†’ Validities d â†’ Derivation d â†’ Set</a>
<a id="9423" class="Comment">--   where</a>
<a id="9434" class="Comment">--     var : âˆ€ {d g i} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="9495" class="Comment">--                        {A : Form d}</a>
<a id="9534" class="Comment">--                     â†’ Î“ âˆ‹âŸ¨ i âŸ© A true</a>
<a id="9575" class="Comment">--                     â†’ Î” â¨¾ Î“ âŠ¢ VAR i â¦‚ A true</a>

<a id="9624" class="Comment">--     lam : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="9685" class="Comment">--                        {A B : Form d}</a>
<a id="9726" class="Comment">--                     â†’ Î” â¨¾ Î“ , A true âŠ¢ M â¦‚ B true</a>
<a id="9779" class="Comment">--                     â†’ Î” â¨¾ Î“ âŠ¢ LAM M â¦‚ A âŠƒ B true</a>

<a id="9832" class="Comment">--     app : âˆ€ {d g M N} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="9895" class="Comment">--                          {A B : Form d}</a>
<a id="9938" class="Comment">--                       â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A âŠƒ B true â†’ Î” â¨¾ Î“ âŠ¢ N â¦‚ A true</a>
<a id="10009" class="Comment">--                       â†’ Î” â¨¾ Î“ âŠ¢ APP M N â¦‚ B true</a>

<a id="10062" class="Comment">--     mvar : âˆ€ {d g i} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="10124" class="Comment">--                         {A : Form d}</a>
<a id="10164" class="Comment">--                      â†’ Î” âˆ‹âŸª i âŸ« A valid</a>
<a id="10207" class="Comment">--                      â†’ Î” â¨¾ Î“ âŠ¢ MVAR i â¦‚ A true</a>

<a id="10258" class="Comment">--     box : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="10319" class="Comment">--                        {A : Form d}</a>
<a id="10358" class="Comment">--                     â†’ Î” â¨¾ âˆ™ âŠ¢ M â¦‚ A true</a>
<a id="10402" class="Comment">--                     â†’ Î” â¨¾ Î“ âŠ¢ BOX M â¦‚ [ M ] A true</a>

<a id="10457" class="Comment">--     letbox : âˆ€ {d g M N O} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="10525" class="Comment">--                               {A : Form d} {B : Form (suc d)}</a>
<a id="10590" class="Comment">--                               {Î“Â° : Truths (suc d) g} {{_ : Î“Â° â‰¡ MWKSâ‚œ Î“}}</a>
<a id="10668" class="Comment">--                               {BÂ° : Form d} {{_ : BÂ° â‰¡ MCUTâ‚š O B}}</a>
<a id="10738" class="Comment">--                            â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ [ O ] A true â†’ Î” , A valid â¨¾ Î“Â° âŠ¢ N â¦‚ B true</a>
<a id="10827" class="Comment">--                            â†’ Î” â¨¾ Î“ âŠ¢ LETBOX M N â¦‚ BÂ° true</a>


<a id="10890" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="10976" class="Comment">-- ren : âˆ€ {d g gâ€² e M} â†’ {Î” : Validities d} {Î“ : Truths d g} {Î“â€² : Truths d gâ€²}</a>
<a id="11057" class="Comment">--                         {A : Form d}</a>
<a id="11097" class="Comment">--                      â†’ Î“â€² âŠ‡âŸ¨ e âŸ© Î“ â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="11156" class="Comment">--                      â†’ Î” â¨¾ Î“â€² âŠ¢ REN e M â¦‚ A true</a>
<a id="11208" class="Comment">-- ren Î· (var ğ’¾)   = var (renâˆ‹ Î· ğ’¾)</a>
<a id="11244" class="Comment">-- ren Î· (lam ğ’Ÿ)   = lam (ren (keep Î·) ğ’Ÿ)</a>
<a id="11286" class="Comment">-- ren Î· (app ğ’Ÿ â„°) = app (ren Î· ğ’Ÿ) (ren Î· â„°)</a>
<a id="11331" class="Comment">-- ren Î· (mvar ğ’¾)  = mvar ğ’¾</a>
<a id="11359" class="Comment">-- ren Î· (box ğ’Ÿ)   = box ğ’Ÿ</a>
<a id="11386" class="Comment">-- ren Î· (letbox {{refl}} {{refl}} ğ’Ÿ â„°)</a>
<a id="11426" class="Comment">--   = letbox {{refl}} {{refl}} (ren Î· ğ’Ÿ) (ren (resp-MWKSâ‚œ-âŠ‡ Î·) â„°)</a>


<a id="11495" class="Comment">-- wk : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="11551" class="Comment">--                   {A B : Form d}</a>
<a id="11587" class="Comment">--                â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="11626" class="Comment">--                â†’ Î” â¨¾ Î“ , B true âŠ¢ WK M â¦‚ A true</a>
<a id="11677" class="Comment">-- wk ğ’Ÿ = ren (drop idâŠ‡) ğ’Ÿ</a>


<a id="11706" class="Comment">-- vz : âˆ€ {d g} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="11760" class="Comment">--                 {A : Form d}</a>
<a id="11792" class="Comment">--              â†’ Î” â¨¾ Î“ , A true âŠ¢ VZ â¦‚ A true</a>
<a id="11839" class="Comment">-- vz = var zero</a>


<a id="11858" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="11944" class="Comment">-- comp-MWKâ‚š-MRENâ‚š-keep : âˆ€ {d dâ€²} â†’ (e : dâ€² â‰¥ d) (A : Form d)</a>
<a id="12007" class="Comment">--                                 â†’ (MRENâ‚š (keep e) âˆ˜ MWKâ‚š) A â‰¡ (MWKâ‚š âˆ˜ MRENâ‚š e) A</a>
<a id="12091" class="Comment">-- comp-MWKâ‚š-MRENâ‚š-keep e A = comp-MRENâ‚š (drop idâ‰¥) (keep e) A â»Â¹</a>
<a id="12157" class="Comment">--                          â‹® (\ eâ€² â†’ MRENâ‚š (drop eâ€²) A) &amp; (lidâˆ˜ e â‹® ridâˆ˜ e â»Â¹)</a>
<a id="12237" class="Comment">--                          â‹® comp-MRENâ‚š e (drop idâ‰¥) A</a>


<a id="12295" class="Comment">-- comp-MWKSâ‚œ-MRENSâ‚œ-keep : âˆ€ {d dâ€² g} â†’ (e : dâ€² â‰¥ d) (Î“ : Truths d g)</a>
<a id="12366" class="Comment">--                                     â†’ (MRENSâ‚œ (keep e) âˆ˜ MWKSâ‚œ) Î“ â‰¡ (MWKSâ‚œ âˆ˜ MRENSâ‚œ e) Î“</a>
<a id="12458" class="Comment">-- comp-MWKSâ‚œ-MRENSâ‚œ-keep e âˆ™            = refl</a>
<a id="12506" class="Comment">-- comp-MWKSâ‚œ-MRENSâ‚œ-keep e (Î“ , A true) = _,_ &amp; comp-MWKSâ‚œ-MRENSâ‚œ-keep e Î“</a>
<a id="12582" class="Comment">--                                             âŠ— _true &amp; comp-MWKâ‚š-MRENâ‚š-keep e A</a>


<a id="12666" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š : âˆ€ {d dâ€² n} â†’ (e : dâ€² â‰¥ d) (x : Termsâ‚ d n) (A : Form n)</a>
<a id="12744" class="Comment">--                               â†’ MSUBâ‚š (MRENSâ‚ e x) A â‰¡ (MRENâ‚š e âˆ˜ MSUBâ‚š x) A</a>
<a id="12824" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š e x BASE      = refl</a>
<a id="12865" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š e x (A âŠƒ B)   = _âŠƒ_ &amp; comp-MRENâ‚š-MSUBâ‚š e x A âŠ— comp-MRENâ‚š-MSUBâ‚š e x B</a>
<a id="12955" class="Comment">-- comp-MRENâ‚š-MSUBâ‚š e x ([ M ] A) = [_]_ &amp; comp-MREN-MSUB e x M âŠ— comp-MRENâ‚š-MSUBâ‚š e x A</a>


<a id="13046" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š : âˆ€ {d n nâ€²} â†’ (x : Termsâ‚ d nâ€²) (e : nâ€² â‰¥ n) (A : Form n)</a>
<a id="13125" class="Comment">--                               â†’ MSUBâ‚š (GETS x e) A â‰¡ (MSUBâ‚š x âˆ˜ MRENâ‚š e) A</a>
<a id="13203" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š x e BASE      = refl</a>
<a id="13244" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š x e (A âŠƒ B)   = _âŠƒ_ &amp; comp-MSUBâ‚š-MRENâ‚š x e A âŠ— comp-MSUBâ‚š-MRENâ‚š x e B</a>
<a id="13334" class="Comment">-- comp-MSUBâ‚š-MRENâ‚š x e ([ M ] A) = [_]_ &amp; comp-MSUB-MREN x e M âŠ— comp-MSUBâ‚š-MRENâ‚š x e A</a>


<a id="13425" class="Comment">-- oops : âˆ€ {d dâ€²} â†’ (e : dâ€² â‰¥ d)</a>
<a id="13459" class="Comment">--                 â†’ MRENS e MIDSâ‚ â‰¡ GETS MIDSâ‚ e</a>
<a id="13509" class="Comment">-- oops done     = refl</a>
<a id="13533" class="Comment">-- oops (drop e) = comp-MRENS e (drop idâ‰¥) MIDSâ‚</a>
<a id="13582" class="Comment">--               â‹® MWKS &amp; oops e</a>
<a id="13615" class="Comment">--               â‹® comp-MRENS-GETS (drop idâ‰¥) MIDSâ‚ e â»Â¹</a>
<a id="13672" class="Comment">-- oops (keep e) = (_, MVZ) &amp; ( comp-MWKS-MRENS-keep e MIDSâ‚</a>
<a id="13733" class="Comment">--                            â‹® MWKS &amp; oops e</a>
<a id="13779" class="Comment">--                            â‹® comp-MRENS-GETS (drop idâ‰¥) MIDSâ‚ e â»Â¹</a>
<a id="13849" class="Comment">--                            )</a>


<a id="13883" class="Comment">-- mren : âˆ€ {d dâ€² g e M} â†’ {Î” : Validities d} {Î”â€² : Validities dâ€²} {Î“ : Truths d g}</a>
<a id="13967" class="Comment">--                          {A : Form d}</a>
<a id="14008" class="Comment">--                       â†’ Î”â€² âŠ‡âŸª e âŸ« Î” â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="14068" class="Comment">--                       â†’ Î”â€² â¨¾ MRENSâ‚œ e Î“ âŠ¢ MREN e M â¦‚ MRENâ‚š e A true</a>
<a id="14139" class="Comment">-- mren Î· (var ğ’¾)   = var (resp-MRENSâ‚œ-âˆ‹ _ ğ’¾)</a>
<a id="14185" class="Comment">-- mren Î· (lam ğ’Ÿ)   = lam (mren Î· ğ’Ÿ)</a>
<a id="14222" class="Comment">-- mren Î· (app ğ’Ÿ â„°) = app (mren Î· ğ’Ÿ) (mren Î· â„°)</a>
<a id="14270" class="Comment">-- mren Î· (mvar ğ’¾)  = mvar (renâˆ‹â—ˆ Î· ğ’¾)</a>
<a id="14309" class="Comment">-- mren Î· (box ğ’Ÿ)   = box (mren Î· ğ’Ÿ)</a>
<a id="14346" class="Comment">-- mren {e = e} Î· (letbox {O = O} {Î“ = Î“} {A = A} {B} {{refl}} {{refl}} ğ’Ÿ â„°)</a>
<a id="14423" class="Comment">--   = letbox</a>
<a id="14437" class="Comment">--       {{comp-MWKSâ‚œ-MRENSâ‚œ-keep e Î“}}</a>
<a id="14477" class="Comment">--       {{( comp-MRENâ‚š-MSUBâ‚š e (MIDSâ‚ , O) B â»Â¹</a>
<a id="14526" class="Comment">--         â‹® (\ xâ€² â†’ MSUBâ‚š (xâ€² , MREN e O) B) &amp; oops e</a>
<a id="14581" class="Comment">--         â‹® comp-MSUBâ‚š-MRENâ‚š (MIDSâ‚ , MREN e O) (keep e) B</a>
<a id="14641" class="Comment">--         )}}</a>
<a id="14656" class="Comment">--       (mren Î· ğ’Ÿ)</a>
<a id="14676" class="Comment">--       (mren (keep {{refl}} Î·) â„°)</a>


<a id="14714" class="Comment">-- mwk : âˆ€ {d g M} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="14771" class="Comment">--                    {A B : Form d}</a>
<a id="14808" class="Comment">--                 â†’ Î” â¨¾ Î“ âŠ¢ M â¦‚ A true</a>
<a id="14848" class="Comment">--                 â†’ Î” , B valid â¨¾ MWKSâ‚œ Î“ âŠ¢ MWK M â¦‚ MWKâ‚š A true</a>
<a id="14913" class="Comment">-- mwk ğ’Ÿ = mren (drop idâŠ‡â—ˆ) ğ’Ÿ</a>


<a id="14945" class="Comment">-- mvz : âˆ€ {d g} â†’ {Î” : Validities d} {Î“ : Truths d g}</a>
<a id="15000" class="Comment">--                  {A : Form d}</a>
<a id="15033" class="Comment">--               â†’ Î” , A valid â¨¾ MWKSâ‚œ Î“ âŠ¢ MVZ â¦‚ MWKâ‚š A true</a>
<a id="15094" class="Comment">-- mvz = mvar zero</a>


<a id="15115" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>