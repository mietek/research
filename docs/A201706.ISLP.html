<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201706.ISLP</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201706.ISLP.html" class="Module">A201706.ISLP</a> <a id="50" class="Keyword">where</a>

<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="A201706.PreludeVec.html" class="Module">A201706.PreludeVec</a> <a id="88" class="Keyword">public</a>


<a id="97" class="Comment">-- Terms.</a>

<a id="108" class="Keyword">mutual</a>
  <a id="117" class="Keyword">data</a> <a id="Tm"></a><a id="122" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="125" class="Symbol">(</a><a id="126" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="128" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="130" class="Symbol">:</a> <a id="132" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a><a id="135" class="Symbol">)</a> <a id="137" class="Symbol">:</a> <a id="139" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="143" class="Keyword">where</a>
    <a id="Tm.VAR"></a><a id="153" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a>   <a id="159" class="Symbol">:</a> <a id="161" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="165" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="167" class="Symbol">→</a> <a id="169" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="172" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="174" href="A201706.ISLP.html#128" class="Bound">g</a>
    <a id="Tm.MVAR"></a><a id="180" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a>  <a id="186" class="Symbol">:</a> <a id="188" class="Symbol">∀</a> <a id="190" class="Symbol">{</a><a id="191" href="A201706.ISLP.html#191" class="Bound">`d</a> <a id="194" href="A201706.ISLP.html#194" class="Bound">`g</a><a id="196" class="Symbol">}</a> <a id="198" class="Symbol">→</a> <a id="200" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="204" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="206" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="211" href="A201706.ISLP.html#191" class="Bound">`d</a> <a id="214" class="Symbol">→</a> <a id="216" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="220" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="222" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="224" href="A201706.ISLP.html#194" class="Bound">`g</a> <a id="227" class="Symbol">→</a> <a id="229" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="233" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="235" class="Symbol">→</a> <a id="237" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="240" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="242" href="A201706.ISLP.html#128" class="Bound">g</a>
    <a id="Tm.LAM"></a><a id="248" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a>   <a id="254" class="Symbol">:</a> <a id="256" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="259" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="261" class="Symbol">(</a><a id="262" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="266" href="A201706.ISLP.html#128" class="Bound">g</a><a id="267" class="Symbol">)</a> <a id="269" class="Symbol">→</a> <a id="271" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="274" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="276" href="A201706.ISLP.html#128" class="Bound">g</a>
    <a id="Tm.APP"></a><a id="282" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a>   <a id="288" class="Symbol">:</a> <a id="290" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="293" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="295" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="297" class="Symbol">→</a> <a id="299" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="302" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="304" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="306" class="Symbol">→</a> <a id="308" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="311" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="313" href="A201706.ISLP.html#128" class="Bound">g</a>
    <a id="Tm.BOX"></a><a id="319" href="A201706.ISLP.html#319" class="InductiveConstructor">BOX</a>   <a id="325" class="Symbol">:</a> <a id="327" class="Symbol">∀</a> <a id="329" class="Symbol">{</a><a id="330" href="A201706.ISLP.html#330" class="Bound">`d</a> <a id="333" href="A201706.ISLP.html#333" class="Bound">`g</a><a id="335" class="Symbol">}</a> <a id="337" class="Symbol">→</a> <a id="339" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="342" href="A201706.ISLP.html#330" class="Bound">`d</a> <a id="345" href="A201706.ISLP.html#333" class="Bound">`g</a> <a id="348" class="Symbol">→</a> <a id="350" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="353" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="355" href="A201706.ISLP.html#128" class="Bound">g</a>
    <a id="Tm.UNBOX"></a><a id="361" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="367" class="Symbol">:</a> <a id="369" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="372" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="374" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="376" class="Symbol">→</a> <a id="378" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="381" class="Symbol">(</a><a id="382" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="386" href="A201706.ISLP.html#126" class="Bound">d</a><a id="387" class="Symbol">)</a> <a id="389" href="A201706.ISLP.html#128" class="Bound">g</a> <a id="391" class="Symbol">→</a> <a id="393" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="396" href="A201706.ISLP.html#126" class="Bound">d</a> <a id="398" href="A201706.ISLP.html#128" class="Bound">g</a>

  <a id="Tm⋆"></a><a id="403" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="407" class="Symbol">:</a> <a id="409" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="413" class="Symbol">→</a> <a id="415" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="419" class="Symbol">→</a> <a id="421" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="425" class="Symbol">→</a> <a id="427" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="433" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="437" href="A201706.ISLP.html#437" class="Bound">d</a> <a id="439" href="A201706.ISLP.html#439" class="Bound">g</a> <a id="441" href="A201706.ISLP.html#441" class="Bound">n</a> <a id="443" class="Symbol">=</a> <a id="445" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="449" class="Symbol">(</a><a id="450" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="453" href="A201706.ISLP.html#437" class="Bound">d</a> <a id="455" href="A201706.ISLP.html#439" class="Bound">g</a><a id="456" class="Symbol">)</a> <a id="458" href="A201706.ISLP.html#441" class="Bound">n</a>

<a id="461" class="Keyword">mutual</a>
  <a id="monoTm"></a><a id="470" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="477" class="Symbol">:</a> <a id="479" class="Symbol">∀</a> <a id="481" class="Symbol">{</a><a id="482" href="A201706.ISLP.html#482" class="Bound">d</a> <a id="484" href="A201706.ISLP.html#484" class="Bound">g</a> <a id="486" href="A201706.ISLP.html#486" class="Bound">d′</a> <a id="489" href="A201706.ISLP.html#489" class="Bound">g′</a><a id="491" class="Symbol">}</a> <a id="493" class="Symbol">→</a> <a id="495" href="A201706.ISLP.html#486" class="Bound">d′</a> <a id="498" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="500" href="A201706.ISLP.html#482" class="Bound">d</a> <a id="502" class="Symbol">→</a> <a id="504" href="A201706.ISLP.html#489" class="Bound">g′</a> <a id="507" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="509" href="A201706.ISLP.html#484" class="Bound">g</a> <a id="511" class="Symbol">→</a> <a id="513" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="516" href="A201706.ISLP.html#482" class="Bound">d</a> <a id="518" href="A201706.ISLP.html#484" class="Bound">g</a> <a id="520" class="Symbol">→</a> <a id="522" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="525" href="A201706.ISLP.html#486" class="Bound">d′</a> <a id="528" href="A201706.ISLP.html#489" class="Bound">g′</a>
  <a id="533" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="540" href="A201706.ISLP.html#540" class="Bound">z</a> <a id="542" href="A201706.ISLP.html#542" class="Bound">e</a> <a id="544" class="Symbol">(</a><a id="545" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="549" href="A201706.ISLP.html#549" class="Bound">i</a><a id="550" class="Symbol">)</a>      <a id="557" class="Symbol">=</a> <a id="559" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="563" class="Symbol">(</a><a id="564" href="A201706.Prelude.html#9177" class="Function">monoFin</a> <a id="572" href="A201706.ISLP.html#542" class="Bound">e</a> <a id="574" href="A201706.ISLP.html#549" class="Bound">i</a><a id="575" class="Symbol">)</a>
  <a id="579" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="586" href="A201706.ISLP.html#586" class="Bound">z</a> <a id="588" href="A201706.ISLP.html#588" class="Bound">e</a> <a id="590" class="Symbol">(</a><a id="591" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a> <a id="596" href="A201706.ISLP.html#596" class="Bound">q</a> <a id="598" href="A201706.ISLP.html#598" class="Bound">p</a> <a id="600" href="A201706.ISLP.html#600" class="Bound">i</a><a id="601" class="Symbol">)</a> <a id="603" class="Symbol">=</a> <a id="605" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a> <a id="610" class="Symbol">(</a><a id="611" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="619" href="A201706.ISLP.html#586" class="Bound">z</a> <a id="621" href="A201706.Prelude.html#6658" class="InductiveConstructor">done</a> <a id="626" href="A201706.ISLP.html#596" class="Bound">q</a><a id="627" class="Symbol">)</a> <a id="629" class="Symbol">(</a><a id="630" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="638" href="A201706.ISLP.html#586" class="Bound">z</a> <a id="640" href="A201706.ISLP.html#588" class="Bound">e</a> <a id="642" href="A201706.ISLP.html#598" class="Bound">p</a><a id="643" class="Symbol">)</a> <a id="645" class="Symbol">(</a><a id="646" href="A201706.Prelude.html#9177" class="Function">monoFin</a> <a id="654" href="A201706.ISLP.html#586" class="Bound">z</a> <a id="656" href="A201706.ISLP.html#600" class="Bound">i</a><a id="657" class="Symbol">)</a>
  <a id="661" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="668" href="A201706.ISLP.html#668" class="Bound">z</a> <a id="670" href="A201706.ISLP.html#670" class="Bound">e</a> <a id="672" class="Symbol">(</a><a id="673" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a> <a id="677" href="A201706.ISLP.html#677" class="Bound">M</a><a id="678" class="Symbol">)</a>      <a id="685" class="Symbol">=</a> <a id="687" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a> <a id="691" class="Symbol">(</a><a id="692" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="699" href="A201706.ISLP.html#668" class="Bound">z</a> <a id="701" class="Symbol">(</a><a id="702" href="A201706.Prelude.html#6719" class="InductiveConstructor">lift</a> <a id="707" href="A201706.ISLP.html#670" class="Bound">e</a><a id="708" class="Symbol">)</a> <a id="710" href="A201706.ISLP.html#677" class="Bound">M</a><a id="711" class="Symbol">)</a>
  <a id="715" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="722" href="A201706.ISLP.html#722" class="Bound">z</a> <a id="724" href="A201706.ISLP.html#724" class="Bound">e</a> <a id="726" class="Symbol">(</a><a id="727" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a> <a id="731" href="A201706.ISLP.html#731" class="Bound">M</a> <a id="733" href="A201706.ISLP.html#733" class="Bound">N</a><a id="734" class="Symbol">)</a>    <a id="739" class="Symbol">=</a> <a id="741" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a> <a id="745" class="Symbol">(</a><a id="746" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="753" href="A201706.ISLP.html#722" class="Bound">z</a> <a id="755" href="A201706.ISLP.html#724" class="Bound">e</a> <a id="757" href="A201706.ISLP.html#731" class="Bound">M</a><a id="758" class="Symbol">)</a> <a id="760" class="Symbol">(</a><a id="761" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="768" href="A201706.ISLP.html#722" class="Bound">z</a> <a id="770" href="A201706.ISLP.html#724" class="Bound">e</a> <a id="772" href="A201706.ISLP.html#733" class="Bound">N</a><a id="773" class="Symbol">)</a>
  <a id="777" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="784" href="A201706.ISLP.html#784" class="Bound">z</a> <a id="786" href="A201706.ISLP.html#786" class="Bound">e</a> <a id="788" class="Symbol">(</a><a id="789" href="A201706.ISLP.html#319" class="InductiveConstructor">BOX</a> <a id="793" href="A201706.ISLP.html#793" class="Bound">M</a><a id="794" class="Symbol">)</a>      <a id="801" class="Symbol">=</a> <a id="803" href="A201706.ISLP.html#319" class="InductiveConstructor">BOX</a> <a id="807" href="A201706.ISLP.html#793" class="Bound">M</a>
  <a id="811" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="818" href="A201706.ISLP.html#818" class="Bound">z</a> <a id="820" href="A201706.ISLP.html#820" class="Bound">e</a> <a id="822" class="Symbol">(</a><a id="823" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="829" href="A201706.ISLP.html#829" class="Bound">M</a> <a id="831" href="A201706.ISLP.html#831" class="Bound">N</a><a id="832" class="Symbol">)</a>  <a id="835" class="Symbol">=</a> <a id="837" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="843" class="Symbol">(</a><a id="844" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="851" href="A201706.ISLP.html#818" class="Bound">z</a> <a id="853" href="A201706.ISLP.html#820" class="Bound">e</a> <a id="855" href="A201706.ISLP.html#829" class="Bound">M</a><a id="856" class="Symbol">)</a> <a id="858" class="Symbol">(</a><a id="859" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="866" class="Symbol">(</a><a id="867" href="A201706.Prelude.html#6719" class="InductiveConstructor">lift</a> <a id="872" href="A201706.ISLP.html#818" class="Bound">z</a><a id="873" class="Symbol">)</a> <a id="875" href="A201706.ISLP.html#820" class="Bound">e</a> <a id="877" href="A201706.ISLP.html#831" class="Bound">N</a><a id="878" class="Symbol">)</a>

  <a id="monoTm⋆"></a><a id="883" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="891" class="Symbol">:</a> <a id="893" class="Symbol">∀</a> <a id="895" class="Symbol">{</a><a id="896" href="A201706.ISLP.html#896" class="Bound">d</a> <a id="898" href="A201706.ISLP.html#898" class="Bound">g</a> <a id="900" href="A201706.ISLP.html#900" class="Bound">d′</a> <a id="903" href="A201706.ISLP.html#903" class="Bound">g′</a> <a id="906" href="A201706.ISLP.html#906" class="Bound">n</a><a id="907" class="Symbol">}</a> <a id="909" class="Symbol">→</a> <a id="911" href="A201706.ISLP.html#900" class="Bound">d′</a> <a id="914" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="916" href="A201706.ISLP.html#896" class="Bound">d</a> <a id="918" class="Symbol">→</a> <a id="920" href="A201706.ISLP.html#903" class="Bound">g′</a> <a id="923" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="925" href="A201706.ISLP.html#898" class="Bound">g</a> <a id="927" class="Symbol">→</a> <a id="929" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="933" href="A201706.ISLP.html#896" class="Bound">d</a> <a id="935" href="A201706.ISLP.html#898" class="Bound">g</a> <a id="937" href="A201706.ISLP.html#906" class="Bound">n</a> <a id="939" class="Symbol">→</a> <a id="941" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="945" href="A201706.ISLP.html#900" class="Bound">d′</a> <a id="948" href="A201706.ISLP.html#903" class="Bound">g′</a> <a id="951" href="A201706.ISLP.html#906" class="Bound">n</a>
  <a id="955" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="963" href="A201706.ISLP.html#963" class="Bound">z</a> <a id="965" href="A201706.ISLP.html#965" class="Bound">e</a> <a id="967" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="975" class="Symbol">=</a> <a id="977" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
  <a id="981" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="989" href="A201706.ISLP.html#989" class="Bound">z</a> <a id="991" href="A201706.ISLP.html#991" class="Bound">e</a> <a id="993" class="Symbol">(</a><a id="994" href="A201706.ISLP.html#994" class="Bound">x</a> <a id="996" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="998" href="A201706.ISLP.html#998" class="Bound">M</a><a id="999" class="Symbol">)</a> <a id="1001" class="Symbol">=</a> <a id="1003" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="1011" href="A201706.ISLP.html#989" class="Bound">z</a> <a id="1013" href="A201706.ISLP.html#991" class="Bound">e</a> <a id="1015" href="A201706.ISLP.html#994" class="Bound">x</a> <a id="1017" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1019" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="1026" href="A201706.ISLP.html#989" class="Bound">z</a> <a id="1028" href="A201706.ISLP.html#991" class="Bound">e</a> <a id="1030" href="A201706.ISLP.html#998" class="Bound">M</a>
  <a id="1034" class="Comment">-- NOTE: Equivalent, but does not pass termination check.</a>
  <a id="1094" class="Comment">-- monoTm⋆ z e x = map (monoTm z e) x</a>

<a id="1133" class="Keyword">mutual</a>
  <a id="idmonoTm"></a><a id="1142" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1151" class="Symbol">:</a> <a id="1153" class="Symbol">∀</a> <a id="1155" class="Symbol">{</a><a id="1156" href="A201706.ISLP.html#1156" class="Bound">d</a> <a id="1158" href="A201706.ISLP.html#1158" class="Bound">g</a><a id="1159" class="Symbol">}</a> <a id="1161" class="Symbol">→</a> <a id="1163" class="Symbol">(</a><a id="1164" href="A201706.ISLP.html#1164" class="Bound">M</a> <a id="1166" class="Symbol">:</a> <a id="1168" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="1171" href="A201706.ISLP.html#1156" class="Bound">d</a> <a id="1173" href="A201706.ISLP.html#1158" class="Bound">g</a><a id="1174" class="Symbol">)</a> <a id="1176" class="Symbol">→</a> <a id="1178" href="A201706.ISLP.html#470" class="Function">monoTm</a> <a id="1185" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1191" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1197" href="A201706.ISLP.html#1164" class="Bound">M</a> <a id="1199" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1201" href="A201706.ISLP.html#1164" class="Bound">M</a>
  <a id="1205" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1214" class="Symbol">(</a><a id="1215" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="1219" href="A201706.ISLP.html#1219" class="Bound">i</a><a id="1220" class="Symbol">)</a>      <a id="1227" class="Symbol">=</a> <a id="1229" href="A201706.Prelude.html#1240" class="Function">cong</a> <a id="1234" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="1238" class="Symbol">(</a><a id="1239" href="A201706.Prelude.html#9785" class="Function">idmonoFin</a> <a id="1249" href="A201706.ISLP.html#1219" class="Bound">i</a><a id="1250" class="Symbol">)</a>
  <a id="1254" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1263" class="Symbol">(</a><a id="1264" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a> <a id="1269" href="A201706.ISLP.html#1269" class="Bound">q</a> <a id="1271" href="A201706.ISLP.html#1271" class="Bound">p</a> <a id="1273" href="A201706.ISLP.html#1273" class="Bound">i</a><a id="1274" class="Symbol">)</a> <a id="1276" class="Symbol">=</a> <a id="1278" href="A201706.Prelude.html#1532" class="Function">cong³</a> <a id="1284" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a> <a id="1289" class="Symbol">(</a><a id="1290" href="A201706.ISLP.html#1539" class="Function">idmonoTm⋆</a> <a id="1300" href="A201706.ISLP.html#1269" class="Bound">q</a><a id="1301" class="Symbol">)</a> <a id="1303" class="Symbol">(</a><a id="1304" href="A201706.ISLP.html#1539" class="Function">idmonoTm⋆</a> <a id="1314" href="A201706.ISLP.html#1271" class="Bound">p</a><a id="1315" class="Symbol">)</a> <a id="1317" class="Symbol">(</a><a id="1318" href="A201706.Prelude.html#9785" class="Function">idmonoFin</a> <a id="1328" href="A201706.ISLP.html#1273" class="Bound">i</a><a id="1329" class="Symbol">)</a>
  <a id="1333" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1342" class="Symbol">(</a><a id="1343" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a> <a id="1347" href="A201706.ISLP.html#1347" class="Bound">M</a><a id="1348" class="Symbol">)</a>      <a id="1355" class="Symbol">=</a> <a id="1357" href="A201706.Prelude.html#1240" class="Function">cong</a> <a id="1362" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a> <a id="1366" class="Symbol">(</a><a id="1367" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1376" href="A201706.ISLP.html#1347" class="Bound">M</a><a id="1377" class="Symbol">)</a>
  <a id="1381" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1390" class="Symbol">(</a><a id="1391" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a> <a id="1395" href="A201706.ISLP.html#1395" class="Bound">M</a> <a id="1397" href="A201706.ISLP.html#1397" class="Bound">N</a><a id="1398" class="Symbol">)</a>    <a id="1403" class="Symbol">=</a> <a id="1405" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1411" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a> <a id="1415" class="Symbol">(</a><a id="1416" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1425" href="A201706.ISLP.html#1395" class="Bound">M</a><a id="1426" class="Symbol">)</a> <a id="1428" class="Symbol">(</a><a id="1429" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1438" href="A201706.ISLP.html#1397" class="Bound">N</a><a id="1439" class="Symbol">)</a>
  <a id="1443" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1452" class="Symbol">(</a><a id="1453" href="A201706.ISLP.html#319" class="InductiveConstructor">BOX</a> <a id="1457" href="A201706.ISLP.html#1457" class="Bound">M</a><a id="1458" class="Symbol">)</a>      <a id="1465" class="Symbol">=</a> <a id="1467" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1474" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1483" class="Symbol">(</a><a id="1484" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="1490" href="A201706.ISLP.html#1490" class="Bound">M</a> <a id="1492" href="A201706.ISLP.html#1492" class="Bound">N</a><a id="1493" class="Symbol">)</a>  <a id="1496" class="Symbol">=</a> <a id="1498" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1504" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="1510" class="Symbol">(</a><a id="1511" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1520" href="A201706.ISLP.html#1490" class="Bound">M</a><a id="1521" class="Symbol">)</a> <a id="1523" class="Symbol">(</a><a id="1524" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1533" href="A201706.ISLP.html#1492" class="Bound">N</a><a id="1534" class="Symbol">)</a>

  <a id="idmonoTm⋆"></a><a id="1539" href="A201706.ISLP.html#1539" class="Function">idmonoTm⋆</a> <a id="1549" class="Symbol">:</a> <a id="1551" class="Symbol">∀</a> <a id="1553" class="Symbol">{</a><a id="1554" href="A201706.ISLP.html#1554" class="Bound">d</a> <a id="1556" href="A201706.ISLP.html#1556" class="Bound">g</a> <a id="1558" href="A201706.ISLP.html#1558" class="Bound">n</a><a id="1559" class="Symbol">}</a> <a id="1561" class="Symbol">→</a> <a id="1563" class="Symbol">(</a><a id="1564" href="A201706.ISLP.html#1564" class="Bound">x</a> <a id="1566" class="Symbol">:</a> <a id="1568" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="1572" href="A201706.ISLP.html#1554" class="Bound">d</a> <a id="1574" href="A201706.ISLP.html#1556" class="Bound">g</a> <a id="1576" href="A201706.ISLP.html#1558" class="Bound">n</a><a id="1577" class="Symbol">)</a> <a id="1579" class="Symbol">→</a> <a id="1581" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="1589" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1595" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1601" href="A201706.ISLP.html#1564" class="Bound">x</a> <a id="1603" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1605" href="A201706.ISLP.html#1564" class="Bound">x</a>
  <a id="1609" href="A201706.ISLP.html#1539" class="Function">idmonoTm⋆</a> <a id="1619" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="1627" class="Symbol">=</a> <a id="1629" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1636" href="A201706.ISLP.html#1539" class="Function">idmonoTm⋆</a> <a id="1646" class="Symbol">(</a><a id="1647" href="A201706.ISLP.html#1647" class="Bound">x</a> <a id="1649" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1651" href="A201706.ISLP.html#1651" class="Bound">M</a><a id="1652" class="Symbol">)</a> <a id="1654" class="Symbol">=</a> <a id="1656" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1662" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">_,_</a> <a id="1666" class="Symbol">(</a><a id="1667" href="A201706.ISLP.html#1539" class="Function">idmonoTm⋆</a> <a id="1677" href="A201706.ISLP.html#1647" class="Bound">x</a><a id="1678" class="Symbol">)</a> <a id="1680" class="Symbol">(</a><a id="1681" href="A201706.ISLP.html#1142" class="Function">idmonoTm</a> <a id="1690" href="A201706.ISLP.html#1651" class="Bound">M</a><a id="1691" class="Symbol">)</a>

<a id="reflTm⋆"></a><a id="1694" href="A201706.ISLP.html#1694" class="Function">reflTm⋆</a> <a id="1702" class="Symbol">:</a> <a id="1704" class="Symbol">∀</a> <a id="1706" class="Symbol">{</a><a id="1707" href="A201706.ISLP.html#1707" class="Bound">d</a> <a id="1709" href="A201706.ISLP.html#1709" class="Bound">g</a><a id="1710" class="Symbol">}</a> <a id="1712" class="Symbol">→</a> <a id="1714" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="1718" href="A201706.ISLP.html#1707" class="Bound">d</a> <a id="1720" href="A201706.ISLP.html#1709" class="Bound">g</a> <a id="1722" href="A201706.ISLP.html#1709" class="Bound">g</a>
<a id="1724" href="A201706.ISLP.html#1694" class="Function">reflTm⋆</a> <a id="1732" class="Symbol">{</a><a id="1733" class="Argument">g</a> <a id="1735" class="Symbol">=</a> <a id="1737" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="1741" class="Symbol">}</a>  <a id="1744" class="Symbol">=</a> <a id="1746" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
<a id="1748" href="A201706.ISLP.html#1694" class="Function">reflTm⋆</a> <a id="1756" class="Symbol">{</a><a id="1757" class="Argument">g</a> <a id="1759" class="Symbol">=</a> <a id="1761" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1765" href="A201706.ISLP.html#1765" class="Bound">g</a><a id="1766" class="Symbol">}</a> <a id="1768" class="Symbol">=</a> <a id="1770" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="1778" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1784" class="Symbol">(</a><a id="1785" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="1790" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="1795" class="Symbol">)</a> <a id="1797" href="A201706.ISLP.html#1694" class="Function">reflTm⋆</a> <a id="1805" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1807" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="1811" href="A201706.Prelude.html#8767" class="InductiveConstructor">zero</a>

<a id="1817" class="Comment">-- TODO: What is going on here?</a>
<a id="1849" class="Comment">-- mreflTm⋆ : ∀ {d g} → Tm⋆ d g d</a>
<a id="1883" class="Comment">-- mreflTm⋆ {zero}  = ∅</a>
<a id="1907" class="Comment">-- mreflTm⋆ {suc d} =</a>
<a id="1929" class="Comment">--   monoTm⋆ (weak refl≥) refl≥ mreflTm⋆ ,</a>
<a id="1972" class="Comment">--   MVAR (monoTm⋆ (weak refl≥) done {!!}) {!!} zero</a>

<a id="lookupTm"></a><a id="2026" href="A201706.ISLP.html#2026" class="Function">lookupTm</a> <a id="2035" class="Symbol">:</a> <a id="2037" class="Symbol">∀</a> <a id="2039" class="Symbol">{</a><a id="2040" href="A201706.ISLP.html#2040" class="Bound">d</a> <a id="2042" href="A201706.ISLP.html#2042" class="Bound">g</a> <a id="2044" href="A201706.ISLP.html#2044" class="Bound">n</a><a id="2045" class="Symbol">}</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2053" href="A201706.ISLP.html#2040" class="Bound">d</a> <a id="2055" href="A201706.ISLP.html#2042" class="Bound">g</a> <a id="2057" href="A201706.ISLP.html#2044" class="Bound">n</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="2065" href="A201706.ISLP.html#2044" class="Bound">n</a> <a id="2067" class="Symbol">→</a> <a id="2069" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="2072" href="A201706.ISLP.html#2040" class="Bound">d</a> <a id="2074" href="A201706.ISLP.html#2042" class="Bound">g</a>
<a id="2076" href="A201706.ISLP.html#2026" class="Function">lookupTm</a> <a id="2085" href="A201706.ISLP.html#2085" class="Bound">x</a> <a id="2087" href="A201706.ISLP.html#2087" class="Bound">i</a> <a id="2089" class="Symbol">=</a> <a id="2091" href="A201706.PreludeVec.html#291" class="Function">lookup</a> <a id="2098" href="A201706.ISLP.html#2085" class="Bound">x</a> <a id="2100" href="A201706.ISLP.html#2087" class="Bound">i</a>

<a id="2103" class="Keyword">mutual</a>
  <a id="graftTm"></a><a id="2112" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2120" class="Symbol">:</a> <a id="2122" class="Symbol">∀</a> <a id="2124" class="Symbol">{</a><a id="2125" href="A201706.ISLP.html#2125" class="Bound">d</a> <a id="2127" href="A201706.ISLP.html#2127" class="Bound">g</a> <a id="2129" href="A201706.ISLP.html#2129" class="Bound">`g</a><a id="2131" class="Symbol">}</a> <a id="2133" class="Symbol">→</a> <a id="2135" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2139" href="A201706.ISLP.html#2125" class="Bound">d</a> <a id="2141" href="A201706.ISLP.html#2127" class="Bound">g</a> <a id="2143" href="A201706.ISLP.html#2129" class="Bound">`g</a> <a id="2146" class="Symbol">→</a> <a id="2148" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="2151" href="A201706.ISLP.html#2125" class="Bound">d</a> <a id="2153" href="A201706.ISLP.html#2129" class="Bound">`g</a> <a id="2156" class="Symbol">→</a> <a id="2158" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="2161" href="A201706.ISLP.html#2125" class="Bound">d</a> <a id="2163" href="A201706.ISLP.html#2127" class="Bound">g</a>
  <a id="2167" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2175" href="A201706.ISLP.html#2175" class="Bound">p</a> <a id="2177" class="Symbol">(</a><a id="2178" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="2182" href="A201706.ISLP.html#2182" class="Bound">i</a><a id="2183" class="Symbol">)</a>       <a id="2191" class="Symbol">=</a> <a id="2193" href="A201706.ISLP.html#2026" class="Function">lookupTm</a> <a id="2202" href="A201706.ISLP.html#2175" class="Bound">p</a> <a id="2204" href="A201706.ISLP.html#2182" class="Bound">i</a>
  <a id="2208" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2216" href="A201706.ISLP.html#2216" class="Bound">p</a> <a id="2218" class="Symbol">(</a><a id="2219" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a> <a id="2224" href="A201706.ISLP.html#2224" class="Bound">q</a> <a id="2226" href="A201706.ISLP.html#2226" class="Bound">p′</a> <a id="2229" href="A201706.ISLP.html#2229" class="Bound">i</a><a id="2230" class="Symbol">)</a> <a id="2232" class="Symbol">=</a> <a id="2234" href="A201706.ISLP.html#180" class="InductiveConstructor">MVAR</a> <a id="2239" href="A201706.ISLP.html#2224" class="Bound">q</a> <a id="2241" class="Symbol">(</a><a id="2242" href="A201706.ISLP.html#2533" class="Function">graftTm⋆</a> <a id="2251" href="A201706.ISLP.html#2216" class="Bound">p</a> <a id="2253" href="A201706.ISLP.html#2226" class="Bound">p′</a><a id="2255" class="Symbol">)</a> <a id="2257" href="A201706.ISLP.html#2229" class="Bound">i</a>
  <a id="2261" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2269" href="A201706.ISLP.html#2269" class="Bound">p</a> <a id="2271" class="Symbol">(</a><a id="2272" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a> <a id="2276" href="A201706.ISLP.html#2276" class="Bound">M</a><a id="2277" class="Symbol">)</a>       <a id="2285" class="Symbol">=</a> <a id="2287" href="A201706.ISLP.html#248" class="InductiveConstructor">LAM</a> <a id="2291" class="Symbol">(</a><a id="2292" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2300" class="Symbol">(</a><a id="2301" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="2309" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="2315" class="Symbol">(</a><a id="2316" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="2321" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="2326" class="Symbol">)</a> <a id="2328" href="A201706.ISLP.html#2269" class="Bound">p</a> <a id="2330" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="2332" href="A201706.ISLP.html#153" class="InductiveConstructor">VAR</a> <a id="2336" href="A201706.Prelude.html#8767" class="InductiveConstructor">zero</a><a id="2340" class="Symbol">)</a> <a id="2342" href="A201706.ISLP.html#2276" class="Bound">M</a><a id="2343" class="Symbol">)</a>
  <a id="2347" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2355" href="A201706.ISLP.html#2355" class="Bound">p</a> <a id="2357" class="Symbol">(</a><a id="2358" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a> <a id="2362" href="A201706.ISLP.html#2362" class="Bound">M</a> <a id="2364" href="A201706.ISLP.html#2364" class="Bound">N</a><a id="2365" class="Symbol">)</a>     <a id="2371" class="Symbol">=</a> <a id="2373" href="A201706.ISLP.html#282" class="InductiveConstructor">APP</a> <a id="2377" class="Symbol">(</a><a id="2378" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2386" href="A201706.ISLP.html#2355" class="Bound">p</a> <a id="2388" href="A201706.ISLP.html#2362" class="Bound">M</a><a id="2389" class="Symbol">)</a> <a id="2391" class="Symbol">(</a><a id="2392" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2400" href="A201706.ISLP.html#2355" class="Bound">p</a> <a id="2402" href="A201706.ISLP.html#2364" class="Bound">N</a><a id="2403" class="Symbol">)</a>
  <a id="2407" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2415" href="A201706.ISLP.html#2415" class="Bound">p</a> <a id="2417" class="Symbol">(</a><a id="2418" href="A201706.ISLP.html#319" class="InductiveConstructor">BOX</a> <a id="2422" href="A201706.ISLP.html#2422" class="Bound">M</a><a id="2423" class="Symbol">)</a>       <a id="2431" class="Symbol">=</a> <a id="2433" href="A201706.ISLP.html#319" class="InductiveConstructor">BOX</a> <a id="2437" href="A201706.ISLP.html#2422" class="Bound">M</a>
  <a id="2441" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2449" href="A201706.ISLP.html#2449" class="Bound">p</a> <a id="2451" class="Symbol">(</a><a id="2452" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="2458" href="A201706.ISLP.html#2458" class="Bound">M</a> <a id="2460" href="A201706.ISLP.html#2460" class="Bound">N</a><a id="2461" class="Symbol">)</a>   <a id="2465" class="Symbol">=</a> <a id="2467" href="A201706.ISLP.html#361" class="InductiveConstructor">UNBOX</a> <a id="2473" class="Symbol">(</a><a id="2474" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2482" href="A201706.ISLP.html#2449" class="Bound">p</a> <a id="2484" href="A201706.ISLP.html#2458" class="Bound">M</a><a id="2485" class="Symbol">)</a> <a id="2487" class="Symbol">(</a><a id="2488" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2496" class="Symbol">(</a><a id="2497" href="A201706.ISLP.html#883" class="Function">monoTm⋆</a> <a id="2505" class="Symbol">(</a><a id="2506" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="2511" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="2516" class="Symbol">)</a> <a id="2518" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="2524" href="A201706.ISLP.html#2449" class="Bound">p</a><a id="2525" class="Symbol">)</a> <a id="2527" href="A201706.ISLP.html#2460" class="Bound">N</a><a id="2528" class="Symbol">)</a>

  <a id="graftTm⋆"></a><a id="2533" href="A201706.ISLP.html#2533" class="Function">graftTm⋆</a> <a id="2542" class="Symbol">:</a> <a id="2544" class="Symbol">∀</a> <a id="2546" class="Symbol">{</a><a id="2547" href="A201706.ISLP.html#2547" class="Bound">d</a> <a id="2549" href="A201706.ISLP.html#2549" class="Bound">g</a> <a id="2551" href="A201706.ISLP.html#2551" class="Bound">`g</a> <a id="2554" href="A201706.ISLP.html#2554" class="Bound">n</a><a id="2555" class="Symbol">}</a> <a id="2557" class="Symbol">→</a> <a id="2559" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2563" href="A201706.ISLP.html#2547" class="Bound">d</a> <a id="2565" href="A201706.ISLP.html#2549" class="Bound">g</a> <a id="2567" href="A201706.ISLP.html#2551" class="Bound">`g</a> <a id="2570" class="Symbol">→</a> <a id="2572" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2576" href="A201706.ISLP.html#2547" class="Bound">d</a> <a id="2578" href="A201706.ISLP.html#2551" class="Bound">`g</a> <a id="2581" href="A201706.ISLP.html#2554" class="Bound">n</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2589" href="A201706.ISLP.html#2547" class="Bound">d</a> <a id="2591" href="A201706.ISLP.html#2549" class="Bound">g</a> <a id="2593" href="A201706.ISLP.html#2554" class="Bound">n</a>
  <a id="2597" href="A201706.ISLP.html#2533" class="Function">graftTm⋆</a> <a id="2606" href="A201706.ISLP.html#2606" class="Bound">p</a> <a id="2608" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="2616" class="Symbol">=</a> <a id="2618" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
  <a id="2622" href="A201706.ISLP.html#2533" class="Function">graftTm⋆</a> <a id="2631" href="A201706.ISLP.html#2631" class="Bound">p</a> <a id="2633" class="Symbol">(</a><a id="2634" href="A201706.ISLP.html#2634" class="Bound">x</a> <a id="2636" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="2638" href="A201706.ISLP.html#2638" class="Bound">M</a><a id="2639" class="Symbol">)</a> <a id="2641" class="Symbol">=</a> <a id="2643" href="A201706.ISLP.html#2533" class="Function">graftTm⋆</a> <a id="2652" href="A201706.ISLP.html#2631" class="Bound">p</a> <a id="2654" href="A201706.ISLP.html#2634" class="Bound">x</a> <a id="2656" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="2658" href="A201706.ISLP.html#2112" class="Function">graftTm</a> <a id="2666" href="A201706.ISLP.html#2631" class="Bound">p</a> <a id="2668" href="A201706.ISLP.html#2638" class="Bound">M</a>
  <a id="2672" class="Comment">-- NOTE: Equivalent, but does not pass termination check.</a>
  <a id="2732" class="Comment">-- graftTm⋆ p x = map (graftTm p) x</a>

<a id="transTm"></a><a id="2769" href="A201706.ISLP.html#2769" class="Function">transTm</a> <a id="2777" class="Symbol">:</a> <a id="2779" class="Symbol">∀</a> <a id="2781" class="Symbol">{</a><a id="2782" href="A201706.ISLP.html#2782" class="Bound">d</a> <a id="2784" href="A201706.ISLP.html#2784" class="Bound">g</a> <a id="2786" href="A201706.ISLP.html#2786" class="Bound">g′</a> <a id="2789" href="A201706.ISLP.html#2789" class="Bound">g″</a><a id="2791" class="Symbol">}</a> <a id="2793" class="Symbol">→</a> <a id="2795" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2799" href="A201706.ISLP.html#2782" class="Bound">d</a> <a id="2801" href="A201706.ISLP.html#2789" class="Bound">g″</a> <a id="2804" href="A201706.ISLP.html#2786" class="Bound">g′</a> <a id="2807" class="Symbol">→</a> <a id="2809" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2813" href="A201706.ISLP.html#2782" class="Bound">d</a> <a id="2815" href="A201706.ISLP.html#2786" class="Bound">g′</a> <a id="2818" href="A201706.ISLP.html#2784" class="Bound">g</a> <a id="2820" class="Symbol">→</a> <a id="2822" href="A201706.ISLP.html#403" class="Function">Tm⋆</a> <a id="2826" href="A201706.ISLP.html#2782" class="Bound">d</a> <a id="2828" href="A201706.ISLP.html#2789" class="Bound">g″</a> <a id="2831" href="A201706.ISLP.html#2784" class="Bound">g</a>
<a id="2833" href="A201706.ISLP.html#2769" class="Function">transTm</a> <a id="2841" class="Symbol">=</a> <a id="2843" href="A201706.ISLP.html#2533" class="Function">graftTm⋆</a>

<a id="2853" class="Comment">-- TODO: What is going on here?</a>
<a id="2885" class="Comment">-- mutual</a>
<a id="2895" class="Comment">--   mgraftTm : ∀ {d g `d} → Tm⋆ d zero `d → Tm `d g → Tm d g</a>
<a id="2957" class="Comment">--   mgraftTm q (VAR i)       = VAR i</a>
<a id="2995" class="Comment">--   mgraftTm q (MVAR q′ p i) = UNBOX (monoTm refl≥ inf≥ (lookupTm q i))</a>
<a id="3068" class="Comment">--                                    (MVAR (mgraftTm⋆ (monoTm⋆ (weak refl≥) refl≥ q) q′)</a>
<a id="3158" class="Comment">--                                          (mgraftTm⋆ (monoTm⋆ (weak refl≥) refl≥ q) p) zero)</a>
<a id="3253" class="Comment">--   mgraftTm q (LAM M)       = LAM (mgraftTm q M)</a>
<a id="3304" class="Comment">--   mgraftTm q (APP M N)     = APP (mgraftTm q M) (mgraftTm q N)</a>
<a id="3370" class="Comment">--   mgraftTm q (BOX M)       = BOX M</a>
<a id="3408" class="Comment">--   mgraftTm {g = g} q (UNBOX M N) =</a>
<a id="3446" class="Comment">--     UNBOX (mgraftTm q M)</a>
<a id="3474" class="Comment">--       (mgraftTm (monoTm⋆ (weak refl≥) refl≥ q ,</a>
<a id="3525" class="Comment">--        BOX {`g = g} (MVAR {!!} {!!} zero)) N)</a>
<a id="3574" class="Comment">--</a>
<a id="3577" class="Comment">--   mgraftTm⋆ : ∀ {d g `d n} → Tm⋆ d zero `d → Tm⋆ `d g n → Tm⋆ d g n</a>
<a id="3648" class="Comment">--   mgraftTm⋆ q ∅       = ∅</a>
<a id="3677" class="Comment">--   mgraftTm⋆ q (x , M) = mgraftTm⋆ q x , mgraftTm q M</a>
<a id="3733" class="Comment">--</a>
<a id="3736" class="Comment">-- mtransTm⋆ : ∀ {d d′ d″} → Tm⋆ d″ zero d′ → Tm⋆ d′ zero d → Tm⋆ d″ zero d</a>
<a id="3812" class="Comment">-- mtransTm⋆ = mgraftTm⋆</a>


<a id="3839" class="Comment">-- Types and vectors of types.</a>

<a id="3871" class="Keyword">mutual</a>
  <a id="3880" class="Keyword">infixr</a> <a id="3887" class="Number">7</a> <a id="3889" href="A201706.ISLP.html#3937" class="InductiveConstructor Operator">_⇒_</a>
  <a id="3895" class="Keyword">data</a> <a id="Ty"></a><a id="3900" href="A201706.ISLP.html#3900" class="Datatype">Ty</a> <a id="3903" class="Symbol">:</a> <a id="3905" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3909" class="Keyword">where</a>
    <a id="Ty.•"></a><a id="3919" href="A201706.ISLP.html#3919" class="InductiveConstructor">•</a>        <a id="3928" class="Symbol">:</a> <a id="3930" href="A201706.ISLP.html#3900" class="Datatype">Ty</a>
    <a id="Ty._⇒_"></a><a id="3937" href="A201706.ISLP.html#3937" class="InductiveConstructor Operator">_⇒_</a>     <a id="3945" class="Symbol">:</a> <a id="3947" href="A201706.ISLP.html#3900" class="Datatype">Ty</a> <a id="3950" class="Symbol">→</a> <a id="3952" href="A201706.ISLP.html#3900" class="Datatype">Ty</a> <a id="3955" class="Symbol">→</a> <a id="3957" href="A201706.ISLP.html#3900" class="Datatype">Ty</a>
    <a id="Ty.[_⁏_⊦_]_"></a><a id="3964" href="A201706.ISLP.html#3964" class="InductiveConstructor Operator">[_⁏_⊦_]_</a> <a id="3973" class="Symbol">:</a> <a id="3975" class="Symbol">∀</a> <a id="3977" class="Symbol">{</a><a id="3978" href="A201706.ISLP.html#3978" class="Bound">d</a> <a id="3980" href="A201706.ISLP.html#3980" class="Bound">g</a><a id="3981" class="Symbol">}</a> <a id="3983" class="Symbol">→</a> <a id="3985" href="A201706.ISLP.html#4244" class="Function">BoxTy⋆</a> <a id="3992" href="A201706.ISLP.html#3978" class="Bound">d</a> <a id="3994" class="Symbol">→</a> <a id="3996" href="A201706.ISLP.html#4206" class="Function">Ty⋆</a> <a id="4000" href="A201706.ISLP.html#3980" class="Bound">g</a> <a id="4002" class="Symbol">→</a> <a id="4004" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="4007" href="A201706.ISLP.html#3978" class="Bound">d</a> <a id="4009" href="A201706.ISLP.html#3980" class="Bound">g</a> <a id="4011" class="Symbol">→</a> <a id="4013" href="A201706.ISLP.html#3900" class="Datatype">Ty</a> <a id="4016" class="Symbol">→</a> <a id="4018" href="A201706.ISLP.html#3900" class="Datatype">Ty</a>

  <a id="4024" class="Keyword">record</a> <a id="BoxTy"></a><a id="4031" href="A201706.ISLP.html#4031" class="Record">BoxTy</a> <a id="4037" class="Symbol">:</a> <a id="4039" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="4043" class="Keyword">where</a>
    <a id="4053" class="Keyword">inductive</a>
    <a id="4067" class="Keyword">constructor</a> <a id="[_⁏_⊦_]_"></a><a id="4079" href="A201706.ISLP.html#4079" class="InductiveConstructor Operator">[_⁏_⊦_]_</a>
    <a id="4092" class="Keyword">field</a>
      <a id="4104" class="Symbol">{</a><a id="BoxTy.d"></a><a id="4105" href="A201706.ISLP.html#4105" class="Field">d</a><a id="4106" class="Symbol">}</a> <a id="4108" class="Symbol">:</a> <a id="4110" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
      <a id="4120" class="Symbol">{</a><a id="BoxTy.g"></a><a id="4121" href="A201706.ISLP.html#4121" class="Field">g</a><a id="4122" class="Symbol">}</a> <a id="4124" class="Symbol">:</a> <a id="4126" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
      <a id="BoxTy.Δ"></a><a id="4136" href="A201706.ISLP.html#4136" class="Field">Δ</a>   <a id="4140" class="Symbol">:</a> <a id="4142" href="A201706.ISLP.html#4244" class="Function">BoxTy⋆</a> <a id="4149" href="A201706.ISLP.html#4105" class="Field">d</a>
      <a id="BoxTy.Γ"></a><a id="4157" href="A201706.ISLP.html#4157" class="Field">Γ</a>   <a id="4161" class="Symbol">:</a> <a id="4163" href="A201706.ISLP.html#4206" class="Function">Ty⋆</a> <a id="4167" href="A201706.ISLP.html#4121" class="Field">g</a>
      <a id="BoxTy.M"></a><a id="4175" href="A201706.ISLP.html#4175" class="Field">M</a>   <a id="4179" class="Symbol">:</a> <a id="4181" href="A201706.ISLP.html#122" class="Datatype">Tm</a> <a id="4184" href="A201706.ISLP.html#4105" class="Field">d</a> <a id="4186" href="A201706.ISLP.html#4121" class="Field">g</a>
      <a id="BoxTy.A"></a><a id="4194" href="A201706.ISLP.html#4194" class="Field">A</a>   <a id="4198" class="Symbol">:</a> <a id="4200" href="A201706.ISLP.html#3900" class="Datatype">Ty</a>

  <a id="Ty⋆"></a><a id="4206" href="A201706.ISLP.html#4206" class="Function">Ty⋆</a> <a id="4210" class="Symbol">:</a> <a id="4212" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="4216" class="Symbol">→</a> <a id="4218" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="4224" href="A201706.ISLP.html#4206" class="Function">Ty⋆</a> <a id="4228" href="A201706.ISLP.html#4228" class="Bound">g</a> <a id="4230" class="Symbol">=</a> <a id="4232" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="4236" href="A201706.ISLP.html#3900" class="Datatype">Ty</a> <a id="4239" href="A201706.ISLP.html#4228" class="Bound">g</a>

  <a id="BoxTy⋆"></a><a id="4244" href="A201706.ISLP.html#4244" class="Function">BoxTy⋆</a> <a id="4251" class="Symbol">:</a> <a id="4253" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a> <a id="4257" class="Symbol">→</a> <a id="4259" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="4265" href="A201706.ISLP.html#4244" class="Function">BoxTy⋆</a> <a id="4272" href="A201706.ISLP.html#4272" class="Bound">d</a> <a id="4274" class="Symbol">=</a> <a id="4276" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="4280" href="A201706.ISLP.html#4031" class="Record">BoxTy</a> <a id="4286" href="A201706.ISLP.html#4272" class="Bound">d</a>
</pre></body></html>