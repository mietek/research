<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR3-Mutual</title><link rel="stylesheet" href="AgdaPP.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="A201802.WIP.LR3-Mutual.html" class="Module">A201802.WIP.LR3-Mutual</a> <a id="31" class="Keyword">where</a>

<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="66" class="Keyword">open</a> <a id="71" class="Keyword">import</a> <a id="78" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="149" class="Keyword">open</a> <a id="154" class="Keyword">import</a> <a id="161" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>

<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="A201802.LR0.html" class="Module">A201802.LR0</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="A201802.LR0Lemmas.html" class="Module">A201802.LR0Lemmas</a>
<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="A201802.LR1.html" class="Module">A201802.LR1</a>
<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="A201802.LR2.html" class="Module">A201802.LR2</a> <a id="333" class="Comment">-- TODO: which LR2?</a>


<a id="355" class="Comment">--------------------------------------------------------------------------------</a>


<a id="438" class="Comment">-- -- `SN _ A` is the strong normalisation predicate on terms at type `A`.</a>
<a id="513" class="Comment">-- mutual</a>
<a id="523" class="Comment">--   SN : Term 0 â†’ Type â†’ Set</a>
<a id="553" class="Comment">--   SN M A = âˆ™ âŠ¢ M â¦‚ A Ã— M â‡“ Ã— SN! M A</a>

<a id="594" class="Comment">--   SN! : Term 0 â†’ Type â†’ Set</a>
<a id="625" class="Comment">--   SN! M ğ”¹       = âŠ¤</a>
<a id="648" class="Comment">--   SN! M ğŸ™       = âŠ¤</a>
<a id="671" class="Comment">--   SN! M (A âˆ§ B) = âŠ¤</a>
<a id="694" class="Comment">--   SN! M (A âŠƒ B) = âˆ€ {N} â†’ SN N A â†’ SN (APP M N) B</a>


<a id="749" class="Comment">-- -- Every SN term is well-typed.</a>
<a id="784" class="Comment">-- derp : âˆ€ {A M} â†’ SN M A</a>
<a id="811" class="Comment">--                â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="841" class="Comment">-- derp (ğ’Ÿ , Mâ‡“ , s!) = ğ’Ÿ</a>


<a id="869" class="Comment">-- -- Every SN term terminates.</a>
<a id="901" class="Comment">-- herp : âˆ€ {A M} â†’ SN M A</a>
<a id="928" class="Comment">--                â†’ M â‡“</a>
<a id="952" class="Comment">-- herp (ğ’Ÿ , Mâ‡“ , s!) = Mâ‡“</a>


<a id="981" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1067" class="Comment">-- -- Small-step reduction IN REVERSE preserves SN.</a>
<a id="1119" class="Comment">-- mutual</a>
<a id="1129" class="Comment">--   snprâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1184" class="Comment">--                       â†’ SN M A</a>
<a id="1218" class="Comment">--   snprâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ (ğ’Ÿâ€² , Mâ€²â‡“ , s!â€²) = ğ’Ÿ , hprâ¤‡ Mâ¤‡Mâ€² Mâ€²â‡“ , sn!prâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ s!â€²</a>

<a id="1294" class="Comment">--   sn!prâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN! Mâ€² A</a>
<a id="1351" class="Comment">--                        â†’ SN! M A</a>
<a id="1387" class="Comment">--   sn!prâ¤‡ {ğ”¹}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="1422" class="Comment">--   sn!prâ¤‡ {ğŸ™}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="1457" class="Comment">--   sn!prâ¤‡ {A âˆ§ B} Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="1492" class="Comment">--   sn!prâ¤‡ {A âŠƒ B} Mâ¤‡Mâ€² ğ’Ÿ f s = snprâ¤‡ (cong-APP Mâ¤‡Mâ€²) (app ğ’Ÿ (derp s)) (f s)</a>


<a id="1572" class="Comment">-- -- Iterated small-step reduction IN REVERSE preserves SN.</a>
<a id="1633" class="Comment">-- snprâ¤‡* : âˆ€ {A M Mâ€²} â†’ M â¤‡* Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1688" class="Comment">--                      â†’ SN M A</a>
<a id="1721" class="Comment">-- snprâ¤‡* done                 ğ’Ÿ s = s</a>
<a id="1760" class="Comment">-- snprâ¤‡* (step Mâ¤‡Mâ€³ Mâ€³â¤‡*Mâ€²) ğ’Ÿ s = snprâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ (snprâ¤‡* Mâ€³â¤‡*Mâ€² (tpâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ) s)</a>


<a id="1841" class="Comment">-- -- Big-step reduction IN REVERSE preserves SN.</a>
<a id="1891" class="Comment">-- snprâ‡“ : âˆ€ {A M Mâ€²} â†’ M â‡“ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1944" class="Comment">--                    â†’ SN M A</a>
<a id="1975" class="Comment">-- snprâ‡“ (Mâ¤‡*Mâ€² , VMâ€²) ğ’Ÿ s = snprâ¤‡* Mâ¤‡*Mâ€² ğ’Ÿ s</a>


<a id="2023" class="Comment">-- -- If `M` is SN and `N` is SN, then `PAIR M N` is SN.</a>
<a id="2080" class="Comment">-- sn-PAIR : âˆ€ {A B M N} â†’ SN M A â†’ SN N B</a>
<a id="2123" class="Comment">--                       â†’ SN (PAIR M N) (A âˆ§ B)</a>
<a id="2172" class="Comment">-- sn-PAIR (ğ’Ÿ , Mâ‡“ , s!â‚) (â„° , Nâ‡“ , s!â‚‚) = pair ğ’Ÿ â„° , halt-PAIR Mâ‡“ Nâ‡“ , âˆ™</a>


<a id="2248" class="Comment">-- -- ???</a>
<a id="2258" class="Comment">-- mutual</a>
<a id="2268" class="Comment">--   sn-FST-PAIR : âˆ€ {A B M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="2335" class="Comment">--                                 â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="2404" class="Comment">--                                 â†’ SN (FST M) A</a>
<a id="2454" class="Comment">--   sn-FST-PAIR Mâ¤‡*PAIR ğ’Ÿ = fst ğ’Ÿ , halt-FST-PAIR Mâ¤‡*PAIR , sn!-FST-PAIR Mâ¤‡*PAIR ğ’Ÿ</a>

<a id="2539" class="Comment">--   sn!-FST-PAIR : âˆ€ {A B M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="2607" class="Comment">--                                  â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="2677" class="Comment">--                                  â†’ SN! (FST M) A</a>
<a id="2729" class="Comment">--   sn!-FST-PAIR {ğ”¹}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="2773" class="Comment">--   sn!-FST-PAIR {ğŸ™}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="2817" class="Comment">--   sn!-FST-PAIR {Aâ‚ âˆ§ Aâ‚‚} Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="2861" class="Comment">--   sn!-FST-PAIR {Aâ‚ âŠƒ Aâ‚‚} Mâ¤‡*PAIR ğ’Ÿ s = {!!}</a>
<a id="2908" class="Comment">--   -- snprâ¤‡* (congs-APP (reds-FST-PAIR Mâ¤‡*PAIR)) (app (fst ğ’Ÿ) (derp s)) ?</a>


<a id="2986" class="Comment">-- -- ???</a>
<a id="2996" class="Comment">-- mutual</a>
<a id="3006" class="Comment">--   sn-SND-PAIR : âˆ€ {A B M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="3073" class="Comment">--                                 â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="3142" class="Comment">--                                 â†’ SN (SND M) B</a>
<a id="3192" class="Comment">--   sn-SND-PAIR Mâ¤‡*PAIR ğ’Ÿ = snd ğ’Ÿ , halt-SND-PAIR Mâ¤‡*PAIR , sn!-SND-PAIR Mâ¤‡*PAIR ğ’Ÿ</a>

<a id="3277" class="Comment">--   sn!-SND-PAIR : âˆ€ {B A M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="3345" class="Comment">--                                  â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="3415" class="Comment">--                                  â†’ SN! (SND M) B</a>
<a id="3467" class="Comment">--   sn!-SND-PAIR {ğ”¹}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="3511" class="Comment">--   sn!-SND-PAIR {ğŸ™}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="3555" class="Comment">--   sn!-SND-PAIR {Bâ‚ âˆ§ Bâ‚‚} Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="3599" class="Comment">--   sn!-SND-PAIR {Bâ‚ âŠƒ Bâ‚‚} Mâ¤‡*PAIR ğ’Ÿ s = {!!}</a>
<a id="3646" class="Comment">--   -- snprâ¤‡* (congs-APP (reds-SND-PAIR Mâ¤‡*PAIR)) (app (snd ğ’Ÿ) (derp s)) ?</a>


<a id="3724" class="Comment">-- -- If `M` reduces to `TRUE` and `N` is SN, then `IF M N O` is SN.</a>
<a id="3793" class="Comment">-- mutual</a>
<a id="3803" class="Comment">--   sn-IF-TRUE : âˆ€ {C M N O} â†’ M â¤‡* TRUE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ SN N C â†’ âˆ™ âŠ¢ O â¦‚ C</a>
<a id="3878" class="Comment">--                            â†’ SN (IF M N O) C</a>
<a id="3926" class="Comment">--   sn-IF-TRUE Mâ¤‡*TRUE ğ’Ÿ (â„° , Nâ‡“ , s!) â„± = if ğ’Ÿ â„° â„± , halt-IF-TRUE Mâ¤‡*TRUE Nâ‡“ , sn!-IF-TRUE Mâ¤‡*TRUE ğ’Ÿ â„° â„± s!</a>

<a id="4037" class="Comment">--   sn!-IF-TRUE : âˆ€ {C M N O} â†’ M â¤‡* TRUE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ âˆ™ âŠ¢ O â¦‚ C â†’ SN! N C</a>
<a id="4126" class="Comment">--                             â†’ SN! (IF M N O) C</a>
<a id="4176" class="Comment">--   sn!-IF-TRUE {ğ”¹}     Mâ¤‡*TRUE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4223" class="Comment">--   sn!-IF-TRUE {ğŸ™}     Mâ¤‡*TRUE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4270" class="Comment">--   sn!-IF-TRUE {A âˆ§ B} Mâ¤‡*TRUE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4317" class="Comment">--   sn!-IF-TRUE {A âŠƒ B} Mâ¤‡*TRUE ğ’Ÿ â„° â„± f s = snprâ¤‡* (congs-APP (reds-IF-TRUE Mâ¤‡*TRUE done)) (app (if ğ’Ÿ â„° â„±) (derp s)) (f s)</a>


<a id="4443" class="Comment">-- -- If `M` reduces to `FALSE` and `O` is SN, then `IF M N O` is SN.</a>
<a id="4513" class="Comment">-- mutual</a>
<a id="4523" class="Comment">--   sn-IF-FALSE : âˆ€ {C M N O} â†’ M â¤‡* FALSE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ SN O C</a>
<a id="4600" class="Comment">--                             â†’ SN (IF M N O) C</a>
<a id="4649" class="Comment">--   sn-IF-FALSE Mâ¤‡*FALSE ğ’Ÿ â„° (â„± , Nâ‡“ , s!) = if ğ’Ÿ â„° â„± , halt-IF-FALSE Mâ¤‡*FALSE Nâ‡“ , sn!-IF-FALSE Mâ¤‡*FALSE ğ’Ÿ â„° â„± s!</a>

<a id="4766" class="Comment">--   sn!-IF-FALSE : âˆ€ {C M N O} â†’ M â¤‡* FALSE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ âˆ™ âŠ¢ O â¦‚ C â†’ SN! O C</a>
<a id="4857" class="Comment">--                              â†’ SN! (IF M N O) C</a>
<a id="4908" class="Comment">--   sn!-IF-FALSE {ğ”¹}     Mâ¤‡*FALSE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4957" class="Comment">--   sn!-IF-FALSE {ğŸ™}     Mâ¤‡*FALSE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="5006" class="Comment">--   sn!-IF-FALSE {A âˆ§ B} Mâ¤‡*FALSE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="5055" class="Comment">--   sn!-IF-FALSE {A âŠƒ B} Mâ¤‡*FALSE ğ’Ÿ â„° â„± f s = snprâ¤‡* (congs-APP (reds-IF-FALSE Mâ¤‡*FALSE done)) (app (if ğ’Ÿ â„° â„±) (derp s)) (f s)</a>


<a id="5185" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5271" class="Comment">-- -- Small-step reduction preserves SN.</a>
<a id="5312" class="Comment">-- mutual</a>
<a id="5322" class="Comment">--   snpâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="5375" class="Comment">--                      â†’ SN Mâ€² A</a>
<a id="5409" class="Comment">--   snpâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ (_ , Mâ‡“ , s!) = tpâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ , hpâ¤‡ Mâ¤‡Mâ€² Mâ‡“ , sn!pâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ s!</a>

<a id="5486" class="Comment">--   sn!pâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN! M A</a>
<a id="5541" class="Comment">--                       â†’ SN! Mâ€² A</a>
<a id="5577" class="Comment">--   sn!pâ¤‡ {ğ”¹}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="5611" class="Comment">--   sn!pâ¤‡ {ğŸ™}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="5645" class="Comment">--   sn!pâ¤‡ {A âˆ§ B} Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="5679" class="Comment">--   sn!pâ¤‡ {A âŠƒ B} Mâ¤‡Mâ€² ğ’Ÿ f s = snpâ¤‡ (cong-APP Mâ¤‡Mâ€²) (app ğ’Ÿ (derp s)) (f s)</a>


<a id="5757" class="Comment">-- -- Iterated small-step reduction preserves SN.</a>
<a id="5807" class="Comment">-- snpâ¤‡* : âˆ€ {A M Mâ€²} â†’ M â¤‡* Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="5860" class="Comment">--                     â†’ SN Mâ€² A</a>
<a id="5893" class="Comment">-- snpâ¤‡* done                 ğ’Ÿ s = s</a>
<a id="5931" class="Comment">-- snpâ¤‡* (step Mâ¤‡Mâ€³ Mâ€³â¤‡*Mâ€²) ğ’Ÿ s = snpâ¤‡* Mâ€³â¤‡*Mâ€² (tpâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ) (snpâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ s)</a>


<a id="6009" class="Comment">-- -- Big-step reduction preserves SN.</a>
<a id="6048" class="Comment">-- snpâ‡“ : âˆ€ {A M Mâ€²} â†’ M â‡“ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="6099" class="Comment">--                   â†’ SN Mâ€² A</a>
<a id="6130" class="Comment">-- snpâ‡“ (Mâ¤‡*Mâ€² , VMâ€²) ğ’Ÿ s = snpâ¤‡* Mâ¤‡*Mâ€² ğ’Ÿ s</a>


<a id="6176" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6262" class="Comment">-- -- `SNs Î“` is the strong normalisation predicate on substitutions at all types `Î“`.</a>
<a id="6349" class="Comment">-- SNs : âˆ€ {g} â†’ (Ï„ : Terms 0 g) â†’ Types g â†’ Set</a>
<a id="6398" class="Comment">-- SNs Ï„ Î“ = All (\ { (M , A) â†’ SN M A }) (zip Ï„ Î“)</a>


<a id="6452" class="Comment">-- -- Every SN substitution is well-typed.</a>
<a id="6495" class="Comment">-- derps : âˆ€ {g} â†’ {Ï„ : Terms 0 g} {Î“ : Types g}</a>
<a id="6544" class="Comment">--               â†’ SNs Ï„ Î“</a>
<a id="6571" class="Comment">--               â†’ âˆ™ âŠ¢ Ï„ â¦‚ Î“ all</a>
<a id="6604" class="Comment">-- derps Ïƒ = maps derp Ïƒ</a>


<a id="6631" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6717" class="Comment">-- -- TODO</a>
<a id="6728" class="Comment">-- red-APP-LAM-SUB : âˆ€ {g M N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Val N}}</a>
<a id="6793" class="Comment">--                             â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â¤‡ SUB (Ï„ , N) M</a>
<a id="6872" class="Comment">-- red-APP-LAM-SUB {M = M} {N} {Ï„} rewrite simp-CUT-SUB N Ï„ M â»Â¹ = red APP-LAM</a>


<a id="6953" class="Comment">-- -- TODO</a>
<a id="6964" class="Comment">-- big-red-APP-LAM-SUB : âˆ€ {g M Mâ€² N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="7051" class="Comment">--                                    â†’ SUB (Ï„ , N) M â‡“ Mâ€²</a>
<a id="7110" class="Comment">--                                    â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“ Mâ€²</a>
<a id="7185" class="Comment">-- big-red-APP-LAM-SUB {M = M} (SUBâ¤‡*Mâ€² , VMâ€²) = step (red-APP-LAM-SUB {M = M}) SUBâ¤‡*Mâ€² , VMâ€²</a>


<a id="7281" class="Comment">-- -- TODO</a>
<a id="7292" class="Comment">-- halt-APP-LAM-SUB : âˆ€ {g M N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="7373" class="Comment">--                              â†’ SUB (Ï„ , N) M â‡“</a>
<a id="7423" class="Comment">--                              â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“</a>
<a id="7489" class="Comment">-- halt-APP-LAM-SUB {M = M} (Mâ€² , SUBâ‡“Mâ€²) = Mâ€² , big-red-APP-LAM-SUB {M = M} SUBâ‡“Mâ€²</a>


<a id="7575" class="Comment">-- -- TODO</a>
<a id="7586" class="Comment">-- mutual</a>
<a id="7596" class="Comment">--   sn-APP-LAM-SUB : âˆ€ {B g M N A} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="7681" class="Comment">--                                  â†’ âˆ™ âŠ¢ SUB Ï„ (LAM M) â¦‚ A âŠƒ B â†’ âˆ™ âŠ¢ N â¦‚ A â†’ SN (SUB (Ï„ , N) M) B</a>
<a id="7780" class="Comment">--                                  â†’ SN (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="7855" class="Comment">--   sn-APP-LAM-SUB {M = M} ğ’Ÿ â„° (ğ’Ÿâ€² , SUBâ‡“ , s!) = app ğ’Ÿ â„° , halt-APP-LAM-SUB {M = M} SUBâ‡“ , sn!-APP-LAM-SUB {M = M} ğ’Ÿ â„° s!</a>

<a id="7980" class="Comment">--   sn!-APP-LAM-SUB : âˆ€ {B g M N A} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="8066" class="Comment">--                                   â†’ âˆ™ âŠ¢ SUB Ï„ (LAM M) â¦‚ A âŠƒ B â†’ âˆ™ âŠ¢ N â¦‚ A â†’ SN! (SUB (Ï„ , N) M) B</a>
<a id="8167" class="Comment">--                                   â†’ SN! (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="8244" class="Comment">--   sn!-APP-LAM-SUB {ğ”¹}       {M = M} ğ’Ÿ â„° âˆ™   = âˆ™</a>
<a id="8295" class="Comment">--   sn!-APP-LAM-SUB {ğŸ™}       {M = M} ğ’Ÿ â„° âˆ™   = âˆ™</a>
<a id="8346" class="Comment">--   sn!-APP-LAM-SUB {Bâ‚ âˆ§ Bâ‚‚} {M = M} ğ’Ÿ â„° âˆ™   = âˆ™</a>
<a id="8397" class="Comment">--   sn!-APP-LAM-SUB {Bâ‚ âŠƒ Bâ‚‚} {M = M} ğ’Ÿ â„° f s = snprâ¤‡ (cong-APP (red-APP-LAM-SUB {M = M})) (app (app ğ’Ÿ â„°) (derp s)) (f s)</a>


<a id="8522" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="8608" class="Comment">-- mutual</a>
<a id="8618" class="Comment">--   sn-SUB : âˆ€ {g M A} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="8691" class="Comment">--                      â†’ SNs Ï„ Î“ â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="8737" class="Comment">--                      â†’ SN (SUB Ï„ M) A</a>
<a id="8778" class="Comment">--   sn-SUB Ïƒ (var i)    = get Ïƒ (zipâˆ‹â‚‚ i)</a>
<a id="8821" class="Comment">--   sn-SUB Ïƒ (lam ğ’Ÿ)    = let ğ’Ÿâ€² = sub (derps Ïƒ) (lam ğ’Ÿ) in</a>
<a id="8882" class="Comment">--                           ğ’Ÿâ€² , (LAM _ , done , VLAM) , sn-SUB-LAM Ïƒ ğ’Ÿ ğ’Ÿâ€²</a>
<a id="8958" class="Comment">--   sn-SUB Ïƒ (app ğ’Ÿ â„°)  with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="8999" class="Comment">--   sn-SUB Ïƒ (app ğ’Ÿ â„°)  | ğ’Ÿâ€² , Mâ€²â‡“ , f = f (sn-SUB Ïƒ â„°)</a>
<a id="9056" class="Comment">--   sn-SUB Ïƒ (pair ğ’Ÿ â„°) = sn-PAIR (sn-SUB Ïƒ ğ’Ÿ) (sn-SUB Ïƒ â„°)</a>
<a id="9117" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="9158" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (Mâ€²       , SUBâ¤‡*Mâ€²   , VMâ€²)    , âˆ™ with tpâ¤‡* SUBâ¤‡*Mâ€² ğ’Ÿâ€²</a>
<a id="9247" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (LAM _    , _          , VLAM)   , âˆ™ | ()</a>
<a id="9321" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (UNIT     , _          , VUNIT)  , âˆ™ | ()</a>
<a id="9395" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (PAIR _ _ , SUBâ¤‡*PAIR , VPAIR)  , âˆ™ | pair _ _ = sn-FST-PAIR SUBâ¤‡*PAIR ğ’Ÿâ€²</a>
<a id="9501" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (TRUE     , _          , VTRUE)  , âˆ™ | ()</a>
<a id="9575" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (FALSE    , _          , VFALSE) , âˆ™ | ()</a>
<a id="9649" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="9690" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (Mâ€²       , SUBâ¤‡*Mâ€²   , VMâ€²)    , âˆ™ with tpâ¤‡* SUBâ¤‡*Mâ€² ğ’Ÿâ€²</a>
<a id="9779" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (LAM _    , _          , VLAM)   , âˆ™ | ()</a>
<a id="9853" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (UNIT     , _          , VUNIT)  , âˆ™ | ()</a>
<a id="9927" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (PAIR _ _ , SUBâ¤‡*PAIR , VPAIR)  , âˆ™ | pair _ _ = sn-SND-PAIR SUBâ¤‡*PAIR ğ’Ÿâ€²</a>
<a id="10033" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (TRUE     , _          , VTRUE)  , âˆ™ | ()</a>
<a id="10107" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (FALSE    , _          , VFALSE) , âˆ™ | ()</a>
<a id="10181" class="Comment">--   sn-SUB Ïƒ unit       = unit  , (UNIT  , done , VUNIT)  , âˆ™</a>
<a id="10244" class="Comment">--   sn-SUB Ïƒ true       = true  , (TRUE  , done , VTRUE)  , âˆ™</a>
<a id="10307" class="Comment">--   sn-SUB Ïƒ false      = false , (FALSE , done , VFALSE) , âˆ™</a>
<a id="10370" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="10411" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (Mâ€²       , SUBâ¤‡*Mâ€²    , VMâ€²)    , âˆ™ with tpâ¤‡* SUBâ¤‡*Mâ€² ğ’Ÿâ€²</a>
<a id="10501" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (LAM _    , _           , VLAM)   , âˆ™ | ()</a>
<a id="10576" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (UNIT     , _           , VUNIT)  , âˆ™ | ()</a>
<a id="10651" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (PAIR _ _ , _           , VPAIR)  , âˆ™ | ()</a>
<a id="10726" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (TRUE     , SUBâ¤‡*TRUE  , VTRUE)  , âˆ™ | true  = sn-IF-TRUE SUBâ¤‡*TRUE ğ’Ÿâ€² (sn-SUB Ïƒ â„°) (sub (derps Ïƒ) â„±)</a>
<a id="10860" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (FALSE    , SUBâ¤‡*FALSE , VFALSE) , âˆ™ | false = sn-IF-FALSE SUBâ¤‡*FALSE ğ’Ÿâ€² (sub (derps Ïƒ) â„°) (sn-SUB Ïƒ â„±)</a>

<a id="10997" class="Comment">--   sn-SUB-LAM : âˆ€ {g M N A B} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="11078" class="Comment">--                              â†’ SNs Ï„ Î“ â†’ Î“ , A âŠ¢ M â¦‚ B â†’ âˆ™ âŠ¢ LAM (SUB (LIFTS Ï„) M) â¦‚ A âŠƒ B â†’ SN N A</a>
<a id="11181" class="Comment">--                              â†’ SN (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="11252" class="Comment">--   sn-SUB-LAM {M = M} {{VÏ„}} Ïƒ ğ’Ÿ ğ’Ÿâ€² s@(â„° , (Nâ€² , Nâ‡“Nâ€²@(Nâ¤‡*Nâ€² , VNâ€²)) , s!)</a>
<a id="11329" class="Comment">--     = let sâ€² = snpâ‡“ Nâ‡“Nâ€² â„° s in</a>
<a id="11364" class="Comment">--         snprâ¤‡* (congs-APP-LAM Nâ¤‡*Nâ€²) (app ğ’Ÿâ€² â„°) (sn-APP-LAM-SUB {M = M} {{VÏ„}} {{VNâ€²}} ğ’Ÿâ€² (derp sâ€²) (sn-SUB {{VÏ„ , VNâ€²}} (Ïƒ , sâ€²) ğ’Ÿ))</a>


<a id="11503" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="11589" class="Comment">-- -- Every well-typed term is SN.</a>
<a id="11624" class="Comment">-- sn : âˆ€ {A M} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="11652" class="Comment">--              â†’ SN M A</a>
<a id="11677" class="Comment">-- sn {A} {M} ğ’Ÿ = subst (\ Mâ€² â†’ SN Mâ€² A) (id-SUB M) (sn-SUB âˆ™ ğ’Ÿ)</a>


<a id="11744" class="Comment">-- -- Every well-typed term terminates.</a>
<a id="11784" class="Comment">-- halt : âˆ€ {A M} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="11814" class="Comment">--                â†’ M â‡“</a>
<a id="11838" class="Comment">-- halt {A} ğ’Ÿ = herp {A} (sn ğ’Ÿ)</a>


<a id="11872" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>