<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR3-Mutual</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201802.WIP.LR3-Mutual.html" class="Module">A201802.WIP.LR3-Mutual</a> <a id="60" class="Keyword">where</a>

<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="232" class="Keyword">open</a> <a id="237" class="Keyword">import</a> <a id="244" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>

<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="A201802.LR0.html" class="Module">A201802.LR0</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="A201802.LR0Lemmas.html" class="Module">A201802.LR0Lemmas</a>
<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="A201802.LR1.html" class="Module">A201802.LR1</a>
<a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="A201802.LR2.html" class="Module">A201802.LR2</a> <a id="362" class="Comment">-- TODO: which LR2?</a>


<a id="384" class="Comment">--------------------------------------------------------------------------------</a>


<a id="467" class="Comment">-- -- `SN _ A` is the strong normalisation predicate on terms at type `A`.</a>
<a id="542" class="Comment">-- mutual</a>
<a id="552" class="Comment">--   SN : Term 0 â†’ Type â†’ Set</a>
<a id="582" class="Comment">--   SN M A = âˆ™ âŠ¢ M â¦‚ A Ã— M â‡“ Ã— SN! M A</a>

<a id="623" class="Comment">--   SN! : Term 0 â†’ Type â†’ Set</a>
<a id="654" class="Comment">--   SN! M ğ”¹       = âŠ¤</a>
<a id="677" class="Comment">--   SN! M ğŸ™       = âŠ¤</a>
<a id="700" class="Comment">--   SN! M (A âˆ§ B) = âŠ¤</a>
<a id="723" class="Comment">--   SN! M (A âŠƒ B) = âˆ€ {N} â†’ SN N A â†’ SN (APP M N) B</a>


<a id="778" class="Comment">-- -- Every SN term is well-typed.</a>
<a id="813" class="Comment">-- derp : âˆ€ {A M} â†’ SN M A</a>
<a id="840" class="Comment">--                â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="870" class="Comment">-- derp (ğ’Ÿ , Mâ‡“ , s!) = ğ’Ÿ</a>


<a id="898" class="Comment">-- -- Every SN term terminates.</a>
<a id="930" class="Comment">-- herp : âˆ€ {A M} â†’ SN M A</a>
<a id="957" class="Comment">--                â†’ M â‡“</a>
<a id="981" class="Comment">-- herp (ğ’Ÿ , Mâ‡“ , s!) = Mâ‡“</a>


<a id="1010" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1096" class="Comment">-- -- Small-step reduction IN REVERSE preserves SN.</a>
<a id="1148" class="Comment">-- mutual</a>
<a id="1158" class="Comment">--   snprâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1213" class="Comment">--                       â†’ SN M A</a>
<a id="1247" class="Comment">--   snprâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ (ğ’Ÿâ€² , Mâ€²â‡“ , s!â€²) = ğ’Ÿ , hprâ¤‡ Mâ¤‡Mâ€² Mâ€²â‡“ , sn!prâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ s!â€²</a>

<a id="1323" class="Comment">--   sn!prâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN! Mâ€² A</a>
<a id="1380" class="Comment">--                        â†’ SN! M A</a>
<a id="1416" class="Comment">--   sn!prâ¤‡ {ğ”¹}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="1451" class="Comment">--   sn!prâ¤‡ {ğŸ™}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="1486" class="Comment">--   sn!prâ¤‡ {A âˆ§ B} Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="1521" class="Comment">--   sn!prâ¤‡ {A âŠƒ B} Mâ¤‡Mâ€² ğ’Ÿ f s = snprâ¤‡ (cong-APP Mâ¤‡Mâ€²) (app ğ’Ÿ (derp s)) (f s)</a>


<a id="1601" class="Comment">-- -- Iterated small-step reduction IN REVERSE preserves SN.</a>
<a id="1662" class="Comment">-- snprâ¤‡* : âˆ€ {A M Mâ€²} â†’ M â¤‡* Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1717" class="Comment">--                      â†’ SN M A</a>
<a id="1750" class="Comment">-- snprâ¤‡* done                 ğ’Ÿ s = s</a>
<a id="1789" class="Comment">-- snprâ¤‡* (step Mâ¤‡Mâ€³ Mâ€³â¤‡*Mâ€²) ğ’Ÿ s = snprâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ (snprâ¤‡* Mâ€³â¤‡*Mâ€² (tpâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ) s)</a>


<a id="1870" class="Comment">-- -- Big-step reduction IN REVERSE preserves SN.</a>
<a id="1920" class="Comment">-- snprâ‡“ : âˆ€ {A M Mâ€²} â†’ M â‡“ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN Mâ€² A</a>
<a id="1973" class="Comment">--                    â†’ SN M A</a>
<a id="2004" class="Comment">-- snprâ‡“ (Mâ¤‡*Mâ€² , VMâ€²) ğ’Ÿ s = snprâ¤‡* Mâ¤‡*Mâ€² ğ’Ÿ s</a>


<a id="2052" class="Comment">-- -- If `M` is SN and `N` is SN, then `PAIR M N` is SN.</a>
<a id="2109" class="Comment">-- sn-PAIR : âˆ€ {A B M N} â†’ SN M A â†’ SN N B</a>
<a id="2152" class="Comment">--                       â†’ SN (PAIR M N) (A âˆ§ B)</a>
<a id="2201" class="Comment">-- sn-PAIR (ğ’Ÿ , Mâ‡“ , s!â‚) (â„° , Nâ‡“ , s!â‚‚) = pair ğ’Ÿ â„° , halt-PAIR Mâ‡“ Nâ‡“ , âˆ™</a>


<a id="2277" class="Comment">-- -- ???</a>
<a id="2287" class="Comment">-- mutual</a>
<a id="2297" class="Comment">--   sn-FST-PAIR : âˆ€ {A B M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="2364" class="Comment">--                                 â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="2433" class="Comment">--                                 â†’ SN (FST M) A</a>
<a id="2483" class="Comment">--   sn-FST-PAIR Mâ¤‡*PAIR ğ’Ÿ = fst ğ’Ÿ , halt-FST-PAIR Mâ¤‡*PAIR , sn!-FST-PAIR Mâ¤‡*PAIR ğ’Ÿ</a>

<a id="2568" class="Comment">--   sn!-FST-PAIR : âˆ€ {A B M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="2636" class="Comment">--                                  â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="2706" class="Comment">--                                  â†’ SN! (FST M) A</a>
<a id="2758" class="Comment">--   sn!-FST-PAIR {ğ”¹}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="2802" class="Comment">--   sn!-FST-PAIR {ğŸ™}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="2846" class="Comment">--   sn!-FST-PAIR {Aâ‚ âˆ§ Aâ‚‚} Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="2890" class="Comment">--   sn!-FST-PAIR {Aâ‚ âŠƒ Aâ‚‚} Mâ¤‡*PAIR ğ’Ÿ s = {!!}</a>
<a id="2937" class="Comment">--   -- snprâ¤‡* (congs-APP (reds-FST-PAIR Mâ¤‡*PAIR)) (app (fst ğ’Ÿ) (derp s)) ?</a>


<a id="3015" class="Comment">-- -- ???</a>
<a id="3025" class="Comment">-- mutual</a>
<a id="3035" class="Comment">--   sn-SND-PAIR : âˆ€ {A B M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="3102" class="Comment">--                                 â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="3171" class="Comment">--                                 â†’ SN (SND M) B</a>
<a id="3221" class="Comment">--   sn-SND-PAIR Mâ¤‡*PAIR ğ’Ÿ = snd ğ’Ÿ , halt-SND-PAIR Mâ¤‡*PAIR , sn!-SND-PAIR Mâ¤‡*PAIR ğ’Ÿ</a>

<a id="3306" class="Comment">--   sn!-SND-PAIR : âˆ€ {B A M Mâ€² Nâ€²} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="3374" class="Comment">--                                  â†’ M â¤‡* PAIR Mâ€² Nâ€² â†’ âˆ™ âŠ¢ M â¦‚ A âˆ§ B</a>
<a id="3444" class="Comment">--                                  â†’ SN! (SND M) B</a>
<a id="3496" class="Comment">--   sn!-SND-PAIR {ğ”¹}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="3540" class="Comment">--   sn!-SND-PAIR {ğŸ™}       Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="3584" class="Comment">--   sn!-SND-PAIR {Bâ‚ âˆ§ Bâ‚‚} Mâ¤‡*PAIR ğ’Ÿ   = âˆ™</a>
<a id="3628" class="Comment">--   sn!-SND-PAIR {Bâ‚ âŠƒ Bâ‚‚} Mâ¤‡*PAIR ğ’Ÿ s = {!!}</a>
<a id="3675" class="Comment">--   -- snprâ¤‡* (congs-APP (reds-SND-PAIR Mâ¤‡*PAIR)) (app (snd ğ’Ÿ) (derp s)) ?</a>


<a id="3753" class="Comment">-- -- If `M` reduces to `TRUE` and `N` is SN, then `IF M N O` is SN.</a>
<a id="3822" class="Comment">-- mutual</a>
<a id="3832" class="Comment">--   sn-IF-TRUE : âˆ€ {C M N O} â†’ M â¤‡* TRUE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ SN N C â†’ âˆ™ âŠ¢ O â¦‚ C</a>
<a id="3907" class="Comment">--                            â†’ SN (IF M N O) C</a>
<a id="3955" class="Comment">--   sn-IF-TRUE Mâ¤‡*TRUE ğ’Ÿ (â„° , Nâ‡“ , s!) â„± = if ğ’Ÿ â„° â„± , halt-IF-TRUE Mâ¤‡*TRUE Nâ‡“ , sn!-IF-TRUE Mâ¤‡*TRUE ğ’Ÿ â„° â„± s!</a>

<a id="4066" class="Comment">--   sn!-IF-TRUE : âˆ€ {C M N O} â†’ M â¤‡* TRUE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ âˆ™ âŠ¢ O â¦‚ C â†’ SN! N C</a>
<a id="4155" class="Comment">--                             â†’ SN! (IF M N O) C</a>
<a id="4205" class="Comment">--   sn!-IF-TRUE {ğ”¹}     Mâ¤‡*TRUE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4252" class="Comment">--   sn!-IF-TRUE {ğŸ™}     Mâ¤‡*TRUE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4299" class="Comment">--   sn!-IF-TRUE {A âˆ§ B} Mâ¤‡*TRUE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4346" class="Comment">--   sn!-IF-TRUE {A âŠƒ B} Mâ¤‡*TRUE ğ’Ÿ â„° â„± f s = snprâ¤‡* (congs-APP (reds-IF-TRUE Mâ¤‡*TRUE done)) (app (if ğ’Ÿ â„° â„±) (derp s)) (f s)</a>


<a id="4472" class="Comment">-- -- If `M` reduces to `FALSE` and `O` is SN, then `IF M N O` is SN.</a>
<a id="4542" class="Comment">-- mutual</a>
<a id="4552" class="Comment">--   sn-IF-FALSE : âˆ€ {C M N O} â†’ M â¤‡* FALSE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ SN O C</a>
<a id="4629" class="Comment">--                             â†’ SN (IF M N O) C</a>
<a id="4678" class="Comment">--   sn-IF-FALSE Mâ¤‡*FALSE ğ’Ÿ â„° (â„± , Nâ‡“ , s!) = if ğ’Ÿ â„° â„± , halt-IF-FALSE Mâ¤‡*FALSE Nâ‡“ , sn!-IF-FALSE Mâ¤‡*FALSE ğ’Ÿ â„° â„± s!</a>

<a id="4795" class="Comment">--   sn!-IF-FALSE : âˆ€ {C M N O} â†’ M â¤‡* FALSE â†’ âˆ™ âŠ¢ M â¦‚ ğ”¹ â†’ âˆ™ âŠ¢ N â¦‚ C â†’ âˆ™ âŠ¢ O â¦‚ C â†’ SN! O C</a>
<a id="4886" class="Comment">--                              â†’ SN! (IF M N O) C</a>
<a id="4937" class="Comment">--   sn!-IF-FALSE {ğ”¹}     Mâ¤‡*FALSE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="4986" class="Comment">--   sn!-IF-FALSE {ğŸ™}     Mâ¤‡*FALSE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="5035" class="Comment">--   sn!-IF-FALSE {A âˆ§ B} Mâ¤‡*FALSE ğ’Ÿ â„° â„± âˆ™   = âˆ™</a>
<a id="5084" class="Comment">--   sn!-IF-FALSE {A âŠƒ B} Mâ¤‡*FALSE ğ’Ÿ â„° â„± f s = snprâ¤‡* (congs-APP (reds-IF-FALSE Mâ¤‡*FALSE done)) (app (if ğ’Ÿ â„° â„±) (derp s)) (f s)</a>


<a id="5214" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="5300" class="Comment">-- -- Small-step reduction preserves SN.</a>
<a id="5341" class="Comment">-- mutual</a>
<a id="5351" class="Comment">--   snpâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="5404" class="Comment">--                      â†’ SN Mâ€² A</a>
<a id="5438" class="Comment">--   snpâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ (_ , Mâ‡“ , s!) = tpâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ , hpâ¤‡ Mâ¤‡Mâ€² Mâ‡“ , sn!pâ¤‡ Mâ¤‡Mâ€² ğ’Ÿ s!</a>

<a id="5515" class="Comment">--   sn!pâ¤‡ : âˆ€ {A M Mâ€²} â†’ M â¤‡ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN! M A</a>
<a id="5570" class="Comment">--                       â†’ SN! Mâ€² A</a>
<a id="5606" class="Comment">--   sn!pâ¤‡ {ğ”¹}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="5640" class="Comment">--   sn!pâ¤‡ {ğŸ™}     Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="5674" class="Comment">--   sn!pâ¤‡ {A âˆ§ B} Mâ¤‡Mâ€² ğ’Ÿ âˆ™   = âˆ™</a>
<a id="5708" class="Comment">--   sn!pâ¤‡ {A âŠƒ B} Mâ¤‡Mâ€² ğ’Ÿ f s = snpâ¤‡ (cong-APP Mâ¤‡Mâ€²) (app ğ’Ÿ (derp s)) (f s)</a>


<a id="5786" class="Comment">-- -- Iterated small-step reduction preserves SN.</a>
<a id="5836" class="Comment">-- snpâ¤‡* : âˆ€ {A M Mâ€²} â†’ M â¤‡* Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="5889" class="Comment">--                     â†’ SN Mâ€² A</a>
<a id="5922" class="Comment">-- snpâ¤‡* done                 ğ’Ÿ s = s</a>
<a id="5960" class="Comment">-- snpâ¤‡* (step Mâ¤‡Mâ€³ Mâ€³â¤‡*Mâ€²) ğ’Ÿ s = snpâ¤‡* Mâ€³â¤‡*Mâ€² (tpâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ) (snpâ¤‡ Mâ¤‡Mâ€³ ğ’Ÿ s)</a>


<a id="6038" class="Comment">-- -- Big-step reduction preserves SN.</a>
<a id="6077" class="Comment">-- snpâ‡“ : âˆ€ {A M Mâ€²} â†’ M â‡“ Mâ€² â†’ âˆ™ âŠ¢ M â¦‚ A â†’ SN M A</a>
<a id="6128" class="Comment">--                   â†’ SN Mâ€² A</a>
<a id="6159" class="Comment">-- snpâ‡“ (Mâ¤‡*Mâ€² , VMâ€²) ğ’Ÿ s = snpâ¤‡* Mâ¤‡*Mâ€² ğ’Ÿ s</a>


<a id="6205" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6291" class="Comment">-- -- `SNs Î“` is the strong normalisation predicate on substitutions at all types `Î“`.</a>
<a id="6378" class="Comment">-- SNs : âˆ€ {g} â†’ (Ï„ : Terms 0 g) â†’ Types g â†’ Set</a>
<a id="6427" class="Comment">-- SNs Ï„ Î“ = All (\ { (M , A) â†’ SN M A }) (zip Ï„ Î“)</a>


<a id="6481" class="Comment">-- -- Every SN substitution is well-typed.</a>
<a id="6524" class="Comment">-- derps : âˆ€ {g} â†’ {Ï„ : Terms 0 g} {Î“ : Types g}</a>
<a id="6573" class="Comment">--               â†’ SNs Ï„ Î“</a>
<a id="6600" class="Comment">--               â†’ âˆ™ âŠ¢ Ï„ â¦‚ Î“ all</a>
<a id="6633" class="Comment">-- derps Ïƒ = maps derp Ïƒ</a>


<a id="6660" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="6746" class="Comment">-- -- TODO</a>
<a id="6757" class="Comment">-- red-APP-LAM-SUB : âˆ€ {g M N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Val N}}</a>
<a id="6822" class="Comment">--                             â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â¤‡ SUB (Ï„ , N) M</a>
<a id="6901" class="Comment">-- red-APP-LAM-SUB {M = M} {N} {Ï„} rewrite simp-CUT-SUB N Ï„ M â»Â¹ = red APP-LAM</a>


<a id="6982" class="Comment">-- -- TODO</a>
<a id="6993" class="Comment">-- big-red-APP-LAM-SUB : âˆ€ {g M Mâ€² N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="7080" class="Comment">--                                    â†’ SUB (Ï„ , N) M â‡“ Mâ€²</a>
<a id="7139" class="Comment">--                                    â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“ Mâ€²</a>
<a id="7214" class="Comment">-- big-red-APP-LAM-SUB {M = M} (SUBâ¤‡*Mâ€² , VMâ€²) = step (red-APP-LAM-SUB {M = M}) SUBâ¤‡*Mâ€² , VMâ€²</a>


<a id="7310" class="Comment">-- -- TODO</a>
<a id="7321" class="Comment">-- halt-APP-LAM-SUB : âˆ€ {g M N} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="7402" class="Comment">--                              â†’ SUB (Ï„ , N) M â‡“</a>
<a id="7452" class="Comment">--                              â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“</a>
<a id="7518" class="Comment">-- halt-APP-LAM-SUB {M = M} (Mâ€² , SUBâ‡“Mâ€²) = Mâ€² , big-red-APP-LAM-SUB {M = M} SUBâ‡“Mâ€²</a>


<a id="7604" class="Comment">-- -- TODO</a>
<a id="7615" class="Comment">-- mutual</a>
<a id="7625" class="Comment">--   sn-APP-LAM-SUB : âˆ€ {B g M N A} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="7710" class="Comment">--                                  â†’ âˆ™ âŠ¢ SUB Ï„ (LAM M) â¦‚ A âŠƒ B â†’ âˆ™ âŠ¢ N â¦‚ A â†’ SN (SUB (Ï„ , N) M) B</a>
<a id="7809" class="Comment">--                                  â†’ SN (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="7884" class="Comment">--   sn-APP-LAM-SUB {M = M} ğ’Ÿ â„° (ğ’Ÿâ€² , SUBâ‡“ , s!) = app ğ’Ÿ â„° , halt-APP-LAM-SUB {M = M} SUBâ‡“ , sn!-APP-LAM-SUB {M = M} ğ’Ÿ â„° s!</a>

<a id="8009" class="Comment">--   sn!-APP-LAM-SUB : âˆ€ {B g M N A} â†’ {Ï„ : Terms 0 g} â†’ {{_ : Vals Ï„}} {{_ : Val N}}</a>
<a id="8095" class="Comment">--                                   â†’ âˆ™ âŠ¢ SUB Ï„ (LAM M) â¦‚ A âŠƒ B â†’ âˆ™ âŠ¢ N â¦‚ A â†’ SN! (SUB (Ï„ , N) M) B</a>
<a id="8196" class="Comment">--                                   â†’ SN! (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="8273" class="Comment">--   sn!-APP-LAM-SUB {ğ”¹}       {M = M} ğ’Ÿ â„° âˆ™   = âˆ™</a>
<a id="8324" class="Comment">--   sn!-APP-LAM-SUB {ğŸ™}       {M = M} ğ’Ÿ â„° âˆ™   = âˆ™</a>
<a id="8375" class="Comment">--   sn!-APP-LAM-SUB {Bâ‚ âˆ§ Bâ‚‚} {M = M} ğ’Ÿ â„° âˆ™   = âˆ™</a>
<a id="8426" class="Comment">--   sn!-APP-LAM-SUB {Bâ‚ âŠƒ Bâ‚‚} {M = M} ğ’Ÿ â„° f s = snprâ¤‡ (cong-APP (red-APP-LAM-SUB {M = M})) (app (app ğ’Ÿ â„°) (derp s)) (f s)</a>


<a id="8551" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="8637" class="Comment">-- mutual</a>
<a id="8647" class="Comment">--   sn-SUB : âˆ€ {g M A} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="8720" class="Comment">--                      â†’ SNs Ï„ Î“ â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="8766" class="Comment">--                      â†’ SN (SUB Ï„ M) A</a>
<a id="8807" class="Comment">--   sn-SUB Ïƒ (var i)    = get Ïƒ (zipâˆ‹â‚‚ i)</a>
<a id="8850" class="Comment">--   sn-SUB Ïƒ (lam ğ’Ÿ)    = let ğ’Ÿâ€² = sub (derps Ïƒ) (lam ğ’Ÿ) in</a>
<a id="8911" class="Comment">--                           ğ’Ÿâ€² , (LAM _ , done , VLAM) , sn-SUB-LAM Ïƒ ğ’Ÿ ğ’Ÿâ€²</a>
<a id="8987" class="Comment">--   sn-SUB Ïƒ (app ğ’Ÿ â„°)  with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="9028" class="Comment">--   sn-SUB Ïƒ (app ğ’Ÿ â„°)  | ğ’Ÿâ€² , Mâ€²â‡“ , f = f (sn-SUB Ïƒ â„°)</a>
<a id="9085" class="Comment">--   sn-SUB Ïƒ (pair ğ’Ÿ â„°) = sn-PAIR (sn-SUB Ïƒ ğ’Ÿ) (sn-SUB Ïƒ â„°)</a>
<a id="9146" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="9187" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (Mâ€²       , SUBâ¤‡*Mâ€²   , VMâ€²)    , âˆ™ with tpâ¤‡* SUBâ¤‡*Mâ€² ğ’Ÿâ€²</a>
<a id="9276" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (LAM _    , _          , VLAM)   , âˆ™ | ()</a>
<a id="9350" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (UNIT     , _          , VUNIT)  , âˆ™ | ()</a>
<a id="9424" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (PAIR _ _ , SUBâ¤‡*PAIR , VPAIR)  , âˆ™ | pair _ _ = sn-FST-PAIR SUBâ¤‡*PAIR ğ’Ÿâ€²</a>
<a id="9530" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (TRUE     , _          , VTRUE)  , âˆ™ | ()</a>
<a id="9604" class="Comment">--   sn-SUB Ïƒ (fst ğ’Ÿ)    | ğ’Ÿâ€² , (FALSE    , _          , VFALSE) , âˆ™ | ()</a>
<a id="9678" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="9719" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (Mâ€²       , SUBâ¤‡*Mâ€²   , VMâ€²)    , âˆ™ with tpâ¤‡* SUBâ¤‡*Mâ€² ğ’Ÿâ€²</a>
<a id="9808" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (LAM _    , _          , VLAM)   , âˆ™ | ()</a>
<a id="9882" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (UNIT     , _          , VUNIT)  , âˆ™ | ()</a>
<a id="9956" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (PAIR _ _ , SUBâ¤‡*PAIR , VPAIR)  , âˆ™ | pair _ _ = sn-SND-PAIR SUBâ¤‡*PAIR ğ’Ÿâ€²</a>
<a id="10062" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (TRUE     , _          , VTRUE)  , âˆ™ | ()</a>
<a id="10136" class="Comment">--   sn-SUB Ïƒ (snd ğ’Ÿ)    | ğ’Ÿâ€² , (FALSE    , _          , VFALSE) , âˆ™ | ()</a>
<a id="10210" class="Comment">--   sn-SUB Ïƒ unit       = unit  , (UNIT  , done , VUNIT)  , âˆ™</a>
<a id="10273" class="Comment">--   sn-SUB Ïƒ true       = true  , (TRUE  , done , VTRUE)  , âˆ™</a>
<a id="10336" class="Comment">--   sn-SUB Ïƒ false      = false , (FALSE , done , VFALSE) , âˆ™</a>
<a id="10399" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) with sn-SUB Ïƒ ğ’Ÿ</a>
<a id="10440" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (Mâ€²       , SUBâ¤‡*Mâ€²    , VMâ€²)    , âˆ™ with tpâ¤‡* SUBâ¤‡*Mâ€² ğ’Ÿâ€²</a>
<a id="10530" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (LAM _    , _           , VLAM)   , âˆ™ | ()</a>
<a id="10605" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (UNIT     , _           , VUNIT)  , âˆ™ | ()</a>
<a id="10680" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (PAIR _ _ , _           , VPAIR)  , âˆ™ | ()</a>
<a id="10755" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (TRUE     , SUBâ¤‡*TRUE  , VTRUE)  , âˆ™ | true  = sn-IF-TRUE SUBâ¤‡*TRUE ğ’Ÿâ€² (sn-SUB Ïƒ â„°) (sub (derps Ïƒ) â„±)</a>
<a id="10889" class="Comment">--   sn-SUB Ïƒ (if ğ’Ÿ â„° â„±) | ğ’Ÿâ€² , (FALSE    , SUBâ¤‡*FALSE , VFALSE) , âˆ™ | false = sn-IF-FALSE SUBâ¤‡*FALSE ğ’Ÿâ€² (sub (derps Ïƒ) â„°) (sn-SUB Ïƒ â„±)</a>

<a id="11026" class="Comment">--   sn-SUB-LAM : âˆ€ {g M N A B} â†’ {Ï„ : Terms 0 g} {Î“ : Types g} â†’ {{_ : Vals Ï„}}</a>
<a id="11107" class="Comment">--                              â†’ SNs Ï„ Î“ â†’ Î“ , A âŠ¢ M â¦‚ B â†’ âˆ™ âŠ¢ LAM (SUB (LIFTS Ï„) M) â¦‚ A âŠƒ B â†’ SN N A</a>
<a id="11210" class="Comment">--                              â†’ SN (APP (LAM (SUB (LIFTS Ï„) M)) N) B</a>
<a id="11281" class="Comment">--   sn-SUB-LAM {M = M} {{VÏ„}} Ïƒ ğ’Ÿ ğ’Ÿâ€² s@(â„° , (Nâ€² , Nâ‡“Nâ€²@(Nâ¤‡*Nâ€² , VNâ€²)) , s!)</a>
<a id="11358" class="Comment">--     = let sâ€² = snpâ‡“ Nâ‡“Nâ€² â„° s in</a>
<a id="11393" class="Comment">--         snprâ¤‡* (congs-APP-LAM Nâ¤‡*Nâ€²) (app ğ’Ÿâ€² â„°) (sn-APP-LAM-SUB {M = M} {{VÏ„}} {{VNâ€²}} ğ’Ÿâ€² (derp sâ€²) (sn-SUB {{VÏ„ , VNâ€²}} (Ïƒ , sâ€²) ğ’Ÿ))</a>


<a id="11532" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="11618" class="Comment">-- -- Every well-typed term is SN.</a>
<a id="11653" class="Comment">-- sn : âˆ€ {A M} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="11681" class="Comment">--              â†’ SN M A</a>
<a id="11706" class="Comment">-- sn {A} {M} ğ’Ÿ = subst (\ Mâ€² â†’ SN Mâ€² A) (id-SUB M) (sn-SUB âˆ™ ğ’Ÿ)</a>


<a id="11773" class="Comment">-- -- Every well-typed term terminates.</a>
<a id="11813" class="Comment">-- halt : âˆ€ {A M} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="11843" class="Comment">--                â†’ M â‡“</a>
<a id="11867" class="Comment">-- halt {A} ğ’Ÿ = herp {A} (sn ğ’Ÿ)</a>


<a id="11901" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>