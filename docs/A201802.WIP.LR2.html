<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR2</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201802.WIP.LR2.html" class="Module">A201802.WIP.LR2</a> <a id="53" class="Keyword">where</a>

<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>

<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="A201802.LR0.html" class="Module">A201802.LR0</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="A201802.LR0Lemmas.html" class="Module">A201802.LR0Lemmas</a>
<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="A201802.LR1.html" class="Module">A201802.LR1</a>


<a id="333" class="Comment">--------------------------------------------------------------------------------</a>


<a id="416" class="Comment">-- `Val M` says that the term `M` is a value.</a>
<a id="462" class="Keyword">data</a> <a id="Val"></a><a id="467" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="471" class="Symbol">{</a><a id="472" href="A201802.WIP.LR2.html#472" class="Bound">g</a><a id="473" class="Symbol">}</a> <a id="475" class="Symbol">:</a> <a id="477" href="A201802.LR0.html#576" class="Datatype">Term</a> <a id="482" href="A201802.WIP.LR2.html#472" class="Bound">g</a> <a id="484" class="Symbol">â†’</a> <a id="486" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="492" class="Keyword">where</a>
    <a id="502" class="Keyword">instance</a>
      <a id="Val.val-lam"></a><a id="517" href="A201802.WIP.LR2.html#517" class="InductiveConstructor">val-lam</a>   <a id="527" class="Symbol">:</a> <a id="529" class="Symbol">âˆ€</a> <a id="531" class="Symbol">{</a><a id="532" href="A201802.WIP.LR2.html#532" class="Bound">M</a><a id="533" class="Symbol">}</a> <a id="535" class="Symbol">â†’</a> <a id="537" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="541" class="Symbol">(</a><a id="542" href="A201802.LR0.html#636" class="InductiveConstructor">LAM</a> <a id="546" href="A201802.WIP.LR2.html#532" class="Bound">M</a><a id="547" class="Symbol">)</a>
      <a id="Val.val-pair"></a><a id="555" href="A201802.WIP.LR2.html#555" class="InductiveConstructor">val-pair</a>  <a id="565" class="Symbol">:</a> <a id="567" class="Symbol">âˆ€</a> <a id="569" class="Symbol">{</a><a id="570" href="A201802.WIP.LR2.html#570" class="Bound">M</a> <a id="572" href="A201802.WIP.LR2.html#572" class="Bound">N</a><a id="573" class="Symbol">}</a> <a id="575" class="Symbol">â†’</a> <a id="577" class="Symbol">{{</a><a id="579" href="A201802.WIP.LR2.html#579" class="Bound">_</a> <a id="581" class="Symbol">:</a> <a id="583" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="587" href="A201802.WIP.LR2.html#570" class="Bound">M</a><a id="588" class="Symbol">}}</a> <a id="591" class="Symbol">{{</a><a id="593" href="A201802.WIP.LR2.html#593" class="Bound">_</a> <a id="595" class="Symbol">:</a> <a id="597" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="601" href="A201802.WIP.LR2.html#572" class="Bound">N</a><a id="602" class="Symbol">}}</a> <a id="605" class="Symbol">â†’</a> <a id="607" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="611" class="Symbol">(</a><a id="612" href="A201802.LR0.html#707" class="InductiveConstructor">PAIR</a> <a id="617" href="A201802.WIP.LR2.html#570" class="Bound">M</a> <a id="619" href="A201802.WIP.LR2.html#572" class="Bound">N</a><a id="620" class="Symbol">)</a>
      <a id="Val.val-unit"></a><a id="628" href="A201802.WIP.LR2.html#628" class="InductiveConstructor">val-unit</a>  <a id="638" class="Symbol">:</a> <a id="640" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="644" href="A201802.LR0.html#800" class="InductiveConstructor">UNIT</a>
      <a id="Val.val-left"></a><a id="655" href="A201802.WIP.LR2.html#655" class="InductiveConstructor">val-left</a>  <a id="665" class="Symbol">:</a> <a id="667" class="Symbol">âˆ€</a> <a id="669" class="Symbol">{</a><a id="670" href="A201802.WIP.LR2.html#670" class="Bound">M</a><a id="671" class="Symbol">}</a> <a id="673" class="Symbol">â†’</a> <a id="675" class="Symbol">{{</a><a id="677" href="A201802.WIP.LR2.html#677" class="Bound">_</a> <a id="679" class="Symbol">:</a> <a id="681" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="685" href="A201802.WIP.LR2.html#670" class="Bound">M</a><a id="686" class="Symbol">}}</a> <a id="689" class="Symbol">â†’</a> <a id="691" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="695" class="Symbol">(</a><a id="696" href="A201802.LR0.html#847" class="InductiveConstructor">LEFT</a> <a id="701" href="A201802.WIP.LR2.html#670" class="Bound">M</a><a id="702" class="Symbol">)</a>
      <a id="Val.val-right"></a><a id="710" href="A201802.WIP.LR2.html#710" class="InductiveConstructor">val-right</a> <a id="720" class="Symbol">:</a> <a id="722" class="Symbol">âˆ€</a> <a id="724" class="Symbol">{</a><a id="725" href="A201802.WIP.LR2.html#725" class="Bound">M</a><a id="726" class="Symbol">}</a> <a id="728" class="Symbol">â†’</a> <a id="730" class="Symbol">{{</a><a id="732" href="A201802.WIP.LR2.html#732" class="Bound">_</a> <a id="734" class="Symbol">:</a> <a id="736" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="740" href="A201802.WIP.LR2.html#725" class="Bound">M</a><a id="741" class="Symbol">}}</a> <a id="744" class="Symbol">â†’</a> <a id="746" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="750" class="Symbol">(</a><a id="751" href="A201802.LR0.html#875" class="InductiveConstructor">RIGHT</a> <a id="757" href="A201802.WIP.LR2.html#725" class="Bound">M</a><a id="758" class="Symbol">)</a>
      <a id="Val.val-true"></a><a id="766" href="A201802.WIP.LR2.html#766" class="InductiveConstructor">val-true</a>  <a id="776" class="Symbol">:</a> <a id="778" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="782" href="A201802.LR0.html#961" class="InductiveConstructor">TRUE</a>
      <a id="Val.val-false"></a><a id="793" href="A201802.WIP.LR2.html#793" class="InductiveConstructor">val-false</a> <a id="803" class="Symbol">:</a> <a id="805" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="809" href="A201802.LR0.html#980" class="InductiveConstructor">FALSE</a>


<a id="817" class="Comment">-- `Vals Ï„` says that all terms `Ï„` are values.</a>
<a id="865" class="Keyword">data</a> <a id="Vals"></a><a id="870" href="A201802.WIP.LR2.html#870" class="Datatype">Vals</a> <a id="875" class="Symbol">{</a><a id="876" href="A201802.WIP.LR2.html#876" class="Bound">g</a><a id="877" class="Symbol">}</a> <a id="879" class="Symbol">:</a> <a id="881" class="Symbol">âˆ€</a> <a id="883" class="Symbol">{</a><a id="884" href="A201802.WIP.LR2.html#884" class="Bound">n</a><a id="885" class="Symbol">}</a> <a id="887" class="Symbol">â†’</a> <a id="889" href="A201802.LR0.html#1043" class="Function">Terms</a> <a id="895" href="A201802.WIP.LR2.html#876" class="Bound">g</a> <a id="897" href="A201802.WIP.LR2.html#884" class="Bound">n</a> <a id="899" class="Symbol">â†’</a> <a id="901" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="907" class="Keyword">where</a>
    <a id="917" class="Keyword">instance</a>
      <a id="Vals.âˆ™"></a><a id="932" href="A201802.WIP.LR2.html#932" class="InductiveConstructor">âˆ™</a>   <a id="936" class="Symbol">:</a> <a id="938" href="A201802.WIP.LR2.html#870" class="Datatype">Vals</a> <a id="943" href="A201801.Vec.html#295" class="InductiveConstructor">âˆ™</a>
    <a id="Vals._,_"></a><a id="949" href="A201802.WIP.LR2.html#949" class="InductiveConstructor Operator">_,_</a> <a id="953" class="Symbol">:</a> <a id="955" class="Symbol">âˆ€</a> <a id="957" class="Symbol">{</a><a id="958" href="A201802.WIP.LR2.html#958" class="Bound">n</a> <a id="960" href="A201802.WIP.LR2.html#960" class="Bound">M</a><a id="961" class="Symbol">}</a> <a id="963" class="Symbol">â†’</a> <a id="965" class="Symbol">{</a><a id="966" href="A201802.WIP.LR2.html#966" class="Bound">Ï„</a> <a id="968" class="Symbol">:</a> <a id="970" href="A201802.LR0.html#1043" class="Function">Terms</a> <a id="976" href="A201802.WIP.LR2.html#876" class="Bound">g</a> <a id="978" href="A201802.WIP.LR2.html#958" class="Bound">n</a><a id="979" class="Symbol">}</a> <a id="981" class="Symbol">â†’</a> <a id="983" href="A201802.WIP.LR2.html#870" class="Datatype">Vals</a> <a id="988" href="A201802.WIP.LR2.html#966" class="Bound">Ï„</a> <a id="990" class="Symbol">â†’</a> <a id="992" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="996" href="A201802.WIP.LR2.html#960" class="Bound">M</a> <a id="998" class="Symbol">â†’</a> <a id="1000" href="A201802.WIP.LR2.html#870" class="Datatype">Vals</a> <a id="1005" class="Symbol">(</a><a id="1006" href="A201802.WIP.LR2.html#966" class="Bound">Ï„</a> <a id="1008" href="A201801.Vec.html#316" class="InductiveConstructor Operator">,</a> <a id="1010" href="A201802.WIP.LR2.html#960" class="Bound">M</a><a id="1011" class="Symbol">)</a>



<a id="hm"></a><a id="1016" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1019" class="Symbol">:</a> <a id="1021" class="Symbol">(</a><a id="1022" href="A201802.WIP.LR2.html#1022" class="Bound">M</a> <a id="1024" class="Symbol">:</a> <a id="1026" href="A201802.LR0.html#576" class="Datatype">Term</a> <a id="1031" class="Number">0</a><a id="1032" class="Symbol">)</a> <a id="1034" class="Symbol">(</a><a id="1035" href="A201802.WIP.LR2.html#1035" class="Bound">VM</a> <a id="1038" class="Symbol">:</a> <a id="1040" href="A201802.WIP.LR2.html#467" class="Datatype">Val</a> <a id="1044" href="A201802.WIP.LR2.html#1022" class="Bound">M</a><a id="1045" class="Symbol">)</a> <a id="1047" class="Symbol">â†’</a> <a id="1049" href="A201801.Prelude.html#1191" class="Function Operator">Â¬</a> <a id="1051" class="Symbol">(</a><a id="1052" class="InductiveConstructor">âˆ™</a> <a id="1054" href="A201802.LR1.html#377" class="Datatype Operator">âŠ¢</a> <a id="1056" href="A201802.WIP.LR2.html#1022" class="Bound">M</a> <a id="1058" href="A201802.LR1.html#377" class="Datatype Operator">â¦‚</a> <a id="1060" href="A201802.LR0.html#361" class="InductiveConstructor">ğŸ˜</a><a id="1061" class="Symbol">)</a>
<a id="1063" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1066" class="Symbol">(</a><a id="1067" href="A201802.LR0.html#609" class="InductiveConstructor">VAR</a> <a id="1071" href="A201802.WIP.LR2.html#1071" class="Bound">I</a><a id="1072" class="Symbol">)</a> <a id="1074" class="Symbol">()</a>
<a id="1077" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1080" class="Symbol">(</a><a id="1081" href="A201802.LR0.html#636" class="InductiveConstructor">LAM</a> <a id="1085" href="A201802.WIP.LR2.html#1085" class="Bound">M</a><a id="1086" class="Symbol">)</a> <a id="1088" href="A201802.WIP.LR2.html#517" class="InductiveConstructor">val-lam</a> <a id="1096" class="Symbol">=</a> <a id="1098" class="Symbol">Î»</a> <a id="1100" class="Symbol">()</a>
<a id="1103" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1106" class="Symbol">(</a><a id="1107" href="A201802.LR0.html#670" class="InductiveConstructor">APP</a> <a id="1111" href="A201802.WIP.LR2.html#1111" class="Bound">M</a> <a id="1113" href="A201802.WIP.LR2.html#1113" class="Bound">N</a><a id="1114" class="Symbol">)</a> <a id="1116" class="Symbol">()</a>
<a id="1119" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1122" class="Symbol">(</a><a id="1123" href="A201802.LR0.html#707" class="InductiveConstructor">PAIR</a> <a id="1128" href="A201802.WIP.LR2.html#1128" class="Bound">M</a> <a id="1130" href="A201802.WIP.LR2.html#1130" class="Bound">N</a><a id="1131" class="Symbol">)</a> <a id="1133" class="Symbol">(</a><a id="1134" href="A201802.WIP.LR2.html#555" class="InductiveConstructor">val-pair</a><a id="1142" class="Symbol">)</a> <a id="1144" class="Symbol">=</a> <a id="1146" class="Symbol">Î»</a> <a id="1148" class="Symbol">()</a>
<a id="1151" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1154" class="Symbol">(</a><a id="1155" href="A201802.LR0.html#744" class="InductiveConstructor">FST</a> <a id="1159" href="A201802.WIP.LR2.html#1159" class="Bound">M</a><a id="1160" class="Symbol">)</a> <a id="1162" class="Symbol">()</a>
<a id="1165" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1168" class="Symbol">(</a><a id="1169" href="A201802.LR0.html#772" class="InductiveConstructor">SND</a> <a id="1173" href="A201802.WIP.LR2.html#1173" class="Bound">M</a><a id="1174" class="Symbol">)</a> <a id="1176" class="Symbol">()</a>
<a id="1179" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1182" href="A201802.LR0.html#800" class="InductiveConstructor">UNIT</a> <a id="1187" href="A201802.WIP.LR2.html#628" class="InductiveConstructor">val-unit</a> <a id="1196" class="Symbol">=</a> <a id="1198" class="Symbol">Î»</a> <a id="1200" class="Symbol">()</a>
<a id="1203" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1206" class="Symbol">(</a><a id="1207" href="A201802.LR0.html#819" class="InductiveConstructor">ABORT</a> <a id="1213" href="A201802.WIP.LR2.html#1213" class="Bound">M</a><a id="1214" class="Symbol">)</a> <a id="1216" class="Symbol">()</a>
<a id="1219" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1222" class="Symbol">(</a><a id="1223" href="A201802.LR0.html#847" class="InductiveConstructor">LEFT</a> <a id="1228" href="A201802.WIP.LR2.html#1228" class="Bound">M</a><a id="1229" class="Symbol">)</a> <a id="1231" class="Symbol">(</a><a id="1232" href="A201802.WIP.LR2.html#655" class="InductiveConstructor">val-left</a> <a id="1241" class="Symbol">{{</a><a id="1243" href="A201802.WIP.LR2.html#1243" class="Bound">VM</a><a id="1245" class="Symbol">}})</a> <a id="1249" class="Symbol">=</a> <a id="1251" class="Symbol">Î»</a> <a id="1253" class="Symbol">()</a>
<a id="1256" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1259" class="Symbol">(</a><a id="1260" href="A201802.LR0.html#875" class="InductiveConstructor">RIGHT</a> <a id="1266" href="A201802.WIP.LR2.html#1266" class="Bound">M</a><a id="1267" class="Symbol">)</a> <a id="1269" class="Symbol">(</a><a id="1270" href="A201802.WIP.LR2.html#710" class="InductiveConstructor">val-right</a> <a id="1280" class="Symbol">{{</a><a id="1282" href="A201802.WIP.LR2.html#1282" class="Bound">VN</a><a id="1284" class="Symbol">}})</a> <a id="1288" class="Symbol">=</a> <a id="1290" class="Symbol">Î»</a> <a id="1292" class="Symbol">()</a>
<a id="1295" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1298" class="Symbol">(</a><a id="1299" href="A201802.LR0.html#903" class="InductiveConstructor">CASE</a> <a id="1304" href="A201802.WIP.LR2.html#1304" class="Bound">M</a> <a id="1306" href="A201802.WIP.LR2.html#1306" class="Bound">N</a> <a id="1308" href="A201802.WIP.LR2.html#1308" class="Bound">O</a><a id="1309" class="Symbol">)</a> <a id="1311" class="Symbol">()</a>
<a id="1314" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1317" href="A201802.LR0.html#961" class="InductiveConstructor">TRUE</a> <a id="1322" href="A201802.WIP.LR2.html#766" class="InductiveConstructor">val-true</a> <a id="1331" class="Symbol">=</a> <a id="1333" class="Symbol">Î»</a> <a id="1335" class="Symbol">()</a>
<a id="1338" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1341" href="A201802.LR0.html#980" class="InductiveConstructor">FALSE</a> <a id="1347" href="A201802.WIP.LR2.html#793" class="InductiveConstructor">val-false</a> <a id="1357" class="Symbol">=</a> <a id="1359" class="Symbol">Î»</a> <a id="1361" class="Symbol">()</a>
<a id="1364" href="A201802.WIP.LR2.html#1016" class="Function">hm</a> <a id="1367" class="Symbol">(</a><a id="1368" href="A201802.LR0.html#999" class="InductiveConstructor">IF</a> <a id="1371" href="A201802.WIP.LR2.html#1371" class="Bound">M</a> <a id="1373" href="A201802.WIP.LR2.html#1373" class="Bound">N</a> <a id="1375" href="A201802.WIP.LR2.html#1375" class="Bound">O</a><a id="1376" class="Symbol">)</a> <a id="1378" class="Symbol">()</a>


<a id="1383" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1469" class="Comment">-- -- `_â¤ _` is the CBV computation relation.</a>
<a id="1514" class="Comment">-- infix 3 _â¤ _</a>
<a id="1529" class="Comment">-- data _â¤ _ {g} : Term g â†’ Term g â†’ Set</a>
<a id="1569" class="Comment">--   where</a>
<a id="1580" class="Comment">--     app-lam    : âˆ€ {M N} â†’ {{_ : Val N}} â†’ APP (LAM M) N â¤  CUT N M</a>
<a id="1650" class="Comment">--     fst-pair   : âˆ€ {M N} â†’ {{_ : Val M}} {{_ : Val N}} â†’ FST (PAIR M N) â¤  M</a>
<a id="1729" class="Comment">--     snd-pair   : âˆ€ {M N} â†’ {{_ : Val M}} {{_ : Val N}} â†’ SND (PAIR M N) â¤  N</a>
<a id="1808" class="Comment">--     case-left  : âˆ€ {M N O} â†’ {{_ : Val M}} â†’ CASE (LEFT M) N O â¤  CUT M N</a>
<a id="1884" class="Comment">--     case-right : âˆ€ {M N O} â†’ {{_ : Val M}} â†’ CASE (RIGHT M) N O â¤  CUT M O</a>
<a id="1961" class="Comment">--     if-true    : âˆ€ {N O} â†’ IF TRUE N O â¤  N</a>
<a id="2007" class="Comment">--     if-false   : âˆ€ {N O} â†’ IF FALSE N O â¤  O</a>


<a id="2056" class="Comment">-- -- Values do not compute.</a>
<a id="2085" class="Comment">-- Â¬valâ¤  : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val M}}</a>
<a id="2136" class="Comment">--                â†’ Â¬ (M â¤  Mâ€²)</a>
<a id="2167" class="Comment">-- Â¬valâ¤  {{val-lam}}   ()</a>
<a id="2193" class="Comment">-- Â¬valâ¤  {{val-pair}}  ()</a>
<a id="2219" class="Comment">-- Â¬valâ¤  {{val-unit}}  ()</a>
<a id="2245" class="Comment">-- Â¬valâ¤  {{val-left}}  ()</a>
<a id="2271" class="Comment">-- Â¬valâ¤  {{val-right}} ()</a>
<a id="2297" class="Comment">-- Â¬valâ¤  {{val-true}}  ()</a>
<a id="2323" class="Comment">-- Â¬valâ¤  {{val-false}} ()</a>


<a id="2351" class="Comment">-- -- Computation is deterministic.</a>
<a id="2387" class="Comment">-- detâ¤  : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="2426" class="Comment">--               â†’ M â¤  Mâ€²â‚ â†’ M â¤  Mâ€²â‚‚</a>
<a id="2463" class="Comment">--               â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="2492" class="Comment">-- detâ¤  app-lam    app-lam    = refl</a>
<a id="2529" class="Comment">-- detâ¤  fst-pair   fst-pair   = refl</a>
<a id="2566" class="Comment">-- detâ¤  snd-pair   snd-pair   = refl</a>
<a id="2603" class="Comment">-- detâ¤  case-left  case-left  = refl</a>
<a id="2640" class="Comment">-- detâ¤  case-right case-right = refl</a>
<a id="2677" class="Comment">-- detâ¤  if-true    if-true    = refl</a>
<a id="2714" class="Comment">-- detâ¤  if-false   if-false   = refl</a>


<a id="2753" class="Comment">-- -- Computation is type-preserving.</a>
<a id="2791" class="Comment">-- tpâ¤  : âˆ€ {g M Mâ€² A} â†’ {Î“ : Types g}</a>
<a id="2829" class="Comment">--                     â†’ M â¤  Mâ€² â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="2873" class="Comment">--                     â†’ Î“ âŠ¢ Mâ€² â¦‚ A</a>
<a id="2909" class="Comment">-- tpâ¤  app-lam    (app (lam ğ’Ÿ) â„°)      = cut â„° ğ’Ÿ</a>
<a id="2958" class="Comment">-- tpâ¤  fst-pair   (fst (pair ğ’Ÿ â„°))     = ğ’Ÿ</a>
<a id="3001" class="Comment">-- tpâ¤  snd-pair   (snd (pair ğ’Ÿ â„°))     = â„°</a>
<a id="3044" class="Comment">-- tpâ¤  case-left  (case (left ğ’Ÿ) â„° â„±)  = cut ğ’Ÿ â„°</a>
<a id="3093" class="Comment">-- tpâ¤  case-right (case (right ğ’Ÿ) â„° â„±) = cut ğ’Ÿ â„±</a>
<a id="3142" class="Comment">-- tpâ¤  if-true    (if ğ’Ÿ â„° â„±)           = â„°</a>
<a id="3185" class="Comment">-- tpâ¤  if-false   (if ğ’Ÿ â„° â„±)           = â„±</a>


<a id="3230" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3316" class="Comment">-- -- `_â†¦_` is the CBV small-step reduction relation.</a>
<a id="3370" class="Comment">-- infix 3 _â†¦_</a>
<a id="3385" class="Comment">-- data _â†¦_ {g} : Term g â†’ Term g â†’ Set</a>
<a id="3425" class="Comment">--   where</a>
<a id="3436" class="Comment">--     red : âˆ€ {M Mâ€²} â†’ M â¤  Mâ€²</a>
<a id="3467" class="Comment">--                    â†’ M â†¦ Mâ€²</a>

<a id="3499" class="Comment">--     cong-appâ‚ : âˆ€ {M Mâ€² N} â†’ M â†¦ Mâ€²</a>
<a id="3538" class="Comment">--                            â†’ APP M N â†¦ APP Mâ€² N</a>

<a id="3590" class="Comment">--     cong-appâ‚‚ : âˆ€ {M N Nâ€²} â†’ {{_ : Val M}}</a>
<a id="3636" class="Comment">--                            â†’ N â†¦ Nâ€²</a>
<a id="3675" class="Comment">--                            â†’ APP M N â†¦ APP M Nâ€²</a>

<a id="3727" class="Comment">--     cong-pairâ‚ : âˆ€ {M Mâ€² N} â†’ M â†¦ Mâ€²</a>
<a id="3767" class="Comment">--                             â†’ PAIR M N â†¦ PAIR Mâ€² N</a>

<a id="3822" class="Comment">--     cong-pairâ‚‚ : âˆ€ {M N Nâ€²} â†’ {{_ : Val M}}</a>
<a id="3869" class="Comment">--                             â†’ N â†¦ Nâ€²</a>
<a id="3909" class="Comment">--                             â†’ PAIR M N â†¦ PAIR M Nâ€²</a>

<a id="3964" class="Comment">--     cong-fst : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4000" class="Comment">--                         â†’ FST M â†¦ FST Mâ€²</a>

<a id="4045" class="Comment">--     cong-snd : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4081" class="Comment">--                         â†’ SND M â†¦ SND Mâ€²</a>

<a id="4126" class="Comment">--     cong-abort : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4164" class="Comment">--                           â†’ ABORT M â†¦ ABORT Mâ€²</a>

<a id="4215" class="Comment">--     cong-left : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4252" class="Comment">--                          â†’ LEFT M â†¦ LEFT Mâ€²</a>

<a id="4300" class="Comment">--     cong-right : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4338" class="Comment">--                           â†’ RIGHT M â†¦ RIGHT Mâ€²</a>

<a id="4389" class="Comment">--     cong-case : âˆ€ {M Mâ€² N O} â†’ M â†¦ Mâ€²</a>
<a id="4430" class="Comment">--                              â†’ CASE M N O â†¦ CASE Mâ€² N O</a>

<a id="4490" class="Comment">--     cong-if : âˆ€ {M Mâ€² N O} â†’ M â†¦ Mâ€²</a>
<a id="4529" class="Comment">--                            â†’ IF M N O â†¦ IF Mâ€² N O</a>


<a id="4584" class="Comment">-- -- Values do not reduce.</a>
<a id="4612" class="Comment">-- Â¬valâ†¦ : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val M}}</a>
<a id="4663" class="Comment">--                â†’ Â¬ (M â†¦ Mâ€²)</a>
<a id="4694" class="Comment">-- Â¬valâ†¦ {{val-lam}}   (red ())</a>
<a id="4726" class="Comment">-- Â¬valâ†¦ {{val-pair}}  (red ())</a>
<a id="4758" class="Comment">-- Â¬valâ†¦ {{val-pair}}  (cong-pairâ‚ Mâ†¦Mâ€²) = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>
<a id="4814" class="Comment">-- Â¬valâ†¦ {{val-pair}}  (cong-pairâ‚‚ Nâ†¦Nâ€²) = Nâ†¦Nâ€² â†¯ Â¬valâ†¦</a>
<a id="4870" class="Comment">-- Â¬valâ†¦ {{val-unit}}  (red ())</a>
<a id="4902" class="Comment">-- Â¬valâ†¦ {{val-left}}  (red ())</a>
<a id="4934" class="Comment">-- Â¬valâ†¦ {{val-left}}  (cong-left Mâ†¦Mâ€²)  = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>
<a id="4990" class="Comment">-- Â¬valâ†¦ {{val-right}} (red ())</a>
<a id="5022" class="Comment">-- Â¬valâ†¦ {{val-right}} (cong-right Mâ†¦Mâ€²) = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>
<a id="5078" class="Comment">-- Â¬valâ†¦ {{val-true}}  (red ())</a>
<a id="5110" class="Comment">-- Â¬valâ†¦ {{val-false}} (red ())</a>


<a id="5144" class="Comment">-- -- Computation determines small-step reduction.</a>
<a id="5195" class="Comment">-- red-detâ†¦ : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="5238" class="Comment">--                   â†’ M â¤  Mâ€²â‚ â†’ M â†¦ Mâ€²â‚‚</a>
<a id="5279" class="Comment">--                   â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="5312" class="Comment">-- red-detâ†¦ Mâ¤ Mâ€²â‚     (red Mâ¤ Mâ€²â‚‚)       = detâ¤  Mâ¤ Mâ€²â‚ Mâ¤ Mâ€²â‚‚</a>
<a id="5371" class="Comment">-- red-detâ†¦ app-lam    (cong-appâ‚ Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5428" class="Comment">-- red-detâ†¦ app-lam    (cong-appâ‚‚ Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5485" class="Comment">-- red-detâ†¦ fst-pair   (cong-fst Mâ†¦Mâ€²â‚‚)  = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5542" class="Comment">-- red-detâ†¦ snd-pair   (cong-snd Mâ†¦Mâ€²â‚‚)  = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5599" class="Comment">-- red-detâ†¦ case-left  (cong-case Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5656" class="Comment">-- red-detâ†¦ case-right (cong-case Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5713" class="Comment">-- red-detâ†¦ if-true    (cong-if Mâ†¦Mâ€²â‚‚)   = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5770" class="Comment">-- red-detâ†¦ if-false   (cong-if Mâ†¦Mâ€²â‚‚)   = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5827" class="Comment">-- red-detâ†¦ ()         (cong-pairâ‚ _)</a>
<a id="5865" class="Comment">-- red-detâ†¦ ()         (cong-pairâ‚‚ _)</a>
<a id="5903" class="Comment">-- red-detâ†¦ ()         (cong-abort _)</a>
<a id="5941" class="Comment">-- red-detâ†¦ ()         (cong-left _)</a>
<a id="5978" class="Comment">-- red-detâ†¦ ()         (cong-right _)</a>


<a id="6018" class="Comment">-- -- Small-step reduction is deterministic.</a>
<a id="6063" class="Comment">-- detâ†¦ : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="6102" class="Comment">--               â†’ M â†¦ Mâ€²â‚ â†’ M â†¦ Mâ€²â‚‚</a>
<a id="6139" class="Comment">--               â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="6168" class="Comment">-- detâ†¦ (red Mâ¤ Mâ€²â‚)        Mâ†¦Mâ€²â‚‚              = red-detâ†¦ Mâ¤ Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6237" class="Comment">-- detâ†¦ (cong-appâ‚ Mâ†¦Mâ€²â‚)  (cong-appâ‚ Mâ†¦Mâ€²â‚‚)  = (\ Mâ€² â†’ APP Mâ€² _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6322" class="Comment">-- detâ†¦ (cong-appâ‚ Mâ†¦Mâ€²â‚)  (cong-appâ‚‚ _)       = Mâ†¦Mâ€²â‚ â†¯ Â¬valâ†¦</a>
<a id="6385" class="Comment">-- detâ†¦ (cong-appâ‚‚ _)       (cong-appâ‚ Mâ†¦Mâ€²â‚‚)  = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="6448" class="Comment">-- detâ†¦ (cong-appâ‚‚ Nâ†¦Nâ€²â‚)  (cong-appâ‚‚ Nâ†¦Nâ€²â‚‚)  = (\ Nâ€² â†’ APP _ Nâ€²) &amp; detâ†¦ Nâ†¦Nâ€²â‚ Nâ†¦Nâ€²â‚‚</a>
<a id="6533" class="Comment">-- detâ†¦ (cong-pairâ‚ Mâ†¦Mâ€²â‚) (cong-pairâ‚ Mâ†¦Mâ€²â‚‚) = (\ Mâ€² â†’ PAIR Mâ€² _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6619" class="Comment">-- detâ†¦ (cong-pairâ‚ Mâ†¦Mâ€²â‚) (cong-pairâ‚‚ _)      = Mâ†¦Mâ€²â‚ â†¯ Â¬valâ†¦</a>
<a id="6682" class="Comment">-- detâ†¦ (cong-pairâ‚‚ _)      (cong-pairâ‚ Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="6745" class="Comment">-- detâ†¦ (cong-pairâ‚‚ Nâ†¦Nâ€²â‚) (cong-pairâ‚‚ Nâ†¦Nâ€²â‚‚) = (\ Nâ€² â†’ PAIR _ Nâ€²) &amp; detâ†¦ Nâ†¦Nâ€²â‚ Nâ†¦Nâ€²â‚‚</a>
<a id="6831" class="Comment">-- detâ†¦ (cong-fst Mâ†¦Mâ€²â‚)   (cong-fst Mâ†¦Mâ€²â‚‚)   = FST &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6902" class="Comment">-- detâ†¦ (cong-snd Mâ†¦Mâ€²â‚)   (cong-snd Mâ†¦Mâ€²â‚‚)   = SND &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6973" class="Comment">-- detâ†¦ (cong-abort Mâ†¦Mâ€²â‚) (cong-abort Mâ†¦Mâ€²â‚‚) = ABORT &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7046" class="Comment">-- detâ†¦ (cong-left Mâ†¦Mâ€²â‚)  (cong-left Mâ†¦Mâ€²â‚‚)  = LEFT &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7118" class="Comment">-- detâ†¦ (cong-right Mâ†¦Mâ€²â‚) (cong-right Mâ†¦Mâ€²â‚‚) = RIGHT &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7191" class="Comment">-- detâ†¦ (cong-case Mâ†¦Mâ€²â‚)  (cong-case Mâ†¦Mâ€²â‚‚)  = (\ Mâ€² â†’ CASE Mâ€² _ _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7279" class="Comment">-- detâ†¦ (cong-if Mâ†¦Mâ€²â‚)    (cong-if Mâ†¦Mâ€²â‚‚)    = (\ Mâ€² â†’ IF Mâ€² _ _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7365" class="Comment">-- detâ†¦ Mâ†¦Mâ€²â‚              (red Mâ¤ Mâ€²â‚‚)        = red-detâ†¦ Mâ¤ Mâ€²â‚‚ Mâ†¦Mâ€²â‚ â»Â¹</a>


<a id="7439" class="Comment">-- -- Small-step reduction is type-preserving.</a>
<a id="7486" class="Comment">-- tpâ†¦ : âˆ€ {g M Mâ€² A} â†’ {Î“ : Types g}</a>
<a id="7524" class="Comment">--                     â†’ M â†¦ Mâ€² â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="7568" class="Comment">--                     â†’ Î“ âŠ¢ Mâ€² â¦‚ A</a>
<a id="7604" class="Comment">-- tpâ†¦ (red Mâ¤ Mâ€²)        ğ’Ÿ            = tpâ¤  Mâ¤ Mâ€² ğ’Ÿ</a>
<a id="7655" class="Comment">-- tpâ†¦ (cong-appâ‚ Mâ†¦Mâ€²)  (app ğ’Ÿ â„°)    = app (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„°</a>
<a id="7714" class="Comment">-- tpâ†¦ (cong-appâ‚‚ Mâ†¦Mâ€²)  (app ğ’Ÿ â„°)    = app ğ’Ÿ (tpâ†¦ Mâ†¦Mâ€² â„°)</a>
<a id="7773" class="Comment">-- tpâ†¦ (cong-pairâ‚ Mâ†¦Mâ€²) (pair ğ’Ÿ â„°)   = pair (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„°</a>
<a id="7833" class="Comment">-- tpâ†¦ (cong-pairâ‚‚ Nâ†¦Nâ€²) (pair ğ’Ÿ â„°)   = pair ğ’Ÿ (tpâ†¦ Nâ†¦Nâ€² â„°)</a>
<a id="7893" class="Comment">-- tpâ†¦ (cong-fst Mâ†¦Mâ€²)   (fst ğ’Ÿ)      = fst (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="7950" class="Comment">-- tpâ†¦ (cong-snd Mâ†¦Mâ€²)   (snd ğ’Ÿ)      = snd (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8007" class="Comment">-- tpâ†¦ (cong-abort Mâ†¦Mâ€²) (abort ğ’Ÿ)    = abort (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8066" class="Comment">-- tpâ†¦ (cong-left Mâ†¦Mâ€²)  (left ğ’Ÿ)     = left (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8124" class="Comment">-- tpâ†¦ (cong-right Mâ†¦Mâ€²) (right ğ’Ÿ)    = right (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8183" class="Comment">-- tpâ†¦ (cong-case Mâ†¦Mâ€²)  (case ğ’Ÿ â„° â„±) = case (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„° â„±</a>
<a id="8245" class="Comment">-- tpâ†¦ (cong-if Mâ†¦Mâ€²)    (if ğ’Ÿ â„° â„±)   = if (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„° â„±</a>


<a id="8307" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="8393" class="Comment">-- -- `_â¤…_` is the iterated small-step reduction relation.</a>
<a id="8452" class="Comment">-- infix 3 _â¤…_</a>
<a id="8467" class="Comment">-- data _â¤…_ {g} : Term g â†’ Term g â†’ Set</a>
<a id="8507" class="Comment">--   where</a>
<a id="8518" class="Comment">--     -- Iterated small-step reduction is reflexive.</a>
<a id="8572" class="Comment">--     done : âˆ€ {M} â†’ M â¤… M</a>

<a id="8601" class="Comment">--     -- Small-step reduction IN REVERSE preserves iterated small-step reduction.</a>
<a id="8684" class="Comment">--     step : âˆ€ {M Mâ€² Mâ€³} â†’ M â†¦ Mâ€² â†’ Mâ€² â¤… Mâ€³</a>
<a id="8729" class="Comment">--                        â†’ M â¤… Mâ€³</a>


<a id="8766" class="Comment">-- -- Iterated small-step reduction is transitive.</a>
<a id="8817" class="Comment">-- -- Iterated small-step reduction IN REVERSE preserves iterated small-step reduction.</a>
<a id="8905" class="Comment">-- steps : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g}</a>
<a id="8943" class="Comment">--               â†’ M â¤… Mâ€² â†’ Mâ€² â¤… Mâ€³</a>
<a id="8979" class="Comment">--               â†’ M â¤… Mâ€³</a>
<a id="9005" class="Comment">-- steps done                Mâ¤…Mâ€³  = Mâ¤…Mâ€³</a>
<a id="9047" class="Comment">-- steps (step Mâ†¦Mâ€´ Mâ€´â¤…Mâ€²) Mâ€²â¤…Mâ€³ = step Mâ†¦Mâ€´ (steps Mâ€´â¤…Mâ€² Mâ€²â¤…Mâ€³)</a>


<a id="9114" class="Comment">-- -- When reducing down to a value, the initial small step determines the subsequent small steps.</a>
<a id="9213" class="Comment">-- -- Small-step reduction preserves iterated small-step reduction down to a value.</a>
<a id="9297" class="Comment">-- unstep : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g} â†’ {{_ : Val Mâ€³}}</a>
<a id="9353" class="Comment">--                â†’ M â†¦ Mâ€² â†’ M â¤… Mâ€³</a>
<a id="9389" class="Comment">--                â†’ Mâ€² â¤… Mâ€³</a>
<a id="9417" class="Comment">-- unstep Mâ†¦Mâ€²â‚ (step Mâ†¦Mâ€²â‚‚ Mâ€²â‚‚â¤…Mâ€³) with detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="9475" class="Comment">-- unstep Mâ†¦Mâ€²  (step _      Mâ€²â¤…Mâ€³)  | refl = Mâ€²â¤…Mâ€³</a>
<a id="9527" class="Comment">-- unstep Mâ†¦Mâ€²  done                  = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>


<a id="9582" class="Comment">-- -- When reducing down to a value, iterated small-step reduction is deterministic.</a>
<a id="9667" class="Comment">-- detâ¤… : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g} â†’ {{_ : Val Mâ€²â‚}} {{_ : Val Mâ€²â‚‚}}</a>
<a id="9740" class="Comment">--               â†’ M â¤… Mâ€²â‚ â†’ M â¤… Mâ€²â‚‚</a>
<a id="9777" class="Comment">--               â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="9806" class="Comment">-- detâ¤… done                   done                = refl</a>
<a id="9864" class="Comment">-- detâ¤… done                   (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = Mâ†¦Mâ€³ â†¯ Â¬valâ†¦</a>
<a id="9928" class="Comment">-- detâ¤… (step Mâ†¦Mâ€³â‚ Mâ€³â‚â¤…Mâ€²â‚) Mâ¤…Mâ€²â‚‚              = detâ¤… Mâ€³â‚â¤…Mâ€²â‚ (unstep Mâ†¦Mâ€³â‚ Mâ¤…Mâ€²â‚‚)</a>


<a id="10014" class="Comment">-- -- Iterated small-step reduction is type-preserving.</a>
<a id="10070" class="Comment">-- tpâ¤… : âˆ€ {g M Mâ€² A} â†’ {Î“ : Types g}</a>
<a id="10108" class="Comment">--                     â†’ M â¤… Mâ€² â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="10152" class="Comment">--                     â†’ Î“ âŠ¢ Mâ€² â¦‚ A</a>
<a id="10188" class="Comment">-- tpâ¤… done                ğ’Ÿ = ğ’Ÿ</a>
<a id="10221" class="Comment">-- tpâ¤… (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) ğ’Ÿ = tpâ¤… Mâ€³â¤…Mâ€² (tpâ†¦ Mâ†¦Mâ€³ ğ’Ÿ)</a>


<a id="10275" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `APP M N` reduces to `APP Mâ€² N`.</a>
<a id="10343" class="Comment">-- congs-appâ‚ : âˆ€ {g} â†’ {M Mâ€² N : Term g}</a>
<a id="10385" class="Comment">--                    â†’ M â¤… Mâ€²</a>
<a id="10416" class="Comment">--                    â†’ APP M N â¤… APP Mâ€² N</a>
<a id="10459" class="Comment">-- congs-appâ‚ done                = done</a>
<a id="10500" class="Comment">-- congs-appâ‚ (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-appâ‚ Mâ†¦Mâ€³) (congs-appâ‚ Mâ€³â¤…Mâ€²)</a>


<a id="10577" class="Comment">-- -- If `N` reduces to `Nâ€²`, then `APP (LAM M) N` reduces to `APP (LAM M) Nâ€²`.</a>
<a id="10657" class="Comment">-- congs-appâ‚‚ : âˆ€ {g} â†’ {M : Term (suc g)} {N Nâ€² : Term g}</a>
<a id="10716" class="Comment">--                    â†’ N â¤… Nâ€²</a>
<a id="10747" class="Comment">--                    â†’ APP (LAM M) N â¤… APP (LAM M) Nâ€²</a>
<a id="10802" class="Comment">-- congs-appâ‚‚ done                = done</a>
<a id="10843" class="Comment">-- congs-appâ‚‚ (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-appâ‚‚ Mâ†¦Mâ€³) (congs-appâ‚‚ Mâ€³â¤…Mâ€²)</a>


<a id="10920" class="Comment">-- -- If `M` reduces to `Mâ€²` and `N` reduces to `Nâ€²`, then `PAIR M N` reduces to `PAIR Mâ€² Nâ€²`.</a>
<a id="11015" class="Comment">-- congs-pair : âˆ€ {g} â†’ {M Mâ€² N Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="11092" class="Comment">--                    â†’ M â¤… Mâ€² â†’ N â¤… Nâ€²</a>
<a id="11132" class="Comment">--                    â†’ PAIR M N â¤… PAIR Mâ€² Nâ€²</a>
<a id="11178" class="Comment">-- congs-pair done                done                = done</a>
<a id="11239" class="Comment">-- congs-pair done                (step Nâ†¦Nâ€³ Nâ€³â¤…Nâ€²) = step (cong-pairâ‚‚ Nâ†¦Nâ€³) (congs-pair done Nâ€³â¤…Nâ€²)</a>
<a id="11340" class="Comment">-- congs-pair (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) Nâ¤…Nâ€²               = step (cong-pairâ‚ Mâ†¦Mâ€³) (congs-pair Mâ€³â¤…Mâ€² Nâ¤…Nâ€²)</a>


<a id="11442" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `FST M` reduces to `FST Mâ€²`.</a>
<a id="11506" class="Comment">-- congs-fst : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="11545" class="Comment">--                   â†’ M â¤… Mâ€²</a>
<a id="11575" class="Comment">--                   â†’ FST M â¤… FST Mâ€²</a>
<a id="11613" class="Comment">-- congs-fst done                = done</a>
<a id="11653" class="Comment">-- congs-fst (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-fst Mâ†¦Mâ€³) (congs-fst Mâ€³â¤…Mâ€²)</a>


<a id="11727" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `SND M` reduces to `SND Mâ€²`.</a>
<a id="11791" class="Comment">-- congs-snd : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="11830" class="Comment">--                   â†’ M â¤… Mâ€²</a>
<a id="11860" class="Comment">--                   â†’ SND M â¤… SND Mâ€²</a>
<a id="11898" class="Comment">-- congs-snd done                = done</a>
<a id="11938" class="Comment">-- congs-snd (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-snd Mâ†¦Mâ€³) (congs-snd Mâ€³â¤…Mâ€²)</a>


<a id="12012" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `LEFT M` reduces to `LEFT Mâ€²`.</a>
<a id="12078" class="Comment">-- congs-left : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val Mâ€²}}</a>
<a id="12135" class="Comment">--                    â†’ M â¤… Mâ€²</a>
<a id="12166" class="Comment">--                    â†’ LEFT M â¤… LEFT Mâ€²</a>
<a id="12207" class="Comment">-- congs-left done                = done</a>
<a id="12248" class="Comment">-- congs-left (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-left Mâ†¦Mâ€³) (congs-left Mâ€³â¤…Mâ€²)</a>


<a id="12325" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `RIGHT M` reduces to `RIGHT Mâ€²`.</a>
<a id="12393" class="Comment">-- congs-right : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val Mâ€²}}</a>
<a id="12451" class="Comment">--                     â†’ M â¤… Mâ€²</a>
<a id="12483" class="Comment">--                     â†’ RIGHT M â¤… RIGHT Mâ€²</a>
<a id="12527" class="Comment">-- congs-right done                = done</a>
<a id="12569" class="Comment">-- congs-right (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-right Mâ†¦Mâ€³) (congs-right Mâ€³â¤…Mâ€²)</a>


<a id="12649" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `CASE M N O` reduces to `CASE Mâ€² N O`.</a>
<a id="12723" class="Comment">-- congs-case : âˆ€ {g} â†’ {M Mâ€² : Term g} {N O : Term (suc g)}</a>
<a id="12784" class="Comment">--                    â†’ M â¤… Mâ€²</a>
<a id="12815" class="Comment">--                    â†’ CASE M N O â¤… CASE Mâ€² N O</a>
<a id="12864" class="Comment">-- congs-case done                = done</a>
<a id="12905" class="Comment">-- congs-case (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-case Mâ†¦Mâ€³) (congs-case Mâ€³â¤…Mâ€²)</a>


<a id="12982" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `IF M N O` reduces to `IF Mâ€² N O`.</a>
<a id="13052" class="Comment">-- congs-if : âˆ€ {g} â†’ {M Mâ€² N O : Term g}</a>
<a id="13094" class="Comment">--                  â†’ M â¤… Mâ€²</a>
<a id="13123" class="Comment">--                  â†’ IF M N O â¤… IF Mâ€² N O</a>
<a id="13166" class="Comment">-- congs-if done                = done</a>
<a id="13205" class="Comment">-- congs-if (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-if Mâ†¦Mâ€³) (congs-if Mâ€³â¤…Mâ€²)</a>


<a id="13276" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `FST M` reduces to `Mâ€²`.</a>
<a id="13344" class="Comment">-- reds-fst-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="13422" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="13464" class="Comment">--                       â†’ FST M â¤… Mâ€²</a>
<a id="13502" class="Comment">-- reds-fst-pair Mâ¤…PAIR = steps (congs-fst Mâ¤…PAIR) (step (red fst-pair) done)</a>


<a id="13582" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `SND M` reduces to `Nâ€²`.</a>
<a id="13650" class="Comment">-- reds-snd-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="13728" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="13770" class="Comment">--                       â†’ SND M â¤… Nâ€²</a>
<a id="13808" class="Comment">-- reds-snd-pair Mâ¤…PAIR = steps (congs-snd Mâ¤…PAIR) (step (red snd-pair) done)</a>


<a id="13888" class="Comment">-- -- If `M` reduces to `TRUE` and `N` reduces to `Nâ€²`, then `IF M N O` reduces to `Nâ€²`.</a>
<a id="13977" class="Comment">-- reds-if-true : âˆ€ {g} â†’ {M N Nâ€² O : Term g}</a>
<a id="14023" class="Comment">--                      â†’ M â¤… TRUE â†’ N â¤… Nâ€²</a>
<a id="14067" class="Comment">--                      â†’ IF M N O â¤… Nâ€²</a>
<a id="14107" class="Comment">-- reds-if-true Mâ¤…TRUE Nâ¤…Nâ€² = steps (congs-if Mâ¤…TRUE) (step (red if-true) Nâ¤…Nâ€²)</a>


<a id="14189" class="Comment">-- -- If `M` reduces to `FALSE` and `O` reduces to `Oâ€²`, then `IF M N O` reduces to `Oâ€²`.</a>
<a id="14279" class="Comment">-- reds-if-false : âˆ€ {g} â†’ {M N O Oâ€² : Term g}</a>
<a id="14326" class="Comment">--                       â†’ M â¤… FALSE â†’ O â¤… Oâ€²</a>
<a id="14372" class="Comment">--                       â†’ IF M N O â¤… Oâ€²</a>
<a id="14413" class="Comment">-- reds-if-false Mâ¤…FALSE Nâ¤…Nâ€² = steps (congs-if Mâ¤…FALSE) (step (red if-false) Nâ¤…Nâ€²)</a>


<a id="14499" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="14585" class="Comment">-- -- `_â‡“_` is the big-step reduction relation.</a>
<a id="14633" class="Comment">-- infix 3 _â‡“_</a>
<a id="14648" class="Comment">-- _â‡“_ : âˆ€ {g} â†’ Term g â†’ Term g â†’ Set</a>
<a id="14687" class="Comment">-- M â‡“ Mâ€² = M â¤… Mâ€² Ã— Val Mâ€²</a>


<a id="14717" class="Comment">-- -- A big step can be extended with an initial small step.</a>
<a id="14778" class="Comment">-- -- Small-step reduction IN REVERSE preserves big-step reduction.</a>
<a id="14846" class="Comment">-- big-step : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g}</a>
<a id="14887" class="Comment">--                  â†’ M â†¦ Mâ€² â†’ Mâ€² â‡“ Mâ€³</a>
<a id="14926" class="Comment">--                  â†’ M â‡“ Mâ€³</a>
<a id="14955" class="Comment">-- big-step Mâ†¦Mâ€² (Mâ€²â¤…Mâ€³ , VMâ€³) = step Mâ†¦Mâ€² Mâ€²â¤…Mâ€³ , VMâ€³</a>


<a id="15012" class="Comment">-- -- The initial small step determines the subsequent big step.</a>
<a id="15077" class="Comment">-- -- Small-step reduction preserves big-step reduction.</a>
<a id="15134" class="Comment">-- big-unstep : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g}</a>
<a id="15177" class="Comment">--                    â†’ M â†¦ Mâ€² â†’ M â‡“ Mâ€³</a>
<a id="15217" class="Comment">--                    â†’ Mâ€² â‡“ Mâ€³</a>
<a id="15249" class="Comment">-- big-unstep Mâ†¦Mâ€² (Mâ€²â¤…Mâ€³ , VMâ€³) = unstep {{VMâ€³}} Mâ†¦Mâ€² Mâ€²â¤…Mâ€³ , VMâ€³</a>


<a id="15318" class="Comment">-- -- Big-step reduction is deterministic.</a>
<a id="15361" class="Comment">-- detâ‡“ : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="15400" class="Comment">--              â†’ M â‡“ Mâ€²â‚ â†’ M â‡“ Mâ€²â‚‚</a>
<a id="15436" class="Comment">--              â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="15464" class="Comment">-- detâ‡“ (Mâ¤…Mâ€²â‚ , VMâ€²â‚) (Mâ¤…Mâ€²â‚‚ , VMâ€²â‚‚) = detâ¤… {{VMâ€²â‚}} {{VMâ€²â‚‚}} Mâ¤…Mâ€²â‚ Mâ¤…Mâ€²â‚‚</a>


<a id="15541" class="Comment">-- -- If `M` reduces to `Mâ€²` and `N` reduces to `Nâ€²`, then `PAIR M N` reduces to `PAIR Mâ€² Nâ€²`.</a>
<a id="15636" class="Comment">-- big-red-pair : âˆ€ {g} â†’ {M Mâ€² N Nâ€² : Term g}</a>
<a id="15683" class="Comment">--                      â†’ M â‡“ Mâ€² â†’ N â‡“ Nâ€²</a>
<a id="15725" class="Comment">--                      â†’ PAIR M N â‡“ PAIR Mâ€² Nâ€²</a>
<a id="15773" class="Comment">-- big-red-pair (Mâ¤…Mâ€² , VMâ€²) (Nâ¤…Nâ€² , VNâ€²) = congs-pair {{VMâ€²}} {{VNâ€²}} Mâ¤…Mâ€² Nâ¤…Nâ€² , val-pair {{VMâ€²}} {{VNâ€²}}</a>


<a id="15883" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `FST M` reduces to `Mâ€²`.</a>
<a id="15951" class="Comment">-- big-red-fst-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="16032" class="Comment">--                          â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="16077" class="Comment">--                          â†’ FST M â‡“ Mâ€²</a>
<a id="16118" class="Comment">-- big-red-fst-pair {{VMâ€²}} Mâ¤…PAIR = reds-fst-pair Mâ¤…PAIR , VMâ€²</a>


<a id="16184" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `SND M` reduces to `Nâ€²`.</a>
<a id="16252" class="Comment">-- big-red-snd-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="16333" class="Comment">--                          â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="16378" class="Comment">--                          â†’ SND M â‡“ Nâ€²</a>
<a id="16419" class="Comment">-- big-red-snd-pair {{_}} {{VNâ€²}} Mâ¤…PAIR = reds-snd-pair Mâ¤…PAIR , VNâ€²</a>


<a id="16491" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `LEFT M` reduces to `LEFT Mâ€²`.</a>
<a id="16557" class="Comment">-- big-red-left : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="16599" class="Comment">--                      â†’ M â‡“ Mâ€²</a>
<a id="16632" class="Comment">--                      â†’ LEFT M â‡“ LEFT Mâ€²</a>
<a id="16675" class="Comment">-- big-red-left (Mâ¤…Mâ€² , VMâ€²) = congs-left {{VMâ€²}} Mâ¤…Mâ€² , val-left {{VMâ€²}}</a>


<a id="16751" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `RIGHT M` reduces to `RIGHT Mâ€²`.</a>
<a id="16819" class="Comment">-- big-red-right : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="16862" class="Comment">--                       â†’ M â‡“ Mâ€²</a>
<a id="16896" class="Comment">--                       â†’ RIGHT M â‡“ RIGHT Mâ€²</a>
<a id="16942" class="Comment">-- big-red-right (Mâ¤…Mâ€² , VMâ€²) = congs-right {{VMâ€²}} Mâ¤…Mâ€² , val-right {{VMâ€²}}</a>


<a id="17021" class="Comment">-- -- If `M` reduces to `TRUE` and `N` reduces to `Nâ€²`, then `IF M N O` reduces to `Nâ€²`.</a>
<a id="17110" class="Comment">-- big-red-if-true : âˆ€ {g} â†’ {M N Nâ€² O : Term g}</a>
<a id="17159" class="Comment">--                         â†’ M â¤… TRUE â†’ N â‡“ Nâ€²</a>
<a id="17206" class="Comment">--                         â†’ IF M N O â‡“ Nâ€²</a>
<a id="17249" class="Comment">-- big-red-if-true Mâ¤…TRUE (Nâ¤…Nâ€² , VNâ€²) = reds-if-true Mâ¤…TRUE Nâ¤…Nâ€² , VNâ€²</a>


<a id="17323" class="Comment">-- -- If `M` reduces to `FALSE` and `O` reduces to `Oâ€²`, then `IF M N O` reduces to `Oâ€²`.</a>
<a id="17413" class="Comment">-- big-red-if-false : âˆ€ {g} â†’ {M N O Oâ€² : Term g}</a>
<a id="17463" class="Comment">--                          â†’ M â¤… FALSE â†’ O â‡“ Oâ€²</a>
<a id="17512" class="Comment">--                          â†’ IF M N O â‡“ Oâ€²</a>
<a id="17556" class="Comment">-- big-red-if-false Mâ¤…FALSE (Oâ¤…Oâ€² , VOâ€²) = reds-if-false Mâ¤…FALSE Oâ¤…Oâ€² , VOâ€²</a>


<a id="17634" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="17720" class="Comment">-- -- `_â‡“` is the CBV termination relation.</a>
<a id="17764" class="Comment">-- _â‡“ : âˆ€ {g} â†’ Term g â†’ Set</a>
<a id="17793" class="Comment">-- M â‡“ = Î£ (Term _) (\ Mâ€² â†’ M â‡“ Mâ€²)</a>


<a id="17831" class="Comment">-- -- Small-step reduction IN REVERSE preserves termination.</a>
<a id="17892" class="Comment">-- -- Reversed small-step reduction is halt-preserving.</a>
<a id="17948" class="Comment">-- hprâ†¦ : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="17982" class="Comment">--               â†’ M â†¦ Mâ€² â†’ Mâ€² â‡“</a>
<a id="18015" class="Comment">--               â†’ M â‡“</a>
<a id="18038" class="Comment">-- hprâ†¦ Mâ†¦Mâ€² (Mâ€³ , Mâ€²â‡“Mâ€³) = Mâ€³ , big-step Mâ†¦Mâ€² Mâ€²â‡“Mâ€³</a>


<a id="18093" class="Comment">-- -- Small-step reduction preserves termination.</a>
<a id="18143" class="Comment">-- -- Small-step reduction is halt-preserving.</a>
<a id="18190" class="Comment">-- hpâ†¦ : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="18223" class="Comment">--              â†’ M â†¦ Mâ€² â†’ M â‡“</a>
<a id="18254" class="Comment">--              â†’ Mâ€² â‡“</a>
<a id="18277" class="Comment">-- hpâ†¦ Mâ†¦Mâ€² (Mâ€³ , Mâ€²â‡“Mâ€³) = Mâ€³ , big-unstep Mâ†¦Mâ€² Mâ€²â‡“Mâ€³</a>


<a id="18333" class="Comment">-- -- If `M` terminates and `N` terminates, then `PAIR M N` terminates.</a>
<a id="18405" class="Comment">-- halt-pair : âˆ€ {g} â†’ {M N : Term g}</a>
<a id="18443" class="Comment">--                   â†’ M â‡“ â†’ N â‡“</a>
<a id="18476" class="Comment">--                   â†’ PAIR M N â‡“</a>
<a id="18510" class="Comment">-- halt-pair (Mâ€² , Mâ‡“Mâ€²) (Nâ€² , Nâ‡“Nâ€²) = PAIR Mâ€² Nâ€² , big-red-pair Mâ‡“Mâ€² Nâ‡“Nâ€²</a>


<a id="18587" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `FST M` terminates.</a>
<a id="18650" class="Comment">-- halt-fst-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="18728" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="18770" class="Comment">--                       â†’ FST M â‡“</a>
<a id="18805" class="Comment">-- halt-fst-pair {Mâ€² = Mâ€²} Mâ¤…PAIR = Mâ€² , big-red-fst-pair Mâ¤…PAIR</a>


<a id="18872" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `SND M` terminates.</a>
<a id="18935" class="Comment">-- halt-snd-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="19013" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="19055" class="Comment">--                       â†’ SND M â‡“</a>
<a id="19090" class="Comment">-- halt-snd-pair {Nâ€² = Nâ€²} Mâ¤…PAIR = Nâ€² , big-red-snd-pair Mâ¤…PAIR</a>


<a id="19157" class="Comment">-- -- If `M` terminates, then `FST M` terminates.</a>
<a id="19207" class="Comment">-- halt-fst : âˆ€ {g M A B} â†’ {Î“ : Types g}</a>
<a id="19249" class="Comment">--                        â†’ Î“ âŠ¢ M â¦‚ A âˆ§ B â†’ M â‡“</a>
<a id="19297" class="Comment">--                        â†’ FST M â‡“</a>
<a id="19333" class="Comment">-- halt-fst ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€²   , VMâ€²)       with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="19395" class="Comment">-- halt-fst ğ’Ÿ (LAM _    , _       , val-lam)   | ()</a>
<a id="19447" class="Comment">-- halt-fst ğ’Ÿ (PAIR _ _ , Mâ¤…PAIR , val-pair)  | pair _ _ = halt-fst-pair Mâ¤…PAIR</a>
<a id="19527" class="Comment">-- halt-fst ğ’Ÿ (UNIT     , _       , val-unit)  | ()</a>
<a id="19579" class="Comment">-- halt-fst ğ’Ÿ (LEFT _   , _       , val-left)  | ()</a>
<a id="19631" class="Comment">-- halt-fst ğ’Ÿ (RIGHT _  , _       , val-right) | ()</a>
<a id="19683" class="Comment">-- halt-fst ğ’Ÿ (TRUE     , _       , val-true)  | ()</a>
<a id="19735" class="Comment">-- halt-fst ğ’Ÿ (FALSE    , _       , val-false) | ()</a>


<a id="19789" class="Comment">-- -- If `M` terminates, then `SND M` terminates.</a>
<a id="19839" class="Comment">-- halt-snd : âˆ€ {g M A B} â†’ {Î“ : Types g}</a>
<a id="19881" class="Comment">--                        â†’ Î“ âŠ¢ M â¦‚ A âˆ§ B â†’ M â‡“</a>
<a id="19929" class="Comment">--                        â†’ SND M â‡“</a>
<a id="19965" class="Comment">-- halt-snd ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€²   , VMâ€²)       with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="20027" class="Comment">-- halt-snd ğ’Ÿ (LAM _    , _       , val-lam)   | ()</a>
<a id="20079" class="Comment">-- halt-snd ğ’Ÿ (PAIR _ _ , Mâ¤…PAIR , val-pair)  | pair _ _ = halt-snd-pair Mâ¤…PAIR</a>
<a id="20159" class="Comment">-- halt-snd ğ’Ÿ (UNIT     , _       , val-unit)  | ()</a>
<a id="20211" class="Comment">-- halt-snd ğ’Ÿ (LEFT _   , _       , val-left)  | ()</a>
<a id="20263" class="Comment">-- halt-snd ğ’Ÿ (RIGHT _  , _       , val-right) | ()</a>
<a id="20315" class="Comment">-- halt-snd ğ’Ÿ (TRUE     , _       , val-true)  | ()</a>
<a id="20367" class="Comment">-- halt-snd ğ’Ÿ (FALSE    , _       , val-false) | ()</a>


<a id="20421" class="Comment">-- -- If `M` terminates, then `ABORT M` terminates.</a>
<a id="20473" class="Comment">-- halt-abort : âˆ€ {g M} â†’ {Î“ : Types g}</a>
<a id="20513" class="Comment">--                      â†’ Î“ âŠ¢ M â¦‚ ğŸ˜ â†’ M â‡“</a>
<a id="20555" class="Comment">--                      â†’ ABORT M â‡“</a>
<a id="20591" class="Comment">-- halt-abort ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€² , VMâ€²)       with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="20653" class="Comment">-- halt-abort ğ’Ÿ (LAM _    , _     , val-lam)   | ()</a>
<a id="20705" class="Comment">-- halt-abort ğ’Ÿ (PAIR _ _ , _     , val-pair)  | ()</a>
<a id="20757" class="Comment">-- halt-abort ğ’Ÿ (UNIT     , _     , val-unit)  | ()</a>
<a id="20809" class="Comment">-- halt-abort ğ’Ÿ (LEFT _   , _     , val-left)  | ()</a>
<a id="20861" class="Comment">-- halt-abort ğ’Ÿ (RIGHT _  , _     , val-right) | ()</a>
<a id="20913" class="Comment">-- halt-abort ğ’Ÿ (TRUE     , _     , val-true)  | ()</a>
<a id="20965" class="Comment">-- halt-abort ğ’Ÿ (FALSE    , _     , val-false) | ()</a>


<a id="21019" class="Comment">-- -- If `M` terminates, then `LEFT M` terminates.</a>
<a id="21070" class="Comment">-- halt-left : âˆ€ {g} â†’ {M : Term g}</a>
<a id="21106" class="Comment">--                   â†’ M â‡“</a>
<a id="21133" class="Comment">--                   â†’ LEFT M â‡“</a>
<a id="21165" class="Comment">-- halt-left (Mâ€² , Mâ‡“Mâ€²) = LEFT Mâ€² , big-red-left Mâ‡“Mâ€²</a>


<a id="21222" class="Comment">-- -- If `M` terminates, then `RIGHT M` terminates.</a>
<a id="21274" class="Comment">-- halt-right : âˆ€ {g} â†’ {M : Term g}</a>
<a id="21311" class="Comment">--                    â†’ M â‡“</a>
<a id="21339" class="Comment">--                    â†’ RIGHT M â‡“</a>
<a id="21373" class="Comment">-- halt-right (Mâ€² , Mâ‡“Mâ€²) = RIGHT Mâ€² , big-red-right Mâ‡“Mâ€²</a>


<a id="21433" class="Comment">-- -- If `M` reduces to `TRUE` and `N` terminates, then `IF M N O` terminates.</a>
<a id="21512" class="Comment">-- halt-if-true : âˆ€ {g} â†’ {M N O : Term g}</a>
<a id="21555" class="Comment">--                      â†’ M â¤… TRUE â†’ N â‡“</a>
<a id="21596" class="Comment">--                      â†’ IF M N O â‡“</a>
<a id="21633" class="Comment">-- halt-if-true Mâ¤…TRUE (Nâ€² , Nâ‡“Nâ€²) = Nâ€² , big-red-if-true Mâ¤…TRUE Nâ‡“Nâ€²</a>


<a id="21705" class="Comment">-- -- If `M` reduces to `FALSE` and `O` terminates, then `IF M N O` terminates.</a>
<a id="21785" class="Comment">-- halt-if-false : âˆ€ {g} â†’ {M N O : Term g}</a>
<a id="21829" class="Comment">--                       â†’ M â¤… FALSE â†’ O â‡“</a>
<a id="21872" class="Comment">--                       â†’ IF M N O â‡“</a>
<a id="21910" class="Comment">-- halt-if-false Mâ¤…FALSE (Oâ€² , Oâ‡“Oâ€²) = Oâ€² , big-red-if-false Mâ¤…FALSE Oâ‡“Oâ€²</a>


<a id="21986" class="Comment">-- -- If `M` terminates and `N` terminates and `O` terminates, then `IF M N O` terminates.</a>
<a id="22077" class="Comment">-- halt-if : âˆ€ {g M N O} â†’ {Î“ : Types g}</a>
<a id="22118" class="Comment">--                       â†’ Î“ âŠ¢ M â¦‚ ğ”¹ â†’ M â‡“ â†’ N â‡“ â†’ O â‡“</a>
<a id="22173" class="Comment">--                       â†’ IF M N O â‡“</a>
<a id="22211" class="Comment">-- halt-if ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€²    , VMâ€²)       Nâ‡“ Oâ‡“ with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="22279" class="Comment">-- halt-if ğ’Ÿ (LAM _    , _        , val-lam)   Nâ‡“ Oâ‡“ | ()</a>
<a id="22337" class="Comment">-- halt-if ğ’Ÿ (PAIR _ _ , _        , val-pair)  Nâ‡“ Oâ‡“ | ()</a>
<a id="22395" class="Comment">-- halt-if ğ’Ÿ (UNIT     , _        , val-unit)  Nâ‡“ Oâ‡“ | ()</a>
<a id="22453" class="Comment">-- halt-if ğ’Ÿ (LEFT _   , _        , val-left)  Nâ‡“ Oâ‡“ | ()</a>
<a id="22511" class="Comment">-- halt-if ğ’Ÿ (RIGHT _  , _        , val-right) Nâ‡“ Oâ‡“ | ()</a>
<a id="22569" class="Comment">-- halt-if ğ’Ÿ (TRUE     , Mâ¤…TRUE  , val-true)  Nâ‡“ Oâ‡“ | true  = halt-if-true Mâ¤…TRUE Nâ‡“</a>
<a id="22654" class="Comment">-- halt-if ğ’Ÿ (FALSE    , Mâ¤…FALSE , val-false) Nâ‡“ Oâ‡“ | false = halt-if-false Mâ¤…FALSE Oâ‡“</a>


<a id="22743" class="Comment">-- -- Every well-typed term terminates.</a>
<a id="22783" class="Comment">-- -- Impossible without a stronger induction hypothesis.</a>
<a id="22841" class="Comment">-- {-</a>
<a id="22847" class="Comment">-- halt : âˆ€ {M A} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="22877" class="Comment">--                â†’ M â‡“</a>
<a id="22901" class="Comment">-- halt (var ())</a>
<a id="22918" class="Comment">-- halt (lam ğ’Ÿ)      = LAM _ , done , val-lam</a>
<a id="22964" class="Comment">-- halt (app ğ’Ÿ â„°)    = {!!}</a>
<a id="22992" class="Comment">-- halt (pair ğ’Ÿ â„°)   = halt-pair (halt ğ’Ÿ) (halt â„°)</a>
<a id="23043" class="Comment">-- halt (fst ğ’Ÿ)      = halt-fst ğ’Ÿ (halt ğ’Ÿ)</a>
<a id="23086" class="Comment">-- halt (snd ğ’Ÿ)      = halt-snd ğ’Ÿ (halt ğ’Ÿ)</a>
<a id="23129" class="Comment">-- halt unit         = UNIT , done , val-unit</a>
<a id="23175" class="Comment">-- halt (abort ğ’Ÿ)    = halt-abort ğ’Ÿ (halt ğ’Ÿ)</a>
<a id="23220" class="Comment">-- halt (left ğ’Ÿ)     = halt-left (halt ğ’Ÿ)</a>
<a id="23262" class="Comment">-- halt (right ğ’Ÿ)    = halt-right (halt ğ’Ÿ)</a>
<a id="23305" class="Comment">-- halt (case ğ’Ÿ â„° â„±) = {!!}</a>
<a id="23333" class="Comment">-- halt true         = TRUE , done , val-true</a>
<a id="23379" class="Comment">-- halt false        = FALSE , done , val-false</a>
<a id="23427" class="Comment">-- halt (if ğ’Ÿ â„° â„±)   = halt-if ğ’Ÿ (halt ğ’Ÿ) (halt â„°) (halt â„±)</a>
<a id="23487" class="Comment">-- -}</a>


<a id="23495" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="23581" class="Comment">-- red-app-lam : âˆ€ {g n M N} â†’ {Ï„ : Terms g n} â†’ {{_ : Val N}}</a>
<a id="23644" class="Comment">--                           â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â†¦ SUB (Ï„ , N) M</a>
<a id="23721" class="Comment">-- red-app-lam {M = M} {N} {Ï„} rewrite simp-CUT-SUB N Ï„ M â»Â¹ = red app-lam</a>


<a id="23798" class="Comment">-- big-red-app-lam : âˆ€ {g n M Mâ€² N} â†’ {Ï„ : Terms g n} â†’ {{_ : Val N}}</a>
<a id="23868" class="Comment">--                                  â†’ SUB (Ï„ , N) M â‡“ Mâ€²</a>
<a id="23925" class="Comment">--                                  â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“ Mâ€²</a>
<a id="23998" class="Comment">-- big-red-app-lam {M = M} (SUBâ¤…Mâ€² , VMâ€²) = step (red-app-lam {M = M}) SUBâ¤…Mâ€² , VMâ€²</a>


<a id="24084" class="Comment">-- halt-app-lam : âˆ€ {g n M N} â†’ {Ï„ : Terms g n} â†’ {{_ : Val N}}</a>
<a id="24148" class="Comment">--                            â†’ SUB (Ï„ , N) M â‡“</a>
<a id="24196" class="Comment">--                            â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“</a>
<a id="24260" class="Comment">-- halt-app-lam {M = M} (Mâ€² , SUBâ‡“Mâ€²) = Mâ€² , big-red-app-lam {M = M} SUBâ‡“Mâ€²</a>


<a id="24338" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="24424" class="Comment">-- red-case-left : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="24491" class="Comment">--                               â†’ CASE (LEFT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â†¦ SUB (Ï„ , M) N</a>
<a id="24592" class="Comment">-- red-case-left {M = M} {N} {Ï„ = Ï„} rewrite simp-CUT-SUB M Ï„ N â»Â¹ = red case-left</a>


<a id="24677" class="Comment">-- big-red-case-left : âˆ€ {g n M N Nâ€² O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="24751" class="Comment">--                                      â†’ SUB (Ï„ , M) N â‡“ Nâ€²</a>
<a id="24812" class="Comment">--                                      â†’ CASE (LEFT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“ Nâ€²</a>
<a id="24909" class="Comment">-- big-red-case-left {N = N} {O = O} (SUBâ¤…Nâ€² , VNâ€²) = step (red-case-left {N = N} {O}) SUBâ¤…Nâ€² , VNâ€²</a>


<a id="25011" class="Comment">-- halt-case-left : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="25079" class="Comment">--                                â†’ SUB (Ï„ , M) N â‡“</a>
<a id="25131" class="Comment">--                                â†’ CASE (LEFT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“</a>
<a id="25219" class="Comment">-- halt-case-left {N = N} {O} (Nâ€² , SUBâ‡“Nâ€²) = Nâ€² , big-red-case-left {N = N} {O = O} SUBâ‡“Nâ€²</a>


<a id="25313" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="25399" class="Comment">-- red-case-right : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="25467" class="Comment">--                                â†’ CASE (RIGHT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â†¦ SUB (Ï„ , M) O</a>
<a id="25570" class="Comment">-- red-case-right {M = M} {O = O} {Ï„} rewrite simp-CUT-SUB M Ï„ O â»Â¹ = red case-right</a>


<a id="25657" class="Comment">-- big-red-case-right : âˆ€ {g n M N O Oâ€²} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="25732" class="Comment">--                                       â†’ SUB (Ï„ , M) O â‡“ Oâ€²</a>
<a id="25794" class="Comment">--                                       â†’ CASE (RIGHT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“ Oâ€²</a>
<a id="25893" class="Comment">-- big-red-case-right {N = N} {O} (SUBâ¤…Oâ€² , VOâ€²) = step (red-case-right {N = N} {O}) SUBâ¤…Oâ€² , VOâ€²</a>


<a id="25993" class="Comment">-- halt-case-right : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="26062" class="Comment">--                                 â†’ SUB (Ï„ , M) O â‡“</a>
<a id="26115" class="Comment">--                                 â†’ CASE (RIGHT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“</a>
<a id="26205" class="Comment">-- halt-case-right {N = N} {O} (Oâ€² , SUBâ‡“Oâ€²) = Oâ€² , big-red-case-right {N = N} {O} SUBâ‡“Oâ€²</a>


<a id="26297" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>