<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR2</title><link rel="stylesheet" href="AgdaPP.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="A201802.WIP.LR2.html" class="Module">A201802.WIP.LR2</a> <a id="24" class="Keyword">where</a>

<a id="31" class="Keyword">open</a> <a id="36" class="Keyword">import</a> <a id="43" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="59" class="Keyword">open</a> <a id="64" class="Keyword">import</a> <a id="71" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="A201801.Fin.html" class="Module">A201801.Fin</a>
<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="A201801.FinLemmas.html" class="Module">A201801.FinLemmas</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="A201801.Vec.html" class="Module">A201801.Vec</a>
<a id="166" class="Keyword">open</a> <a id="171" class="Keyword">import</a> <a id="178" href="A201801.VecLemmas.html" class="Module">A201801.VecLemmas</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="A201801.AllVec.html" class="Module">A201801.AllVec</a>

<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="A201802.LR0.html" class="Module">A201802.LR0</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="A201802.LR0Lemmas.html" class="Module">A201802.LR0Lemmas</a>
<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="A201802.LR1.html" class="Module">A201802.LR1</a>


<a id="304" class="Comment">--------------------------------------------------------------------------------</a>


<a id="387" class="Comment">-- `Val M` says that the term `M` is a value.</a>
<a id="433" class="Keyword">data</a> <a id="Val"></a><a id="438" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="442" class="Symbol">{</a><a id="443" href="A201802.WIP.LR2.html#443" class="Bound">g</a><a id="444" class="Symbol">}</a> <a id="446" class="Symbol">:</a> <a id="448" href="A201802.LR0.html#547" class="Datatype">Term</a> <a id="453" href="A201802.WIP.LR2.html#443" class="Bound">g</a> <a id="455" class="Symbol">â†’</a> <a id="457" class="PrimitiveType">Set</a>
  <a id="463" class="Keyword">where</a>
    <a id="473" class="Keyword">instance</a>
      <a id="Val.val-lam"></a><a id="488" href="A201802.WIP.LR2.html#488" class="InductiveConstructor">val-lam</a>   <a id="498" class="Symbol">:</a> <a id="500" class="Symbol">âˆ€</a> <a id="502" class="Symbol">{</a><a id="503" href="A201802.WIP.LR2.html#503" class="Bound">M</a><a id="504" class="Symbol">}</a> <a id="506" class="Symbol">â†’</a> <a id="508" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="512" class="Symbol">(</a><a id="513" href="A201802.LR0.html#607" class="InductiveConstructor">LAM</a> <a id="517" href="A201802.WIP.LR2.html#503" class="Bound">M</a><a id="518" class="Symbol">)</a>
      <a id="Val.val-pair"></a><a id="526" href="A201802.WIP.LR2.html#526" class="InductiveConstructor">val-pair</a>  <a id="536" class="Symbol">:</a> <a id="538" class="Symbol">âˆ€</a> <a id="540" class="Symbol">{</a><a id="541" href="A201802.WIP.LR2.html#541" class="Bound">M</a> <a id="543" href="A201802.WIP.LR2.html#543" class="Bound">N</a><a id="544" class="Symbol">}</a> <a id="546" class="Symbol">â†’</a> <a id="548" class="Symbol">{{</a><a id="550" href="A201802.WIP.LR2.html#550" class="Bound">_</a> <a id="552" class="Symbol">:</a> <a id="554" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="558" href="A201802.WIP.LR2.html#541" class="Bound">M</a><a id="559" class="Symbol">}}</a> <a id="562" class="Symbol">{{</a><a id="564" href="A201802.WIP.LR2.html#564" class="Bound">_</a> <a id="566" class="Symbol">:</a> <a id="568" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="572" href="A201802.WIP.LR2.html#543" class="Bound">N</a><a id="573" class="Symbol">}}</a> <a id="576" class="Symbol">â†’</a> <a id="578" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="582" class="Symbol">(</a><a id="583" href="A201802.LR0.html#678" class="InductiveConstructor">PAIR</a> <a id="588" href="A201802.WIP.LR2.html#541" class="Bound">M</a> <a id="590" href="A201802.WIP.LR2.html#543" class="Bound">N</a><a id="591" class="Symbol">)</a>
      <a id="Val.val-unit"></a><a id="599" href="A201802.WIP.LR2.html#599" class="InductiveConstructor">val-unit</a>  <a id="609" class="Symbol">:</a> <a id="611" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="615" href="A201802.LR0.html#771" class="InductiveConstructor">UNIT</a>
      <a id="Val.val-left"></a><a id="626" href="A201802.WIP.LR2.html#626" class="InductiveConstructor">val-left</a>  <a id="636" class="Symbol">:</a> <a id="638" class="Symbol">âˆ€</a> <a id="640" class="Symbol">{</a><a id="641" href="A201802.WIP.LR2.html#641" class="Bound">M</a><a id="642" class="Symbol">}</a> <a id="644" class="Symbol">â†’</a> <a id="646" class="Symbol">{{</a><a id="648" href="A201802.WIP.LR2.html#648" class="Bound">_</a> <a id="650" class="Symbol">:</a> <a id="652" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="656" href="A201802.WIP.LR2.html#641" class="Bound">M</a><a id="657" class="Symbol">}}</a> <a id="660" class="Symbol">â†’</a> <a id="662" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="666" class="Symbol">(</a><a id="667" href="A201802.LR0.html#818" class="InductiveConstructor">LEFT</a> <a id="672" href="A201802.WIP.LR2.html#641" class="Bound">M</a><a id="673" class="Symbol">)</a>
      <a id="Val.val-right"></a><a id="681" href="A201802.WIP.LR2.html#681" class="InductiveConstructor">val-right</a> <a id="691" class="Symbol">:</a> <a id="693" class="Symbol">âˆ€</a> <a id="695" class="Symbol">{</a><a id="696" href="A201802.WIP.LR2.html#696" class="Bound">M</a><a id="697" class="Symbol">}</a> <a id="699" class="Symbol">â†’</a> <a id="701" class="Symbol">{{</a><a id="703" href="A201802.WIP.LR2.html#703" class="Bound">_</a> <a id="705" class="Symbol">:</a> <a id="707" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="711" href="A201802.WIP.LR2.html#696" class="Bound">M</a><a id="712" class="Symbol">}}</a> <a id="715" class="Symbol">â†’</a> <a id="717" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="721" class="Symbol">(</a><a id="722" href="A201802.LR0.html#846" class="InductiveConstructor">RIGHT</a> <a id="728" href="A201802.WIP.LR2.html#696" class="Bound">M</a><a id="729" class="Symbol">)</a>
      <a id="Val.val-true"></a><a id="737" href="A201802.WIP.LR2.html#737" class="InductiveConstructor">val-true</a>  <a id="747" class="Symbol">:</a> <a id="749" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="753" href="A201802.LR0.html#932" class="InductiveConstructor">TRUE</a>
      <a id="Val.val-false"></a><a id="764" href="A201802.WIP.LR2.html#764" class="InductiveConstructor">val-false</a> <a id="774" class="Symbol">:</a> <a id="776" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="780" href="A201802.LR0.html#951" class="InductiveConstructor">FALSE</a>


<a id="788" class="Comment">-- `Vals Ï„` says that all terms `Ï„` are values.</a>
<a id="836" class="Keyword">data</a> <a id="Vals"></a><a id="841" href="A201802.WIP.LR2.html#841" class="Datatype">Vals</a> <a id="846" class="Symbol">{</a><a id="847" href="A201802.WIP.LR2.html#847" class="Bound">g</a><a id="848" class="Symbol">}</a> <a id="850" class="Symbol">:</a> <a id="852" class="Symbol">âˆ€</a> <a id="854" class="Symbol">{</a><a id="855" href="A201802.WIP.LR2.html#855" class="Bound">n</a><a id="856" class="Symbol">}</a> <a id="858" class="Symbol">â†’</a> <a id="860" href="A201802.LR0.html#1014" class="Function">Terms</a> <a id="866" href="A201802.WIP.LR2.html#847" class="Bound">g</a> <a id="868" href="A201802.WIP.LR2.html#855" class="Bound">n</a> <a id="870" class="Symbol">â†’</a> <a id="872" class="PrimitiveType">Set</a>
  <a id="878" class="Keyword">where</a>
    <a id="888" class="Keyword">instance</a>
      <a id="Vals.âˆ™"></a><a id="903" href="A201802.WIP.LR2.html#903" class="InductiveConstructor">âˆ™</a>   <a id="907" class="Symbol">:</a> <a id="909" href="A201802.WIP.LR2.html#841" class="Datatype">Vals</a> <a id="914" href="A201801.Vec.html#266" class="InductiveConstructor">âˆ™</a>
      <a id="Vals._,_"></a><a id="922" href="A201802.WIP.LR2.html#922" class="InductiveConstructor Operator">_,_</a> <a id="926" class="Symbol">:</a> <a id="928" class="Symbol">âˆ€</a> <a id="930" class="Symbol">{</a><a id="931" href="A201802.WIP.LR2.html#931" class="Bound">n</a> <a id="933" href="A201802.WIP.LR2.html#933" class="Bound">M</a><a id="934" class="Symbol">}</a> <a id="936" class="Symbol">â†’</a> <a id="938" class="Symbol">{</a><a id="939" href="A201802.WIP.LR2.html#939" class="Bound">Ï„</a> <a id="941" class="Symbol">:</a> <a id="943" href="A201802.LR0.html#1014" class="Function">Terms</a> <a id="949" href="A201802.WIP.LR2.html#847" class="Bound">g</a> <a id="951" href="A201802.WIP.LR2.html#931" class="Bound">n</a><a id="952" class="Symbol">}</a> <a id="954" class="Symbol">â†’</a> <a id="956" href="A201802.WIP.LR2.html#841" class="Datatype">Vals</a> <a id="961" href="A201802.WIP.LR2.html#939" class="Bound">Ï„</a> <a id="963" class="Symbol">â†’</a> <a id="965" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="969" href="A201802.WIP.LR2.html#933" class="Bound">M</a> <a id="971" class="Symbol">â†’</a> <a id="973" href="A201802.WIP.LR2.html#841" class="Datatype">Vals</a> <a id="978" class="Symbol">(</a><a id="979" href="A201802.WIP.LR2.html#939" class="Bound">Ï„</a> <a id="981" href="A201801.Vec.html#287" class="InductiveConstructor Operator">,</a> <a id="983" href="A201802.WIP.LR2.html#933" class="Bound">M</a><a id="984" class="Symbol">)</a>



<a id="hm"></a><a id="989" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="992" class="Symbol">:</a> <a id="994" class="Symbol">(</a><a id="995" href="A201802.WIP.LR2.html#995" class="Bound">M</a> <a id="997" class="Symbol">:</a> <a id="999" href="A201802.LR0.html#547" class="Datatype">Term</a> <a id="1004" class="Number">0</a><a id="1005" class="Symbol">)</a> <a id="1007" class="Symbol">(</a><a id="1008" href="A201802.WIP.LR2.html#1008" class="Bound">VM</a> <a id="1011" class="Symbol">:</a> <a id="1013" href="A201802.WIP.LR2.html#438" class="Datatype">Val</a> <a id="1017" href="A201802.WIP.LR2.html#995" class="Bound">M</a><a id="1018" class="Symbol">)</a> <a id="1020" class="Symbol">â†’</a> <a id="1022" href="A201801.Prelude.html#1191" class="Function Operator">Â¬</a> <a id="1024" class="Symbol">(</a><a id="1025" href="A201801.Vec.html#266" class="InductiveConstructor">âˆ™</a> <a id="1027" href="A201802.LR1.html#348" class="Datatype Operator">âŠ¢</a> <a id="1029" href="A201802.WIP.LR2.html#995" class="Bound">M</a> <a id="1031" href="A201802.LR1.html#348" class="Datatype Operator">â¦‚</a> <a id="1033" href="A201802.LR0.html#332" class="InductiveConstructor">ğŸ˜</a><a id="1034" class="Symbol">)</a>
<a id="1036" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1039" class="Symbol">(</a><a id="1040" href="A201802.LR0.html#580" class="InductiveConstructor">VAR</a> <a id="1044" href="A201802.WIP.LR2.html#1044" class="Bound">I</a><a id="1045" class="Symbol">)</a> <a id="1047" class="Symbol">()</a>
<a id="1050" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1053" class="Symbol">(</a><a id="1054" href="A201802.LR0.html#607" class="InductiveConstructor">LAM</a> <a id="1058" href="A201802.WIP.LR2.html#1058" class="Bound">M</a><a id="1059" class="Symbol">)</a> <a id="1061" href="A201802.WIP.LR2.html#488" class="InductiveConstructor">val-lam</a> <a id="1069" class="Symbol">=</a> <a id="1071" class="Symbol">Î»</a> <a id="1073" class="Symbol">()</a>
<a id="1076" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1079" class="Symbol">(</a><a id="1080" href="A201802.LR0.html#641" class="InductiveConstructor">APP</a> <a id="1084" href="A201802.WIP.LR2.html#1084" class="Bound">M</a> <a id="1086" href="A201802.WIP.LR2.html#1086" class="Bound">N</a><a id="1087" class="Symbol">)</a> <a id="1089" class="Symbol">()</a>
<a id="1092" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1095" class="Symbol">(</a><a id="1096" href="A201802.LR0.html#678" class="InductiveConstructor">PAIR</a> <a id="1101" href="A201802.WIP.LR2.html#1101" class="Bound">M</a> <a id="1103" href="A201802.WIP.LR2.html#1103" class="Bound">N</a><a id="1104" class="Symbol">)</a> <a id="1106" class="Symbol">(</a><a id="1107" href="A201802.WIP.LR2.html#526" class="InductiveConstructor">val-pair</a><a id="1115" class="Symbol">)</a> <a id="1117" class="Symbol">=</a> <a id="1119" class="Symbol">Î»</a> <a id="1121" class="Symbol">()</a>
<a id="1124" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1127" class="Symbol">(</a><a id="1128" href="A201802.LR0.html#715" class="InductiveConstructor">FST</a> <a id="1132" href="A201802.WIP.LR2.html#1132" class="Bound">M</a><a id="1133" class="Symbol">)</a> <a id="1135" class="Symbol">()</a>
<a id="1138" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1141" class="Symbol">(</a><a id="1142" href="A201802.LR0.html#743" class="InductiveConstructor">SND</a> <a id="1146" href="A201802.WIP.LR2.html#1146" class="Bound">M</a><a id="1147" class="Symbol">)</a> <a id="1149" class="Symbol">()</a>
<a id="1152" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1155" href="A201802.LR0.html#771" class="InductiveConstructor">UNIT</a> <a id="1160" href="A201802.WIP.LR2.html#599" class="InductiveConstructor">val-unit</a> <a id="1169" class="Symbol">=</a> <a id="1171" class="Symbol">Î»</a> <a id="1173" class="Symbol">()</a>
<a id="1176" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1179" class="Symbol">(</a><a id="1180" href="A201802.LR0.html#790" class="InductiveConstructor">ABORT</a> <a id="1186" href="A201802.WIP.LR2.html#1186" class="Bound">M</a><a id="1187" class="Symbol">)</a> <a id="1189" class="Symbol">()</a>
<a id="1192" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1195" class="Symbol">(</a><a id="1196" href="A201802.LR0.html#818" class="InductiveConstructor">LEFT</a> <a id="1201" href="A201802.WIP.LR2.html#1201" class="Bound">M</a><a id="1202" class="Symbol">)</a> <a id="1204" class="Symbol">(</a><a id="1205" href="A201802.WIP.LR2.html#626" class="InductiveConstructor">val-left</a> <a id="1214" class="Symbol">{{</a><a id="1216" href="A201802.WIP.LR2.html#1216" class="Bound">VM</a><a id="1218" class="Symbol">}})</a> <a id="1222" class="Symbol">=</a> <a id="1224" class="Symbol">Î»</a> <a id="1226" class="Symbol">()</a>
<a id="1229" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1232" class="Symbol">(</a><a id="1233" href="A201802.LR0.html#846" class="InductiveConstructor">RIGHT</a> <a id="1239" href="A201802.WIP.LR2.html#1239" class="Bound">M</a><a id="1240" class="Symbol">)</a> <a id="1242" class="Symbol">(</a><a id="1243" href="A201802.WIP.LR2.html#681" class="InductiveConstructor">val-right</a> <a id="1253" class="Symbol">{{</a><a id="1255" href="A201802.WIP.LR2.html#1255" class="Bound">VN</a><a id="1257" class="Symbol">}})</a> <a id="1261" class="Symbol">=</a> <a id="1263" class="Symbol">Î»</a> <a id="1265" class="Symbol">()</a>
<a id="1268" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1271" class="Symbol">(</a><a id="1272" href="A201802.LR0.html#874" class="InductiveConstructor">CASE</a> <a id="1277" href="A201802.WIP.LR2.html#1277" class="Bound">M</a> <a id="1279" href="A201802.WIP.LR2.html#1279" class="Bound">N</a> <a id="1281" href="A201802.WIP.LR2.html#1281" class="Bound">O</a><a id="1282" class="Symbol">)</a> <a id="1284" class="Symbol">()</a>
<a id="1287" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1290" href="A201802.LR0.html#932" class="InductiveConstructor">TRUE</a> <a id="1295" href="A201802.WIP.LR2.html#737" class="InductiveConstructor">val-true</a> <a id="1304" class="Symbol">=</a> <a id="1306" class="Symbol">Î»</a> <a id="1308" class="Symbol">()</a>
<a id="1311" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1314" href="A201802.LR0.html#951" class="InductiveConstructor">FALSE</a> <a id="1320" href="A201802.WIP.LR2.html#764" class="InductiveConstructor">val-false</a> <a id="1330" class="Symbol">=</a> <a id="1332" class="Symbol">Î»</a> <a id="1334" class="Symbol">()</a>
<a id="1337" href="A201802.WIP.LR2.html#989" class="Function">hm</a> <a id="1340" class="Symbol">(</a><a id="1341" href="A201802.LR0.html#970" class="InductiveConstructor">IF</a> <a id="1344" href="A201802.WIP.LR2.html#1344" class="Bound">M</a> <a id="1346" href="A201802.WIP.LR2.html#1346" class="Bound">N</a> <a id="1348" href="A201802.WIP.LR2.html#1348" class="Bound">O</a><a id="1349" class="Symbol">)</a> <a id="1351" class="Symbol">()</a>


<a id="1356" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1442" class="Comment">-- -- `_â¤ _` is the CBV computation relation.</a>
<a id="1487" class="Comment">-- infix 3 _â¤ _</a>
<a id="1502" class="Comment">-- data _â¤ _ {g} : Term g â†’ Term g â†’ Set</a>
<a id="1542" class="Comment">--   where</a>
<a id="1553" class="Comment">--     app-lam    : âˆ€ {M N} â†’ {{_ : Val N}} â†’ APP (LAM M) N â¤  CUT N M</a>
<a id="1623" class="Comment">--     fst-pair   : âˆ€ {M N} â†’ {{_ : Val M}} {{_ : Val N}} â†’ FST (PAIR M N) â¤  M</a>
<a id="1702" class="Comment">--     snd-pair   : âˆ€ {M N} â†’ {{_ : Val M}} {{_ : Val N}} â†’ SND (PAIR M N) â¤  N</a>
<a id="1781" class="Comment">--     case-left  : âˆ€ {M N O} â†’ {{_ : Val M}} â†’ CASE (LEFT M) N O â¤  CUT M N</a>
<a id="1857" class="Comment">--     case-right : âˆ€ {M N O} â†’ {{_ : Val M}} â†’ CASE (RIGHT M) N O â¤  CUT M O</a>
<a id="1934" class="Comment">--     if-true    : âˆ€ {N O} â†’ IF TRUE N O â¤  N</a>
<a id="1980" class="Comment">--     if-false   : âˆ€ {N O} â†’ IF FALSE N O â¤  O</a>


<a id="2029" class="Comment">-- -- Values do not compute.</a>
<a id="2058" class="Comment">-- Â¬valâ¤  : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val M}}</a>
<a id="2109" class="Comment">--                â†’ Â¬ (M â¤  Mâ€²)</a>
<a id="2140" class="Comment">-- Â¬valâ¤  {{val-lam}}   ()</a>
<a id="2166" class="Comment">-- Â¬valâ¤  {{val-pair}}  ()</a>
<a id="2192" class="Comment">-- Â¬valâ¤  {{val-unit}}  ()</a>
<a id="2218" class="Comment">-- Â¬valâ¤  {{val-left}}  ()</a>
<a id="2244" class="Comment">-- Â¬valâ¤  {{val-right}} ()</a>
<a id="2270" class="Comment">-- Â¬valâ¤  {{val-true}}  ()</a>
<a id="2296" class="Comment">-- Â¬valâ¤  {{val-false}} ()</a>


<a id="2324" class="Comment">-- -- Computation is deterministic.</a>
<a id="2360" class="Comment">-- detâ¤  : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="2399" class="Comment">--               â†’ M â¤  Mâ€²â‚ â†’ M â¤  Mâ€²â‚‚</a>
<a id="2436" class="Comment">--               â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="2465" class="Comment">-- detâ¤  app-lam    app-lam    = refl</a>
<a id="2502" class="Comment">-- detâ¤  fst-pair   fst-pair   = refl</a>
<a id="2539" class="Comment">-- detâ¤  snd-pair   snd-pair   = refl</a>
<a id="2576" class="Comment">-- detâ¤  case-left  case-left  = refl</a>
<a id="2613" class="Comment">-- detâ¤  case-right case-right = refl</a>
<a id="2650" class="Comment">-- detâ¤  if-true    if-true    = refl</a>
<a id="2687" class="Comment">-- detâ¤  if-false   if-false   = refl</a>


<a id="2726" class="Comment">-- -- Computation is type-preserving.</a>
<a id="2764" class="Comment">-- tpâ¤  : âˆ€ {g M Mâ€² A} â†’ {Î“ : Types g}</a>
<a id="2802" class="Comment">--                     â†’ M â¤  Mâ€² â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="2846" class="Comment">--                     â†’ Î“ âŠ¢ Mâ€² â¦‚ A</a>
<a id="2882" class="Comment">-- tpâ¤  app-lam    (app (lam ğ’Ÿ) â„°)      = cut â„° ğ’Ÿ</a>
<a id="2931" class="Comment">-- tpâ¤  fst-pair   (fst (pair ğ’Ÿ â„°))     = ğ’Ÿ</a>
<a id="2974" class="Comment">-- tpâ¤  snd-pair   (snd (pair ğ’Ÿ â„°))     = â„°</a>
<a id="3017" class="Comment">-- tpâ¤  case-left  (case (left ğ’Ÿ) â„° â„±)  = cut ğ’Ÿ â„°</a>
<a id="3066" class="Comment">-- tpâ¤  case-right (case (right ğ’Ÿ) â„° â„±) = cut ğ’Ÿ â„±</a>
<a id="3115" class="Comment">-- tpâ¤  if-true    (if ğ’Ÿ â„° â„±)           = â„°</a>
<a id="3158" class="Comment">-- tpâ¤  if-false   (if ğ’Ÿ â„° â„±)           = â„±</a>


<a id="3203" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="3289" class="Comment">-- -- `_â†¦_` is the CBV small-step reduction relation.</a>
<a id="3343" class="Comment">-- infix 3 _â†¦_</a>
<a id="3358" class="Comment">-- data _â†¦_ {g} : Term g â†’ Term g â†’ Set</a>
<a id="3398" class="Comment">--   where</a>
<a id="3409" class="Comment">--     red : âˆ€ {M Mâ€²} â†’ M â¤  Mâ€²</a>
<a id="3440" class="Comment">--                    â†’ M â†¦ Mâ€²</a>

<a id="3472" class="Comment">--     cong-appâ‚ : âˆ€ {M Mâ€² N} â†’ M â†¦ Mâ€²</a>
<a id="3511" class="Comment">--                            â†’ APP M N â†¦ APP Mâ€² N</a>

<a id="3563" class="Comment">--     cong-appâ‚‚ : âˆ€ {M N Nâ€²} â†’ {{_ : Val M}}</a>
<a id="3609" class="Comment">--                            â†’ N â†¦ Nâ€²</a>
<a id="3648" class="Comment">--                            â†’ APP M N â†¦ APP M Nâ€²</a>

<a id="3700" class="Comment">--     cong-pairâ‚ : âˆ€ {M Mâ€² N} â†’ M â†¦ Mâ€²</a>
<a id="3740" class="Comment">--                             â†’ PAIR M N â†¦ PAIR Mâ€² N</a>

<a id="3795" class="Comment">--     cong-pairâ‚‚ : âˆ€ {M N Nâ€²} â†’ {{_ : Val M}}</a>
<a id="3842" class="Comment">--                             â†’ N â†¦ Nâ€²</a>
<a id="3882" class="Comment">--                             â†’ PAIR M N â†¦ PAIR M Nâ€²</a>

<a id="3937" class="Comment">--     cong-fst : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="3973" class="Comment">--                         â†’ FST M â†¦ FST Mâ€²</a>

<a id="4018" class="Comment">--     cong-snd : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4054" class="Comment">--                         â†’ SND M â†¦ SND Mâ€²</a>

<a id="4099" class="Comment">--     cong-abort : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4137" class="Comment">--                           â†’ ABORT M â†¦ ABORT Mâ€²</a>

<a id="4188" class="Comment">--     cong-left : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4225" class="Comment">--                          â†’ LEFT M â†¦ LEFT Mâ€²</a>

<a id="4273" class="Comment">--     cong-right : âˆ€ {M Mâ€²} â†’ M â†¦ Mâ€²</a>
<a id="4311" class="Comment">--                           â†’ RIGHT M â†¦ RIGHT Mâ€²</a>

<a id="4362" class="Comment">--     cong-case : âˆ€ {M Mâ€² N O} â†’ M â†¦ Mâ€²</a>
<a id="4403" class="Comment">--                              â†’ CASE M N O â†¦ CASE Mâ€² N O</a>

<a id="4463" class="Comment">--     cong-if : âˆ€ {M Mâ€² N O} â†’ M â†¦ Mâ€²</a>
<a id="4502" class="Comment">--                            â†’ IF M N O â†¦ IF Mâ€² N O</a>


<a id="4557" class="Comment">-- -- Values do not reduce.</a>
<a id="4585" class="Comment">-- Â¬valâ†¦ : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val M}}</a>
<a id="4636" class="Comment">--                â†’ Â¬ (M â†¦ Mâ€²)</a>
<a id="4667" class="Comment">-- Â¬valâ†¦ {{val-lam}}   (red ())</a>
<a id="4699" class="Comment">-- Â¬valâ†¦ {{val-pair}}  (red ())</a>
<a id="4731" class="Comment">-- Â¬valâ†¦ {{val-pair}}  (cong-pairâ‚ Mâ†¦Mâ€²) = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>
<a id="4787" class="Comment">-- Â¬valâ†¦ {{val-pair}}  (cong-pairâ‚‚ Nâ†¦Nâ€²) = Nâ†¦Nâ€² â†¯ Â¬valâ†¦</a>
<a id="4843" class="Comment">-- Â¬valâ†¦ {{val-unit}}  (red ())</a>
<a id="4875" class="Comment">-- Â¬valâ†¦ {{val-left}}  (red ())</a>
<a id="4907" class="Comment">-- Â¬valâ†¦ {{val-left}}  (cong-left Mâ†¦Mâ€²)  = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>
<a id="4963" class="Comment">-- Â¬valâ†¦ {{val-right}} (red ())</a>
<a id="4995" class="Comment">-- Â¬valâ†¦ {{val-right}} (cong-right Mâ†¦Mâ€²) = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>
<a id="5051" class="Comment">-- Â¬valâ†¦ {{val-true}}  (red ())</a>
<a id="5083" class="Comment">-- Â¬valâ†¦ {{val-false}} (red ())</a>


<a id="5117" class="Comment">-- -- Computation determines small-step reduction.</a>
<a id="5168" class="Comment">-- red-detâ†¦ : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="5211" class="Comment">--                   â†’ M â¤  Mâ€²â‚ â†’ M â†¦ Mâ€²â‚‚</a>
<a id="5252" class="Comment">--                   â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="5285" class="Comment">-- red-detâ†¦ Mâ¤ Mâ€²â‚     (red Mâ¤ Mâ€²â‚‚)       = detâ¤  Mâ¤ Mâ€²â‚ Mâ¤ Mâ€²â‚‚</a>
<a id="5344" class="Comment">-- red-detâ†¦ app-lam    (cong-appâ‚ Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5401" class="Comment">-- red-detâ†¦ app-lam    (cong-appâ‚‚ Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5458" class="Comment">-- red-detâ†¦ fst-pair   (cong-fst Mâ†¦Mâ€²â‚‚)  = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5515" class="Comment">-- red-detâ†¦ snd-pair   (cong-snd Mâ†¦Mâ€²â‚‚)  = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5572" class="Comment">-- red-detâ†¦ case-left  (cong-case Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5629" class="Comment">-- red-detâ†¦ case-right (cong-case Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5686" class="Comment">-- red-detâ†¦ if-true    (cong-if Mâ†¦Mâ€²â‚‚)   = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5743" class="Comment">-- red-detâ†¦ if-false   (cong-if Mâ†¦Mâ€²â‚‚)   = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="5800" class="Comment">-- red-detâ†¦ ()         (cong-pairâ‚ _)</a>
<a id="5838" class="Comment">-- red-detâ†¦ ()         (cong-pairâ‚‚ _)</a>
<a id="5876" class="Comment">-- red-detâ†¦ ()         (cong-abort _)</a>
<a id="5914" class="Comment">-- red-detâ†¦ ()         (cong-left _)</a>
<a id="5951" class="Comment">-- red-detâ†¦ ()         (cong-right _)</a>


<a id="5991" class="Comment">-- -- Small-step reduction is deterministic.</a>
<a id="6036" class="Comment">-- detâ†¦ : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="6075" class="Comment">--               â†’ M â†¦ Mâ€²â‚ â†’ M â†¦ Mâ€²â‚‚</a>
<a id="6112" class="Comment">--               â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="6141" class="Comment">-- detâ†¦ (red Mâ¤ Mâ€²â‚)        Mâ†¦Mâ€²â‚‚              = red-detâ†¦ Mâ¤ Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6210" class="Comment">-- detâ†¦ (cong-appâ‚ Mâ†¦Mâ€²â‚)  (cong-appâ‚ Mâ†¦Mâ€²â‚‚)  = (\ Mâ€² â†’ APP Mâ€² _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6295" class="Comment">-- detâ†¦ (cong-appâ‚ Mâ†¦Mâ€²â‚)  (cong-appâ‚‚ _)       = Mâ†¦Mâ€²â‚ â†¯ Â¬valâ†¦</a>
<a id="6358" class="Comment">-- detâ†¦ (cong-appâ‚‚ _)       (cong-appâ‚ Mâ†¦Mâ€²â‚‚)  = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="6421" class="Comment">-- detâ†¦ (cong-appâ‚‚ Nâ†¦Nâ€²â‚)  (cong-appâ‚‚ Nâ†¦Nâ€²â‚‚)  = (\ Nâ€² â†’ APP _ Nâ€²) &amp; detâ†¦ Nâ†¦Nâ€²â‚ Nâ†¦Nâ€²â‚‚</a>
<a id="6506" class="Comment">-- detâ†¦ (cong-pairâ‚ Mâ†¦Mâ€²â‚) (cong-pairâ‚ Mâ†¦Mâ€²â‚‚) = (\ Mâ€² â†’ PAIR Mâ€² _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6592" class="Comment">-- detâ†¦ (cong-pairâ‚ Mâ†¦Mâ€²â‚) (cong-pairâ‚‚ _)      = Mâ†¦Mâ€²â‚ â†¯ Â¬valâ†¦</a>
<a id="6655" class="Comment">-- detâ†¦ (cong-pairâ‚‚ _)      (cong-pairâ‚ Mâ†¦Mâ€²â‚‚) = Mâ†¦Mâ€²â‚‚ â†¯ Â¬valâ†¦</a>
<a id="6718" class="Comment">-- detâ†¦ (cong-pairâ‚‚ Nâ†¦Nâ€²â‚) (cong-pairâ‚‚ Nâ†¦Nâ€²â‚‚) = (\ Nâ€² â†’ PAIR _ Nâ€²) &amp; detâ†¦ Nâ†¦Nâ€²â‚ Nâ†¦Nâ€²â‚‚</a>
<a id="6804" class="Comment">-- detâ†¦ (cong-fst Mâ†¦Mâ€²â‚)   (cong-fst Mâ†¦Mâ€²â‚‚)   = FST &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6875" class="Comment">-- detâ†¦ (cong-snd Mâ†¦Mâ€²â‚)   (cong-snd Mâ†¦Mâ€²â‚‚)   = SND &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="6946" class="Comment">-- detâ†¦ (cong-abort Mâ†¦Mâ€²â‚) (cong-abort Mâ†¦Mâ€²â‚‚) = ABORT &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7019" class="Comment">-- detâ†¦ (cong-left Mâ†¦Mâ€²â‚)  (cong-left Mâ†¦Mâ€²â‚‚)  = LEFT &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7091" class="Comment">-- detâ†¦ (cong-right Mâ†¦Mâ€²â‚) (cong-right Mâ†¦Mâ€²â‚‚) = RIGHT &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7164" class="Comment">-- detâ†¦ (cong-case Mâ†¦Mâ€²â‚)  (cong-case Mâ†¦Mâ€²â‚‚)  = (\ Mâ€² â†’ CASE Mâ€² _ _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7252" class="Comment">-- detâ†¦ (cong-if Mâ†¦Mâ€²â‚)    (cong-if Mâ†¦Mâ€²â‚‚)    = (\ Mâ€² â†’ IF Mâ€² _ _) &amp; detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="7338" class="Comment">-- detâ†¦ Mâ†¦Mâ€²â‚              (red Mâ¤ Mâ€²â‚‚)        = red-detâ†¦ Mâ¤ Mâ€²â‚‚ Mâ†¦Mâ€²â‚ â»Â¹</a>


<a id="7412" class="Comment">-- -- Small-step reduction is type-preserving.</a>
<a id="7459" class="Comment">-- tpâ†¦ : âˆ€ {g M Mâ€² A} â†’ {Î“ : Types g}</a>
<a id="7497" class="Comment">--                     â†’ M â†¦ Mâ€² â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="7541" class="Comment">--                     â†’ Î“ âŠ¢ Mâ€² â¦‚ A</a>
<a id="7577" class="Comment">-- tpâ†¦ (red Mâ¤ Mâ€²)        ğ’Ÿ            = tpâ¤  Mâ¤ Mâ€² ğ’Ÿ</a>
<a id="7628" class="Comment">-- tpâ†¦ (cong-appâ‚ Mâ†¦Mâ€²)  (app ğ’Ÿ â„°)    = app (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„°</a>
<a id="7687" class="Comment">-- tpâ†¦ (cong-appâ‚‚ Mâ†¦Mâ€²)  (app ğ’Ÿ â„°)    = app ğ’Ÿ (tpâ†¦ Mâ†¦Mâ€² â„°)</a>
<a id="7746" class="Comment">-- tpâ†¦ (cong-pairâ‚ Mâ†¦Mâ€²) (pair ğ’Ÿ â„°)   = pair (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„°</a>
<a id="7806" class="Comment">-- tpâ†¦ (cong-pairâ‚‚ Nâ†¦Nâ€²) (pair ğ’Ÿ â„°)   = pair ğ’Ÿ (tpâ†¦ Nâ†¦Nâ€² â„°)</a>
<a id="7866" class="Comment">-- tpâ†¦ (cong-fst Mâ†¦Mâ€²)   (fst ğ’Ÿ)      = fst (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="7923" class="Comment">-- tpâ†¦ (cong-snd Mâ†¦Mâ€²)   (snd ğ’Ÿ)      = snd (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="7980" class="Comment">-- tpâ†¦ (cong-abort Mâ†¦Mâ€²) (abort ğ’Ÿ)    = abort (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8039" class="Comment">-- tpâ†¦ (cong-left Mâ†¦Mâ€²)  (left ğ’Ÿ)     = left (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8097" class="Comment">-- tpâ†¦ (cong-right Mâ†¦Mâ€²) (right ğ’Ÿ)    = right (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ)</a>
<a id="8156" class="Comment">-- tpâ†¦ (cong-case Mâ†¦Mâ€²)  (case ğ’Ÿ â„° â„±) = case (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„° â„±</a>
<a id="8218" class="Comment">-- tpâ†¦ (cong-if Mâ†¦Mâ€²)    (if ğ’Ÿ â„° â„±)   = if (tpâ†¦ Mâ†¦Mâ€² ğ’Ÿ) â„° â„±</a>


<a id="8280" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="8366" class="Comment">-- -- `_â¤…_` is the iterated small-step reduction relation.</a>
<a id="8425" class="Comment">-- infix 3 _â¤…_</a>
<a id="8440" class="Comment">-- data _â¤…_ {g} : Term g â†’ Term g â†’ Set</a>
<a id="8480" class="Comment">--   where</a>
<a id="8491" class="Comment">--     -- Iterated small-step reduction is reflexive.</a>
<a id="8545" class="Comment">--     done : âˆ€ {M} â†’ M â¤… M</a>

<a id="8574" class="Comment">--     -- Small-step reduction IN REVERSE preserves iterated small-step reduction.</a>
<a id="8657" class="Comment">--     step : âˆ€ {M Mâ€² Mâ€³} â†’ M â†¦ Mâ€² â†’ Mâ€² â¤… Mâ€³</a>
<a id="8702" class="Comment">--                        â†’ M â¤… Mâ€³</a>


<a id="8739" class="Comment">-- -- Iterated small-step reduction is transitive.</a>
<a id="8790" class="Comment">-- -- Iterated small-step reduction IN REVERSE preserves iterated small-step reduction.</a>
<a id="8878" class="Comment">-- steps : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g}</a>
<a id="8916" class="Comment">--               â†’ M â¤… Mâ€² â†’ Mâ€² â¤… Mâ€³</a>
<a id="8952" class="Comment">--               â†’ M â¤… Mâ€³</a>
<a id="8978" class="Comment">-- steps done                Mâ¤…Mâ€³  = Mâ¤…Mâ€³</a>
<a id="9020" class="Comment">-- steps (step Mâ†¦Mâ€´ Mâ€´â¤…Mâ€²) Mâ€²â¤…Mâ€³ = step Mâ†¦Mâ€´ (steps Mâ€´â¤…Mâ€² Mâ€²â¤…Mâ€³)</a>


<a id="9087" class="Comment">-- -- When reducing down to a value, the initial small step determines the subsequent small steps.</a>
<a id="9186" class="Comment">-- -- Small-step reduction preserves iterated small-step reduction down to a value.</a>
<a id="9270" class="Comment">-- unstep : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g} â†’ {{_ : Val Mâ€³}}</a>
<a id="9326" class="Comment">--                â†’ M â†¦ Mâ€² â†’ M â¤… Mâ€³</a>
<a id="9362" class="Comment">--                â†’ Mâ€² â¤… Mâ€³</a>
<a id="9390" class="Comment">-- unstep Mâ†¦Mâ€²â‚ (step Mâ†¦Mâ€²â‚‚ Mâ€²â‚‚â¤…Mâ€³) with detâ†¦ Mâ†¦Mâ€²â‚ Mâ†¦Mâ€²â‚‚</a>
<a id="9448" class="Comment">-- unstep Mâ†¦Mâ€²  (step _      Mâ€²â¤…Mâ€³)  | refl = Mâ€²â¤…Mâ€³</a>
<a id="9500" class="Comment">-- unstep Mâ†¦Mâ€²  done                  = Mâ†¦Mâ€² â†¯ Â¬valâ†¦</a>


<a id="9555" class="Comment">-- -- When reducing down to a value, iterated small-step reduction is deterministic.</a>
<a id="9640" class="Comment">-- detâ¤… : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g} â†’ {{_ : Val Mâ€²â‚}} {{_ : Val Mâ€²â‚‚}}</a>
<a id="9713" class="Comment">--               â†’ M â¤… Mâ€²â‚ â†’ M â¤… Mâ€²â‚‚</a>
<a id="9750" class="Comment">--               â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="9779" class="Comment">-- detâ¤… done                   done                = refl</a>
<a id="9837" class="Comment">-- detâ¤… done                   (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = Mâ†¦Mâ€³ â†¯ Â¬valâ†¦</a>
<a id="9901" class="Comment">-- detâ¤… (step Mâ†¦Mâ€³â‚ Mâ€³â‚â¤…Mâ€²â‚) Mâ¤…Mâ€²â‚‚              = detâ¤… Mâ€³â‚â¤…Mâ€²â‚ (unstep Mâ†¦Mâ€³â‚ Mâ¤…Mâ€²â‚‚)</a>


<a id="9987" class="Comment">-- -- Iterated small-step reduction is type-preserving.</a>
<a id="10043" class="Comment">-- tpâ¤… : âˆ€ {g M Mâ€² A} â†’ {Î“ : Types g}</a>
<a id="10081" class="Comment">--                     â†’ M â¤… Mâ€² â†’ Î“ âŠ¢ M â¦‚ A</a>
<a id="10125" class="Comment">--                     â†’ Î“ âŠ¢ Mâ€² â¦‚ A</a>
<a id="10161" class="Comment">-- tpâ¤… done                ğ’Ÿ = ğ’Ÿ</a>
<a id="10194" class="Comment">-- tpâ¤… (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) ğ’Ÿ = tpâ¤… Mâ€³â¤…Mâ€² (tpâ†¦ Mâ†¦Mâ€³ ğ’Ÿ)</a>


<a id="10248" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `APP M N` reduces to `APP Mâ€² N`.</a>
<a id="10316" class="Comment">-- congs-appâ‚ : âˆ€ {g} â†’ {M Mâ€² N : Term g}</a>
<a id="10358" class="Comment">--                    â†’ M â¤… Mâ€²</a>
<a id="10389" class="Comment">--                    â†’ APP M N â¤… APP Mâ€² N</a>
<a id="10432" class="Comment">-- congs-appâ‚ done                = done</a>
<a id="10473" class="Comment">-- congs-appâ‚ (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-appâ‚ Mâ†¦Mâ€³) (congs-appâ‚ Mâ€³â¤…Mâ€²)</a>


<a id="10550" class="Comment">-- -- If `N` reduces to `Nâ€²`, then `APP (LAM M) N` reduces to `APP (LAM M) Nâ€²`.</a>
<a id="10630" class="Comment">-- congs-appâ‚‚ : âˆ€ {g} â†’ {M : Term (suc g)} {N Nâ€² : Term g}</a>
<a id="10689" class="Comment">--                    â†’ N â¤… Nâ€²</a>
<a id="10720" class="Comment">--                    â†’ APP (LAM M) N â¤… APP (LAM M) Nâ€²</a>
<a id="10775" class="Comment">-- congs-appâ‚‚ done                = done</a>
<a id="10816" class="Comment">-- congs-appâ‚‚ (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-appâ‚‚ Mâ†¦Mâ€³) (congs-appâ‚‚ Mâ€³â¤…Mâ€²)</a>


<a id="10893" class="Comment">-- -- If `M` reduces to `Mâ€²` and `N` reduces to `Nâ€²`, then `PAIR M N` reduces to `PAIR Mâ€² Nâ€²`.</a>
<a id="10988" class="Comment">-- congs-pair : âˆ€ {g} â†’ {M Mâ€² N Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="11065" class="Comment">--                    â†’ M â¤… Mâ€² â†’ N â¤… Nâ€²</a>
<a id="11105" class="Comment">--                    â†’ PAIR M N â¤… PAIR Mâ€² Nâ€²</a>
<a id="11151" class="Comment">-- congs-pair done                done                = done</a>
<a id="11212" class="Comment">-- congs-pair done                (step Nâ†¦Nâ€³ Nâ€³â¤…Nâ€²) = step (cong-pairâ‚‚ Nâ†¦Nâ€³) (congs-pair done Nâ€³â¤…Nâ€²)</a>
<a id="11313" class="Comment">-- congs-pair (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) Nâ¤…Nâ€²               = step (cong-pairâ‚ Mâ†¦Mâ€³) (congs-pair Mâ€³â¤…Mâ€² Nâ¤…Nâ€²)</a>


<a id="11415" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `FST M` reduces to `FST Mâ€²`.</a>
<a id="11479" class="Comment">-- congs-fst : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="11518" class="Comment">--                   â†’ M â¤… Mâ€²</a>
<a id="11548" class="Comment">--                   â†’ FST M â¤… FST Mâ€²</a>
<a id="11586" class="Comment">-- congs-fst done                = done</a>
<a id="11626" class="Comment">-- congs-fst (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-fst Mâ†¦Mâ€³) (congs-fst Mâ€³â¤…Mâ€²)</a>


<a id="11700" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `SND M` reduces to `SND Mâ€²`.</a>
<a id="11764" class="Comment">-- congs-snd : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="11803" class="Comment">--                   â†’ M â¤… Mâ€²</a>
<a id="11833" class="Comment">--                   â†’ SND M â¤… SND Mâ€²</a>
<a id="11871" class="Comment">-- congs-snd done                = done</a>
<a id="11911" class="Comment">-- congs-snd (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-snd Mâ†¦Mâ€³) (congs-snd Mâ€³â¤…Mâ€²)</a>


<a id="11985" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `LEFT M` reduces to `LEFT Mâ€²`.</a>
<a id="12051" class="Comment">-- congs-left : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val Mâ€²}}</a>
<a id="12108" class="Comment">--                    â†’ M â¤… Mâ€²</a>
<a id="12139" class="Comment">--                    â†’ LEFT M â¤… LEFT Mâ€²</a>
<a id="12180" class="Comment">-- congs-left done                = done</a>
<a id="12221" class="Comment">-- congs-left (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-left Mâ†¦Mâ€³) (congs-left Mâ€³â¤…Mâ€²)</a>


<a id="12298" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `RIGHT M` reduces to `RIGHT Mâ€²`.</a>
<a id="12366" class="Comment">-- congs-right : âˆ€ {g} â†’ {M Mâ€² : Term g} â†’ {{_ : Val Mâ€²}}</a>
<a id="12424" class="Comment">--                     â†’ M â¤… Mâ€²</a>
<a id="12456" class="Comment">--                     â†’ RIGHT M â¤… RIGHT Mâ€²</a>
<a id="12500" class="Comment">-- congs-right done                = done</a>
<a id="12542" class="Comment">-- congs-right (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-right Mâ†¦Mâ€³) (congs-right Mâ€³â¤…Mâ€²)</a>


<a id="12622" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `CASE M N O` reduces to `CASE Mâ€² N O`.</a>
<a id="12696" class="Comment">-- congs-case : âˆ€ {g} â†’ {M Mâ€² : Term g} {N O : Term (suc g)}</a>
<a id="12757" class="Comment">--                    â†’ M â¤… Mâ€²</a>
<a id="12788" class="Comment">--                    â†’ CASE M N O â¤… CASE Mâ€² N O</a>
<a id="12837" class="Comment">-- congs-case done                = done</a>
<a id="12878" class="Comment">-- congs-case (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-case Mâ†¦Mâ€³) (congs-case Mâ€³â¤…Mâ€²)</a>


<a id="12955" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `IF M N O` reduces to `IF Mâ€² N O`.</a>
<a id="13025" class="Comment">-- congs-if : âˆ€ {g} â†’ {M Mâ€² N O : Term g}</a>
<a id="13067" class="Comment">--                  â†’ M â¤… Mâ€²</a>
<a id="13096" class="Comment">--                  â†’ IF M N O â¤… IF Mâ€² N O</a>
<a id="13139" class="Comment">-- congs-if done                = done</a>
<a id="13178" class="Comment">-- congs-if (step Mâ†¦Mâ€³ Mâ€³â¤…Mâ€²) = step (cong-if Mâ†¦Mâ€³) (congs-if Mâ€³â¤…Mâ€²)</a>


<a id="13249" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `FST M` reduces to `Mâ€²`.</a>
<a id="13317" class="Comment">-- reds-fst-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="13395" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="13437" class="Comment">--                       â†’ FST M â¤… Mâ€²</a>
<a id="13475" class="Comment">-- reds-fst-pair Mâ¤…PAIR = steps (congs-fst Mâ¤…PAIR) (step (red fst-pair) done)</a>


<a id="13555" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `SND M` reduces to `Nâ€²`.</a>
<a id="13623" class="Comment">-- reds-snd-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="13701" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="13743" class="Comment">--                       â†’ SND M â¤… Nâ€²</a>
<a id="13781" class="Comment">-- reds-snd-pair Mâ¤…PAIR = steps (congs-snd Mâ¤…PAIR) (step (red snd-pair) done)</a>


<a id="13861" class="Comment">-- -- If `M` reduces to `TRUE` and `N` reduces to `Nâ€²`, then `IF M N O` reduces to `Nâ€²`.</a>
<a id="13950" class="Comment">-- reds-if-true : âˆ€ {g} â†’ {M N Nâ€² O : Term g}</a>
<a id="13996" class="Comment">--                      â†’ M â¤… TRUE â†’ N â¤… Nâ€²</a>
<a id="14040" class="Comment">--                      â†’ IF M N O â¤… Nâ€²</a>
<a id="14080" class="Comment">-- reds-if-true Mâ¤…TRUE Nâ¤…Nâ€² = steps (congs-if Mâ¤…TRUE) (step (red if-true) Nâ¤…Nâ€²)</a>


<a id="14162" class="Comment">-- -- If `M` reduces to `FALSE` and `O` reduces to `Oâ€²`, then `IF M N O` reduces to `Oâ€²`.</a>
<a id="14252" class="Comment">-- reds-if-false : âˆ€ {g} â†’ {M N O Oâ€² : Term g}</a>
<a id="14299" class="Comment">--                       â†’ M â¤… FALSE â†’ O â¤… Oâ€²</a>
<a id="14345" class="Comment">--                       â†’ IF M N O â¤… Oâ€²</a>
<a id="14386" class="Comment">-- reds-if-false Mâ¤…FALSE Nâ¤…Nâ€² = steps (congs-if Mâ¤…FALSE) (step (red if-false) Nâ¤…Nâ€²)</a>


<a id="14472" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="14558" class="Comment">-- -- `_â‡“_` is the big-step reduction relation.</a>
<a id="14606" class="Comment">-- infix 3 _â‡“_</a>
<a id="14621" class="Comment">-- _â‡“_ : âˆ€ {g} â†’ Term g â†’ Term g â†’ Set</a>
<a id="14660" class="Comment">-- M â‡“ Mâ€² = M â¤… Mâ€² Ã— Val Mâ€²</a>


<a id="14690" class="Comment">-- -- A big step can be extended with an initial small step.</a>
<a id="14751" class="Comment">-- -- Small-step reduction IN REVERSE preserves big-step reduction.</a>
<a id="14819" class="Comment">-- big-step : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g}</a>
<a id="14860" class="Comment">--                  â†’ M â†¦ Mâ€² â†’ Mâ€² â‡“ Mâ€³</a>
<a id="14899" class="Comment">--                  â†’ M â‡“ Mâ€³</a>
<a id="14928" class="Comment">-- big-step Mâ†¦Mâ€² (Mâ€²â¤…Mâ€³ , VMâ€³) = step Mâ†¦Mâ€² Mâ€²â¤…Mâ€³ , VMâ€³</a>


<a id="14985" class="Comment">-- -- The initial small step determines the subsequent big step.</a>
<a id="15050" class="Comment">-- -- Small-step reduction preserves big-step reduction.</a>
<a id="15107" class="Comment">-- big-unstep : âˆ€ {g} â†’ {M Mâ€² Mâ€³ : Term g}</a>
<a id="15150" class="Comment">--                    â†’ M â†¦ Mâ€² â†’ M â‡“ Mâ€³</a>
<a id="15190" class="Comment">--                    â†’ Mâ€² â‡“ Mâ€³</a>
<a id="15222" class="Comment">-- big-unstep Mâ†¦Mâ€² (Mâ€²â¤…Mâ€³ , VMâ€³) = unstep {{VMâ€³}} Mâ†¦Mâ€² Mâ€²â¤…Mâ€³ , VMâ€³</a>


<a id="15291" class="Comment">-- -- Big-step reduction is deterministic.</a>
<a id="15334" class="Comment">-- detâ‡“ : âˆ€ {g} â†’ {M Mâ€²â‚ Mâ€²â‚‚ : Term g}</a>
<a id="15373" class="Comment">--              â†’ M â‡“ Mâ€²â‚ â†’ M â‡“ Mâ€²â‚‚</a>
<a id="15409" class="Comment">--              â†’ Mâ€²â‚ â‰¡ Mâ€²â‚‚</a>
<a id="15437" class="Comment">-- detâ‡“ (Mâ¤…Mâ€²â‚ , VMâ€²â‚) (Mâ¤…Mâ€²â‚‚ , VMâ€²â‚‚) = detâ¤… {{VMâ€²â‚}} {{VMâ€²â‚‚}} Mâ¤…Mâ€²â‚ Mâ¤…Mâ€²â‚‚</a>


<a id="15514" class="Comment">-- -- If `M` reduces to `Mâ€²` and `N` reduces to `Nâ€²`, then `PAIR M N` reduces to `PAIR Mâ€² Nâ€²`.</a>
<a id="15609" class="Comment">-- big-red-pair : âˆ€ {g} â†’ {M Mâ€² N Nâ€² : Term g}</a>
<a id="15656" class="Comment">--                      â†’ M â‡“ Mâ€² â†’ N â‡“ Nâ€²</a>
<a id="15698" class="Comment">--                      â†’ PAIR M N â‡“ PAIR Mâ€² Nâ€²</a>
<a id="15746" class="Comment">-- big-red-pair (Mâ¤…Mâ€² , VMâ€²) (Nâ¤…Nâ€² , VNâ€²) = congs-pair {{VMâ€²}} {{VNâ€²}} Mâ¤…Mâ€² Nâ¤…Nâ€² , val-pair {{VMâ€²}} {{VNâ€²}}</a>


<a id="15856" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `FST M` reduces to `Mâ€²`.</a>
<a id="15924" class="Comment">-- big-red-fst-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="16005" class="Comment">--                          â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="16050" class="Comment">--                          â†’ FST M â‡“ Mâ€²</a>
<a id="16091" class="Comment">-- big-red-fst-pair {{VMâ€²}} Mâ¤…PAIR = reds-fst-pair Mâ¤…PAIR , VMâ€²</a>


<a id="16157" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `SND M` reduces to `Nâ€²`.</a>
<a id="16225" class="Comment">-- big-red-snd-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="16306" class="Comment">--                          â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="16351" class="Comment">--                          â†’ SND M â‡“ Nâ€²</a>
<a id="16392" class="Comment">-- big-red-snd-pair {{_}} {{VNâ€²}} Mâ¤…PAIR = reds-snd-pair Mâ¤…PAIR , VNâ€²</a>


<a id="16464" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `LEFT M` reduces to `LEFT Mâ€²`.</a>
<a id="16530" class="Comment">-- big-red-left : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="16572" class="Comment">--                      â†’ M â‡“ Mâ€²</a>
<a id="16605" class="Comment">--                      â†’ LEFT M â‡“ LEFT Mâ€²</a>
<a id="16648" class="Comment">-- big-red-left (Mâ¤…Mâ€² , VMâ€²) = congs-left {{VMâ€²}} Mâ¤…Mâ€² , val-left {{VMâ€²}}</a>


<a id="16724" class="Comment">-- -- If `M` reduces to `Mâ€²`, then `RIGHT M` reduces to `RIGHT Mâ€²`.</a>
<a id="16792" class="Comment">-- big-red-right : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="16835" class="Comment">--                       â†’ M â‡“ Mâ€²</a>
<a id="16869" class="Comment">--                       â†’ RIGHT M â‡“ RIGHT Mâ€²</a>
<a id="16915" class="Comment">-- big-red-right (Mâ¤…Mâ€² , VMâ€²) = congs-right {{VMâ€²}} Mâ¤…Mâ€² , val-right {{VMâ€²}}</a>


<a id="16994" class="Comment">-- -- If `M` reduces to `TRUE` and `N` reduces to `Nâ€²`, then `IF M N O` reduces to `Nâ€²`.</a>
<a id="17083" class="Comment">-- big-red-if-true : âˆ€ {g} â†’ {M N Nâ€² O : Term g}</a>
<a id="17132" class="Comment">--                         â†’ M â¤… TRUE â†’ N â‡“ Nâ€²</a>
<a id="17179" class="Comment">--                         â†’ IF M N O â‡“ Nâ€²</a>
<a id="17222" class="Comment">-- big-red-if-true Mâ¤…TRUE (Nâ¤…Nâ€² , VNâ€²) = reds-if-true Mâ¤…TRUE Nâ¤…Nâ€² , VNâ€²</a>


<a id="17296" class="Comment">-- -- If `M` reduces to `FALSE` and `O` reduces to `Oâ€²`, then `IF M N O` reduces to `Oâ€²`.</a>
<a id="17386" class="Comment">-- big-red-if-false : âˆ€ {g} â†’ {M N O Oâ€² : Term g}</a>
<a id="17436" class="Comment">--                          â†’ M â¤… FALSE â†’ O â‡“ Oâ€²</a>
<a id="17485" class="Comment">--                          â†’ IF M N O â‡“ Oâ€²</a>
<a id="17529" class="Comment">-- big-red-if-false Mâ¤…FALSE (Oâ¤…Oâ€² , VOâ€²) = reds-if-false Mâ¤…FALSE Oâ¤…Oâ€² , VOâ€²</a>


<a id="17607" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="17693" class="Comment">-- -- `_â‡“` is the CBV termination relation.</a>
<a id="17737" class="Comment">-- _â‡“ : âˆ€ {g} â†’ Term g â†’ Set</a>
<a id="17766" class="Comment">-- M â‡“ = Î£ (Term _) (\ Mâ€² â†’ M â‡“ Mâ€²)</a>


<a id="17804" class="Comment">-- -- Small-step reduction IN REVERSE preserves termination.</a>
<a id="17865" class="Comment">-- -- Reversed small-step reduction is halt-preserving.</a>
<a id="17921" class="Comment">-- hprâ†¦ : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="17955" class="Comment">--               â†’ M â†¦ Mâ€² â†’ Mâ€² â‡“</a>
<a id="17988" class="Comment">--               â†’ M â‡“</a>
<a id="18011" class="Comment">-- hprâ†¦ Mâ†¦Mâ€² (Mâ€³ , Mâ€²â‡“Mâ€³) = Mâ€³ , big-step Mâ†¦Mâ€² Mâ€²â‡“Mâ€³</a>


<a id="18066" class="Comment">-- -- Small-step reduction preserves termination.</a>
<a id="18116" class="Comment">-- -- Small-step reduction is halt-preserving.</a>
<a id="18163" class="Comment">-- hpâ†¦ : âˆ€ {g} â†’ {M Mâ€² : Term g}</a>
<a id="18196" class="Comment">--              â†’ M â†¦ Mâ€² â†’ M â‡“</a>
<a id="18227" class="Comment">--              â†’ Mâ€² â‡“</a>
<a id="18250" class="Comment">-- hpâ†¦ Mâ†¦Mâ€² (Mâ€³ , Mâ€²â‡“Mâ€³) = Mâ€³ , big-unstep Mâ†¦Mâ€² Mâ€²â‡“Mâ€³</a>


<a id="18306" class="Comment">-- -- If `M` terminates and `N` terminates, then `PAIR M N` terminates.</a>
<a id="18378" class="Comment">-- halt-pair : âˆ€ {g} â†’ {M N : Term g}</a>
<a id="18416" class="Comment">--                   â†’ M â‡“ â†’ N â‡“</a>
<a id="18449" class="Comment">--                   â†’ PAIR M N â‡“</a>
<a id="18483" class="Comment">-- halt-pair (Mâ€² , Mâ‡“Mâ€²) (Nâ€² , Nâ‡“Nâ€²) = PAIR Mâ€² Nâ€² , big-red-pair Mâ‡“Mâ€² Nâ‡“Nâ€²</a>


<a id="18560" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `FST M` terminates.</a>
<a id="18623" class="Comment">-- halt-fst-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="18701" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="18743" class="Comment">--                       â†’ FST M â‡“</a>
<a id="18778" class="Comment">-- halt-fst-pair {Mâ€² = Mâ€²} Mâ¤…PAIR = Mâ€² , big-red-fst-pair Mâ¤…PAIR</a>


<a id="18845" class="Comment">-- -- If `M` reduces to `PAIR Mâ€² Nâ€²`, then `SND M` terminates.</a>
<a id="18908" class="Comment">-- halt-snd-pair : âˆ€ {g} â†’ {M Mâ€² Nâ€² : Term g} â†’ {{_ : Val Mâ€²}} {{_ : Val Nâ€²}}</a>
<a id="18986" class="Comment">--                       â†’ M â¤… PAIR Mâ€² Nâ€²</a>
<a id="19028" class="Comment">--                       â†’ SND M â‡“</a>
<a id="19063" class="Comment">-- halt-snd-pair {Nâ€² = Nâ€²} Mâ¤…PAIR = Nâ€² , big-red-snd-pair Mâ¤…PAIR</a>


<a id="19130" class="Comment">-- -- If `M` terminates, then `FST M` terminates.</a>
<a id="19180" class="Comment">-- halt-fst : âˆ€ {g M A B} â†’ {Î“ : Types g}</a>
<a id="19222" class="Comment">--                        â†’ Î“ âŠ¢ M â¦‚ A âˆ§ B â†’ M â‡“</a>
<a id="19270" class="Comment">--                        â†’ FST M â‡“</a>
<a id="19306" class="Comment">-- halt-fst ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€²   , VMâ€²)       with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="19368" class="Comment">-- halt-fst ğ’Ÿ (LAM _    , _       , val-lam)   | ()</a>
<a id="19420" class="Comment">-- halt-fst ğ’Ÿ (PAIR _ _ , Mâ¤…PAIR , val-pair)  | pair _ _ = halt-fst-pair Mâ¤…PAIR</a>
<a id="19500" class="Comment">-- halt-fst ğ’Ÿ (UNIT     , _       , val-unit)  | ()</a>
<a id="19552" class="Comment">-- halt-fst ğ’Ÿ (LEFT _   , _       , val-left)  | ()</a>
<a id="19604" class="Comment">-- halt-fst ğ’Ÿ (RIGHT _  , _       , val-right) | ()</a>
<a id="19656" class="Comment">-- halt-fst ğ’Ÿ (TRUE     , _       , val-true)  | ()</a>
<a id="19708" class="Comment">-- halt-fst ğ’Ÿ (FALSE    , _       , val-false) | ()</a>


<a id="19762" class="Comment">-- -- If `M` terminates, then `SND M` terminates.</a>
<a id="19812" class="Comment">-- halt-snd : âˆ€ {g M A B} â†’ {Î“ : Types g}</a>
<a id="19854" class="Comment">--                        â†’ Î“ âŠ¢ M â¦‚ A âˆ§ B â†’ M â‡“</a>
<a id="19902" class="Comment">--                        â†’ SND M â‡“</a>
<a id="19938" class="Comment">-- halt-snd ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€²   , VMâ€²)       with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="20000" class="Comment">-- halt-snd ğ’Ÿ (LAM _    , _       , val-lam)   | ()</a>
<a id="20052" class="Comment">-- halt-snd ğ’Ÿ (PAIR _ _ , Mâ¤…PAIR , val-pair)  | pair _ _ = halt-snd-pair Mâ¤…PAIR</a>
<a id="20132" class="Comment">-- halt-snd ğ’Ÿ (UNIT     , _       , val-unit)  | ()</a>
<a id="20184" class="Comment">-- halt-snd ğ’Ÿ (LEFT _   , _       , val-left)  | ()</a>
<a id="20236" class="Comment">-- halt-snd ğ’Ÿ (RIGHT _  , _       , val-right) | ()</a>
<a id="20288" class="Comment">-- halt-snd ğ’Ÿ (TRUE     , _       , val-true)  | ()</a>
<a id="20340" class="Comment">-- halt-snd ğ’Ÿ (FALSE    , _       , val-false) | ()</a>


<a id="20394" class="Comment">-- -- If `M` terminates, then `ABORT M` terminates.</a>
<a id="20446" class="Comment">-- halt-abort : âˆ€ {g M} â†’ {Î“ : Types g}</a>
<a id="20486" class="Comment">--                      â†’ Î“ âŠ¢ M â¦‚ ğŸ˜ â†’ M â‡“</a>
<a id="20528" class="Comment">--                      â†’ ABORT M â‡“</a>
<a id="20564" class="Comment">-- halt-abort ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€² , VMâ€²)       with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="20626" class="Comment">-- halt-abort ğ’Ÿ (LAM _    , _     , val-lam)   | ()</a>
<a id="20678" class="Comment">-- halt-abort ğ’Ÿ (PAIR _ _ , _     , val-pair)  | ()</a>
<a id="20730" class="Comment">-- halt-abort ğ’Ÿ (UNIT     , _     , val-unit)  | ()</a>
<a id="20782" class="Comment">-- halt-abort ğ’Ÿ (LEFT _   , _     , val-left)  | ()</a>
<a id="20834" class="Comment">-- halt-abort ğ’Ÿ (RIGHT _  , _     , val-right) | ()</a>
<a id="20886" class="Comment">-- halt-abort ğ’Ÿ (TRUE     , _     , val-true)  | ()</a>
<a id="20938" class="Comment">-- halt-abort ğ’Ÿ (FALSE    , _     , val-false) | ()</a>


<a id="20992" class="Comment">-- -- If `M` terminates, then `LEFT M` terminates.</a>
<a id="21043" class="Comment">-- halt-left : âˆ€ {g} â†’ {M : Term g}</a>
<a id="21079" class="Comment">--                   â†’ M â‡“</a>
<a id="21106" class="Comment">--                   â†’ LEFT M â‡“</a>
<a id="21138" class="Comment">-- halt-left (Mâ€² , Mâ‡“Mâ€²) = LEFT Mâ€² , big-red-left Mâ‡“Mâ€²</a>


<a id="21195" class="Comment">-- -- If `M` terminates, then `RIGHT M` terminates.</a>
<a id="21247" class="Comment">-- halt-right : âˆ€ {g} â†’ {M : Term g}</a>
<a id="21284" class="Comment">--                    â†’ M â‡“</a>
<a id="21312" class="Comment">--                    â†’ RIGHT M â‡“</a>
<a id="21346" class="Comment">-- halt-right (Mâ€² , Mâ‡“Mâ€²) = RIGHT Mâ€² , big-red-right Mâ‡“Mâ€²</a>


<a id="21406" class="Comment">-- -- If `M` reduces to `TRUE` and `N` terminates, then `IF M N O` terminates.</a>
<a id="21485" class="Comment">-- halt-if-true : âˆ€ {g} â†’ {M N O : Term g}</a>
<a id="21528" class="Comment">--                      â†’ M â¤… TRUE â†’ N â‡“</a>
<a id="21569" class="Comment">--                      â†’ IF M N O â‡“</a>
<a id="21606" class="Comment">-- halt-if-true Mâ¤…TRUE (Nâ€² , Nâ‡“Nâ€²) = Nâ€² , big-red-if-true Mâ¤…TRUE Nâ‡“Nâ€²</a>


<a id="21678" class="Comment">-- -- If `M` reduces to `FALSE` and `O` terminates, then `IF M N O` terminates.</a>
<a id="21758" class="Comment">-- halt-if-false : âˆ€ {g} â†’ {M N O : Term g}</a>
<a id="21802" class="Comment">--                       â†’ M â¤… FALSE â†’ O â‡“</a>
<a id="21845" class="Comment">--                       â†’ IF M N O â‡“</a>
<a id="21883" class="Comment">-- halt-if-false Mâ¤…FALSE (Oâ€² , Oâ‡“Oâ€²) = Oâ€² , big-red-if-false Mâ¤…FALSE Oâ‡“Oâ€²</a>


<a id="21959" class="Comment">-- -- If `M` terminates and `N` terminates and `O` terminates, then `IF M N O` terminates.</a>
<a id="22050" class="Comment">-- halt-if : âˆ€ {g M N O} â†’ {Î“ : Types g}</a>
<a id="22091" class="Comment">--                       â†’ Î“ âŠ¢ M â¦‚ ğ”¹ â†’ M â‡“ â†’ N â‡“ â†’ O â‡“</a>
<a id="22146" class="Comment">--                       â†’ IF M N O â‡“</a>
<a id="22184" class="Comment">-- halt-if ğ’Ÿ (Mâ€²       , Mâ¤…Mâ€²    , VMâ€²)       Nâ‡“ Oâ‡“ with tpâ¤… Mâ¤…Mâ€² ğ’Ÿ</a>
<a id="22252" class="Comment">-- halt-if ğ’Ÿ (LAM _    , _        , val-lam)   Nâ‡“ Oâ‡“ | ()</a>
<a id="22310" class="Comment">-- halt-if ğ’Ÿ (PAIR _ _ , _        , val-pair)  Nâ‡“ Oâ‡“ | ()</a>
<a id="22368" class="Comment">-- halt-if ğ’Ÿ (UNIT     , _        , val-unit)  Nâ‡“ Oâ‡“ | ()</a>
<a id="22426" class="Comment">-- halt-if ğ’Ÿ (LEFT _   , _        , val-left)  Nâ‡“ Oâ‡“ | ()</a>
<a id="22484" class="Comment">-- halt-if ğ’Ÿ (RIGHT _  , _        , val-right) Nâ‡“ Oâ‡“ | ()</a>
<a id="22542" class="Comment">-- halt-if ğ’Ÿ (TRUE     , Mâ¤…TRUE  , val-true)  Nâ‡“ Oâ‡“ | true  = halt-if-true Mâ¤…TRUE Nâ‡“</a>
<a id="22627" class="Comment">-- halt-if ğ’Ÿ (FALSE    , Mâ¤…FALSE , val-false) Nâ‡“ Oâ‡“ | false = halt-if-false Mâ¤…FALSE Oâ‡“</a>


<a id="22716" class="Comment">-- -- Every well-typed term terminates.</a>
<a id="22756" class="Comment">-- -- Impossible without a stronger induction hypothesis.</a>
<a id="22814" class="Comment">-- {-</a>
<a id="22820" class="Comment">-- halt : âˆ€ {M A} â†’ âˆ™ âŠ¢ M â¦‚ A</a>
<a id="22850" class="Comment">--                â†’ M â‡“</a>
<a id="22874" class="Comment">-- halt (var ())</a>
<a id="22891" class="Comment">-- halt (lam ğ’Ÿ)      = LAM _ , done , val-lam</a>
<a id="22937" class="Comment">-- halt (app ğ’Ÿ â„°)    = {!!}</a>
<a id="22965" class="Comment">-- halt (pair ğ’Ÿ â„°)   = halt-pair (halt ğ’Ÿ) (halt â„°)</a>
<a id="23016" class="Comment">-- halt (fst ğ’Ÿ)      = halt-fst ğ’Ÿ (halt ğ’Ÿ)</a>
<a id="23059" class="Comment">-- halt (snd ğ’Ÿ)      = halt-snd ğ’Ÿ (halt ğ’Ÿ)</a>
<a id="23102" class="Comment">-- halt unit         = UNIT , done , val-unit</a>
<a id="23148" class="Comment">-- halt (abort ğ’Ÿ)    = halt-abort ğ’Ÿ (halt ğ’Ÿ)</a>
<a id="23193" class="Comment">-- halt (left ğ’Ÿ)     = halt-left (halt ğ’Ÿ)</a>
<a id="23235" class="Comment">-- halt (right ğ’Ÿ)    = halt-right (halt ğ’Ÿ)</a>
<a id="23278" class="Comment">-- halt (case ğ’Ÿ â„° â„±) = {!!}</a>
<a id="23306" class="Comment">-- halt true         = TRUE , done , val-true</a>
<a id="23352" class="Comment">-- halt false        = FALSE , done , val-false</a>
<a id="23400" class="Comment">-- halt (if ğ’Ÿ â„° â„±)   = halt-if ğ’Ÿ (halt ğ’Ÿ) (halt â„°) (halt â„±)</a>
<a id="23460" class="Comment">-- -}</a>


<a id="23468" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="23554" class="Comment">-- red-app-lam : âˆ€ {g n M N} â†’ {Ï„ : Terms g n} â†’ {{_ : Val N}}</a>
<a id="23617" class="Comment">--                           â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â†¦ SUB (Ï„ , N) M</a>
<a id="23694" class="Comment">-- red-app-lam {M = M} {N} {Ï„} rewrite simp-CUT-SUB N Ï„ M â»Â¹ = red app-lam</a>


<a id="23771" class="Comment">-- big-red-app-lam : âˆ€ {g n M Mâ€² N} â†’ {Ï„ : Terms g n} â†’ {{_ : Val N}}</a>
<a id="23841" class="Comment">--                                  â†’ SUB (Ï„ , N) M â‡“ Mâ€²</a>
<a id="23898" class="Comment">--                                  â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“ Mâ€²</a>
<a id="23971" class="Comment">-- big-red-app-lam {M = M} (SUBâ¤…Mâ€² , VMâ€²) = step (red-app-lam {M = M}) SUBâ¤…Mâ€² , VMâ€²</a>


<a id="24057" class="Comment">-- halt-app-lam : âˆ€ {g n M N} â†’ {Ï„ : Terms g n} â†’ {{_ : Val N}}</a>
<a id="24121" class="Comment">--                            â†’ SUB (Ï„ , N) M â‡“</a>
<a id="24169" class="Comment">--                            â†’ APP (LAM (SUB (LIFTS Ï„) M)) N â‡“</a>
<a id="24233" class="Comment">-- halt-app-lam {M = M} (Mâ€² , SUBâ‡“Mâ€²) = Mâ€² , big-red-app-lam {M = M} SUBâ‡“Mâ€²</a>


<a id="24311" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="24397" class="Comment">-- red-case-left : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="24464" class="Comment">--                               â†’ CASE (LEFT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â†¦ SUB (Ï„ , M) N</a>
<a id="24565" class="Comment">-- red-case-left {M = M} {N} {Ï„ = Ï„} rewrite simp-CUT-SUB M Ï„ N â»Â¹ = red case-left</a>


<a id="24650" class="Comment">-- big-red-case-left : âˆ€ {g n M N Nâ€² O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="24724" class="Comment">--                                      â†’ SUB (Ï„ , M) N â‡“ Nâ€²</a>
<a id="24785" class="Comment">--                                      â†’ CASE (LEFT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“ Nâ€²</a>
<a id="24882" class="Comment">-- big-red-case-left {N = N} {O = O} (SUBâ¤…Nâ€² , VNâ€²) = step (red-case-left {N = N} {O}) SUBâ¤…Nâ€² , VNâ€²</a>


<a id="24984" class="Comment">-- halt-case-left : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="25052" class="Comment">--                                â†’ SUB (Ï„ , M) N â‡“</a>
<a id="25104" class="Comment">--                                â†’ CASE (LEFT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“</a>
<a id="25192" class="Comment">-- halt-case-left {N = N} {O} (Nâ€² , SUBâ‡“Nâ€²) = Nâ€² , big-red-case-left {N = N} {O = O} SUBâ‡“Nâ€²</a>


<a id="25286" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="25372" class="Comment">-- red-case-right : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="25440" class="Comment">--                                â†’ CASE (RIGHT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â†¦ SUB (Ï„ , M) O</a>
<a id="25543" class="Comment">-- red-case-right {M = M} {O = O} {Ï„} rewrite simp-CUT-SUB M Ï„ O â»Â¹ = red case-right</a>


<a id="25630" class="Comment">-- big-red-case-right : âˆ€ {g n M N O Oâ€²} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="25705" class="Comment">--                                       â†’ SUB (Ï„ , M) O â‡“ Oâ€²</a>
<a id="25767" class="Comment">--                                       â†’ CASE (RIGHT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“ Oâ€²</a>
<a id="25866" class="Comment">-- big-red-case-right {N = N} {O} (SUBâ¤…Oâ€² , VOâ€²) = step (red-case-right {N = N} {O}) SUBâ¤…Oâ€² , VOâ€²</a>


<a id="25966" class="Comment">-- halt-case-right : âˆ€ {g n M N O} â†’ {Ï„ : Terms g n} â†’ {{_ : Val M}}</a>
<a id="26035" class="Comment">--                                 â†’ SUB (Ï„ , M) O â‡“</a>
<a id="26088" class="Comment">--                                 â†’ CASE (RIGHT M) (SUB (LIFTS Ï„) N) (SUB (LIFTS Ï„) O) â‡“</a>
<a id="26178" class="Comment">-- halt-case-right {N = N} {O} (Oâ€² , SUBâ‡“Oâ€²) = Oâ€² , big-red-case-right {N = N} {O} SUBâ‡“Oâ€²</a>


<a id="26270" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>