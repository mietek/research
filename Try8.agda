module Try8 where

{-

...
          â‡‘Â²   â‡“Â³
level 3:  tâ‚‚ : t : u : A
          â‡‘    â‡“Â²
level 2:  t : u : A
          !    â‡“
level 1:  u : A
          int  Â¡
level 0:  A true

-}


infixl 3 _âˆ˜_ _âˆ˜Â²_ _âˆ˜Â³_
infixl 2 ğœ†_ ğœ†Â²_ ğœ†Â³_
infixr 1 _âŠƒ_
infixr 0 _âŠ¢_ âŠ©_
infixr 0 _âŠ¢_âˆ·_ âŠ©_âˆ·_
infixr 0 _âŠ¢_âˆ·_âˆ·_ âŠ©_âˆ·_âˆ·_
infixr 0 _âŠ¢_âˆ·_âˆ·_âˆ·_


mutual
  data Cx : Set where
    âˆ…   : Cx
    _,_ : Cx â†’ Ty â†’ Cx

  data Ty : Set where
    âŠ¥   : Ty
    _âŠƒ_ : Ty â†’ Ty â†’ Ty
    [_âˆ¶_]     : (A : Ty) â†’ âˆ… âŠ¢ A â†’ Ty
    Ï„_âˆ·_âˆ·_   : (A : Ty) (t : âˆ… âŠ¢ A) â†’ âˆ… âŠ¢ A âˆ· t â†’ Ty
    Ï„_âˆ·_âˆ·_âˆ·_ : (A : Ty) (t : âˆ… âŠ¢ A) (tâ‚‚ : âˆ… âŠ¢ A âˆ· t) â†’ âˆ… âŠ¢ A âˆ· t âˆ· tâ‚‚ â†’ Ty

  data _âˆˆ_ : Ty â†’ Cx â†’ Set where
    Z  : âˆ€{A Î“} â†’ A âˆˆ (Î“ , A)
    S_ : âˆ€{A B Î“} â†’ A âˆˆ Î“ â†’ A âˆˆ (Î“ , B)


  data _âŠ¢_ (Î“ : Cx) : Ty â†’ Set where
    wk_ : âˆ€{A}  â†’ âˆ… âŠ¢ A
                â†’ Î“ âŠ¢ A

    wkâ€²_ : âˆ€{A t}  â†’ âˆ… âŠ¢ A âˆ· t
                   â†’ Î“ âŠ¢ [ A âˆ¶ t ]

    wkâ€³_ : âˆ€{A t tâ‚‚}  â†’ âˆ… âŠ¢ A âˆ· t âˆ· tâ‚‚
                      â†’ Î“ âŠ¢ (Ï„ A âˆ· t âˆ· tâ‚‚)

    ğ‘£_ : âˆ€{A}  â†’ A âˆˆ Î“
               â†’ Î“ âŠ¢ A

    ğœ†_ : âˆ€{A B}  â†’ Î“ , A âŠ¢ B
                 â†’ Î“ âŠ¢ A âŠƒ B

    _âˆ˜_ : âˆ€{A B}  â†’ Î“ âŠ¢ A âŠƒ B  â†’ Î“ âŠ¢ A
                  â†’ Î“ âŠ¢ B

    !_ : âˆ€{A}  â†’ (u : âˆ… âŠ¢ A)
               â†’ Î“ âŠ¢ [ A âˆ¶ u ]

    â‡“_ : âˆ€{A u}  â†’ Î“ âŠ¢ A âˆ· u
                 â†’ Î“ âŠ¢ A


  data _âŠ¢_âˆ·_ (Î“ : Cx) : (A : Ty) â†’ Î“ âŠ¢ A â†’ Set where
    wk_ : âˆ€{A t}  â†’ âˆ… âŠ¢ A âˆ· t
                  â†’ Î“ âŠ¢ A âˆ· wk t

    wkâ€²_ : âˆ€{A t tâ‚‚}  â†’ âˆ… âŠ¢ A âˆ· t âˆ· tâ‚‚
                      â†’ Î“ âŠ¢ [ A âˆ¶ t ] âˆ· wkâ€² tâ‚‚

    wkâ€³_ : âˆ€{A t tâ‚‚ tâ‚ƒ}  â†’ âˆ… âŠ¢ A âˆ· t âˆ· tâ‚‚ âˆ· tâ‚ƒ
                         â†’ Î“ âŠ¢ (Ï„ A âˆ· t âˆ· tâ‚‚) âˆ· wkâ€³ tâ‚ƒ

--    kw_  : âˆ€{A t}  â†’ Î“ âŠ¢ (Ï„ A âˆ· t)
--                   â†’ Î“ âŠ¢ A âˆ· wk t

    ğ‘£_ : âˆ€{A x}  â†’ [ A âˆ¶ x ] âˆˆ Î“
                 â†’ Î“ âŠ¢ A âˆ· wk x

    ğ‘£Â²_ : âˆ€{A}  â†’ (x : A âˆˆ Î“)
                â†’ Î“ âŠ¢ A âˆ· ğ‘£ x

    ğœ†Â²_ : âˆ€{A B t}  â†’ Î“ , A âŠ¢ B âˆ· t
                    â†’ Î“ âŠ¢ A âŠƒ B âˆ· ğœ† t

    _âˆ˜Â²_ : âˆ€{A B t s}  â†’ Î“ âŠ¢ A âŠƒ B âˆ· t  â†’ Î“ âŠ¢ A âˆ· s
                       â†’ Î“ âŠ¢ B âˆ· t âˆ˜ s

    !_ : âˆ€{A}  â†’ (u : Î“ âŠ¢ A)
               â†’ Î“ âŠ¢ A âˆ· u

    â‡‘_ : âˆ€{A u}  â†’ Î“ âŠ¢ [ A âˆ¶ u ]
                 â†’ Î“ âŠ¢ [ A âˆ¶ u ] âˆ· ! u

    â‡“Â²_ : âˆ€{A u t}  â†’ Î“ âŠ¢ A âˆ· u âˆ· t
                    â†’ Î“ âŠ¢ A âˆ· â‡“ t


  data _âŠ¢_âˆ·_âˆ·_ (Î“ : Cx) : (A : Ty) (t : Î“ âŠ¢ A) â†’ Î“ âŠ¢ A âˆ· t â†’ Set where
    wk_ : âˆ€{A t tâ‚‚}  â†’ âˆ… âŠ¢ A âˆ· t âˆ· tâ‚‚
                     â†’ Î“ âŠ¢ A âˆ· wk t âˆ· wk tâ‚‚

    wkâ€²_ : âˆ€{A t tâ‚‚ tâ‚ƒ}  â†’ âˆ… âŠ¢ A âˆ· t âˆ· tâ‚‚ âˆ· tâ‚ƒ
                         â†’ Î“ âŠ¢ [ A âˆ¶ t ] âˆ· wkâ€² tâ‚‚ âˆ· wkâ€² tâ‚ƒ

--    kw_  : âˆ€{A t tâ‚‚}  â†’ Î“ âŠ¢ (Ï„ A âˆ· t âˆ· tâ‚‚)
--                      â†’ Î“ âŠ¢ A âˆ· wk t âˆ· wk tâ‚‚

    ğ‘£_ : âˆ€{A x xâ‚‚}  â†’ (Ï„ A âˆ· x âˆ· xâ‚‚) âˆˆ Î“
                    â†’ Î“ âŠ¢ A âˆ· wk x âˆ· wk xâ‚‚

    ğ‘£Â³_ : âˆ€{A}  â†’ (x : A âˆˆ Î“)
                â†’ Î“ âŠ¢ A âˆ· ğ‘£ x âˆ· ğ‘£Â² x

    ğœ†Â³_ : âˆ€{A B t tâ‚‚}  â†’ Î“ , A âŠ¢ B âˆ· t âˆ· tâ‚‚
                       â†’ Î“ âŠ¢ A âŠƒ B âˆ· ğœ† t âˆ· ğœ†Â² tâ‚‚

    _âˆ˜Â³_ : âˆ€{A B t tâ‚‚ s sâ‚‚}  â†’ Î“ âŠ¢ A âŠƒ B âˆ· t âˆ· tâ‚‚  â†’ Î“ âŠ¢ A âˆ· s âˆ· sâ‚‚
                             â†’ Î“ âŠ¢ B âˆ· t âˆ˜ s âˆ· tâ‚‚ âˆ˜Â² sâ‚‚

    â‡‘_ : âˆ€{A u}  â†’ Î“ âŠ¢ A âˆ· u
                 â†’ Î“ âŠ¢ A âˆ· u âˆ· ! u

    â‡“Â³_ : âˆ€{A u t tâ‚‚}  â†’ Î“ âŠ¢ A âˆ· u âˆ· t âˆ· tâ‚‚
                       â†’ Î“ âŠ¢ A âˆ· â‡“ t âˆ· â‡“Â² tâ‚‚


  data _âŠ¢_âˆ·_âˆ·_âˆ·_ (Î“ : Cx) : (A : Ty) (t : Î“ âŠ¢ A) (tâ‚‚ : Î“ âŠ¢ A âˆ· t) â†’ Î“ âŠ¢ A âˆ· t âˆ· tâ‚‚ â†’ Set where
    â‡‘Â²_ : âˆ€{A u t}  â†’ Î“ âŠ¢ A âˆ· u âˆ· t
                    â†’ Î“ âŠ¢ A âˆ· u âˆ· ! u âˆ· â‡‘ t


âŠ©_ : Ty â†’ Set
âŠ© A = {Î“ : Cx} â†’ Î“ âŠ¢ A

âŠ©_âˆ·_ : (A : Ty) â†’ âˆ… âŠ¢ A â†’ Set
âŠ© A âˆ· t = {Î“ : Cx} â†’ Î“ âŠ¢ A âˆ· wk t

âŠ©_âˆ·_âˆ·_ : (A : Ty) (t : âˆ… âŠ¢ A) â†’ âˆ… âŠ¢ A âˆ· t â†’ Set
âŠ© A âˆ· t âˆ· tâ‚‚ = {Î“ : Cx} â†’ Î“ âŠ¢ A âˆ· wk t âˆ· wk tâ‚‚


eI : âˆ€{Î“ A} â†’ Î“ âŠ¢ A âŠƒ A
eI = ğœ† ğ‘£ Z

eIÂ² : âˆ€{Î“ A} â†’ Î“ âŠ¢ A âŠƒ A âˆ· ğœ† ğ‘£ Z
eIÂ² = ğœ†Â² ğ‘£Â² Z

eIÂ²â€² : âˆ€{Î“ A} â†’ Î“ âŠ¢ A âŠƒ A âˆ· ğœ† ğ‘£ Z
eIÂ²â€² = ! (ğœ† ğ‘£ Z)

eIÂ³ : âˆ€{Î“ A} â†’ Î“ âŠ¢ A âŠƒ A âˆ· ğœ† ğ‘£ Z âˆ· ğœ†Â² ğ‘£Â² Z
eIÂ³ = ğœ†Â³ ğ‘£Â³ Z

eIÂ³â€² : âˆ€{Î“ A} â†’ Î“ âŠ¢ A âŠƒ A âˆ· ğœ† ğ‘£ Z âˆ· ! (ğœ† ğ‘£ Z)
eIÂ³â€² = â‡‘ (! (ğœ† ğ‘£ Z))


{-
proposition:
  if x proves A, then A.
proof:
  assume x proves A.
  reflect x.
-}

e11 : âˆ€{Î“ A x} â†’ Î“ âŠ¢ [ A âˆ¶ ğ‘£ x ] âŠƒ A âˆ· ğœ† â‡“ ğ‘£ Z
e11 = ! (ğœ† â‡“ ğ‘£ Z)  -- why "!"?

{-
proposition:
  if x proves A, then !x proves that x proves A.
proof:
  assume x proves A.
  reify x.
-}

e12 : âˆ€{Î“ A x} â†’ Î“ âŠ¢ [ A âˆ¶ ğ‘£ x ] âŠƒ (Ï„ A âˆ· ğ‘£ x âˆ· ! ğ‘£ x) âˆ· ğœ† {!â‡‘ ?!}
e12 = {!!}


--                Î“ âŠ¢    A âˆ· u    âˆ·  !  u
--Î“ , (Ï„ A âˆ· (ğ‘£ x)) âŠ¢ (Ï„ A âˆ· ğ‘£ x) âˆ· (! (ğ‘£ x))
