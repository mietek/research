module Try9 where

open import Data.Nat using (â„•)

{-

...
          â‡‘Â³
level 3:  A âˆ‹ u âˆ‹ t âˆ‹ tâ‚‚
          â‡‘Â²  â‡“Â²
level 2:  A âˆ‹ u âˆ‹ t
          â‡‘   â‡“Â²
level 1:  A âˆ‹ u
          !   â‡“
level 0:  A true

-}


Var : Set
Var = â„•


mutual
  infixl 5 _âˆ·_
  infixl 4 _âˆ§_
  infixr 3 _âŠƒ_
  data Ty : Set where
    âŠ¥   : Ty
    _âŠƒ_ : Ty â†’ Ty â†’ Ty
    _âˆ§_ : Ty â†’ Ty â†’ Ty
    _âˆ·_ : Ty â†’ Tm â†’ Ty

  infixl 9 !_
  data Tm : Set where
    ğ‘£_ : Var â†’ Tm
    ğœ†_âˆ™_ : Var â†’ Tm â†’ Tm
    ğœ†Â²_âˆ™_ : Var â†’ Tm â†’ Tm
    _âˆ˜_ : Tm â†’ Tm â†’ Tm
    _âˆ˜Â²_ : Tm â†’ Tm â†’ Tm
    ğ‘âŸ¨_,_âŸ© : Tm â†’ Tm â†’ Tm
    ğ‘Â²âŸ¨_,_âŸ© : Tm â†’ Tm â†’ Tm
    ğœ‹â‚€_ : Tm â†’ Tm
    ğœ‹â‚€Â²_ : Tm â†’ Tm
    ğœ‹â‚_ : Tm â†’ Tm
    ğœ‹â‚Â²_ : Tm â†’ Tm
    !_ : Tm â†’ Tm
    â‡‘_ : Tm â†’ Tm
    â‡‘Â²_ : Tm â†’ Tm
    â‡“_ : Tm â†’ Tm
    â‡“Â²_ : Tm â†’ Tm


infixl 2 _,_
data Cx : Set where
  âˆ…   : Cx
  _,_ : Cx â†’ Ty â†’ Cx

infixr 1 _âˆˆ_
data _âˆˆ_ : Ty â†’ Cx â†’ Set where
  Z  : âˆ€{Î“ A}           â†’ A âˆˆ Î“ , A
  S_ : âˆ€{Î“ A B} â†’ A âˆˆ Î“ â†’ A âˆˆ Î“ , B


mutual
  infixr 0 _âŠ¢_true
  data _âŠ¢_true (Î“ : Cx) : Ty â†’ Set where
    Mğ‘£â° : âˆ€{A}  â†’ A âˆˆ Î“
                â†’ Î“ âŠ¢ A true

    Mğœ†â° : âˆ€{A B}  â†’ Î“ , A âŠ¢ B true
                  â†’ Î“ âŠ¢ A âŠƒ B true

    Mâˆ˜â° : âˆ€{A B}  â†’ Î“ âŠ¢ A âŠƒ B true  â†’ Î“ âŠ¢ A true
                  â†’ Î“ âŠ¢ B true

    Mğ‘â° : âˆ€{A B}  â†’ Î“ âŠ¢ A true  â†’ Î“ âŠ¢ B true
                  â†’ Î“ âŠ¢ A âˆ§ B true

    Mâ‡“â° : âˆ€{A u}  â†’ Î“ âŠ¢ A âˆ‹ u
                  â†’ Î“ âŠ¢ A true

  infixr 0 _âŠ¢_âˆ‹_
  data _âŠ¢_âˆ‹_ (Î“ : Cx) : Ty â†’ Tm â†’ Set where
    Mğ‘£Â¹ : âˆ€{A x}  â†’ A âˆ· ğ‘£ x âˆˆ Î“
                  â†’ Î“ âŠ¢ A âˆ‹ ğ‘£ x

    Mğœ†Â¹ : âˆ€{A B x t}  â†’ Î“ , A âˆ· ğ‘£ x âŠ¢ B âˆ‹ t
                      â†’ Î“ âŠ¢ A âŠƒ B âˆ‹ ğœ† x âˆ™ t

    Mâˆ˜Â¹ : âˆ€{A B t s}  â†’ Î“ âŠ¢ A âŠƒ B âˆ‹ t  â†’ Î“ âŠ¢ A âˆ‹ s
                      â†’ Î“ âŠ¢ B âˆ‹ t âˆ˜ s

    Mğ‘Â¹ : âˆ€{A B t s}  â†’ Î“ âŠ¢ A âˆ‹ t  â†’ Î“ âŠ¢ B âˆ‹ s
                      â†’ Î“ âŠ¢ (A âˆ§ B) âˆ‹ ğ‘âŸ¨ t , s âŸ©

    Mâ‡“Â¹ : âˆ€{A u t}  â†’ Î“ âŠ¢ A âˆ· u âˆ‹ t
                    â†’ Î“ âŠ¢ A âˆ‹ â‡“ t

    Mâ‡‘Â¹ : âˆ€{A u t}  â†’ Î“ âŠ¢ A âˆ· u âˆ‹ t
                    â†’ Î“ âŠ¢ A âˆ· u âˆ· ! u âˆ‹ â‡‘ t

  infixr 0 _âŠ¢_âˆ‹_âˆ‹_
  data _âŠ¢_âˆ‹_âˆ‹_ (Î“ : Cx) : Ty â†’ Tm â†’ Tm â†’ Set where
    Mğ‘£Â² : âˆ€{A x xâ‚‚}  â†’ A âˆ· ğ‘£ x âˆ· ğ‘£ xâ‚‚ âˆˆ Î“
                     â†’ Î“ âŠ¢ A âˆ‹ ğ‘£ x âˆ‹ ğ‘£ xâ‚‚

    Mğœ†Â² : âˆ€{A B x t xâ‚‚ tâ‚‚}  â†’ Î“ , A âˆ· ğ‘£ x âˆ· ğ‘£ xâ‚‚ âŠ¢ B âˆ‹ t âˆ‹ tâ‚‚
                            â†’ Î“ âŠ¢ A âŠƒ B âˆ‹ ğœ† x âˆ™ t âˆ‹ ğœ†Â² xâ‚‚ âˆ™ tâ‚‚

    Mâˆ˜Â² : âˆ€{A B t s tâ‚‚ sâ‚‚}  â†’ Î“ âŠ¢ A âŠƒ B âˆ‹ t âˆ‹ tâ‚‚  â†’ Î“ âŠ¢ A âˆ‹ s âˆ‹ sâ‚‚
                            â†’ Î“ âŠ¢ B âˆ‹ t âˆ˜ s âˆ‹ tâ‚‚ âˆ˜Â² sâ‚‚

    Mğ‘Â² : âˆ€{A B t s tâ‚‚ sâ‚‚}  â†’ Î“ âŠ¢ A âˆ‹ t âˆ‹ tâ‚‚  â†’ Î“ âŠ¢ B âˆ‹ s âˆ‹ sâ‚‚
                            â†’ Î“ âŠ¢ (A âˆ§ B) âˆ‹ ğ‘âŸ¨ t , s âŸ© âˆ‹ ğ‘Â²âŸ¨ tâ‚‚ , sâ‚‚ âŸ©

    Mâ‡“Â² : âˆ€{A u t tâ‚‚}  â†’ Î“ âŠ¢ A âˆ· u âˆ‹ t âˆ‹ tâ‚‚
                       â†’ Î“ âŠ¢ A âˆ‹ â‡“ t âˆ‹ â‡“Â² tâ‚‚

    Mâ‡‘Â² : âˆ€{A u t tâ‚‚}  â†’ Î“ âŠ¢ A âˆ· u âˆ‹ t âˆ‹ tâ‚‚
                       â†’ Î“ âŠ¢ A âˆ· u âˆ· ! u âˆ‹ â‡‘ t âˆ‹ â‡‘Â² tâ‚‚

  infixr 0 _âŠ¢_âˆ‹_âˆ‹_âˆ‹_
  data _âŠ¢_âˆ‹_âˆ‹_âˆ‹_ (Î“ : Cx) : Ty â†’ Tm â†’ Tm â†’ Tm â†’ Set where


eIâ° : âˆ€{Î“ A} â†’ Î“ âŠ¢ A âŠƒ A true
eIâ° = Mğœ†â° (Mğ‘£â° Z)

eIÂ¹ : âˆ€{Î“ A x} â†’ Î“ âŠ¢ (A âŠƒ A) âˆ‹ ğœ† x âˆ™ ğ‘£ x
eIÂ¹ = Mğœ†Â¹ (Mğ‘£Â¹ Z)

eIÂ² : âˆ€{Î“ A x u} â†’ Î“ âŠ¢ (A âŠƒ A) âˆ‹ ğœ† x âˆ™ ğ‘£ x âˆ‹ ğœ†Â² u âˆ™ ğ‘£ u
eIÂ² = Mğœ†Â² (Mğ‘£Â² Z)


e11 : âˆ€{Î“ A x y} â†’ Î“ âŠ¢ (A âˆ· x âŠƒ A) âˆ‹ ğœ† y âˆ™ â‡“ ğ‘£ y
e11 = Mğœ†Â¹ (Mâ‡“Â¹ (Mğ‘£Â¹ Z))

e12 : âˆ€{Î“ A x y} â†’ Î“ âŠ¢ (A âˆ· x âŠƒ A âˆ· x âˆ· ! x) âˆ‹ ğœ† y âˆ™ â‡‘ ğ‘£ y
e12 = Mğœ†Â¹ (Mâ‡‘Â¹ (Mğ‘£Â¹ Z))

e13 : âˆ€{Î“ A B x y u v} â†’ Î“ âŠ¢ (A âŠƒ B âŠƒ A âˆ§ B) âˆ‹ ğœ† x âˆ™ ğœ† y âˆ™ ğ‘âŸ¨ ğ‘£ x , ğ‘£ y âŸ© âˆ‹ ğœ†Â² u âˆ™ ğœ†Â² v âˆ™ ğ‘Â²âŸ¨ ğ‘£ u , ğ‘£ v âŸ©
e13 = Mğœ†Â² (Mğœ†Â² (Mğ‘Â² (Mğ‘£Â² (S Z)) (Mğ‘£Â² Z)))

e14 : âˆ€{Î“ A B x y u v} â†’ Î“ âŠ¢ (A âˆ· x âŠƒ B âˆ· y âŠƒ (A âˆ§ B) âˆ· ğ‘âŸ¨ x , y âŸ© âˆ· ! ğ‘âŸ¨ x , y âŸ©) âˆ‹ ğœ† u âˆ™ ğœ† v âˆ™ â‡‘ ğ‘Â²âŸ¨ ğ‘£ u , ğ‘£ v âŸ©
e14 = Mğœ†Â¹ (Mğœ†Â¹ (Mâ‡‘Â¹ {!Mğ‘Â² ? ?!}))
