----------------------------------------------------------------------------------------------------

-- first-order renamings

module FOR {ğ“} {X : Set ğ“} where

open import DBI public


----------------------------------------------------------------------------------------------------

infix 4 _âŠ†_
data _âŠ†_ : List X â†’ List X â†’ Set ğ“ where
  []  : âˆ€ {Î“} â†’ [] âŠ† Î“
  _âˆ·_ : âˆ€ {Î“ Î“â€² A} (i : Î“â€² âˆ‹ A) (is : Î“ âŠ† Î“â€²) â†’ A âˆ· Î“ âŠ† Î“â€²

stopâŠ† : [] âŠ† []
stopâŠ† = []

wkâŠ† : âˆ€ {B Î“ Î“â€²} â†’ Î“ âŠ† Î“â€² â†’ Î“ âŠ† B âˆ· Î“â€²
wkâŠ† []       = []
wkâŠ† (i âˆ· is) = suc i âˆ· wkâŠ† is

liftâŠ† : âˆ€ {B Î“ Î“â€²} â†’ Î“ âŠ† Î“â€² â†’ B âˆ· Î“ âŠ† B âˆ· Î“â€²
liftâŠ† is = zero âˆ· wkâŠ† is

idâŠ† reflâŠ† : âˆ€ {Î“} â†’ Î“ âŠ† Î“
idâŠ† {[]}    = []
idâŠ† {A âˆ· Î“} = liftâŠ† idâŠ†
reflâŠ† = idâŠ†


----------------------------------------------------------------------------------------------------

renâˆ‹ : âˆ€ {Î“ Î“â€² A} â†’ Î“ âŠ† Î“â€² â†’ Î“ âˆ‹ A â†’ Î“â€² âˆ‹ A
renâˆ‹ (j âˆ· js) zero    = j
renâˆ‹ (j âˆ· js) (suc i) = renâˆ‹ js i

wkâˆ‹ : âˆ€ {B Î“ A} â†’ Î“ âˆ‹ B â†’ A âˆ· Î“ âˆ‹ B
wkâˆ‹ i = renâˆ‹ (wkâŠ† idâŠ†) i

eqwkrenâˆ‹ : âˆ€ {B Î“ Î“â€² A} (js : Î“ âŠ† Î“â€²) (i : Î“ âˆ‹ A) â†’
           renâˆ‹ (wkâŠ† js) i â‰¡ (_âˆ‹_.suc {B = B} âˆ˜ renâˆ‹ js) i
eqwkrenâˆ‹ (j âˆ· js) zero    = refl
eqwkrenâˆ‹ (j âˆ· js) (suc i) = eqwkrenâˆ‹ js i

idrenâˆ‹ : âˆ€ {Î“ A} (i : Î“ âˆ‹ A) â†’ renâˆ‹ idâŠ† i â‰¡ i
idrenâˆ‹ zero    = refl
idrenâˆ‹ (suc i) = eqwkrenâˆ‹ idâŠ† i â‹® suc & idrenâˆ‹ i

_âˆ˜âŠ†_ : âˆ€ {Î“ Î“â€² Î“â€³} â†’ Î“â€² âŠ† Î“â€³ â†’ Î“ âŠ† Î“â€² â†’ Î“ âŠ† Î“â€³
isâ€² âˆ˜âŠ† []       = []
isâ€² âˆ˜âŠ† (i âˆ· is) = renâˆ‹ isâ€² i âˆ· (isâ€² âˆ˜âŠ† is)

transâŠ† _â—‹_ : âˆ€ {Î“ Î“â€² Î“â€³} â†’ Î“ âŠ† Î“â€² â†’ Î“â€² âŠ† Î“â€³ â†’ Î“ âŠ† Î“â€³
transâŠ† = flip _âˆ˜âŠ†_
_â—‹_ = transâŠ†

comprenâˆ‹ : âˆ€ {Î“ Î“â€² Î“â€³ A} (jsâ€² : Î“â€² âŠ† Î“â€³) (js : Î“ âŠ† Î“â€²) (i : Î“ âˆ‹ A) â†’
           renâˆ‹ (jsâ€² âˆ˜âŠ† js) i â‰¡ (renâˆ‹ jsâ€² âˆ˜ renâˆ‹ js) i
comprenâˆ‹ (jâ€² âˆ· jsâ€²) (j âˆ· js) zero    = refl
comprenâˆ‹ (jâ€² âˆ· jsâ€²) (j âˆ· js) (suc i) = comprenâˆ‹ (jâ€² âˆ· jsâ€²) js i


----------------------------------------------------------------------------------------------------

lidâŠ† : âˆ€ {Î“ Î“â€²} (is : Î“ âŠ† Î“â€²) â†’ idâŠ† âˆ˜âŠ† is â‰¡ is
lidâŠ† []       = refl
lidâŠ† (i âˆ· is) = _âˆ·_ & idrenâˆ‹ i âŠ— lidâŠ† is

eqâŠ† : âˆ€ {B Î“ Î“â€² Î“â€³} (iâ€² : Î“â€³ âˆ‹ B) (isâ€² : Î“â€² âŠ† Î“â€³) (is : Î“ âŠ† Î“â€²) â†’
      (iâ€² âˆ· isâ€²) âˆ˜âŠ† (wkâŠ† is) â‰¡ isâ€² âˆ˜âŠ† is
eqâŠ† iâ€² isâ€² []       = refl
eqâŠ† iâ€² isâ€² (i âˆ· is) = (renâˆ‹ isâ€² i âˆ·_) & eqâŠ† iâ€² isâ€² is

eqwkâŠ† : âˆ€ {B Î“ Î“â€² Î“â€³} (isâ€² : Î“â€² âŠ† Î“â€³) (is : Î“ âŠ† Î“â€²) â†’
        (liftâŠ† isâ€²) âˆ˜âŠ† (wkâŠ† is) â‰¡ wkâŠ† {B} (isâ€² âˆ˜âŠ† is)
eqwkâŠ† isâ€² []       = refl
eqwkâŠ† isâ€² (i âˆ· is) = _âˆ·_ & eqwkrenâˆ‹ isâ€² i âŠ— eqwkâŠ† isâ€² is

eqliftâŠ† : âˆ€ {B Î“ Î“â€² Î“â€³} (isâ€² : Î“â€² âŠ† Î“â€³) (is : Î“ âŠ† Î“â€²) â†’
          (liftâŠ† isâ€²) âˆ˜âŠ† (liftâŠ† is) â‰¡ liftâŠ† {B} (isâ€² âˆ˜âŠ† is)
eqliftâŠ† isâ€² []       = refl
eqliftâŠ† isâ€² (i âˆ· is) = (zero âˆ·_) & eqwkâŠ† isâ€² (i âˆ· is)

ridâŠ† : âˆ€ {Î“ Î“â€²} (is : Î“ âŠ† Î“â€²) â†’ is âˆ˜âŠ† idâŠ† â‰¡ is
ridâŠ† []       = refl
ridâŠ† (i âˆ· is) = (i âˆ·_) & (eqâŠ† i is idâŠ† â‹® ridâŠ† is)

assâŠ† : âˆ€ {Î“ Î“â€² Î“â€³ Î“â€´} (isâ€³ : Î“â€³ âŠ† Î“â€´) (isâ€² : Î“â€² âŠ† Î“â€³) (is : Î“ âŠ† Î“â€²) â†’
       isâ€³ âˆ˜âŠ† (isâ€² âˆ˜âŠ† is) â‰¡ (isâ€³ âˆ˜âŠ† isâ€²) âˆ˜âŠ† is
assâŠ† isâ€³ isâ€² []       = refl
assâŠ† isâ€³ isâ€² (i âˆ· is) = _âˆ·_ & comprenâˆ‹ isâ€³ isâ€² i â»Â¹ âŠ— assâŠ† isâ€³ isâ€² is


----------------------------------------------------------------------------------------------------
