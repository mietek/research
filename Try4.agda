{-# OPTIONS --allow-unsolved-metas #-}

{-

'(agda-input-user-translations
   (quote
    (("i" "âŠƒ") ("e" "âŠ¢") ("t" "âŠ©")
     ("f" "ğ‘“") ("f2" "ğ‘“Â²") ("f3" "ğ‘“Â³") ("fn" "ğ‘“â¿")
     ("v" "ğ‘£") ("v2" "ğ‘£Â²") ("v3" "ğ‘£Â³") ("vn" "ğ‘£â¿")
     ("l" "ğœ†") ("l2" "ğœ†Â²") ("l3" "ğœ†Â³") ("ln" "ğœ†â¿")
     ("o" "âˆ˜") ("o2" "âˆ˜Â²") ("o3" "âˆ˜Â³") ("on" "âˆ˜â¿")
     ("p" "ğ‘") ("p2" "ğ‘Â²") ("p3" "ğ‘Â³") ("pn" "ğ‘â¿")
     ("1" "ğœ‹â‚€") ("12" "ğœ‹â‚€Â²") ("13" "ğœ‹â‚€Â³") ("1n" "ğœ‹â‚€â¿")
     ("2" "ğœ‹â‚") ("22" "ğœ‹â‚Â²") ("23" "ğœ‹â‚Â³") ("2n" "ğœ‹â‚â¿")
     ("u" "â‡‘") ("u2" "â‡‘Â²") ("u3" "â‡‘Â³") ("un" "â‡‘â¿")
     ("d" "â‡“") ("d2" "â‡“Â²") ("d3" "â‡“Â³") ("dn" "â‡“â¿"))))

-}

module Try4 where

open import Data.Fin using (Fin; zero; suc; toâ„•)
open import Data.Nat using (â„•; zero; suc; _+_)
open import Data.Product using (Î£; _Ã—_; _,_)


data Vec (X : Set) : â„• â†’ Set where
  âˆ…   : Vec X zero
  _,_ : âˆ€{n} â†’ Vec X n â†’ X â†’ Vec X (suc n)

data _âˆˆ_ {X : Set} : âˆ€{n} â†’ X â†’ Vec X n â†’ Set where
  Z  : âˆ€{n x} {xs : Vec X n}
     â†’ x âˆˆ (xs , x)
  S_ : âˆ€{n x y} {xs : Vec X n}
     â†’ x âˆˆ xs
     â†’ x âˆˆ (xs , y)


infixl 4 _âˆ˜_ _âˆ˜Â²_ _âˆ˜Â³_
infixr 3 ğœ†_ ğœ†Â²_ ğœ†Â³_
infixl 2 _âˆ§_
infixr 1 _âŠƒ_
infixr 0 _âˆ™_âŠ¢_ _âŠ©_ âŠª_
infixr 0 _âˆ™_âŠ¢_âˆ·_ _âŠ©_âˆ·_ âŠª_âˆ·_
infixr 0 _âˆ™_âŠ¢_âˆ·_âˆ·_ _âŠ©_âˆ·_âˆ·_ âŠª_âˆ·_âˆ·_


data Ty : Set where
  âŠ¥   : Ty
  _âŠƒ_ : Ty â†’ Ty â†’ Ty
  _âˆ§_ : Ty â†’ Ty â†’ Ty


Cx : â„• â†’ Set
Cx = Vec Ty


data _âˆ™_âŠ¢_ {k n : â„•} (Î¦ : Cx k) (Î“ : Cx n) : Ty â†’ Set where
  ğ‘“_     : âˆ€{A}
         â†’ A âˆˆ Î¦
         â†’ Î¦ âˆ™ Î“ âŠ¢ A
  ğ‘£_     : âˆ€{A}
         â†’ A âˆˆ Î“
         â†’ Î¦ âˆ™ Î“ âŠ¢ A
  ğœ†_     : âˆ€{A B}
         â†’ Î¦ âˆ™ Î“ , A âŠ¢ B
         â†’ Î¦ âˆ™ Î“ âŠ¢ A âŠƒ B
  _âˆ˜_    : âˆ€{A B}
         â†’ Î¦ âˆ™ Î“ âŠ¢ A âŠƒ B    â†’ Î¦ âˆ™ Î“ âŠ¢ A
         â†’ Î¦ âˆ™ Î“ âŠ¢ B
  ğ‘âŸ¨_,_âŸ© : âˆ€{A B}
         â†’ Î¦ âˆ™ Î“ âŠ¢ A        â†’ Î¦ âˆ™ Î“ âŠ¢ B
         â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B
  ğœ‹â‚€_    : âˆ€{A B}
         â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B
         â†’ Î¦ âˆ™ Î“ âŠ¢ A
  ğœ‹â‚_    : âˆ€{A B}
         â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B
         â†’ Î¦ âˆ™ Î“ âŠ¢ B


_âŠ©_ : âˆ€{k} â†’ Cx k â†’ Ty â†’ Set
Î¦ âŠ© A = âˆ€{n} {Î“ : Cx n} â†’ Î¦ âˆ™ Î“ âŠ¢ A

âŠª_ : Ty â†’ Set
âŠª A = âˆ€{k} {Î¦ : Cx k} â†’ Î¦ âŠ© A


tI : âˆ€{A}
   â†’ âŠª A âŠƒ A
tI = ğœ† ğ‘£ Z

tK : âˆ€{A B}
   â†’ âŠª A âŠƒ B âŠƒ A
tK = ğœ† ğœ† ğ‘£ S Z

tS : âˆ€{A B C}
   â†’ âŠª (A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C
tS = ğœ† ğœ† ğœ† (ğ‘£ S S Z âˆ˜ ğ‘£ Z) âˆ˜ (ğ‘£ S Z âˆ˜ ğ‘£ Z)


data _âˆ™_âŠ¢_âˆ·_ {k n : â„•} (Î¦ : Cx k) (Î“ : Cx n) : (A : Ty) â†’ Î¦ âˆ™ Î“ âŠ¢ A â†’ Set where
  ğ‘“Â²_     : âˆ€{A x}
          â†’ A âˆˆ Î¦
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· ğ‘“ x
  ğ‘£Â²_     : âˆ€{A}
          â†’ (x : A âˆˆ Î“)
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· ğ‘£ x
  ğœ†Â²_     : âˆ€{A B t}
          â†’ Î¦ âˆ™ Î“ , A âŠ¢ B âˆ· t
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âŠƒ B âˆ· ğœ† t
  _âˆ˜Â²_    : âˆ€{A B t s}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âŠƒ B âˆ· t    â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· s
          â†’ Î¦ âˆ™ Î“ âŠ¢ B âˆ· t âˆ˜ s
  ğ‘Â²âŸ¨_,_âŸ© : âˆ€{A B t s}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t        â†’ Î¦ âˆ™ Î“ âŠ¢ B âˆ· s
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B âˆ· ğ‘âŸ¨ t , s âŸ©
  ğœ‹â‚€Â²_    : âˆ€{A B t}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B âˆ· t
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· ğœ‹â‚€ t
  ğœ‹â‚Â²_    : âˆ€{A B t}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B âˆ· t
          â†’ Î¦ âˆ™ Î“ âŠ¢ B âˆ· ğœ‹â‚ t
  !_      : âˆ€{A t}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t


_âŠ©_âˆ·_ : âˆ€{k} (Î¦ : Cx k) (A : Ty) â†’ Î¦ âŠ© A â†’ Set
Î¦ âŠ© A âˆ· t = âˆ€{n} {Î“ : Cx n} â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t

âŠª_âˆ·_ : (A : Ty) â†’ âŠª A â†’ Set
âŠª A âˆ· t = âˆ€{k} {Î¦ : Cx k} â†’ Î¦ âŠ© A âˆ· t


tIÂ² : âˆ€{A}
    â†’ âŠª A âŠƒ A
      âˆ· ğœ† ğ‘£ Z
tIÂ² = ğœ†Â² (ğ‘£Â² Z)

tKÂ² : âˆ€{A B}
    â†’ âŠª A âŠƒ B âŠƒ A
      âˆ· ğœ† ğœ† ğ‘£ S Z
tKÂ² = ğœ†Â² ğœ†Â² ğ‘£Â² S Z

tSÂ² : âˆ€{A B C}
    â†’ âŠª (A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C
      âˆ· ğœ† ğœ† ğœ† (ğ‘£ S S Z âˆ˜ ğ‘£ Z) âˆ˜ (ğ‘£ S Z âˆ˜ ğ‘£ Z)
tSÂ² = ğœ†Â² ğœ†Â² ğœ†Â² (ğ‘£Â² S S Z âˆ˜Â² ğ‘£Â² Z) âˆ˜Â² (ğ‘£Â² S Z âˆ˜Â² ğ‘£Â² Z)



data _âˆ™_âŠ¢_âˆ·_âˆ·_ {k n : â„•} (Î¦ : Cx k) (Î“ : Cx n) : (A : Ty) â†’ (t : Î¦ âˆ™ Î“ âŠ¢ A) â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t â†’ Set where
  ğ‘“Â³_      : âˆ€{A x}
          â†’ A âˆˆ Î¦
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· ğ‘“ x âˆ· ğ‘“Â² x
  ğ‘£Â³_     : âˆ€{A}
          â†’ (x : A âˆˆ Î“)
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· ğ‘£ x âˆ· ğ‘£Â² x
  ğœ†Â³_     : âˆ€{A B t tâ‚‚}
          â†’ Î¦ âˆ™ Î“ , A âŠ¢ B âˆ· t âˆ· tâ‚‚
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âŠƒ B âˆ· ğœ† t âˆ· ğœ†Â² tâ‚‚
  _âˆ˜Â³_    : âˆ€{A B t tâ‚‚ s sâ‚‚}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âŠƒ B âˆ· t âˆ· tâ‚‚   â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· s âˆ· sâ‚‚
          â†’ Î¦ âˆ™ Î“ âŠ¢ B âˆ· t âˆ˜ s âˆ· tâ‚‚ âˆ˜Â² sâ‚‚
  ğ‘Â³âŸ¨_,_âŸ© : âˆ€{A B t tâ‚‚ s sâ‚‚}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t âˆ· tâ‚‚       â†’ Î¦ âˆ™ Î“ âŠ¢ B âˆ· s âˆ· sâ‚‚
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B âˆ· ğ‘âŸ¨ t , s âŸ© âˆ· ğ‘Â²âŸ¨ tâ‚‚ , sâ‚‚ âŸ©
  ğœ‹â‚€Â³_    : âˆ€{A B t tâ‚‚}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B âˆ· t âˆ· tâ‚‚
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· ğœ‹â‚€ t âˆ· ğœ‹â‚€Â² tâ‚‚
  ğœ‹â‚Â³_    : âˆ€{A B t tâ‚‚}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ§ B âˆ· t âˆ· tâ‚‚
          â†’ Î¦ âˆ™ Î“ âŠ¢ B âˆ· ğœ‹â‚ t âˆ· ğœ‹â‚Â² tâ‚‚
  !_      : âˆ€{A t tâ‚‚}
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t âˆ· tâ‚‚
          â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t âˆ· tâ‚‚


â‡‘_ : âˆ€{k n} {Î¦ : Cx k} {Î“ : Cx n} {A : Ty} {u : Î¦ âˆ™ Î“ âŠ¢ A}
   â†’ (x : Î¦ âˆ™ Î“ âŠ¢ A âˆ· u)
   â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· u âˆ· (! x)
â‡‘_ = {!!}

â‡“_ : âˆ€{k n} {Î¦ : Cx k} {Î“ : Cx n} {A : Ty} {u : Î¦ âˆ™ Î“ âŠ¢ A}
   â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· u
   â†’ Î¦ âˆ™ Î“ âŠ¢ A
â‡“_ {u = u} = Î» _ â†’ u


_âŠ©_âˆ·_âˆ·_ : âˆ€{k} (Î¦ : Cx k) (A : Ty) (t : Î¦ âŠ© A) â†’ Î¦ âŠ© A âˆ· t â†’ Set
Î¦ âŠ© A âˆ· t âˆ· tâ‚‚ = âˆ€{n} {Î“ : Cx n} â†’ Î¦ âˆ™ Î“ âŠ¢ A âˆ· t âˆ· tâ‚‚

âŠª_âˆ·_âˆ·_ : (A : Ty) (t : âŠª A) â†’ âŠª A âˆ· t â†’ Set
âŠª A âˆ· t âˆ· tâ‚‚ = âˆ€{k} {Î¦ : Cx k} â†’ Î¦ âŠ© A âˆ· t âˆ· tâ‚‚


tIÂ³ : âˆ€{A} â†’ âŠª A âŠƒ A
    âˆ· ğœ† ğ‘£ Z
    âˆ· ğœ†Â² ğ‘£Â² Z
tIÂ³ = ğœ†Â³ ğ‘£Â³ Z

tKÂ³ : âˆ€{A B} â†’ âŠª A âŠƒ B âŠƒ A
    âˆ· ğœ† ğœ† ğ‘£ S Z
    âˆ· ğœ†Â² ğœ†Â² ğ‘£Â² S Z
tKÂ³ = ğœ†Â³ ğœ†Â³ ğ‘£Â³ S Z

tSÂ³ : âˆ€{A B C} â†’ âŠª (A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C
    âˆ· ğœ† ğœ† ğœ† (ğ‘£ S S Z âˆ˜ ğ‘£ Z) âˆ˜ (ğ‘£ S Z âˆ˜ ğ‘£ Z)
    âˆ· ğœ†Â² ğœ†Â² ğœ†Â² (ğ‘£Â² S S Z âˆ˜Â² ğ‘£Â² Z) âˆ˜Â² (ğ‘£Â² S Z âˆ˜Â² ğ‘£Â² Z)
tSÂ³ = ğœ†Â³ ğœ†Â³ ğœ†Â³ (ğ‘£Â³ S S Z âˆ˜Â³ ğ‘£Â³ Z) âˆ˜Â³ (ğ‘£Â³ S Z âˆ˜Â³ ğ‘£Â³ Z)


-- tt : âˆ€{A x}
--    â†’ âˆ… , x âŠ© A âŠƒ A
--            âˆ· ?
--            âˆ· ğœ† â‡‘ ğ‘£ Z
-- tt = {!!}
