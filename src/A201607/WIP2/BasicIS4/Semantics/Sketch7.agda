{-# OPTIONS --allow-unsolved-metas #-}

module A201607.WIP2.BasicIS4.Semantics.Sketch7 where

open import A201607.Common.Semantics public
open import A201607.BasicIS4.Syntax.Common public


record Model : Setâ‚ where
  field
    World : Set

    -- Zero : World

    _L_    : World â†’ World â†’ Set
    reflL  : âˆ€ {w} â†’ w L w
    transL : âˆ€ {w wâ€² wâ€³} â†’ w L wâ€² â†’ wâ€² L wâ€³ â†’ w L wâ€³
    -- botL   : âˆ€ {w} â†’ Zero L w

    _R_    : World â†’ World â†’ Set
    reflR  : âˆ€ {w} â†’ w R w
    transR : âˆ€ {w wâ€² wâ€³} â†’ w R wâ€² â†’ wâ€² R wâ€³ â†’ w R wâ€³
    -- botR   : âˆ€ {w} â†’ Zero R w

    _[âŠ¢]_   : World â†’ Ty â†’ Set
    mono[âŠ¢] : âˆ€ {A w wâ€²} â†’ w L wâ€² Ã— w R wâ€² â†’ w [âŠ¢] A â†’ wâ€² [âŠ¢] A

    _[âŠ¢â¿á¶ ]_ : World â†’ Ty â†’ Set

    _âŠªáµ…_   : World â†’ Atom â†’ Set
    monoâŠªáµ… : âˆ€ {P w wâ€²} â†’ w L wâ€² Ã— w R wâ€² â†’ w âŠªáµ… P â†’ wâ€² âŠªáµ… P

  _â‰¤_ : World â†’ World â†’ Set
  w â‰¤ wâ€² = w L wâ€² Ã— w R wâ€²

  reflâ‰¤ : âˆ€ {w} â†’ w â‰¤ w
  reflâ‰¤ = reflL , reflR

  transâ‰¤ : âˆ€ {w wâ€² wâ€³} â†’ w â‰¤ wâ€² â†’ wâ€² â‰¤ wâ€³ â†’ w â‰¤ wâ€³
  transâ‰¤ (Î· , Î¸) (Î·â€² , Î¸â€²) = transL Î· Î·â€² , transR Î¸ Î¸â€²

  -- botâ‰¤ : âˆ€ {w} â†’ Zero â‰¤ w
  -- botâ‰¤ = botL , botR

  _â‰¤â¨¾R_ : World â†’ World â†’ Set
  _â‰¤â¨¾R_ = _â‰¤_ â¨¾ _R_

  -- _Râ¨¾â‰¤_ : World â†’ World â†’ Set
  -- _Râ¨¾â‰¤_ = _R_ â¨¾ _â‰¤_

  -- reflâ‰¤â¨¾R : âˆ€ {w} â†’ w â‰¤â¨¾R w
  -- reflâ‰¤â¨¾R {w} = w , (reflâ‰¤ , reflR)

  -- reflRâ¨¾â‰¤ : âˆ€ {w} â†’ w Râ¨¾â‰¤ w
  -- reflRâ¨¾â‰¤ {w} = w , (reflR , reflâ‰¤)

  â‰¤â¨¾Râ†’R : âˆ€ {vâ€² w} â†’ w â‰¤â¨¾R vâ€² â†’ w R vâ€²
  â‰¤â¨¾Râ†’R (wâ€² , ((Î· , Î¸) , Î¸â€²)) = transR Î¸ Î¸â€²

  -- Râ¨¾â‰¤â†’R : âˆ€ {w vâ€²} â†’ w Râ¨¾â‰¤ vâ€² â†’ w R vâ€²
  -- Râ¨¾â‰¤â†’R (v , (Î¸ , (Î· , Î¸â€²))) = transR Î¸ Î¸â€²

  -- â‰¤â¨¾Râ†’Râ¨¾â‰¤ : âˆ€ {wâ€² w} â†’ w â‰¤â¨¾R wâ€² â†’ w Râ¨¾â‰¤ wâ€²
  -- â‰¤â¨¾Râ†’Râ¨¾â‰¤ {wâ€²} Î¾,Î¸ = wâ€² , (â‰¤â¨¾Râ†’R Î¾,Î¸ , reflâ‰¤)

  -- transRâ¨¾â‰¤ : âˆ€ {wâ€² w wâ€³} â†’ w Râ¨¾â‰¤ wâ€² â†’ wâ€² Râ¨¾â‰¤ wâ€³ â†’ w Râ¨¾â‰¤ wâ€³
  -- transRâ¨¾â‰¤ {wâ€²} (v , (Î¸ , Î¾)) (vâ€² , (Î¸â€² , Î¾â€²)) = let vâ€³ , (Î¸â€³ , Î¾â€³) = â‰¤â¨¾Râ†’Râ¨¾â‰¤ (wâ€² , (Î¾ , Î¸â€²))
  --                                                in  vâ€³ , (transR Î¸ Î¸â€³ , transâ‰¤ Î¾â€³ Î¾â€²)

  â‰¤â†’R : âˆ€ {vâ€² w} â†’ w â‰¤ vâ€² â†’ w R vâ€²
  â‰¤â†’R {vâ€²} Î¾ = â‰¤â¨¾Râ†’R (vâ€² , (Î¾ , reflR))

  -- Râ¨¾â‰¤â†’â‰¤â¨¾R : âˆ€ {w vâ€²} â†’ w Râ¨¾â‰¤ vâ€² â†’ w â‰¤â¨¾R vâ€²
  -- Râ¨¾â‰¤â†’â‰¤â¨¾R {w} Î¸,Î¾ = w , (reflâ‰¤ , Râ¨¾â‰¤â†’R Î¸,Î¾)

  -- transâ‰¤â¨¾R : âˆ€ {wâ€² w wâ€³} â†’ w â‰¤â¨¾R wâ€² â†’ wâ€² â‰¤â¨¾R wâ€³ â†’ w â‰¤â¨¾R wâ€³
  -- transâ‰¤â¨¾R {wâ€²} (v , (Î¾ , Î¸)) (vâ€² , (Î¾â€² , Î¸â€²)) = let vâ€³ , (Î¾â€³ , Î¸â€³) = Râ¨¾â‰¤â†’â‰¤â¨¾R (wâ€² , (Î¸ , Î¾â€²))
  --                                                in  vâ€³ , (transâ‰¤ Î¾ Î¾â€³ , transR Î¸â€³ Î¸â€²)

  -- â‰¤â†’Râ€² : âˆ€ {w vâ€²} â†’ w â‰¤ vâ€² â†’ w R vâ€²
  -- â‰¤â†’Râ€² {w} Î¾ = Râ¨¾â‰¤â†’R (w , (reflR , Î¾))

  -- _â‰¤âŠ“R_ : World â†’ World â†’ Set
  -- _â‰¤âŠ“R_ = _â‰¤_ âŠ“ _R_

  -- _RâŠ“â‰¤_ : World â†’ World â†’ Set
  -- _RâŠ“â‰¤_ = _R_ âŠ“ _â‰¤_

  -- â‰¤âŠ“Râ†’RâŠ“â‰¤ : âˆ€ {wâ€² v} â†’ wâ€² â‰¤âŠ“R v â†’ v RâŠ“â‰¤ wâ€²
  -- â‰¤âŠ“Râ†’RâŠ“â‰¤ (w , (Î¾ , Î¸)) = w , (Î¸ , Î¾)

  -- RâŠ“â‰¤â†’â‰¤âŠ“R : âˆ€ {wâ€² v} â†’ v RâŠ“â‰¤ wâ€² â†’ wâ€² â‰¤âŠ“R v
  -- RâŠ“â‰¤â†’â‰¤âŠ“R (w , (Î¸ , Î¾)) = w , (Î¾ , Î¸)

  -- infix 3 _â‰¤âŠ”R_
  -- _â‰¤âŠ”R_ : World â†’ World â†’ Set
  -- _â‰¤âŠ”R_ = _â‰¤_ âŠ” _R_

  -- infix 3 _RâŠ”â‰¤_
  -- _RâŠ”â‰¤_ : World â†’ World â†’ Set
  -- _RâŠ”â‰¤_ = _R_ âŠ” _â‰¤_

  -- â‰¤âŠ”Râ†’RâŠ”â‰¤ : âˆ€ {wâ€² v} â†’ wâ€² â‰¤âŠ”R v â†’ v RâŠ”â‰¤ wâ€²
  -- â‰¤âŠ”Râ†’RâŠ”â‰¤ (vâ€² , (Î¾ , Î¸)) = vâ€² , (Î¸ , Î¾)

  -- RâŠ”â‰¤â†’â‰¤âŠ”R : âˆ€ {wâ€² v} â†’ v RâŠ”â‰¤ wâ€² â†’ wâ€² â‰¤âŠ”R v
  -- RâŠ”â‰¤â†’â‰¤âŠ”R (vâ€² , (Î¸ , Î¾)) = vâ€² , (Î¾ , Î¸)

  -- â‰¤âŠ“Râ†’â‰¤âŠ”R : âˆ€ {v wâ€²} â†’ wâ€² â‰¤âŠ“R v â†’ v â‰¤âŠ”R wâ€²
  -- â‰¤âŠ“Râ†’â‰¤âŠ”R {v} {wâ€²} (w , ((Î· , Î¸) , Î¸â€²)) = {!!} , ({!!} , {!!})

  -- â‰¤âŠ”Râ†’â‰¤âŠ“R : âˆ€ {wâ€² v} â†’ v â‰¤âŠ”R wâ€² â†’ wâ€² â‰¤âŠ“R v
  -- â‰¤âŠ”Râ†’â‰¤âŠ“R (vâ€² , ((Î· , Î¸) , Î¸â€²)) = Zero , (botâ‰¤ , botR)

open Model {{â€¦}} public


module _ {{_ : Model}} where
  mutual
    infix 3 _âŠª_
    _âŠª_ : World â†’ Ty â†’ Set
    w âŠª Î± P   = w âŠªáµ… P
    w âŠª A â–» B = âˆ€ {wâ€²} â†’ w â‰¤ wâ€² â†’ wâ€² âŠ© A â†’ wâ€² âŠ© B
    w âŠª â–¡ A   = âˆ€ {wâ€²} â†’ wâ€² L {!w!} â†’ w R wâ€² â†’ wâ€² [âŠ¢] A Ã— wâ€² âŠ© A
    w âŠª A âˆ§ B = w âŠ© A Ã— w âŠ© B
    w âŠª âŠ¤    = ğŸ™

    infix 3 _âŠ©_
    _âŠ©_ : World â†’ Ty â†’ Set
    w âŠ© A = âˆ€ {C} {wâ€² : World} â†’ w â‰¤ wâ€² â†’ (âˆ€ {wâ€³ : World} â†’ wâ€² â‰¤ wâ€³ â†’ wâ€³ âŠª A â†’ wâ€³ [âŠ¢â¿á¶ ] C) â†’ wâ€² [âŠ¢â¿á¶ ] C

  infix 3 _âŠ©â‹†_
  _âŠ©â‹†_ : World â†’ Cx Ty â†’ Set
  w âŠ©â‹† âˆ…     = ğŸ™
  w âŠ©â‹† Î , A = w âŠ©â‹† Î Ã— w âŠ© A
