{-# OPTIONS --allow-unsolved-metas #-}

{-

An extension of reflective Î»-calculus
=====================================

A work-in-progress implementation of the Alt-ArtÃ«mov system Î»âˆ,
extended with disjunction and falsehood.

For easy editing with Emacs agda-mode, add to your .emacs file:

'(agda-input-user-translations
   (quote
    (("i" "âŠƒ") ("ii" "â«—") ("e" "âŠ¢") ("ee" "âŠ©") ("n" "Â¬") (":." "âˆµ")
     ("v" "ğ‘£") ("v2" "ğ‘£Â²") ("v3" "ğ‘£Â³") ("v4" "ğ‘£â´") ("vn" "ğ‘£â¿")
     ("fv" "ğ‘“ğ‘£") ("fv2" "ğ‘“ğ‘£Â²") ("fv3" "ğ‘“ğ‘£Â³") ("fv4" "ğ‘“ğ‘£â´") ("fvn" "ğ‘“ğ‘£â¿")
     ("bv" "ğ‘ğ‘£") ("bv2" "ğ‘ğ‘£Â²") ("bv3" "ğ‘ğ‘£Â³") ("bv4" "ğ‘ğ‘£â´") ("bvn" "ğ‘ğ‘£â¿")
     ("l" "ğœ†") ("l2" "ğœ†Â²") ("l3" "ğœ†Â³") ("l4" "ğœ†â´") ("ln" "ğœ†â¿")
     ("o" "âˆ˜") ("o2" "âˆ˜Â²") ("o3" "âˆ˜Â³") ("o4" "âˆ˜â´") ("on" "âˆ˜â¿")
     ("p" "ğ‘") ("p2" "ğ‘Â²") ("p3" "ğ‘Â³") ("p4" "ğ‘â´") ("pn" "ğ‘â¿")
     ("pi" "ğœ‹")
     ("pi0" "ğœ‹â‚€") ("pi02" "ğœ‹â‚€Â²") ("pi03" "ğœ‹â‚€Â³") ("pi04" "ğœ‹â‚€â´") ("pi0n" "ğœ‹â‚€â¿")
     ("pi1" "ğœ‹â‚") ("pi12" "ğœ‹â‚Â²") ("pi13" "ğœ‹â‚Â³") ("pi14" "ğœ‹â‚â´") ("pi1n" "ğœ‹â‚â¿")
     ("io" "ğœ„")
     ("io0" "ğœ„â‚€") ("io02" "ğœ„â‚€Â²") ("io03" "ğœ„â‚€Â³") ("io04" "ğœ„â‚€â´") ("io0n" "ğœ„â‚€â¿")
     ("io1" "ğœ„â‚") ("io12" "ğœ„â‚Â²") ("io13" "ğœ„â‚Â³") ("io14" "ğœ„â‚â´") ("io1n" "ğœ„â‚â¿")
     ("c" "ğ‘") ("c2" "ğ‘Â²") ("c3" "ğ‘Â³") ("c4" "ğ‘â´") ("cn" "ğ‘â¿")
     ("u" "â‡‘") ("u2" "â‡‘Â²") ("u3" "â‡‘Â³") ("u4" "â‡‘â´") ("un" "â‡‘â¿")
     ("d" "â‡“") ("d2" "â‡“Â²") ("d3" "â‡“Â³") ("d4" "â‡“â´") ("dn" "â‡“â¿")
     ("t" "ğ‘¡") ("t2" "ğ‘¡Â²") ("t3" "ğ‘¡Â³") ("t4" "ğ‘¡â´") ("tn" "ğ‘¡â¿")
     ("x" "â˜†") ("x2" "â˜†Â²") ("x3" "â˜†Â³") ("x4" "â˜†â´") ("xn" "â˜†â¿")
     ("b" "â–¡")
     ("S" "ğ•Š") ("Z" "â„¤")
     ("0" "ğŸ˜") ("1" "ğŸ™") ("2" "ğŸš") ("3" "ğŸ›") ("4" "ğŸœ")
     ("mv" "ğ’—") ("mv2" "ğ’—Â²") ("mv3" "ğ’—Â³") ("mv4" "ğ’—â´") ("mvn" "ğ’—â¿")
     ("mfv" "ğ’‡ğ’—") ("mfv2" "ğ’‡ğ’—Â²") ("mfv3" "ğ’‡ğ’—Â³") ("mfv4" "ğ’‡ğ’—â´") ("mfvn" "ğ’‡ğ’—â¿")
     ("mbv" "ğ’ƒğ’—") ("mbv2" "ğ’ƒğ’—Â²") ("mbv3" "ğ’ƒğ’—Â³") ("mbv4" "ğ’ƒğ’—â´") ("mbvn" "ğ’ƒğ’—â¿")
     ("ml" "ğ€") ("ml2" "ğ€Â²") ("ml3" "ğ€Â³") ("ml4" "ğ€â´") ("mln" "ğ€â¿")
     ("mo" "âˆ™") ("mo2" "âˆ™Â²") ("mo3" "âˆ™Â³") ("mo4" "âˆ™â´") ("mon" "âˆ™â¿")
     ("mp" "ğ’‘") ("mp2" "ğ’‘Â²") ("mp3" "ğ’‘Â³") ("mp4" "ğ’‘â´") ("mpn" "ğ’‘â¿")
     ("mpi" "ğ…")
     ("mpi0" "ğ…â‚€") ("mpi02" "ğ…â‚€Â²") ("mpi03" "ğ…â‚€Â³") ("mpi04" "ğ…â‚€â´") ("mpi0n" "ğ…â‚€â¿")
     ("mpi1" "ğ…â‚") ("mpi12" "ğ…â‚Â²") ("mpi13" "ğ…â‚Â³") ("mpi14" "ğ…â‚â´") ("mpi1n" "ğ…â‚â¿")
     ("mi" "ğœ¾")
     ("mi0" "ğœ¾â‚€") ("mi02" "ğœ¾â‚€Â²") ("mi03" "ğœ¾â‚€Â³") ("mi04" "ğœ¾â‚€â´") ("mi0n" "ğœ¾â‚€â¿")
     ("mi1" "ğœ¾â‚") ("mi12" "ğœ¾â‚Â²") ("mi13" "ğœ¾â‚Â³") ("mi14" "ğœ¾â‚â´") ("mi1n" "ğœ¾â‚â¿")
     ("mc" "ğ’„") ("mc2" "ğ’„Â²") ("mc3" "ğ’„Â³") ("mc4" "ğ’„â´") ("mcn" "ğ’„â¿")
     ("mu" "â¬†") ("mu2" "â¬†Â²") ("mu3" "â¬†Â³") ("mu4" "â¬†â´") ("mun" "â¬†â¿")
     ("md" "â¬‡") ("md2" "â¬‡Â²") ("md3" "â¬‡Â³") ("md4" "â¬‡â´") ("mdn" "â¬‡â¿")
     ("mt" "ğ’•") ("mt2" "ğ’•Â²") ("mt3" "ğ’•Â³") ("mt4" "ğ’•â´") ("mtn" "ğ’•â¿")
     ("mx" "â˜…") ("mx2" "â˜…Â²") ("mx3" "â˜…Â³") ("mx4" "â˜…â´") ("mxn" "â˜…â¿")
     ("mb" "â– ")
     ("mS" "ğ’") ("mZ" "ğ™")
     ("m0" "ğŸ") ("m1" "ğŸ") ("m2" "ğŸ") ("m3" "ğŸ‘") ("m4" "ğŸ’")
     ("ss" "ğ¬") ("ts" "ğ­") ("us" "ğ®") ("xs" "ğ±") ("ys" "ğ²") ("zs" "ğ³")
     ("C" "ğ’") ("D" "ğ’Ÿ") ("E" "â„°")
     ("N" "â„•"))))

-}


module A201602.AltArtemov-WIP3 where

open import Data.Fin using (Fin ; zero ; suc)
open import Data.Nat using (â„• ; zero ; suc ; _+_)
open import Data.Product using (_Ã—_) renaming (_,_ to âŸ¨_,_âŸ©)
open import Data.Vec using (Vec ; [] ; _âˆ·_ ; replicate)
open import Relation.Binary.PropositionalEquality using (_â‰¡_ ; refl ; cong ; subst)

infixl 9 !_ ğ‘£_ ğ’—_
infixl 9 â˜†_ â˜†Â²_ -- â˜†Â³_ â˜†â´_ â˜†â¿_
infixl 9 â˜…_ â˜…Â²_ -- â˜…Â³_ â˜…â´_ â˜…â¿_
infixl 8 ğœ‹â‚€_ ğœ‹â‚€Â²_ -- ğœ‹â‚€Â³_ ğœ‹â‚€â´_ ğœ‹â‚€â¿_
infixl 8 ğ…â‚€_ ğ…â‚€Â²_ -- ğ…â‚€Â³_ ğ…â‚€â´_ ğ…â‚€â¿_
infixl 8 ğœ‹â‚_ ğœ‹â‚Â²_ -- ğœ‹â‚Â³_ ğœ‹â‚â´_ ğœ‹â‚â¿_
infixl 8 ğ…â‚_ ğ…â‚Â²_ -- ğ…â‚Â³_ ğ…â‚â´_ ğ…â‚â¿_
infixl 8 ğœ„â‚€_ ğœ„â‚€Â²_ -- ğœ„â‚€Â³_ ğœ„â‚€â´_ ğœ„â‚€â¿_
infixl 8 ğœ¾â‚€_ ğœ¾â‚€Â²_ -- ğœ¾â‚€Â³_ ğœ¾â‚€â´_ ğœ¾â‚€â¿_
infixl 8 ğœ„â‚_ ğœ„â‚Â²_ -- ğœ„â‚Â³_ ğœ„â‚â´_ ğœ„â‚â¿_
infixl 7 ğœ¾â‚_ ğœ¾â‚Â²_ -- ğœ¾â‚Â³_ ğœ¾â‚â´_ ğœ¾â‚â¿_
infixl 7 _âˆ˜_ _âˆ˜Â²_ -- _âˆ˜Â³_ _âˆ˜â´_ _âˆ˜â¿_
infixl 7 _âˆ™_ _âˆ™Â²_ -- _âˆ™Â³_ _âˆ™â´_ _âˆ™â¿_
infixr 6 â‡‘_ â‡‘Â²_ -- â‡‘Â³_ â‡‘â´_ â‡‘â¿_
infixr 6 â¬†_ â¬†Â²_ -- â¬†Â³_ â¬†â´_ â¬†â¿_
infixr 6 â‡“_ â‡“Â²_ -- â‡“Â³_ â‡“â´_ â‡“â¿_
infixr 6 â¬‡_ â¬‡Â²_ -- â¬‡Â³_ â¬‡â´_ â¬‡â¿_
infixr 5 ğœ†_ ğœ†Â²_ -- ğœ†Â³_ ğœ†â´_ ğœ†â¿_
infixr 5 ğ€_ ğ€Â²_ -- ğ€Â³_ ğ€â´_ ğ€â¿_
infixr 5 _âˆ¶_ -- _âˆµ_
infixr 4 Â¬_
infixl 4 _âˆ§_
infixl 3 _âˆ¨_ _,_ _â€_
infixr 2 _âŠƒ_
infixr 1 _â«—_
infixr 0 _âŠ¢_âˆ¶â¿_ _âŠ¢_ _âŠ¢_âˆµ_ -- âŠ©_


-- --------------------------------------------------------------------------
--
-- Well-scoped syntax


-- Untyped terms
data Tm (m : â„•) : Set where
  -- Variable reference
  ğ‘£_ : Fin m â†’ Tm m

  -- Abstraction (âŠƒI) at level n
  ğœ†[_]_ : â„• â†’ Tm (suc m) â†’ Tm m

  -- Application (âŠƒE) at level n
  _âˆ˜[_]_ : Tm m â†’ â„• â†’ Tm m â†’ Tm m

  -- Pair (âˆ§I) at level n
  ğ‘[_]âŸ¨_,_âŸ© : â„• â†’ Tm m â†’ Tm m â†’ Tm m

  -- 0th projection (âˆ§Eâ‚€) at level n
  ğœ‹â‚€[_]_ : â„• â†’ Tm m â†’ Tm m

  -- 1st projection (âˆ§Eâ‚) at level n
  ğœ‹â‚[_]_ : â„• â†’ Tm m â†’ Tm m

  -- 0th injection (âˆ¨Iâ‚€) at level n
  ğœ„â‚€[_]_ : â„• â†’ Tm m â†’ Tm m

  -- 1st injection (âˆ¨Iâ‚) at level n
  ğœ„â‚[_]_ : â„• â†’ Tm m â†’ Tm m

  -- Case split (âˆ¨E) at level n
  ğ‘[_][_â–·_âˆ£_] : â„• â†’ Tm m â†’ Tm (suc m) â†’ Tm (suc m) â†’ Tm m

  -- ArtÃ«movâ€™s â€œproof checkerâ€
  !_ : Tm m â†’ Tm m

  -- Reification at level n
  â‡‘[_]_ : â„• â†’ Tm m â†’ Tm m

  -- Reflection at level n
  â‡“[_]_ : â„• â†’ Tm m â†’ Tm m

  -- Explosion (âŠ¥E) at level n
  â˜†[_]_ : â„• â†’ Tm m â†’ Tm m


-- Types
data Ty : Set where
  -- Implication
  _âŠƒ_ : Ty â†’ Ty â†’ Ty

  -- Conjunction
  _âˆ§_ : Ty â†’ Ty â†’ Ty

  -- Disjunction
  _âˆ¨_ : Ty â†’ Ty â†’ Ty

  -- Explicit provability
  _âˆ¶_ : Tm 0 â†’ Ty â†’ Ty

  -- Falsehood
  âŠ¥ : Ty


-- --------------------------------------------------------------------------
--
-- Example types


-- Truth
âŠ¤ : Ty
âŠ¤ = âŠ¥ âŠƒ âŠ¥

-- Negation
Â¬_ : Ty â†’ Ty
Â¬ A = A âŠƒ âŠ¥

-- Equivalence
_â«—_ : Ty â†’ Ty â†’ Ty
A â«— B = (A âŠƒ B) âˆ§ (B âŠƒ A)


-- --------------------------------------------------------------------------
--
-- Notation for untyped terms at level 1


ğœ†_ : âˆ€{m} â†’ Tm (suc m) â†’ Tm m
ğœ† t = ğœ†[ 1 ] t

_âˆ˜_ : âˆ€{m} â†’ Tm m â†’ Tm m â†’ Tm m
t âˆ˜ s = t âˆ˜[ 1 ] s

ğ‘âŸ¨_,_âŸ© : âˆ€{m} â†’ Tm m â†’ Tm m â†’ Tm m
ğ‘âŸ¨ t , s âŸ© = ğ‘[ 1 ]âŸ¨ t , s âŸ©

ğœ‹â‚€_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ‹â‚€ t = ğœ‹â‚€[ 1 ] t

ğœ‹â‚_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ‹â‚ t = ğœ‹â‚[ 1 ] t

ğœ„â‚€_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ„â‚€ t = ğœ„â‚€[ 1 ] t

ğœ„â‚_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ„â‚ t = ğœ„â‚[ 1 ] t

ğ‘[_â–·_âˆ£_] : âˆ€{m} â†’ Tm m â†’ Tm (suc m) â†’ Tm (suc m) â†’ Tm m
ğ‘[ t â–· s âˆ£ r ] = ğ‘[ 1 ][ t â–· s âˆ£ r ]

â‡‘_ : âˆ€{m} â†’ Tm m â†’ Tm m
â‡‘ t = â‡‘[ 1 ] t

â‡“_ : âˆ€{m} â†’ Tm m â†’ Tm m
â‡“ t = â‡“[ 1 ] t

â˜†_ : âˆ€{m} â†’ Tm m â†’ Tm m
â˜† t = â˜†[ 1 ] t


-- --------------------------------------------------------------------------
--
-- Notation for untyped terms at level 2


ğœ†Â²_ : âˆ€{m} â†’ Tm (suc m) â†’ Tm m
ğœ†Â² tâ‚‚ = ğœ†[ 2 ] tâ‚‚

_âˆ˜Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m â†’ Tm m
tâ‚‚ âˆ˜Â² sâ‚‚ = tâ‚‚ âˆ˜[ 2 ] sâ‚‚

ğ‘Â²âŸ¨_,_âŸ© : âˆ€{m} â†’ Tm m â†’ Tm m â†’ Tm m
ğ‘Â²âŸ¨ tâ‚‚ , sâ‚‚ âŸ© = ğ‘[ 2 ]âŸ¨ tâ‚‚ , sâ‚‚ âŸ©

ğœ‹â‚€Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ‹â‚€Â² tâ‚‚ = ğœ‹â‚€[ 2 ] tâ‚‚

ğœ‹â‚Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ‹â‚Â² tâ‚‚ = ğœ‹â‚[ 2 ] tâ‚‚

ğœ„â‚€Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ„â‚€Â² tâ‚‚ = ğœ„â‚€[ 2 ] tâ‚‚

ğœ„â‚Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
ğœ„â‚Â² tâ‚‚ = ğœ„â‚[ 2 ] tâ‚‚

ğ‘Â²[_â–·_âˆ£_] : âˆ€{m} â†’ Tm m â†’ Tm (suc m) â†’ Tm (suc m) â†’ Tm m
ğ‘Â²[ tâ‚‚ â–· sâ‚‚ âˆ£ râ‚‚ ] = ğ‘[ 2 ][ tâ‚‚ â–· sâ‚‚ âˆ£ râ‚‚ ]

â‡‘Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
â‡‘Â² tâ‚‚ = â‡‘[ 2 ] tâ‚‚

â‡“Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
â‡“Â² tâ‚‚ = â‡“[ 2 ] tâ‚‚

â˜†Â²_ : âˆ€{m} â†’ Tm m â†’ Tm m
â˜†Â² t = â˜†[ 2 ] t


-- --------------------------------------------------------------------------
--
-- Notation for untyped terms at level 3

{-
ğœ†Â³_ : Tm â†’ Tm
ğœ†Â³ tâ‚ƒ = ğœ†[ 3 ] tâ‚ƒ

_âˆ˜Â³_ : Tm â†’ Tm â†’ Tm
tâ‚ƒ âˆ˜Â³ sâ‚ƒ = tâ‚ƒ âˆ˜[ 3 ] sâ‚ƒ

ğ‘Â³âŸ¨_,_âŸ© : Tm â†’ Tm â†’ Tm
ğ‘Â³âŸ¨ tâ‚ƒ , sâ‚ƒ âŸ© = ğ‘[ 3 ]âŸ¨ tâ‚ƒ , sâ‚ƒ âŸ©

ğœ‹â‚€Â³_ : Tm â†’ Tm
ğœ‹â‚€Â³ tâ‚ƒ = ğœ‹â‚€[ 3 ] tâ‚ƒ

ğœ‹â‚Â³_ : Tm â†’ Tm
ğœ‹â‚Â³ tâ‚ƒ = ğœ‹â‚[ 3 ] tâ‚ƒ

ğœ„â‚€Â³_ : Tm â†’ Tm
ğœ„â‚€Â³ tâ‚ƒ = ğœ„â‚€[ 3 ] tâ‚ƒ

ğœ„â‚Â³_ : Tm â†’ Tm
ğœ„â‚Â³ tâ‚ƒ = ğœ„â‚[ 3 ] tâ‚ƒ

ğ‘Â³[_â–·_âˆ£_] : Tm â†’ Tm â†’ Tm â†’ Tm
ğ‘Â³[ tâ‚ƒ â–· sâ‚ƒ âˆ£ râ‚ƒ ] = ğ‘[ 3 ][ tâ‚ƒ â–· sâ‚ƒ âˆ£ râ‚ƒ ]

â‡‘Â³_ : Tm â†’ Tm
â‡‘Â³ tâ‚ƒ = â‡‘[ 3 ] tâ‚ƒ

â‡“Â³_ : Tm â†’ Tm
â‡“Â³ tâ‚ƒ = â‡“[ 3 ] tâ‚ƒ

â˜†Â³_ : Tm â†’ Tm
â˜†Â³ t = â˜†[ 3 ] t


-- --------------------------------------------------------------------------
--
-- Notation for untyped terms at level 4


ğœ†â´_ : Tm â†’ Tm
ğœ†â´ tâ‚„ = ğœ†[ 4 ] tâ‚„

_âˆ˜â´_ : Tm â†’ Tm â†’ Tm
tâ‚„ âˆ˜â´ sâ‚„ = tâ‚„ âˆ˜[ 4 ] sâ‚„

ğ‘â´âŸ¨_,_âŸ© : Tm â†’ Tm â†’ Tm
ğ‘â´âŸ¨ tâ‚„ , sâ‚„ âŸ© = ğ‘[ 4 ]âŸ¨ tâ‚„ , sâ‚„ âŸ©

ğœ‹â‚€â´_ : Tm â†’ Tm
ğœ‹â‚€â´ tâ‚„ = ğœ‹â‚€[ 4 ] tâ‚„

ğœ‹â‚â´_ : Tm â†’ Tm
ğœ‹â‚â´ tâ‚„ = ğœ‹â‚[ 4 ] tâ‚„

ğœ„â‚€â´_ : Tm â†’ Tm
ğœ„â‚€â´ tâ‚„ = ğœ„â‚€[ 4 ] tâ‚„

ğœ„â‚â´_ : Tm â†’ Tm
ğœ„â‚â´ tâ‚„ = ğœ„â‚[ 4 ] tâ‚„

ğ‘â´[_â–·_âˆ£_] : Tm â†’ Tm â†’ Tm â†’ Tm
ğ‘â´[ tâ‚„ â–· sâ‚„ âˆ£ râ‚„ ] = ğ‘[ 4 ][ tâ‚„ â–· sâ‚„ âˆ£ râ‚„ ]

â‡‘â´_ : Tm â†’ Tm
â‡‘â´ tâ‚„ = â‡‘[ 4 ] tâ‚„

â‡“â´_ : Tm â†’ Tm
â‡“â´ tâ‚„ = â‡“[ 4 ] tâ‚„

â˜†â´_ : Tm â†’ Tm
â˜†â´ t = â˜†[ 4 ] t
-}

-- --------------------------------------------------------------------------
--
-- Vector notation (p. 27 [1])


map# : âˆ€{n} {X Y : Set}
    â†’ (â„• â†’ X â†’ Y) â†’ Vec X n â†’ Vec Y n
map# {zero}  f []      = []
map# {suc n} f (x âˆ· ğ±) = f (suc n) x âˆ· map# f ğ±

map2# : âˆ€{n} {X Y Z : Set}
    â†’ (â„• â†’ X â†’ Y â†’ Z) â†’ Vec X n â†’ Vec Y n â†’ Vec Z n
map2# {zero}  f []      []      = []
map2# {suc n} f (x âˆ· ğ±) (y âˆ· ğ²) = f (suc n) x y âˆ· map2# f ğ± ğ²

map3# : âˆ€{n} {X Y Z A : Set}
    â†’ (â„• â†’ X â†’ Y â†’ Z â†’ A) â†’ Vec X n â†’ Vec Y n â†’ Vec Z n â†’ Vec A n
map3# {zero}  f []      []      []      = []
map3# {suc n} f (x âˆ· ğ±) (y âˆ· ğ²) (z âˆ· ğ³) = f (suc n) x y z âˆ· map3# f ğ± ğ² ğ³


-- Term vectors
Tms : â„• â†’ â„• â†’ Set
Tms m = Vec (Tm m)


-- ğ‘£ x âˆ¶ ğ‘£ x âˆ¶ â€¦ âˆ¶ ğ‘£ x
ğ‘£[_]_ : âˆ€{m} â†’ (n : â„•) â†’ Fin m â†’ Tms m n
ğ‘£[ zero ]  i = []
ğ‘£[ suc n ] i = ğ‘£ i âˆ· ğ‘£[ n ] i

-- ğœ†â¿ tâ‚™ âˆ¶ ğœ†â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ ğœ† t
ğœ†â¿_ : âˆ€{m n} â†’ Tms (suc m) n â†’ Tms m n
ğœ†â¿_ = map# ğœ†[_]_

-- tâ‚™ âˆ˜â¿ sâ‚™ âˆ¶ tâ‚™â‚‹â‚ âˆ˜â¿â»Â¹ âˆ¶ sâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ t âˆ˜ s
_âˆ˜â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n â†’ Tms m n
_âˆ˜â¿_ = map2# (Î» n t s â†’ t âˆ˜[ n ] s)

-- ğ‘â¿âŸ¨ tâ‚™ , sâ‚™ âŸ© âˆ¶ ğ‘â¿â»Â¹âŸ¨ tâ‚™â‚‹â‚ , sâ‚™â‚‹â‚ âŸ© âˆ¶ â€¦ âˆ¶ pâŸ¨ t , s âŸ©
ğ‘â¿âŸ¨_,_âŸ© : âˆ€{m n} â†’ Tms m n â†’ Tms m n â†’ Tms m n
ğ‘â¿âŸ¨_,_âŸ© = map2# ğ‘[_]âŸ¨_,_âŸ©

-- ğœ‹â‚€â¿ tâ‚™ âˆ¶ ğœ‹â‚€â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ ğœ‹â‚€ t
ğœ‹â‚€â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
ğœ‹â‚€â¿_ = map# ğœ‹â‚€[_]_

-- ğœ‹â‚â¿ tâ‚™ âˆ¶ ğœ‹â‚â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ ğœ‹â‚ t
ğœ‹â‚â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
ğœ‹â‚â¿_ = map# ğœ‹â‚[_]_

-- ğœ„â‚€â¿ tâ‚™ âˆ¶ ğœ„â‚€â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ ğœ„â‚€ t
ğœ„â‚€â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
ğœ„â‚€â¿_ = map# ğœ„â‚€[_]_

-- ğœ„â‚â¿ tâ‚™ âˆ¶ ğœ„â‚â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ ğœ„â‚ t
ğœ„â‚â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
ğœ„â‚â¿_ = map# ğœ„â‚[_]_

-- ğ‘â¿[ tâ‚™ â–· sâ‚™ âˆ£ râ‚™ ] âˆ¶ ğ‘â¿â»Â¹[ tâ‚™â‚‹â‚ â–· sâ‚™â‚‹â‚ âˆ£ râ‚™â‚‹â‚ ] âˆ¶ â€¦ âˆ¶ ğ‘[ t â–· s âˆ£ r ]
ğ‘â¿[_â–·_âˆ£_] : âˆ€{m n} â†’ Tms m n â†’ Tms (suc m) n â†’ Tms (suc m) n â†’ Tms m n
ğ‘â¿[_â–·_âˆ£_] = map3# ğ‘[_][_â–·_âˆ£_]

-- â‡‘â¿ tâ‚™ âˆ¶ â‡‘â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ â‡‘ t
â‡‘â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
â‡‘â¿_ = map# â‡‘[_]_

-- â‡“â¿ tâ‚™ âˆ¶ â‡‘â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ â‡‘ t
â‡“â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
â‡“â¿_ = map# â‡“[_]_

-- â˜†â¿ tâ‚™ âˆ¶ â˜†â¿â»Â¹ tâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ â˜† t
â˜†â¿_ : âˆ€{m n} â†’ Tms m n â†’ Tms m n
â˜†â¿_ = map# â˜†[_]_


-- --------------------------------------------------------------------------
--
-- Well-typed syntax


-- Hypotheses
Hyp : Set
Hyp = â„• Ã— Ty


-- Contexts
data Cx : Set where
  âˆ…   : Cx
  _,_ : Cx â†’ Hyp â†’ Cx


nat : Cx â†’ â„•
nat âˆ…       = zero
nat (Î“ , x) = suc (nat Î“)


_â€_ : Cx â†’ Cx â†’ Cx
Î“ â€ âˆ…       = Î“
Î“ â€ (Î” , A) = (Î“ â€ Î”) , A


-- Context membership
data _âˆˆ_ : Hyp â†’ Cx â†’ Set where
  ğ™ : âˆ€{A Î“}
      â†’ A âˆˆ (Î“ , A)

  ğ’_ : âˆ€{A B Î“}
      â†’ A âˆˆ Î“
      â†’ A âˆˆ (Î“ , B)


fin : âˆ€ {Î“ A} â†’ A âˆˆ Î“ â†’ Fin (nat Î“)
fin ğ™     = zero
fin (ğ’ i) = suc (fin i)


lift : âˆ€{m} â†’ Tm 0 â†’ Tm m
lift t = {!!}


-- Typed terms
data _âŠ¢_âˆ¶â¿_ (Î“ : Cx) {n : â„•} : Tms (nat Î“) n â†’ Ty â†’ Set where
  -- Variable reference
  ğ’—_ : âˆ€{A}
      â†’ (i : âŸ¨ n , A âŸ© âˆˆ Î“)
      â†’ Î“ âŠ¢ ğ‘£[ n ] (fin i) âˆ¶â¿ A

  -- Abstraction (âŠƒI) at level n
  ğ€â¿_ : âˆ€{ğ­ : Tms (suc (nat Î“)) n} {A B}
      â†’ Î“ , âŸ¨ n , A âŸ© âŠ¢ ğ­ âˆ¶â¿ B
      â†’ Î“ âŠ¢ ğœ†â¿ ğ­ âˆ¶â¿ A âŠƒ B

  -- Application (âŠƒE) at level n
  _âˆ™â¿_ : âˆ€{ğ­ ğ¬ : Tms (nat Î“) n} {A B}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A âŠƒ B    â†’ Î“ âŠ¢ ğ¬ âˆ¶â¿ A
      â†’ Î“ âŠ¢ ğ­ âˆ˜â¿ ğ¬ âˆ¶â¿ B

  -- Pair (âˆ§I) at level n
  ğ’‘â¿âŸ¨_,_âŸ© : âˆ€{ğ­ ğ¬ : Tms (nat Î“) n} {A B}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A          â†’ Î“ âŠ¢ ğ¬ âˆ¶â¿ B
      â†’ Î“ âŠ¢ ğ‘â¿âŸ¨ ğ­ , ğ¬ âŸ© âˆ¶â¿ A âˆ§ B

  -- 0th projection (âˆ§Eâ‚€) at level n
  ğ…â‚€â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {A B}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A âˆ§ B
      â†’ Î“ âŠ¢ ğœ‹â‚€â¿ ğ­ âˆ¶â¿ A

  -- 1st projection (âˆ§Eâ‚) at level n
  ğ…â‚â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {A B}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A âˆ§ B
      â†’ Î“ âŠ¢ ğœ‹â‚â¿ ğ­ âˆ¶â¿ B

  -- 0th injection (âˆ¨Iâ‚€) at level n
  ğœ¾â‚€â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {A B}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A
      â†’ Î“ âŠ¢ ğœ„â‚€â¿ ğ­ âˆ¶â¿ A âˆ¨ B

  -- 1st injection (âˆ¨Iâ‚) at level n
  ğœ¾â‚â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {A B}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ B
      â†’ Î“ âŠ¢ ğœ„â‚â¿ ğ­ âˆ¶â¿ A âˆ¨ B

  -- Case split (âˆ¨E) at level n
  ğ’„â¿[_â–·_âˆ£_] : âˆ€{ğ­ : Tms (nat Î“) n} {ğ¬ ğ® : Tms (suc (nat Î“)) n} {A B C}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A âˆ¨ B    â†’ Î“ , âŸ¨ n , A âŸ© âŠ¢ ğ¬ âˆ¶â¿ C
                           â†’ Î“ , âŸ¨ n , B âŸ© âŠ¢ ğ® âˆ¶â¿ C
      â†’ Î“ âŠ¢ ğ‘â¿[ ğ­ â–· ğ¬ âˆ£ ğ® ] âˆ¶â¿ C

  -- Reification at level n
  â¬†â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {u A}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ u âˆ¶ A
      â†’ Î“ âŠ¢ â‡‘â¿ ğ­ âˆ¶â¿ ! u âˆ¶ u âˆ¶ A

  -- Reflection at level n
  â¬‡â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {u A}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ u âˆ¶ A
      â†’ Î“ âŠ¢ â‡“â¿ ğ­ âˆ¶â¿ A

  -- Explosion (âŠ¥E)
  â˜…â¿_ : âˆ€{ğ­ : Tms (nat Î“) n} {A}
      â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ âŠ¥
      â†’ Î“ âŠ¢ â˜†â¿ ğ­ âˆ¶â¿ A


-- Closed terms
âŠ©_âˆ¶â¿_  : âˆ€{n} â†’ Tms 0 n â†’ Ty â†’ Set
âŠ© ğ­ âˆ¶â¿ A = âˆ… âŠ¢ ğ­ âˆ¶â¿ A


-- --------------------------------------------------------------------------
--
-- Notation for context membership


ğŸ : âˆ€{A Î“}
    â†’ A âˆˆ (Î“ , A)
ğŸ = ğ™

ğŸ : âˆ€{A B Î“}
    â†’ A âˆˆ ((Î“ , A) , B)
ğŸ = ğ’ ğŸ

ğŸ : âˆ€{A B C Î“}
    â†’ A âˆˆ (((Î“ , A) , B) , C)
ğŸ = ğ’ ğŸ

ğŸ‘ : âˆ€{A B C D Î“}
    â†’ A âˆˆ ((((Î“ , A) , B) , C) , D)
ğŸ‘ = ğ’ ğŸ

ğŸ’ : âˆ€{A B C D E Î“}
    â†’ A âˆˆ (((((Î“ , A) , B) , C) , D) , E)
ğŸ’ = ğ’ ğŸ‘


-- --------------------------------------------------------------------------
--
-- Notation for typed terms at level 1


_âŠ¢_ : Cx â†’ Ty â†’ Set
Î“ âŠ¢ A = Î“ âŠ¢ [] âˆ¶â¿ A


ğ€_ : âˆ€{Î“ A B}
    â†’ Î“ , âŸ¨ 0 , A âŸ© âŠ¢ B
    â†’ Î“ âŠ¢ A âŠƒ B
ğ€_ = ğ€â¿_

_âˆ™_ : âˆ€{Î“ A B}
    â†’ Î“ âŠ¢ A âŠƒ B    â†’ Î“ âŠ¢ A
    â†’ Î“ âŠ¢ B
_âˆ™_ = _âˆ™â¿_

ğ’‘âŸ¨_,_âŸ© : âˆ€{Î“ A B}
    â†’ Î“ âŠ¢ A        â†’ Î“ âŠ¢ B
    â†’ Î“ âŠ¢ A âˆ§ B
ğ’‘âŸ¨_,_âŸ© = ğ’‘â¿âŸ¨_,_âŸ©

ğ…â‚€_ : âˆ€{Î“ A B}
    â†’ Î“ âŠ¢ A âˆ§ B
    â†’ Î“ âŠ¢ A
ğ…â‚€_ = ğ…â‚€â¿_

ğ…â‚_ : âˆ€{Î“ A B}
    â†’ Î“ âŠ¢ A âˆ§ B
    â†’ Î“ âŠ¢ B
ğ…â‚_ = ğ…â‚â¿_

ğœ¾â‚€_ : âˆ€{Î“ A B}
    â†’ Î“ âŠ¢ A
    â†’ Î“ âŠ¢ A âˆ¨ B
ğœ¾â‚€_ = ğœ¾â‚€â¿_

ğœ¾â‚_ : âˆ€{Î“ A B}
    â†’ Î“ âŠ¢ B
    â†’ Î“ âŠ¢ A âˆ¨ B
ğœ¾â‚_ = ğœ¾â‚â¿_

ğ’„[_â–·_âˆ£_] : âˆ€{Î“ A B C}
    â†’ Î“ âŠ¢ A âˆ¨ B    â†’ Î“ , âŸ¨ 0 , A âŸ© âŠ¢ C
                     â†’ Î“ , âŸ¨ 0 , B âŸ© âŠ¢ C
    â†’ Î“ âŠ¢ C
ğ’„[_â–·_âˆ£_] = ğ’„â¿[_â–·_âˆ£_]

â¬†_ : âˆ€{Î“ u A}
    â†’ Î“ âŠ¢ u âˆ¶ A
    â†’ Î“ âŠ¢ ! u âˆ¶ u âˆ¶ A
â¬†_ = â¬†â¿_

â¬‡_ : âˆ€{Î“ u A}
    â†’ Î“ âŠ¢ u âˆ¶ A
    â†’ Î“ âŠ¢ A
â¬‡_ = â¬‡â¿_

â˜…_ : âˆ€{Î“ A}
    â†’ Î“ âŠ¢ âŠ¥
    â†’ Î“ âŠ¢ A
â˜…_ = â˜…â¿_


-- --------------------------------------------------------------------------
--
-- Notation for typed terms at level 2


_âŠ¢_âˆµ_ : (Î“ : Cx) â†’ Tm (nat Î“) â†’ Ty â†’ Set
Î“ âŠ¢ t âˆµ A = Î“ âŠ¢ t âˆ· [] âˆ¶â¿ A


ğ€Â²_ : âˆ€{Î“ t A B}
    â†’ Î“ , âŸ¨ 1 , A âŸ© âŠ¢ t âˆµ B
    â†’ Î“ âŠ¢ ğœ† t âˆµ A âŠƒ B
ğ€Â²_ = ğ€â¿_

_âˆ™Â²_ : âˆ€{Î“ t s A B}
    â†’ Î“ âŠ¢ t âˆµ A âŠƒ B    â†’ Î“ âŠ¢ s âˆµ A
    â†’ Î“ âŠ¢ t âˆ˜ s âˆµ B
_âˆ™Â²_ = _âˆ™â¿_

ğ’‘Â²âŸ¨_,_âŸ© : âˆ€{Î“ t s A B}
    â†’ Î“ âŠ¢ t âˆµ A          â†’ Î“ âŠ¢ s âˆµ B
    â†’ Î“ âŠ¢ ğ‘âŸ¨ t , s âŸ© âˆµ A âˆ§ B
ğ’‘Â²âŸ¨_,_âŸ© = ğ’‘â¿âŸ¨_,_âŸ©

ğ…â‚€Â²_ : âˆ€{Î“ t A B}
    â†’ Î“ âŠ¢ t âˆµ A âˆ§ B
    â†’ Î“ âŠ¢ ğœ‹â‚€ t âˆµ A
ğ…â‚€Â²_ = ğ…â‚€â¿_

ğ…â‚Â²_ : âˆ€{Î“ t A B}
    â†’ Î“ âŠ¢ t âˆµ A âˆ§ B
    â†’ Î“ âŠ¢ ğœ‹â‚ t âˆµ B
ğ…â‚Â²_ = ğ…â‚â¿_

ğœ¾â‚€Â²_ : âˆ€{Î“ t A B}
    â†’ Î“ âŠ¢ t âˆµ A
    â†’ Î“ âŠ¢ ğœ„â‚€ t âˆµ A âˆ¨ B
ğœ¾â‚€Â²_ = ğœ¾â‚€â¿_

ğœ¾â‚Â²_ : âˆ€{Î“ t A B}
    â†’ Î“ âŠ¢ t âˆµ B
    â†’ Î“ âŠ¢ ğœ„â‚ t âˆµ A âˆ¨ B
ğœ¾â‚Â²_ = ğœ¾â‚â¿_

ğ’„Â²[_â–·_âˆ£_] : âˆ€{Î“ t s u A B C}
    â†’ Î“ âŠ¢ t âˆµ A âˆ¨ B    â†’ Î“ , âŸ¨ 1 , A âŸ© âŠ¢ s âˆµ C
                         â†’ Î“ , âŸ¨ 1 , B âŸ© âŠ¢ u âˆµ C
    â†’ Î“ âŠ¢ ğ‘[ t â–· s âˆ£ u ] âˆµ C
ğ’„Â²[_â–·_âˆ£_] = ğ’„â¿[_â–·_âˆ£_]

â¬†Â²_ : âˆ€{Î“ t u A}
    â†’ Î“ âŠ¢ t âˆµ u âˆ¶ A
    â†’ Î“ âŠ¢ â‡‘ t âˆµ ! u âˆ¶ u âˆ¶ A
â¬†Â²_ = â¬†â¿_

â¬‡Â²_ : âˆ€{Î“ t u A}
    â†’ Î“ âŠ¢ t âˆµ u âˆ¶ A
    â†’ Î“ âŠ¢ â‡“ t âˆµ A
â¬‡Â²_ = â¬‡â¿_

â˜…Â²_ : âˆ€{Î“ t A}
    â†’ Î“ âŠ¢ t âˆµ âŠ¥
    â†’ Î“ âŠ¢ â˜† t âˆµ A
â˜…Â²_ = â˜…â¿_


-- --------------------------------------------------------------------------
--
-- Notation for typed terms at level 3


{-ğ€Â³_ : âˆ€{tâ‚‚ t A B Î“}
    â†’ Î“ , âŸ¨ 2 , A âŸ© âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ B
    â†’ Î“ âŠ¢ ğœ†Â² tâ‚‚ âˆ¶ ğœ† t âˆ¶ (A âŠƒ B)
ğ€Â³_ {tâ‚‚} {t} =
    ğ€â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

_âˆ™Â³_ : âˆ€{tâ‚‚ t sâ‚‚ s A B Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ (A âŠƒ B)    â†’ Î“ âŠ¢ sâ‚‚ âˆ¶ s âˆ¶ A
    â†’ Î“ âŠ¢ tâ‚‚ âˆ˜Â² sâ‚‚ âˆ¶ t âˆ˜ s âˆ¶ B
_âˆ™Â³_ {tâ‚‚} {t} {sâ‚‚} {s} =
    _âˆ™â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []} {ğ¬ = sâ‚‚ âˆ· s âˆ· []}

ğ’‘Â³âŸ¨_,_âŸ© : âˆ€{tâ‚‚ t sâ‚‚ s A B Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ A          â†’ Î“ âŠ¢ sâ‚‚ âˆ¶ s âˆ¶ B
    â†’ Î“ âŠ¢ ğ‘Â²âŸ¨ tâ‚‚ , sâ‚‚ âŸ© âˆ¶ ğ‘âŸ¨ t , s âŸ© âˆ¶ (A âˆ§ B)
ğ’‘Â³âŸ¨_,_âŸ© {tâ‚‚} {t} {sâ‚‚} {s} =
    ğ’‘â¿âŸ¨_,_âŸ© {ğ­ = tâ‚‚ âˆ· t âˆ· []} {ğ¬ = sâ‚‚ âˆ· s âˆ· []}

ğ…â‚€Â³_ : âˆ€{tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ (A âˆ§ B)
    â†’ Î“ âŠ¢ ğœ‹â‚€Â² tâ‚‚ âˆ¶ ğœ‹â‚€ t âˆ¶ A
ğ…â‚€Â³_ {tâ‚‚} {t} =
    ğ…â‚€â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

ğ…â‚Â³_ : âˆ€{tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ (A âˆ§ B)
    â†’ Î“ âŠ¢ ğœ‹â‚Â² tâ‚‚ âˆ¶ ğœ‹â‚ t âˆ¶ B
ğ…â‚Â³_ {tâ‚‚} {t} =
    ğ…â‚â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

ğœ¾â‚€Â³_ : âˆ€{tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ A
    â†’ Î“ âŠ¢ ğœ„â‚€Â² tâ‚‚ âˆ¶ ğœ„â‚€ t âˆ¶ (A âˆ¨ B)
ğœ¾â‚€Â³_ {tâ‚‚} {t} =
    ğœ¾â‚€â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

ğœ¾â‚Â³_ : âˆ€{tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ B
    â†’ Î“ âŠ¢ ğœ„â‚Â² tâ‚‚ âˆ¶ ğœ„â‚ t âˆ¶ (A âˆ¨ B)
ğœ¾â‚Â³_ {tâ‚‚} {t} =
    ğœ¾â‚â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

ğ’„Â³[_â–·_âˆ£_] : âˆ€{tâ‚‚ t sâ‚‚ s uâ‚‚ u A B C Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ (A âˆ¨ B)    â†’ Î“ , âŸ¨ 2 , A âŸ© âŠ¢ sâ‚‚ âˆ¶ s âˆ¶ C
                                â†’ Î“ , âŸ¨ 2 , B âŸ© âŠ¢ uâ‚‚ âˆ¶ u âˆ¶ C
    â†’ Î“ âŠ¢ ğ‘Â²[ tâ‚‚ â–· sâ‚‚ âˆ£ uâ‚‚ ] âˆ¶ ğ‘[ t â–· s âˆ£ u ] âˆ¶ C
ğ’„Â³[_â–·_âˆ£_] {tâ‚‚} {t} {sâ‚‚} {s} {uâ‚‚} {u} =
    ğ’„â¿[_â–·_âˆ£_] {ğ­ = tâ‚‚ âˆ· t âˆ· []} {ğ¬ = sâ‚‚ âˆ· s âˆ· []}
                                {ğ® = uâ‚‚ âˆ· u âˆ· []}

â¬†Â³_ : âˆ€{tâ‚‚ t u A Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ u âˆ¶ A
    â†’ Î“ âŠ¢ â‡‘Â² tâ‚‚ âˆ¶ â‡‘ t âˆ¶ ! u âˆ¶ u âˆ¶ A
â¬†Â³_ {tâ‚‚} {t} =
    â¬†â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

â¬‡Â³_ : âˆ€{tâ‚‚ t u A Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ u âˆ¶ A
    â†’ Î“ âŠ¢ â‡“Â² tâ‚‚ âˆ¶ â‡“ t âˆ¶ A
â¬‡Â³_ {tâ‚‚} {t} =
    â¬‡â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}

â˜…Â³_ : âˆ€{tâ‚‚ t A Î“}
    â†’ Î“ âŠ¢ tâ‚‚ âˆ¶ t âˆ¶ âŠ¥
    â†’ Î“ âŠ¢ â˜†Â² tâ‚‚ âˆ¶ â˜† t âˆ¶ A
â˜…Â³_ {tâ‚‚} {t} =
    â˜…â¿_ {ğ­ = tâ‚‚ âˆ· t âˆ· []}-}


-- --------------------------------------------------------------------------
--
-- Notation for typed terms at level 4


{-ğ€â´_ : âˆ€{tâ‚ƒ tâ‚‚ t A B Î“}
    â†’ Î“ , âŸ¨ 3 , A âŸ© âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ B
    â†’ Î“ âŠ¢ ğœ†Â³ tâ‚ƒ âˆ¶ ğœ†Â² tâ‚‚ âˆ¶ ğœ† t âˆ¶ (A âŠƒ B)
ğ€â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    ğ€â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

_âˆ™â´_ : âˆ€{tâ‚ƒ tâ‚‚ t sâ‚ƒ sâ‚‚ s A B Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ (A âŠƒ B)    â†’ Î“ âŠ¢ sâ‚ƒ âˆ¶ sâ‚‚ âˆ¶ s âˆ¶ A
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ˜Â³ sâ‚ƒ âˆ¶ tâ‚‚ âˆ˜Â² sâ‚‚ âˆ¶ t âˆ˜ s âˆ¶ B
_âˆ™â´_ {tâ‚ƒ} {tâ‚‚} {t} {sâ‚ƒ} {sâ‚‚} {s} =
    _âˆ™â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []} {ğ¬ = sâ‚ƒ âˆ· sâ‚‚ âˆ· s âˆ· []}

ğ’‘â´âŸ¨_,_âŸ© : âˆ€{tâ‚ƒ tâ‚‚ t sâ‚ƒ sâ‚‚ s A B Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ A          â†’ Î“ âŠ¢ sâ‚ƒ âˆ¶ sâ‚‚ âˆ¶ s âˆ¶ B
    â†’ Î“ âŠ¢ ğ‘Â³âŸ¨ tâ‚ƒ , sâ‚ƒ âŸ© âˆ¶ ğ‘Â²âŸ¨ tâ‚‚ , sâ‚‚ âŸ© âˆ¶ ğ‘âŸ¨ t , s âŸ© âˆ¶ (A âˆ§ B)
ğ’‘â´âŸ¨_,_âŸ© {tâ‚ƒ} {tâ‚‚} {t} {sâ‚ƒ} {sâ‚‚} {s} =
    ğ’‘â¿âŸ¨_,_âŸ© {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []} {ğ¬ = sâ‚ƒ âˆ· sâ‚‚ âˆ· s âˆ· []}

ğ…â‚€â´_ : âˆ€{tâ‚ƒ tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ (A âˆ§ B)
    â†’ Î“ âŠ¢ ğœ‹â‚€Â³ tâ‚ƒ âˆ¶ ğœ‹â‚€Â² tâ‚‚ âˆ¶ ğœ‹â‚€ t âˆ¶ A
ğ…â‚€â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    ğ…â‚€â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

ğ…â‚â´_ : âˆ€{tâ‚ƒ tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ (A âˆ§ B)
    â†’ Î“ âŠ¢ ğœ‹â‚Â³ tâ‚ƒ âˆ¶ ğœ‹â‚Â² tâ‚‚ âˆ¶ ğœ‹â‚ t âˆ¶ B
ğ…â‚â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    ğ…â‚â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

ğœ¾â‚€â´_ : âˆ€{tâ‚ƒ tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ A
    â†’ Î“ âŠ¢ ğœ„â‚€Â³ tâ‚ƒ âˆ¶ ğœ„â‚€Â² tâ‚‚ âˆ¶ ğœ„â‚€ t âˆ¶ (A âˆ¨ B)
ğœ¾â‚€â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    ğœ¾â‚€â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

ğœ¾â‚â´_ : âˆ€{tâ‚ƒ tâ‚‚ t A B Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ B
    â†’ Î“ âŠ¢ ğœ„â‚Â³ tâ‚ƒ âˆ¶ ğœ„â‚Â² tâ‚‚ âˆ¶ ğœ„â‚ t âˆ¶ (A âˆ¨ B)
ğœ¾â‚â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    ğœ¾â‚â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

ğ’„â´[_â–·_âˆ£_] : âˆ€{tâ‚ƒ tâ‚‚ t sâ‚ƒ sâ‚‚ s uâ‚ƒ uâ‚‚ u A B C Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ (A âˆ¨ B)    â†’ Î“ , âŸ¨ 3 , A âŸ© âŠ¢ sâ‚ƒ âˆ¶ sâ‚‚ âˆ¶ s âˆ¶ C
                                     â†’ Î“ , âŸ¨ 3 , B âŸ© âŠ¢ uâ‚ƒ âˆ¶ uâ‚‚ âˆ¶ u âˆ¶ C
    â†’ Î“ âŠ¢ ğ‘Â³[ tâ‚ƒ â–· sâ‚ƒ âˆ£ uâ‚ƒ ] âˆ¶ ğ‘Â²[ tâ‚‚ â–· sâ‚‚ âˆ£ uâ‚‚ ] âˆ¶ ğ‘[ t â–· s âˆ£ u ] âˆ¶ C
ğ’„â´[_â–·_âˆ£_] {tâ‚ƒ} {tâ‚‚} {t} {sâ‚ƒ} {sâ‚‚} {s} {uâ‚ƒ} {uâ‚‚} {u} =
    ğ’„â¿[_â–·_âˆ£_] {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []} {ğ¬ = sâ‚ƒ âˆ· sâ‚‚ âˆ· s âˆ· []}
                                     {ğ® = uâ‚ƒ âˆ· uâ‚‚ âˆ· u âˆ· []}

â¬†â´_ : âˆ€{tâ‚ƒ tâ‚‚ t u A Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ u âˆ¶ A
    â†’ Î“ âŠ¢ â‡‘Â³ tâ‚ƒ âˆ¶ â‡‘Â² tâ‚‚ âˆ¶ â‡‘ t âˆ¶ ! u âˆ¶ u âˆ¶ A
â¬†â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    â¬†â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

â¬‡â´_ : âˆ€{tâ‚ƒ tâ‚‚ t u A Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ u âˆ¶ A
    â†’ Î“ âŠ¢ â‡“Â³ tâ‚ƒ âˆ¶ â‡“Â² tâ‚‚ âˆ¶ â‡“ t âˆ¶ A
â¬‡â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    â¬‡â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}

â˜…â´_ : âˆ€{tâ‚ƒ tâ‚‚ t A Î“}
    â†’ Î“ âŠ¢ tâ‚ƒ âˆ¶ tâ‚‚ âˆ¶ t âˆ¶ âŠ¥
    â†’ Î“ âŠ¢ â˜†Â³ tâ‚ƒ âˆ¶ â˜†Â² tâ‚‚ âˆ¶ â˜† t âˆ¶ A
â˜…â´_ {tâ‚ƒ} {tâ‚‚} {t} =
    â˜…â¿_ {ğ­ = tâ‚ƒ âˆ· tâ‚‚ âˆ· t âˆ· []}-}


-- --------------------------------------------------------------------------
--
-- Quotation


quot : âˆ€{n Î“} {ğ­ : Tms (nat Î“) n} {A}
    â†’ Î“ âŠ¢ ğ­ âˆ¶â¿ A
    â†’ Tm (nat Î“)
quot (ğ’— i)                 = ğ‘£ fin i
quot {n} (ğ€â¿ ğ’Ÿ)            = ğœ†[ suc n ] quot ğ’Ÿ
quot {n} (ğ’Ÿâ‚€ âˆ™â¿ ğ’Ÿâ‚)        = quot ğ’Ÿâ‚€ âˆ˜[ suc n ] quot ğ’Ÿâ‚
quot {n} ğ’‘â¿âŸ¨ ğ’Ÿâ‚€ , ğ’Ÿâ‚ âŸ©     = ğ‘[ suc n ]âŸ¨ quot ğ’Ÿâ‚€ , quot ğ’Ÿâ‚ âŸ©
quot {n} (ğ…â‚€â¿ ğ’Ÿ)           = ğœ‹â‚€[ suc n ] quot ğ’Ÿ
quot {n} (ğ…â‚â¿ ğ’Ÿ)           = ğœ‹â‚[ suc n ] quot ğ’Ÿ
quot {n} (ğœ¾â‚€â¿ ğ’Ÿ)           = ğœ„â‚€[ suc n ] quot ğ’Ÿ
quot {n} (ğœ¾â‚â¿ ğ’Ÿ)           = ğœ„â‚[ suc n ] quot ğ’Ÿ
quot {n} ğ’„â¿[ ğ’Ÿ â–· ğ’Ÿâ‚ âˆ£ ğ’Ÿâ‚‚ ] = ğ‘[ suc n ][ quot ğ’Ÿ â–· quot ğ’Ÿâ‚ âˆ£ quot ğ’Ÿâ‚‚ ]
quot {n} (â¬†â¿ ğ’Ÿ)            = â‡‘[ suc n ] quot ğ’Ÿ
quot {n} (â¬‡â¿ ğ’Ÿ)            = â‡“[ suc n ] quot ğ’Ÿ
quot {n} (â˜…â¿ ğ’Ÿ)            = â˜†[ suc n ] quot ğ’Ÿ


-- --------------------------------------------------------------------------
--
-- Internalisation (theorem 1, p. 29 [1]; lemma 5.4, pp. 9â€“10 [2])


-- A , Aâ‚‚ , â€¦ , Aâ‚˜ â‡’
--   x âˆ¶ A , xâ‚‚ âˆ¶ Aâ‚‚ , â€¦ , xâ‚˜ âˆ¶ Aâ‚˜
prefix-each : Cx â†’ Cx
prefix-each âˆ…               = âˆ…
prefix-each (Î“ , âŸ¨ n , A âŸ©) = prefix-each Î“ , âŸ¨ suc n , A âŸ©


-- yâ‚™ âˆ¶ yâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ y âˆ¶ Aâ°â‚– âˆˆ A , Aâ‚‚ , â€¦ , Aâ‚˜ â‡’
--   xâ‚– âˆ¶ yâ‚™ âˆ¶ yâ‚™â‚‹â‚ âˆ¶ â€¦ âˆ¶ y âˆ¶ Aâ°â‚– âˆˆ x âˆ¶ A, xâ‚‚ âˆ¶ Aâ‚‚ , â€¦ , xâ‚˜ âˆ¶ Aâ‚˜
intâˆˆ : âˆ€{Î“ n A}
    â†’ âŸ¨ n , A âŸ© âˆˆ Î“
    â†’ âŸ¨ suc n , A âŸ© âˆˆ prefix-each Î“
intâˆˆ ğ™     = ğ™
intâˆˆ (ğ’ i) = ğ’ (intâˆˆ i)


same-nat : (Î“ : Cx)
    â†’ nat (prefix-each Î“) â‰¡ nat Î“
same-nat âˆ…       = refl
same-nat (Î“ , x) = cong suc (same-nat Î“)

same-tms : âˆ€{Î“ n}
    â†’ Tms (nat Î“) n
    â†’ Tms (nat (prefix-each Î“)) n
same-tms {Î“} tms rewrite same-nat Î“ = tms

same-over-map : âˆ€{Î“ n}
    â†’ (f : âˆ€{m} â†’ â„• â†’ Tm m â†’ Tm m)
    â†’ (ğ­ : Tms (nat Î“) n)
    â†’ same-tms (map# f ğ­) â‰¡ map# f (same-tms ğ­)
same-over-map {Î“} f ğ­
    rewrite same-nat Î“ = refl

ğœ†-same-over-map : âˆ€{Î“ n}
    â†’ (f : âˆ€{m} â†’ â„• â†’ Tm (suc m) â†’ Tm m)
    â†’ (ğ­ : Tms (suc (nat Î“)) n)    â†’ (A : Ty)
    â†’ same-tms (map# f ğ­) â‰¡ map# f (same-tms {Î“ = Î“ , âŸ¨ n , A âŸ©} {n} ğ­)
ğœ†-same-over-map {Î“} f ğ­ A
    rewrite same-nat Î“ = refl

same-over-map2 : âˆ€{Î“ n}
    â†’ (f : âˆ€{m} â†’ â„• â†’ Tm m â†’ Tm m â†’ Tm m)
    â†’ (ğ­ ğ¬ : Tms (nat Î“) n)
    â†’ same-tms (map2# f ğ­ ğ¬) â‰¡ map2# f (same-tms ğ­) (same-tms ğ¬)
same-over-map2 {Î“} f ğ­ ğ¬
    rewrite same-nat Î“ = refl

same-over-map3 : âˆ€{Î“ n}
    â†’ (f : âˆ€{m} â†’ â„• â†’ Tm m â†’ Tm m â†’ Tm m â†’ Tm m)
    â†’ (ğ­ ğ¬ ğ® : Tms (nat Î“) n)
    â†’ same-tms (map3# f ğ­ ğ¬ ğ®) â‰¡ map3# f (same-tms ğ­) (same-tms ğ¬) (same-tms ğ®)
same-over-map3 {Î“} f ğ­ ğ¬ ğ®
    rewrite same-nat Î“ = refl

ğ‘-same-over-map3 : âˆ€{Î“ n}
    â†’ (f : âˆ€{m} â†’ â„• â†’ Tm m â†’ Tm (suc m) â†’ Tm (suc m) â†’ Tm m)
    â†’ (ğ­ : Tms (nat Î“) n)    â†’ (ğ¬ ğ® : Tms (suc (nat Î“)) n)    â†’ (A B : Ty)
    â†’ same-tms (map3# f ğ­ ğ¬ ğ®) â‰¡ map3# f (same-tms ğ­) (same-tms {Î“ = Î“ , âŸ¨ n , A âŸ©} ğ¬) (same-tms {Î“ = Î“ , âŸ¨ n , B âŸ©} ğ®)
ğ‘-same-over-map3 {Î“} f ğ­ ğ¬ ğ® A B
    rewrite same-nat Î“ = refl


-- A , Aâ‚‚ , â€¦ , Aâ‚˜ âŠ¢ B â‡’
--   x âˆ¶ A , xâ‚‚ âˆ¶ Aâ‚‚ , â€¦ xâ‚˜ âˆ¶ Aâ‚˜ âŠ¢ t (x , xâ‚‚ , â€¦ , xâ‚˜) âˆ¶ B
intâŠ¢ : âˆ€{Î“ n} {ğ­ : Tms (nat Î“) n} {B}
    â†’ (ğ’Ÿ : Î“ âŠ¢ ğ­ âˆ¶â¿ B)
    â†’ prefix-each Î“ âŠ¢ same-tms (quot ğ’Ÿ âˆ· ğ­) âˆ¶â¿ B

intâŠ¢ (ğ’— i) = {!ğ’— intâˆˆ i!}

intâŠ¢ {Î“} {n} (ğ€â¿_ {ğ­} {A} ğ’Ÿ)
    rewrite ğœ†-same-over-map ğœ†[_]_ (quot ğ’Ÿ âˆ· ğ­) A =
        ğ€â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} {!intâŠ¢ ğ’Ÿ!}

intâŠ¢ (_âˆ™â¿_ {ğ­} {ğ¬} ğ’Ÿ ğ’)
    rewrite same-over-map2 (Î» n t s â†’ t âˆ˜[ n ] s) (quot ğ’Ÿ âˆ· ğ­) (quot ğ’ âˆ· ğ¬) =
        _âˆ™â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} {ğ¬ = same-tms (quot ğ’ âˆ· ğ¬)} (intâŠ¢ ğ’Ÿ) (intâŠ¢ ğ’)

intâŠ¢ (ğ’‘â¿âŸ¨_,_âŸ© {ğ­} {ğ¬} ğ’Ÿ ğ’)
    rewrite same-over-map2 ğ‘[_]âŸ¨_,_âŸ© (quot ğ’Ÿ âˆ· ğ­) (quot ğ’ âˆ· ğ¬) =
        ğ’‘â¿âŸ¨_,_âŸ© {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} {same-tms (quot ğ’ âˆ· ğ¬)} (intâŠ¢ ğ’Ÿ) (intâŠ¢ ğ’)

intâŠ¢ (ğ…â‚€â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map ğœ‹â‚€[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        ğ…â‚€â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)

intâŠ¢ (ğ…â‚â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map ğœ‹â‚[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        ğ…â‚â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)

intâŠ¢ (ğœ¾â‚€â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map ğœ„â‚€[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        ğœ¾â‚€â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)

intâŠ¢ (ğœ¾â‚â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map ğœ„â‚[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        ğœ¾â‚â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)

intâŠ¢ {Î“} {n} (ğ’„â¿[_â–·_âˆ£_] {ğ­} {ğ¬} {ğ®} {A} {B} ğ’Ÿ ğ’ â„°)
    rewrite ğ‘-same-over-map3 ğ‘[_][_â–·_âˆ£_] (quot ğ’Ÿ âˆ· ğ­) (quot ğ’ âˆ· ğ¬) (quot â„° âˆ· ğ®) A B =
        ğ’„â¿[_â–·_âˆ£_] {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} {same-tms (quot ğ’ âˆ· ğ¬)} {same-tms (quot â„° âˆ· ğ®)} (intâŠ¢ ğ’Ÿ) {!intâŠ¢ ğ’!} {!intâŠ¢ â„°!}

intâŠ¢ (â¬†â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map â‡‘[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        â¬†â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)

intâŠ¢ (â¬‡â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map â‡“[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        â¬‡â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)

intâŠ¢ (â˜…â¿_ {ğ­} ğ’Ÿ)
    rewrite same-over-map â˜†[_]_ (quot ğ’Ÿ âˆ· ğ­) =
        â˜…â¿_ {ğ­ = same-tms (quot ğ’Ÿ âˆ· ğ­)} (intâŠ¢ ğ’Ÿ)


-- -- --------------------------------------------------------------------------
-- --
-- -- Weakening


-- wkâˆˆ : âˆ€{x A Î”}
--     â†’ (Î“ : Cx)    â†’ A âˆˆ[ x ] (âˆ… â€ Î“)
--     â†’ A âˆˆ[ x ] (Î” â€ Î“)
-- wkâˆˆ âˆ…       ()
-- wkâˆˆ (Î“ , A) ğ™     = ğ™
-- wkâˆˆ (Î“ , A) (ğ’ i) = ğ’ (wkâˆˆ Î“ i)


-- wkâŠ¢ : âˆ€{A Î”}
--     â†’ (Î“ : Cx)    â†’ âˆ… â€ Î“ âŠ¢ A
--     â†’ Î” â€ Î“ âŠ¢ A

-- wkâŠ¢ Î“ (ğ’— i)               = ğ’— wkâˆˆ Î“ i
-- wkâŠ¢ Î“ (ğ€â¿_ {n} {ğ­} {A} ğ’Ÿ) = ğ€â¿_ {ğ­ = ğ­} (wkâŠ¢ (Î“ , âŸ¨ n , A âŸ©) ğ’Ÿ)

-- wkâŠ¢ Î“ (_âˆ™â¿_ {ğ­ = ğ­} {ğ¬ = ğ¬} ğ’Ÿ ğ’) =
--     _âˆ™â¿_ {ğ­ = ğ­} {ğ¬ = ğ¬} (wkâŠ¢ Î“ ğ’Ÿ) (wkâŠ¢ Î“ ğ’)

-- wkâŠ¢ Î“ (ğ’‘â¿âŸ¨_,_âŸ© {ğ­ = ğ­} {ğ¬ = ğ¬} ğ’Ÿ ğ’) =
--     ğ’‘â¿âŸ¨_,_âŸ© {ğ­ = ğ­} {ğ¬ = ğ¬} (wkâŠ¢ Î“ ğ’Ÿ) (wkâŠ¢ Î“ ğ’)

-- wkâŠ¢ Î“ (ğ…â‚€â¿_ {ğ­ = ğ­} ğ’Ÿ) = ğ…â‚€â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)
-- wkâŠ¢ Î“ (ğ…â‚â¿_ {ğ­ = ğ­} ğ’Ÿ) = ğ…â‚â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)
-- wkâŠ¢ Î“ (ğœ¾â‚€â¿_ {ğ­ = ğ­} ğ’Ÿ) = ğœ¾â‚€â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)
-- wkâŠ¢ Î“ (ğœ¾â‚â¿_ {ğ­ = ğ­} ğ’Ÿ) = ğœ¾â‚â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)

-- wkâŠ¢ Î“ (ğ’„â¿[_â–·_âˆ£_] {n} {ğ­} {ğ¬} {ğ®} {A} {B} ğ’Ÿ ğ’ â„°) =
--     ğ’„â¿[_â–·_âˆ£_] {ğ­ = ğ­} {ğ¬ = ğ¬}
--                       {ğ® = ğ®} (wkâŠ¢ Î“ ğ’Ÿ) (wkâŠ¢ (Î“ , âŸ¨ n , A âŸ©) ğ’)
--                                          (wkâŠ¢ (Î“ , âŸ¨ n , B âŸ©) â„°)

-- wkâŠ¢ Î“ (â¬†â¿_ {ğ­ = ğ­} ğ’Ÿ) = â¬†â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)
-- wkâŠ¢ Î“ (â¬‡â¿_ {ğ­ = ğ­} ğ’Ÿ) = â¬‡â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)
-- wkâŠ¢ Î“ (â˜…â¿_ {ğ­ = ğ­} ğ’Ÿ) = â˜…â¿_ {ğ­ = ğ­} (wkâŠ¢ Î“ ğ’Ÿ)


-- -- --------------------------------------------------------------------------
-- --
-- -- Constructive necessitation (corollary 5.5, p. 10 [2])


-- nec : âˆ€{A}
--     â†’ (ğ’Ÿ : âˆ… âŠ¢ A)
--     â†’ âŠ© quot ğ’Ÿ âˆ¶ A
-- nec ğ’Ÿ = wkâŠ¢ âˆ… (intâŠ¢ ğ’Ÿ)


-- --------------------------------------------------------------------------
--
-- Examples


-- Some theorems of propositional logic
module PL where
  I : âˆ€{Î“ A}
      â†’ Î“ âŠ¢ A âŠƒ A
  I = ğ€ ğ’— ğŸ

  K : âˆ€{Î“ A B}
      â†’ Î“ âŠ¢ A âŠƒ B âŠƒ A
  K = ğ€ ğ€ ğ’— ğŸ

  S : âˆ€{Î“ A B C}
      â†’ Î“ âŠ¢ (A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C
  S = ğ€ ğ€ ğ€ (ğ’— ğŸ âˆ™ ğ’— ğŸ) âˆ™ (ğ’— ğŸ âˆ™ ğ’— ğŸ)

  X1 : âˆ€{Î“ A B}
      â†’ Î“ âŠ¢ A âŠƒ B âŠƒ A âˆ§ B
  X1 = ğ€ ğ€ ğ’‘âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ©


-- -- Some derived theorems
-- module PLExamples where
--   -- â–¡ (A âŠƒ A)
--   IÂ² : âˆ€{A}
--       â†’ âŠ© ğœ† ğ‘£ 0 âˆ¶ (A âŠƒ A)
--   IÂ² = nec PL.I

--   -- â–¡ â–¡ (A âŠƒ A)
--   IÂ³ : âˆ€{A}
--       â†’ âŠ© ğœ†Â² ğ‘£ 0 âˆ¶ ğœ† ğ‘£ 0 âˆ¶ (A âŠƒ A)
--   IÂ³ = nec IÂ²

--   -- â–¡ (A âŠƒ B âŠƒ A)
--   KÂ² : âˆ€{A B}
--       â†’ âŠ© ğœ† ğœ† ğ‘£ 1 âˆ¶ (A âŠƒ B âŠƒ A)
--   KÂ² = nec PL.K

--   -- â–¡ â–¡ (A âŠƒ B âŠƒ A)
--   KÂ³ : âˆ€{A B}
--       â†’ âŠ© ğœ†Â² ğœ†Â² ğ‘£ 1 âˆ¶ ğœ† ğœ† ğ‘£ 1 âˆ¶ (A âŠƒ B âŠƒ A)
--   KÂ³ = nec KÂ²

--   -- â–¡ ((A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C)
--   SÂ² : âˆ€{A B C}
--       â†’ âŠ© ğœ† ğœ† ğœ† (ğ‘£ 2 âˆ˜ ğ‘£ 0) âˆ˜ (ğ‘£ 1 âˆ˜ ğ‘£ 0)
--           âˆ¶ ((A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C)
--   SÂ² = nec PL.S

--   -- â–¡ â–¡ ((A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C)
--   SÂ³ : âˆ€{A B C}
--       â†’ âŠ© ğœ†Â² ğœ†Â² ğœ†Â² (ğ‘£ 2 âˆ˜Â² ğ‘£ 0) âˆ˜Â² (ğ‘£ 1 âˆ˜Â² ğ‘£ 0)
--           âˆ¶ ğœ† ğœ† ğœ† (ğ‘£ 2 âˆ˜ ğ‘£ 0) âˆ˜ (ğ‘£ 1 âˆ˜ ğ‘£ 0)
--               âˆ¶ ((A âŠƒ B âŠƒ C) âŠƒ (A âŠƒ B) âŠƒ A âŠƒ C)
--   SÂ³ = nec SÂ²


postulate
  push : âˆ€{Î“} {t : Tm 0} {A}
      â†’ âˆ… âŠ¢ t âˆµ A
      â†’ Î“ âŠ¢ t âˆ¶ A


-- Some theorems of modal logic S4
module S4 where
  -- â–¡ (A âŠƒ B) âŠƒ â–¡ A âŠƒ â–¡ B
  K : âˆ€{Î“ A B f x}
      â†’ Î“ âŠ¢ (f âˆ¶ (A âŠƒ B)) âŠƒ x âˆ¶ A âŠƒ (f âˆ˜ x) âˆ¶ B
  K = ğ€ ğ€ {!ğ’— ğŸ!} âˆ™ {!ğ’— ğŸ!} -- ğ€ ğ€ {!ğ’— ğŸ âˆ™Â² ğ’— ğŸ!} -- (ğ’— ğŸ âˆ™Â² ğ’— ğŸ)

  -- â–¡ A âŠƒ A
  T : âˆ€{Î“ A x}
      â†’ Î“ âŠ¢ x âˆ¶ A âŠƒ A
  T = ğ€ â¬‡ ğ’— ğŸ

  -- â–¡ A âŠƒ â–¡ â–¡ A
  #4 : âˆ€{Î“ A x}
      â†’ Î“ âŠ¢ x âˆ¶ A âŠƒ ! x âˆ¶ x âˆ¶ A
  #4 = ğ€ â¬† ğ’— ğŸ

  -- â–¡ A âŠƒ â–¡ B âŠƒ â–¡ â–¡ (A âˆ§ B)
  X1 : âˆ€{Î“ A B x y}
      â†’ Î“ âŠ¢ x âˆ¶ A âŠƒ y âˆ¶ B âŠƒ ! ğ‘âŸ¨ x , y âŸ© âˆ¶ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B)
  X1 = ğ€ ğ€ â¬† {!!} -- ğ’‘Â²âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ©

  -- â–¡ A âŠƒ â–¡ B âŠƒ â–¡ (A âˆ§ B)
  X2 : âˆ€{Î“ A B x y}
      â†’ Î“ âŠ¢ x âˆ¶ A âŠƒ y âˆ¶ B âŠƒ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B)
  X2 = ğ€ ğ€ {!!} -- ğ’‘Â²âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ©

  -- â–¡ A âˆ§ â–¡ B âŠƒ â–¡ â–¡ (A âˆ§ B)
  X3 : âˆ€{Î“ A B x y}
      â†’ Î“ âŠ¢ x âˆ¶ A âˆ§ y âˆ¶ B âŠƒ ! ğ‘âŸ¨ x , y âŸ© âˆ¶ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B)
  X3 = ğ€ â¬† {!!} -- ğ’‘Â²âŸ¨ ğ…â‚€ ğ’— ğŸ , ğ…â‚ ğ’— ğŸ âŸ©

  -- â–¡ A âˆ§ â–¡ B âŠƒ â–¡ (A âˆ§ B)
  X4 : âˆ€{Î“ A B x y}
      â†’ Î“ âŠ¢ x âˆ¶ A âˆ§ y âˆ¶ B âŠƒ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B)
  X4 = ğ€ {!!} -- ğ’‘Â²âŸ¨ ğ…â‚€ ğ’— ğŸ , ğ…â‚ ğ’— ğŸ âŸ©


-- -- Some more derived theorems
-- module S4Examples where
--   -- â–¡ (â–¡ (A âŠƒ B) âŠƒ â–¡ A âŠƒ â–¡ B)
--   KÂ² : âˆ€{f x A B}
--       â†’ âŠ© ğœ† ğœ† ğ‘£ 1 âˆ˜Â² ğ‘£ 0 âˆ¶ (f âˆ¶ (A âŠƒ B) âŠƒ x âˆ¶ A âŠƒ (f âˆ˜ x) âˆ¶ B)
--   KÂ² = nec S4.K


-- -- --------------------------------------------------------------------------
-- --
-- -- Original examples


-- -- Example 1 (p. 28 [1])
-- module Example1 where
--   -- â–¡ (â–¡ A âŠƒ A)
--   E11 : âˆ€{x A}
--       â†’ âŠ© ğœ† â‡“ ğ‘£ 0 âˆ¶ (x âˆ¶ A âŠƒ A)
--   E11 = nec S4.T

--   -- â–¡ (â–¡ A âŠƒ â–¡ â–¡ A)
--   E12 : âˆ€{x A}
--       â†’ âŠ© ğœ† â‡‘ ğ‘£ 0 âˆ¶ (x âˆ¶ A âŠƒ ! x âˆ¶ x âˆ¶ A)
--   E12 = nec S4.#4

--   -- â–¡ â–¡ (A âŠƒ B âŠƒ A âˆ§ B)
--   E13 : âˆ€{A B}
--       â†’ âŠ© ğœ†Â² ğœ†Â² ğ‘Â²âŸ¨ ğ‘£ 1 , ğ‘£ 0 âŸ© âˆ¶ ğœ† ğœ† ğ‘âŸ¨ ğ‘£ 1 , ğ‘£ 0 âŸ© âˆ¶ (A âŠƒ B âŠƒ A âˆ§ B)
--   E13 = nec (nec PL.X1)

--   -- â–¡ (â–¡ A âŠƒ â–¡ B âŠƒ â–¡ â–¡ (A âˆ§ B))
--   E14 : âˆ€{x y A B}
--       â†’ âŠ© ğœ† ğœ† â‡‘ ğ‘Â²âŸ¨ ğ‘£ 1 , ğ‘£ 0 âŸ©
--           âˆ¶ (x âˆ¶ A âŠƒ y âˆ¶ B âŠƒ ! ğ‘âŸ¨ x , y âŸ© âˆ¶ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B))
--   E14 = nec S4.X1


-- -- Some more variants of example 1
-- module Example1a where
--   -- â–¡ (â–¡ A âŠƒ â–¡ B âŠƒ â–¡ (A âˆ§ B))
--   E14a : âˆ€{x y A B}
--       â†’ âŠ© ğœ† ğœ† ğ‘Â²âŸ¨ ğ‘£ 1 , ğ‘£ 0 âŸ© âˆ¶ (x âˆ¶ A âŠƒ y âˆ¶ B âŠƒ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B))
--   E14a = nec S4.X2

--   -- â–¡ (â–¡ A âˆ§ â–¡ B âŠƒ â–¡ â–¡ (A âˆ§ B))
--   E14c : âˆ€{x y A B}
--       â†’ âŠ© ğœ† â‡‘ ğ‘Â²âŸ¨ ğœ‹â‚€ ğ‘£ 0 , ğœ‹â‚ ğ‘£ 0 âŸ©
--           âˆ¶ (x âˆ¶ A âˆ§ y âˆ¶ B âŠƒ ! ğ‘âŸ¨ x , y âŸ© âˆ¶ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B))
--   E14c = nec S4.X3

--   -- â–¡ (â–¡ A âˆ§ â–¡ B âŠƒ â–¡ (A âˆ§ B))
--   E14b : âˆ€{x y A B}
--       â†’ âŠ© ğœ† ğ‘Â²âŸ¨ ğœ‹â‚€ ğ‘£ 0 , ğœ‹â‚ ğ‘£ 0 âŸ© âˆ¶ (x âˆ¶ A âˆ§ y âˆ¶ B âŠƒ ğ‘âŸ¨ x , y âŸ© âˆ¶ (A âˆ§ B))
--   E14b = nec S4.X4


-- -- Example 2 (pp. 31â€“32 [1])
-- module Example2 where
--   E2 : âˆ€{x A}
--       â†’ âŠ© ğœ†Â² â‡“Â² â‡‘Â² ğ‘£ 0 âˆ¶ ğœ† â‡“ â‡‘ ğ‘£ 0 âˆ¶ (x âˆ¶ A âŠƒ x âˆ¶ A)
--   E2 = ğ€Â³ â¬‡Â³ â¬†Â³ ğ’— ğŸ

--   E2a : âˆ€{x A}
--       â†’ âŠ© ğœ†Â² ğ‘£ 0 âˆ¶ ğœ† ğ‘£ 0 âˆ¶ (x âˆ¶ A âŠƒ x âˆ¶ A)
--   E2a = ğ€Â³ ğ’— ğŸ


-- -- --------------------------------------------------------------------------
-- --
-- -- Additional examples


-- -- De Morganâ€™s laws
-- module DeMorgan where
--   -- (A âŠƒ âŠ¥) âˆ§ (B âŠƒ âŠ¥) â«— (A âˆ¨ B) âŠƒ âŠ¥
--   L1 : âˆ€{A B}
--       â†’ âŠ© Â¬ A âˆ§ Â¬ B â«— Â¬ (A âˆ¨ B)
--   L1 = ğ’‘âŸ¨ ğ€ ğ€ ğ’„[ ğ’— ğŸ â–· ğ…â‚€ ğ’— ğŸ âˆ™ ğ’— ğŸ âˆ£ ğ…â‚ ğ’— ğŸ âˆ™ ğ’— ğŸ ]
--         , ğ€ ğ’‘âŸ¨ ğ€ ğ’— ğŸ âˆ™ ğœ¾â‚€ ğ’— ğŸ , ğ€ ğ’— ğŸ âˆ™ ğœ¾â‚ ğ’— ğŸ âŸ© âŸ©

--   -- (A âŠƒ âŠ¥) âˆ¨ (B âŠƒ âŠ¥) âŠƒ (A âŠƒ âŠ¥) âˆ§ B
--   L2 : âˆ€{A B}
--       â†’ âŠ© Â¬ A âˆ¨ Â¬ B âŠƒ Â¬ (A âˆ§ B)
--   L2 = ğ€ ğ€ ğ’„[ ğ’— ğŸ â–· ğ’— ğŸ âˆ™ ğ…â‚€ ğ’— ğŸ âˆ£ ğ’— ğŸ âˆ™ ğ…â‚ ğ’— ğŸ ]


-- -- Explosions and contradictions
-- module ExploCon where
--   X1 : âˆ€{A}
--       â†’ âŠ© âŠ¥ âŠƒ A
--   X1 = ğ€ â˜… ğ’— ğŸ

--   -- â–¡ (âŠ¥ âŠƒ A)
--   X1Â² : âˆ€{A}
--       â†’ âŠ© ğœ† â˜† ğ‘£ 0 âˆ¶ (âŠ¥ âŠƒ A)
--   X1Â² = nec X1

--   -- â–¡ âŠ¥ âŠƒ â–¡ A
--   X2 : âˆ€{x A}
--       â†’ âŠ© x âˆ¶ âŠ¥ âŠƒ â˜† x âˆ¶ A
--   X2 = ğ€ â˜…Â² ğ’— ğŸ

--   X3 : âˆ€{A}
--       â†’ âŠ© Â¬ A âŠƒ A âŠƒ âŠ¥
--   X3 = ğ€ ğ€ ğ’— ğŸ âˆ™ ğ’— ğŸ

--   -- â–¡ (Â¬ A) âŠƒ â–¡ A âŠƒ â–¡ âŠ¥
--   X4 : âˆ€{x y A}
--       â†’ âŠ© x âˆ¶ (Â¬ A) âŠƒ y âˆ¶ A âŠƒ x âˆ˜ y âˆ¶ âŠ¥
--   X4 = ğ€ ğ€ ğ’— ğŸ âˆ™Â² ğ’— ğŸ

--   -- â–¡ (Â¬ A) âŠƒ â–¡ A âŠƒ â–¡ â–¡ âŠ¥
--   X5 : âˆ€{x y A}
--       â†’ âŠ© x âˆ¶ (Â¬ A) âŠƒ y âˆ¶ A âŠƒ ! (x âˆ˜ y) âˆ¶ x âˆ˜ y âˆ¶ âŠ¥
--   X5 = ğ€ ğ€ â¬† ğ’— ğŸ âˆ™Â² ğ’— ğŸ


-- -- --------------------------------------------------------------------------
-- --
-- -- Further examples


-- module Idempotence where
--   âŠƒ-idem : âˆ€{A}
--       â†’ âŠ© A âŠƒ A â«— âŠ¤
--   âŠƒ-idem = ğ’‘âŸ¨ ğ€ ğ€ ğ’— ğŸ
--             , ğ€ ğ€ ğ’— ğŸ âŸ©

--   âˆ§-idem : âˆ€{A}
--       â†’ âŠ© A âˆ§ A â«— A
--   âˆ§-idem = ğ’‘âŸ¨ ğ€ ğ…â‚€ ğ’— ğŸ
--             , ğ€ ğ’‘âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ© âŸ©

--   âˆ¨-idem : âˆ€{A}
--       â†’ âŠ© A âˆ¨ A â«— A
--   âˆ¨-idem = ğ’‘âŸ¨ ğ€ ğ’„[ ğ’— ğŸ â–· ğ’— ğŸ âˆ£ ğ’— ğŸ ]
--             , ğ€ ğœ¾â‚€ ğ’— ğŸ âŸ©


-- module Commutativity where
--   âˆ§-comm : âˆ€{A B}
--       â†’ âŠ© A âˆ§ B â«— B âˆ§ A
--   âˆ§-comm = ğ’‘âŸ¨ ğ€ ğ’‘âŸ¨ ğ…â‚ ğ’— ğŸ , ğ…â‚€ ğ’— ğŸ âŸ©
--             , ğ€ ğ’‘âŸ¨ ğ…â‚ ğ’— ğŸ , ğ…â‚€ ğ’— ğŸ âŸ© âŸ©

--   âˆ¨-comm : âˆ€{A B}
--       â†’ âŠ© A âˆ¨ B â«— B âˆ¨ A
--   âˆ¨-comm = ğ’‘âŸ¨ ğ€ ğ’„[ ğ’— ğŸ â–· ğœ¾â‚ ğ’— ğŸ âˆ£ ğœ¾â‚€ ğ’— ğŸ ]
--             , ğ€ ğ’„[ ğ’— ğŸ â–· ğœ¾â‚ ğ’— ğŸ âˆ£ ğœ¾â‚€ ğ’— ğŸ ] âŸ©


-- module Associativity where
--   âˆ§-assoc : âˆ€{A B C}
--       â†’ âŠ© A âˆ§ (B âˆ§ C) â«— (A âˆ§ B) âˆ§ C
--   âˆ§-assoc = ğ’‘âŸ¨ ğ€ ğ’‘âŸ¨ ğ’‘âŸ¨ ğ…â‚€ ğ’— ğŸ , ğ…â‚€ ğ…â‚ ğ’— ğŸ âŸ© , ğ…â‚ ğ…â‚ ğ’— ğŸ âŸ©
--              , ğ€ ğ’‘âŸ¨ ğ…â‚€ ğ…â‚€ ğ’— ğŸ , ğ’‘âŸ¨ ğ…â‚ ğ…â‚€ ğ’— ğŸ , ğ…â‚ ğ’— ğŸ âŸ© âŸ© âŸ©

--   âˆ¨-assoc : âˆ€{A B C}
--       â†’ âŠ© A âˆ¨ (B âˆ¨ C) â«— (A âˆ¨ B) âˆ¨ C
--   âˆ¨-assoc = ğ’‘âŸ¨ ğ€ ğ’„[ ğ’— ğŸ â–· ğœ¾â‚€ ğœ¾â‚€ ğ’— ğŸ âˆ£ ğ’„[ ğ’— ğŸ â–· ğœ¾â‚€ ğœ¾â‚ ğ’— ğŸ âˆ£ ğœ¾â‚ ğ’— ğŸ ] ]
--              , ğ€ ğ’„[ ğ’— ğŸ â–· ğ’„[ ğ’— ğŸ â–· ğœ¾â‚€ ğ’— ğŸ âˆ£ ğœ¾â‚ ğœ¾â‚€ ğ’— ğŸ ] âˆ£ ğœ¾â‚ ğœ¾â‚ ğ’— ğŸ ] âŸ©


-- module Distributivity where
--   âŠƒ-dist-âˆ§ : âˆ€{A B C}
--       â†’ âŠ© A âŠƒ (B âˆ§ C) â«— (A âŠƒ B) âˆ§ (A âŠƒ C)
--   âŠƒ-dist-âˆ§ = ğ’‘âŸ¨ ğ€ ğ’‘âŸ¨ ğ€ ğ…â‚€ (ğ’— ğŸ âˆ™ ğ’— ğŸ) , ğ€ ğ…â‚ (ğ’— ğŸ âˆ™ ğ’— ğŸ) âŸ©
--               , ğ€ ğ€ ğ’‘âŸ¨ ğ…â‚€ ğ’— ğŸ âˆ™ ğ’— ğŸ , ğ…â‚ ğ’— ğŸ âˆ™ ğ’— ğŸ âŸ© âŸ©

--   âˆ§-dist-âˆ¨ : âˆ€{A B C}
--       â†’ âŠ© A âˆ§ (B âˆ¨ C) â«— (A âˆ§ B) âˆ¨ (A âˆ§ C)
--   âˆ§-dist-âˆ¨ = ğ’‘âŸ¨ ğ€ ğ’„[ ğ…â‚ ğ’— ğŸ â–· ğœ¾â‚€ ğ’‘âŸ¨ ğ…â‚€ ğ’— ğŸ , ğ’— ğŸ âŸ© âˆ£ ğœ¾â‚ ğ’‘âŸ¨ ğ…â‚€ ğ’— ğŸ , ğ’— ğŸ âŸ© ]
--               , ğ€ ğ’„[ ğ’— ğŸ â–· ğ’‘âŸ¨ ğ…â‚€ ğ’— ğŸ , ğœ¾â‚€ ğ…â‚ ğ’— ğŸ âŸ© âˆ£ ğ’‘âŸ¨ ğ…â‚€ ğ’— ğŸ , ğœ¾â‚ ğ…â‚ ğ’— ğŸ âŸ© ] âŸ©

--   âˆ¨-dist-âˆ§ : âˆ€{A B C}
--       â†’ âŠ© A âˆ¨ (B âˆ§ C) â«— (A âˆ¨ B) âˆ§ (A âˆ¨ C)
--   âˆ¨-dist-âˆ§ = ğ’‘âŸ¨ ğ€ ğ’„[ ğ’— ğŸ â–· ğ’‘âŸ¨ ğœ¾â‚€ ğ’— ğŸ , ğœ¾â‚€ ğ’— ğŸ âŸ© âˆ£ ğ’‘âŸ¨ ğœ¾â‚ ğ…â‚€ ğ’— ğŸ , ğœ¾â‚ ğ…â‚ ğ’— ğŸ âŸ© ]
--               , ğ€ ğ’„[ ğ…â‚€ ğ’— ğŸ â–· ğœ¾â‚€ ğ’— ğŸ âˆ£ ğ’„[ ğ…â‚ ğ’— ğŸ â–· ğœ¾â‚€ ğ’— ğŸ âˆ£ ğœ¾â‚ ğ’‘âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ© ] ] âŸ©


-- module Untitled where
--   âŠƒ-law : âˆ€{A B C}
--       â†’ âŠ© (A âŠƒ B) âŠƒ (B âŠƒ C) âŠƒ A âŠƒ C
--   âŠƒ-law = ğ€ ğ€ ğ€ ğ’— ğŸ âˆ™ (ğ’— ğŸ âˆ™ ğ’— ğŸ)

--   âŠƒ-âˆ§-law : âˆ€{A B C}
--       â†’ âŠ© A âŠƒ B âŠƒ C â«— (A âˆ§ B) âŠƒ C
--   âŠƒ-âˆ§-law = ğ’‘âŸ¨ ğ€ ğ€ ğ’— ğŸ âˆ™ ğ…â‚€ ğ’— ğŸ âˆ™ ğ…â‚ ğ’— ğŸ
--              , ğ€ ğ€ ğ€ ğ’— ğŸ âˆ™ ğ’‘âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ© âŸ©

--   âˆ¨-âŠƒ-âˆ§-law : âˆ€{A B C}
--       â†’ âŠ© (A âˆ¨ B) âŠƒ C â«— (A âŠƒ C) âˆ§ (B âŠƒ C)
--   âˆ¨-âŠƒ-âˆ§-law = ğ’‘âŸ¨ ğ€ ğ’‘âŸ¨ ğ€ ğ’— ğŸ âˆ™ ğœ¾â‚€ ğ’— ğŸ , ğ€ ğ’— ğŸ âˆ™ ğœ¾â‚ ğ’— ğŸ âŸ©
--                , ğ€ ğ€ ğ’„[ ğ’— ğŸ â–· ğ…â‚€ ğ’— ğŸ âˆ™ ğ’— ğŸ âˆ£ ğ…â‚ ğ’— ğŸ âˆ™ ğ’— ğŸ ] âŸ©


-- module Trivial where
--   âŠƒ-âŠ¤-law : âˆ€{A}
--       â†’ âŠ© A âŠƒ âŠ¤ â«— âŠ¤
--   âŠƒ-âŠ¤-law = ğ’‘âŸ¨ ğ€ ğ€ ğ’— ğŸ
--               , ğ€ ğ€ ğ’— ğŸ âŸ©

--   âŠ¤-âŠƒ-law : âˆ€{A}
--       â†’ âŠ© âŠ¤ âŠƒ A â«— A
--   âŠ¤-âŠƒ-law = ğ’‘âŸ¨ ğ€ ğ’— ğŸ âˆ™ (ğ€ ğ’— ğŸ)
--               , ğ€ ğ€ ğ’— ğŸ âŸ©

--   âŠ¥-âŠƒ-âŠ¤-law : âˆ€{A}
--       â†’ âŠ© âŠ¥ âŠƒ A â«— âŠ¤
--   âŠ¥-âŠƒ-âŠ¤-law = ğ’‘âŸ¨ ğ€ ğ€ ğ’— ğŸ
--                  , ğ€ ğ€ â˜… ğ’— ğŸ âŸ©

--   âˆ§-âŠ¥-law : âˆ€{A}
--       â†’ âŠ© A âˆ§ âŠ¥ â«— âŠ¥
--   âˆ§-âŠ¥-law = ğ’‘âŸ¨ ğ€ ğ…â‚ ğ’— ğŸ
--                 , ğ€ â˜… ğ’— ğŸ âŸ©

--   âˆ¨-âŠ¥-law : âˆ€{A}
--       â†’ âŠ© A âˆ¨ âŠ¥ â«— A
--   âˆ¨-âŠ¥-law = ğ’‘âŸ¨ ğ€ ğ’„[ ğ’— ğŸ â–· ğ’— ğŸ âˆ£ â˜… ğ’— ğŸ ]
--                 , ğ€ ğœ¾â‚€ ğ’— ğŸ âŸ©

--   âˆ§-âŠ¤-law : âˆ€{A}
--       â†’ âŠ© A âˆ§ âŠ¤ â«— A
--   âˆ§-âŠ¤-law = ğ’‘âŸ¨ ğ€ ğ…â‚€ ğ’— ğŸ
--                 , ğ€ ğ’‘âŸ¨ ğ’— ğŸ , ğ€ ğ’— ğŸ âŸ© âŸ©

--   âˆ¨-âŠ¤-law : âˆ€{A}
--       â†’ âŠ© A âˆ¨ âŠ¤ â«— âŠ¤
--   âˆ¨-âŠ¤-law = ğ’‘âŸ¨ ğ€ ğ€ ğ’— ğŸ
--                 , ğ€ ğœ¾â‚ ğ’— ğŸ âŸ©
