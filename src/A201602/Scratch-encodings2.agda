module A201602.Scratch-encodings2 where

{-

-- --------------------------------------------------------------------------
--
-- Church encoding of true and false (macros/schemas)


âŒœBoolâŒ : Ty â†’ Ty
âŒœBoolâŒ A = A âŠƒ A âŠƒ A


âŒœtrueâŒ : âˆ€{A} â†’ âŠ© âŒœBoolâŒ A
âŒœtrueâŒ = ğ€ ğ€ ğ’— ğŸ

âŒœfalseâŒ : âˆ€{A} â†’ âŠ© âŒœBoolâŒ A
âŒœfalseâŒ = ğ€ ğ€ ğ’— ğŸ


-- --------------------------------------------------------------------------
--
-- Church encoding of natural numbers (macros/schemas)


âŒœâ„•âŒ : Ty â†’ Ty
âŒœâ„•âŒ A = (A âŠƒ A) âŠƒ A âŠƒ A


âŒœzeroâŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœzeroâŒ = ğ€ ğ€ ğ’— ğŸ

âŒœsucâŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A âŠƒ âŒœâ„•âŒ A
âŒœsucâŒ = ğ€ ğ€ ğ€ ğ’— ğŸ âˆ™ (ğ’— ğŸ âˆ™ ğ’— ğŸ âˆ™ ğ’— ğŸ)


âŒœ1âŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœ1âŒ = ğ€ ğ€ ğ’— ğŸ âˆ™ ğ’— ğŸ

âŒœ2âŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœ2âŒ = ğ€ ğ€ ğ’— ğŸ âˆ™ (ğ’— ğŸ âˆ™ ğ’— ğŸ)

âŒœ3âŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœ3âŒ = ğ€ ğ€ ğ’— ğŸ âˆ™ (ğ’— ğŸ âˆ™ (ğ’— ğŸ âˆ™ ğ’— ğŸ))


âŒœsucâˆ˜zeroâŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœsucâˆ˜zeroâŒ = âŒœsucâŒ âˆ™ âŒœzeroâŒ

âŒœsucâˆ˜sucâˆ˜zeroâŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœsucâˆ˜sucâˆ˜zeroâŒ = âŒœsucâŒ âˆ™ âŒœsucâˆ˜zeroâŒ

âŒœsucâˆ˜sucâˆ˜sucâˆ˜zeroâŒ : âˆ€{A} â†’ âŠ© âŒœâ„•âŒ A
âŒœsucâˆ˜sucâˆ˜sucâˆ˜zeroâŒ = âŒœsucâŒ âˆ™ âŒœsucâˆ˜sucâˆ˜zeroâŒ


module `Bool where
  -- A âŠƒ A âŠƒ A

  `true : âˆ€{A t f}
      â†’ âŠ© ğœ† ğœ† ğ‘£ 1
          âˆ¶ (t âˆ¶ A âŠƒ f âˆ¶ A âŠƒ t âˆ¶ A)
  `true = ğ€Â² ğ€Â² ğ’— ğŸ

  `false : âˆ€{A t f}
      â†’ âŠ© ğœ† ğœ† ğ‘£ 0
          âˆ¶ (t âˆ¶ A âŠƒ f âˆ¶ A âŠƒ f âˆ¶ A)
  `false = ğ€Â² ğ€Â² ğ’— ğŸ

  `ifThenElse : âˆ€{A b t f}
      â†’ âŠ© ğœ† ğœ† ğœ† ğ‘£ 2 âˆ˜Â² ğ‘£ 1 âˆ˜Â² ğ‘£ 0
          âˆ¶ (b âˆ¶ (A âŠƒ A âŠƒ A) âŠƒ t âˆ¶ A âŠƒ f âˆ¶ A âŠƒ (b âˆ˜ t âˆ˜ f) âˆ¶ A)
  `ifThenElse = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ âˆ™Â³ ğ’— ğŸ


module `Maybe where
  -- (A âŠƒ B) âŠƒ B âŠƒ B

  `just : âˆ€{A B a j n}
      â†’ âŠ© ğœ† ğœ† ğœ† ğ‘£ 1 âˆ˜Â² ğ‘£ 2
          âˆ¶ (a âˆ¶ A âŠƒ j âˆ¶ (A âŠƒ B) âŠƒ n âˆ¶ B âŠƒ (j âˆ˜ a) âˆ¶ B)
  `just = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ

  `nothing : âˆ€{A B j n}
      â†’ âŠ© ğœ† ğœ† ğ‘£ 0
          âˆ¶ (j âˆ¶ (A âŠƒ B) âŠƒ n âˆ¶ B âŠƒ n âˆ¶ B)
  `nothing = ğ€Â² ğ€Â² ğ’— ğŸ

  `maybe : âˆ€{A B m j n}
      â†’ âŠ© ğœ† ğœ† ğœ† ğ‘£ 2 âˆ˜Â² ğ‘£ 1 âˆ˜Â² ğ‘£ 0
          âˆ¶ (m âˆ¶ ((A âŠƒ B) âŠƒ B âŠƒ B) âŠƒ j âˆ¶ (A âŠƒ B) âŠƒ n âˆ¶ B âŠƒ (m âˆ˜ j âˆ˜ n) âˆ¶ B)
  `maybe = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ âˆ™Â³ ğ’— ğŸ


module `Either where
  -- (A âŠƒ C) âŠƒ (B âŠƒ C) âŠƒ C

  `left : âˆ€{A B C a l r}
      â†’ âŠ© ğœ† ğœ† ğœ† ğ‘£ 1 âˆ˜Â² ğ‘£ 2
          âˆ¶ (a âˆ¶ A âŠƒ l âˆ¶ (A âŠƒ C) âŠƒ r âˆ¶ (B âŠƒ C) âŠƒ (l âˆ˜ a) âˆ¶ C)
  `left = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ

  `right : âˆ€{A B C b l r}
      â†’ âŠ© ğœ† ğœ† ğœ† ğ‘£ 0 âˆ˜Â² ğ‘£ 2
          âˆ¶ (b âˆ¶ B âŠƒ l âˆ¶ (A âŠƒ C) âŠƒ r âˆ¶ (B âŠƒ C) âŠƒ (r âˆ˜ b) âˆ¶ C)
  `right = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ

  `either : âˆ€{A B C e l r}
      â†’ âŠ© ğœ† ğœ† ğœ† ğ‘£ 2 âˆ˜Â² ğ‘£ 1 âˆ˜Â² ğ‘£ 0
          âˆ¶ (e âˆ¶ ((A âŠƒ C) âŠƒ (B âŠƒ C) âŠƒ C) âŠƒ l âˆ¶ (A âŠƒ C) âŠƒ r âˆ¶ (B âŠƒ C) âŠƒ (e âˆ˜ l âˆ˜ r) âˆ¶ C)
  `either = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ âˆ™Â³ ğ’— ğŸ


module `â„• where
  -- (A âŠƒ A) âŠƒ A âŠƒ A

  Tsuc : Tm
  Tsuc = ğœ† ğœ† ğœ† ğ‘£ 1 âˆ˜Â² (ğ‘£ 2 âˆ˜Â² ğ‘£ 1 âˆ˜Â² ğ‘£ 0)

  TsucÂ² : Tm
  TsucÂ² = ğœ†Â² ğœ†Â² ğœ†Â² ğ‘£ 1 âˆ˜Â³ (ğ‘£ 2 âˆ˜Â³ ğ‘£ 1 âˆ˜Â³ ğ‘£ 0)

  `suc : âˆ€{A n s z}
      â†’ âŠ© Tsuc
          âˆ¶ (n âˆ¶ ((A âŠƒ A) âŠƒ A âŠƒ A) âŠƒ s âˆ¶ (A âŠƒ A) âŠƒ z âˆ¶ A âŠƒ (s âˆ˜ (n âˆ˜ s âˆ˜ z)) âˆ¶ A)
  `suc = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ (ğ’— ğŸ âˆ™Â³ ğ’— ğŸ âˆ™Â³ ğ’— ğŸ)

  Tzero : Tm
  Tzero = ğœ† ğœ† ğ‘£ 0

  TzeroÂ² : Tm
  TzeroÂ² = ğœ†Â² ğœ†Â² ğ‘£ 0

  `zero : âˆ€{A s z}
      â†’ âŠ© Tzero
          âˆ¶ (s âˆ¶ (A âŠƒ A) âŠƒ z âˆ¶ A âŠƒ z âˆ¶ A)
  `zero = ğ€Â² ğ€Â² ğ’— ğŸ

  Titer : Tm
  Titer = ğœ† ğœ† ğœ† ğ‘£ 2 âˆ˜Â² ğ‘£ 1 âˆ˜Â² ğ‘£ 0

  TiterÂ² : Tm
  TiterÂ² = ğœ†Â² ğœ†Â² ğœ†Â² ğ‘£ 2 âˆ˜Â³ ğ‘£ 1 âˆ˜Â³ ğ‘£ 0

  `iter : âˆ€{m A n s z} {Î“ : Cx m}
      â†’ Î“ âŠ¢ Titer
          âˆ¶ (n âˆ¶ ((A âŠƒ A) âŠƒ A âŠƒ A) âŠƒ s âˆ¶ (A âŠƒ A) âŠƒ z âˆ¶ A âŠƒ (n âˆ˜ s âˆ˜ z) âˆ¶ A)
  `iter = ğ€Â² ğ€Â² ğ€Â² ğ’— ğŸ âˆ™Â³ ğ’— ğŸ âˆ™Â³ ğ’— ğŸ

  `iterÂ² : âˆ€{m A n s z} {Î“ : Cx m}
      â†’ Î“ âŠ¢ TiterÂ²
          âˆ¶ Titer
          âˆ¶ (n âˆ¶ ((A âŠƒ A) âŠƒ A âŠƒ A) âŠƒ s âˆ¶ (A âŠƒ A) âŠƒ z âˆ¶ A âŠƒ (n âˆ˜ s âˆ˜ z) âˆ¶ A)
  `iterÂ² = ğ€Â³ ğ€Â³ ğ€Â³ ğ’— ğŸ âˆ™â´ ğ’— ğŸ âˆ™â´ ğ’— ğŸ

  `rec : âˆ€{A n f z}
      â†’ âŠ© ğœ† ğœ† ğœ† ğœ‹â‚Â² (ğ‘£ 2 âˆ˜Â² (ğœ†Â² ğ‘Â²âŸ¨ TsucÂ² âˆ˜Â² ğœ‹â‚€Â² ğ‘£ 0 , ğ‘£ 2 âˆ˜Â² ğœ‹â‚€Â² ğ‘£ 0 âˆ˜Â² ğœ‹â‚Â² ğ‘£ 0 âŸ©) âˆ˜Â² ğ‘Â²âŸ¨ TzeroÂ² , ğ‘£ 0 âŸ©)
          âˆ¶ (n âˆ¶ ((A âŠƒ A) âŠƒ A âŠƒ A) âŠƒ f âˆ¶ (((A âŠƒ A) âŠƒ A âŠƒ A) âŠƒ A âŠƒ A) âŠƒ z âˆ¶ A
              âŠƒ (ğœ‹â‚ (n âˆ˜ (ğœ† ğ‘âŸ¨ Tsuc âˆ˜ ğœ‹â‚€ ğ‘£ 0 , ğ‘£ 2 âˆ˜ ğœ‹â‚€ ğ‘£ 0 âˆ˜ ğœ‹â‚ ğ‘£ 0 âŸ©) âˆ˜ ğ‘âŸ¨ Tzero , z âŸ©)) âˆ¶ A)
  `rec = ğ€Â² ğ€Â² ğ€Â² ğ…â‚Â³ ({!ğ’— ğŸ!} âˆ™Â³ {!!} âˆ™Â³ {!!})




wtf : {TX TA : Ty} {X A x a : Tm} â†’ âŠ©  ğœ† ğœ† â‡‘ ğ‘Â³âŸ¨ ğ‘£ 1 , ğ‘£ 0 âŸ©  âˆ¶  (x âˆ¶ X âˆ¶ TX âŠƒ a âˆ¶ A âˆ˜ x âˆ¶ TA âŠƒ ! ğ‘Â²âŸ¨ x , a âŸ© âˆ¶ ğ‘Â²âŸ¨ x , a âŸ© âˆ¶ ğ‘âŸ¨ X , A âˆ˜ x âŸ© âˆ¶ (TX âˆ§ TA))
wtf = ğ€Â² ğ€Â² â¬†Â² ğ’‘â´âŸ¨ ğ’— ğŸ , ğ’— ğŸ âŸ©

-}
