{-# OPTIONS --rewriting #-}

module A201801.CMLProjectionToS4 where

open import A201801.Prelude
open import A201801.Category
open import A201801.List
open import A201801.ListLemmas
open import A201801.ListConcatenation
open import A201801.AllList
open import A201801.CMLPropositions
open import A201801.CMLStandardDerivations
import A201801.S4Propositions as S4
import A201801.S4StandardDerivations as S4


--------------------------------------------------------------------------------


mutual
  âŸ¦_âŸ§â‚š : Form â†’ S4.Form
  âŸ¦ Î¹ P âŸ§â‚š     = S4.Î¹ P
  âŸ¦ A âŠƒ B âŸ§â‚š   = âŸ¦ A âŸ§â‚š S4.âŠƒ âŸ¦ B âŸ§â‚š
  âŸ¦ [ Î¨ ] A âŸ§â‚š = S4.â–¡ (âŸ¦ Î¨ âŸ§â‚šâ‚› S4.âŠƒâ‹¯âŠƒ âŸ¦ A âŸ§â‚š)

  âŸ¦_âŸ§â‚šâ‚› : List Form â†’ List S4.Form
  âŸ¦ âˆ™ âŸ§â‚šâ‚›     = âˆ™
  âŸ¦ Î , A âŸ§â‚šâ‚› = âŸ¦ Î âŸ§â‚šâ‚› , âŸ¦ A âŸ§â‚š


âŸ¦_âŸ§â‚ : Assert â†’ S4.Assert
âŸ¦ âŸª Î“ âŠ« A âŸ« âŸ§â‚ = S4.âŸªâŠ« âŸ¦ Î“ âŸ§â‚šâ‚› S4.âŠƒâ‹¯âŠƒ âŸ¦ A âŸ§â‚š âŸ«


âŸ¦_âŸ§â‚â‚› : List Assert â†’ List S4.Assert
âŸ¦ Î” âŸ§â‚â‚› = map âŸ¦_âŸ§â‚ Î”


âŸ¦_âŸ§âˆ‹â‚š : âˆ€ {Î“ A} â†’ Î“ âˆ‹ A
                â†’ âŸ¦ Î“ âŸ§â‚šâ‚› âˆ‹ âŸ¦ A âŸ§â‚š
âŸ¦ zero âŸ§âˆ‹â‚š  = zero
âŸ¦ suc i âŸ§âˆ‹â‚š = suc âŸ¦ i âŸ§âˆ‹â‚š


âŸ¦_âŸ§âˆ‹â‚ : âˆ€ {Î” Î“ A} â†’ Î” âˆ‹ âŸª Î“ âŠ« A âŸ«
                  â†’ âŸ¦ Î” âŸ§â‚â‚› âˆ‹ S4.âŸªâŠ« âŸ¦ Î“ âŸ§â‚šâ‚› S4.âŠƒâ‹¯âŠƒ âŸ¦ A âŸ§â‚š âŸ«
âŸ¦ zero âŸ§âˆ‹â‚  = zero
âŸ¦ suc i âŸ§âˆ‹â‚ = suc âŸ¦ i âŸ§âˆ‹â‚


-- TODO: unfinished
-- mutual
--   âŸ¦_âŸ§ : âˆ€ {Î” Î“ A} â†’ Î” âŠ¢ A valid[ Î“ ]
--                   â†’ âŸ¦ Î” âŸ§â‚â‚› S4.âŠ¢ âŸ¦ A âŸ§â‚š valid[ âŸ¦ Î“ âŸ§â‚šâ‚› ]
--   âŸ¦ var i âŸ§         = S4.var âŸ¦ i âŸ§âˆ‹â‚š
--   âŸ¦ lam ğ’Ÿ âŸ§         = S4.lam âŸ¦ ğ’Ÿ âŸ§
--   âŸ¦ app ğ’Ÿ â„° âŸ§       = S4.app âŸ¦ ğ’Ÿ âŸ§ âŸ¦ â„° âŸ§
--   âŸ¦ mvar i Ïˆ âŸ§      = {!S4.apps (S4.mvar âŸ¦ i âŸ§âˆ‹â‚) âŸ¦ Ïˆ âŸ§â¿!}
--   âŸ¦ box {Î¨ = Î¨} ğ’Ÿ âŸ§ = {!S4.box (S4.lams âŸ¦ Î¨ âŸ§â‚šâ‚› âŸ¦ ğ’Ÿ âŸ§)!}
--   âŸ¦ letbox ğ’Ÿ â„° âŸ§    = S4.letbox âŸ¦ ğ’Ÿ âŸ§ âŸ¦ â„° âŸ§
--
--   âŸ¦_âŸ§â¿ : âˆ€ {Î” Î“ Î} â†’ Î” âŠ¢ Î allvalid[ Î“ ]
--                    â†’ âŸ¦ Î” âŸ§â‚â‚› S4.âŠ¢ âŸ¦ Î âŸ§â‚šâ‚› allvalid[ âŸ¦ Î“ âŸ§â‚šâ‚› ]
--   âŸ¦ âˆ™ âŸ§â¿     = âˆ™
--   âŸ¦ Î¾ , ğ’Ÿ âŸ§â¿ = âŸ¦ Î¾ âŸ§â¿ , âŸ¦ ğ’Ÿ âŸ§


--------------------------------------------------------------------------------


â†“â‚š : S4.Form â†’ Form
â†“â‚š (S4.Î¹ P)   = Î¹ P
â†“â‚š (A S4.âŠƒ B) = (â†“â‚š A) âŠƒ (â†“â‚š B)
â†“â‚š (S4.â–¡ A)   = [ âˆ™ ] (â†“â‚š A)


â†“â‚šâ‚› : List S4.Form â†’ List Form
â†“â‚šâ‚› Î“ = map â†“â‚š Î“


â†“â‚ : S4.Assert â†’ Assert
â†“â‚ S4.âŸªâŠ« A âŸ« = âŸª âˆ™ âŠ« â†“â‚š A âŸ«


â†“â‚â‚› : List S4.Assert â†’ List Assert
â†“â‚â‚› Î” = map â†“â‚ Î”


â†“âˆ‹â‚š : âˆ€ {Î“ A} â†’ Î“ âˆ‹ A
              â†’ â†“â‚šâ‚› Î“ âˆ‹ â†“â‚š A
â†“âˆ‹â‚š zero    = zero
â†“âˆ‹â‚š (suc i) = suc (â†“âˆ‹â‚š i)


â†“âˆ‹â‚ : âˆ€ {Î” A} â†’ Î” âˆ‹ S4.âŸªâŠ« A âŸ«
              â†’ â†“â‚â‚› Î” âˆ‹ âŸª âˆ™ âŠ« â†“â‚š A âŸ«
â†“âˆ‹â‚ zero    = zero
â†“âˆ‹â‚ (suc i) = suc (â†“âˆ‹â‚ i)


â†“ : âˆ€ {Î” Î“ A} â†’ Î” S4.âŠ¢ A valid[ Î“ ]
              â†’ â†“â‚â‚› Î” âŠ¢ â†“â‚š A valid[ â†“â‚šâ‚› Î“ ]
â†“ (S4.var i)      = var (â†“âˆ‹â‚š i)
â†“ (S4.lam ğ’Ÿ)      = lam (â†“ ğ’Ÿ)
â†“ (S4.app ğ’Ÿ â„°)    = app (â†“ ğ’Ÿ) (â†“ â„°)
â†“ (S4.mvar i)     = mvar (â†“âˆ‹â‚ i) âˆ™
â†“ (S4.box ğ’Ÿ)      = box (â†“ ğ’Ÿ)
â†“ (S4.letbox ğ’Ÿ â„°) = letbox (â†“ ğ’Ÿ) (â†“ â„°)


--------------------------------------------------------------------------------


idâŸ¦âŸ§â†“â‚š : âˆ€ {A : S4.Form} â†’ âŸ¦_âŸ§â‚š (â†“â‚š A) â‰¡ A
idâŸ¦âŸ§â†“â‚š {S4.Î¹ P}   = refl
idâŸ¦âŸ§â†“â‚š {A S4.âŠƒ B} = S4._âŠƒ_ & idâŸ¦âŸ§â†“â‚š âŠ— idâŸ¦âŸ§â†“â‚š
idâŸ¦âŸ§â†“â‚š {S4.â–¡ A}   = S4.â–¡_ & idâŸ¦âŸ§â†“â‚š


idâŸ¦âŸ§â†“â‚šâ‚› : âˆ€ {Î“ : List S4.Form} â†’ âŸ¦_âŸ§â‚šâ‚› (â†“â‚šâ‚› Î“) â‰¡ Î“
idâŸ¦âŸ§â†“â‚šâ‚› {âˆ™}     = refl
idâŸ¦âŸ§â†“â‚šâ‚› {Î“ , A} = _,_ & idâŸ¦âŸ§â†“â‚šâ‚› âŠ— idâŸ¦âŸ§â†“â‚š


idâŸ¦âŸ§â†“â‚ : âˆ€ {A} â†’ âŸ¦_âŸ§â‚ (â†“â‚ S4.âŸªâŠ« A âŸ«) â‰¡ S4.âŸªâŠ« A âŸ«
idâŸ¦âŸ§â†“â‚ = S4.âŸªâŠ«_âŸ« & idâŸ¦âŸ§â†“â‚š


-- NOTE: Agda does not accept this type for REWRITE
-- idâŸ¦âŸ§â†“â‚â‚› : âˆ€ {Î”} â†’ (âŸ¦_âŸ§â‚â‚› âˆ˜ â†“â‚â‚›) Î” â‰¡ Î”

idâŸ¦âŸ§â†“â‚â‚› : âˆ€ {Î”} â†’ map âŸ¦_âŸ§â‚ (map â†“â‚ Î”) â‰¡ Î”
idâŸ¦âŸ§â†“â‚â‚› {âˆ™}              = refl
idâŸ¦âŸ§â†“â‚â‚› {Î” , S4.âŸªâŠ« A âŸ«} = _,_ & idâŸ¦âŸ§â†“â‚â‚› âŠ— idâŸ¦âŸ§â†“â‚


{-# REWRITE idâŸ¦âŸ§â†“â‚š #-}
{-# REWRITE idâŸ¦âŸ§â†“â‚šâ‚› #-}
idâŸ¦âŸ§â†“âˆ‹â‚š : âˆ€ {Î“ A} â†’ (i : Î“ âˆ‹ A)
                  â†’ âŸ¦_âŸ§âˆ‹â‚š (â†“âˆ‹â‚š i) â‰¡ i
idâŸ¦âŸ§â†“âˆ‹â‚š zero    = refl
idâŸ¦âŸ§â†“âˆ‹â‚š (suc i) = suc & idâŸ¦âŸ§â†“âˆ‹â‚š i


{-# REWRITE idâŸ¦âŸ§â†“â‚â‚› #-}
idâŸ¦âŸ§â†“âˆ‹â‚ : âˆ€ {Î” A} â†’ (i : Î” âˆ‹ S4.âŸªâŠ« A âŸ«)
                  â†’ âŸ¦_âŸ§âˆ‹â‚ (â†“âˆ‹â‚ i) â‰¡ i
idâŸ¦âŸ§â†“âˆ‹â‚ zero    = refl
idâŸ¦âŸ§â†“âˆ‹â‚ (suc i) = suc & idâŸ¦âŸ§â†“âˆ‹â‚ i


-- TODO: unfinished
-- {-# REWRITE idâŸ¦âŸ§â†“âˆ‹â‚š #-}
-- {-# REWRITE idâŸ¦âŸ§â†“âˆ‹â‚ #-}
-- idâŸ¦âŸ§â†“ : âˆ€ {Î” Î“ A} â†’ (ğ’Ÿ : Î” S4.âŠ¢ A valid[ Î“ ])
--                   â†’ âŸ¦_âŸ§ (â†“ ğ’Ÿ) â‰¡ ğ’Ÿ
-- idâŸ¦âŸ§â†“ (S4.var i)      = refl
-- idâŸ¦âŸ§â†“ (S4.lam ğ’Ÿ)      = S4.lam & idâŸ¦âŸ§â†“ ğ’Ÿ
-- idâŸ¦âŸ§â†“ (S4.app ğ’Ÿ â„°)    = S4.app & idâŸ¦âŸ§â†“ ğ’Ÿ âŠ— idâŸ¦âŸ§â†“ â„°
-- idâŸ¦âŸ§â†“ (S4.mvar i)     = refl
-- idâŸ¦âŸ§â†“ (S4.box ğ’Ÿ)      = S4.box & idâŸ¦âŸ§â†“ ğ’Ÿ
-- idâŸ¦âŸ§â†“ (S4.letbox ğ’Ÿ â„°) = S4.letbox & idâŸ¦âŸ§â†“ ğ’Ÿ âŠ— idâŸ¦âŸ§â†“ â„°


--------------------------------------------------------------------------------
