module StdIPLLemmas where

open import Prelude
open import List
open import StdIPL


--------------------------------------------------------------------------------


idren : âˆ€ {Î“ A} â†’ (ğ’Ÿ : Î“ âŠ¢ A true)
                â†’ ren idâŠ‡ ğ’Ÿ â‰¡ ğ’Ÿ
idren (var ğ’¾)   = var & idrenâˆ‹ ğ’¾
idren (lam ğ’Ÿ)   = lam & idren ğ’Ÿ
idren (app ğ’Ÿ â„°) = app & idren ğ’Ÿ âŠ— idren â„°

assocren : âˆ€ {Î“ Î“â€² Î“â€³ A} â†’ (Î·â‚ : Î“â€² âŠ‡ Î“) (Î·â‚‚ : Î“â€³ âŠ‡ Î“â€²) (ğ’Ÿ : Î“ âŠ¢ A true)
                         â†’ ren Î·â‚‚ (ren Î·â‚ ğ’Ÿ) â‰¡ ren (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) ğ’Ÿ
assocren Î·â‚ Î·â‚‚ (var ğ’¾)   = var & assocrenâˆ‹ Î·â‚ Î·â‚‚ ğ’¾
assocren Î·â‚ Î·â‚‚ (lam ğ’Ÿ)   = lam & assocren (keep Î·â‚) (keep Î·â‚‚) ğ’Ÿ
assocren Î·â‚ Î·â‚‚ (app ğ’Ÿ â„°) = app & assocren Î·â‚ Î·â‚‚ ğ’Ÿ âŠ— assocren Î·â‚ Î·â‚‚ â„°


--------------------------------------------------------------------------------


idlookups : âˆ€ {Î“ Î} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                    â†’ lookups Î¾ idâŠ‡ â‰¡ Î¾
idlookups âˆ™       = refl
idlookups (Î¾ , ğ’Ÿ) = (_, ğ’Ÿ) & idlookups Î¾


sublookups : âˆ€ {Î“ Î Îâ€² A} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’Ÿ : Î âŠ¢ A true)
                          â†’ sub Î¾ (ren Î· ğ’Ÿ) â‰¡ sub (lookups Î¾ Î·) ğ’Ÿ
sublookups Î¾ Î· ğ’Ÿ = {!!}


--------------------------------------------------------------------------------


zapsubs : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î“ âŠ¢ A true)
                      â†’ subs (Î¾ , ğ’Ÿ) (wks Ïˆ) â‰¡ subs Î¾ Ïˆ
zapsubs Î¾ âˆ™       ğ’Ÿ = refl
zapsubs Î¾ (Ïˆ , â„°) ğ’Ÿ = _,_ & zapsubs Î¾ Ïˆ ğ’Ÿ âŠ— ( sublookups (Î¾ , ğ’Ÿ) (drop idâŠ‡) â„°
                                            â¦™ (\ Î¾â€² â†’ sub Î¾â€² â„°) & idlookups Î¾
                                            )


--------------------------------------------------------------------------------


lookuprens : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’¾ : Î âˆ‹ A true)
                          â†’ lookup (rens Î· Î¾) ğ’¾ â‰¡ ren Î· (lookup Î¾ ğ’¾)
lookuprens Î· (Î¾ , ğ’Ÿ) zero    = refl
lookuprens Î· (Î¾ , ğ’Ÿ) (suc ğ’¾) = lookuprens Î· Î¾ ğ’¾
lookupwks : âˆ€ {Î“ Î A B} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (ğ’¾ : Î âˆ‹ A true)
                        â†’ lookup (wks {B} Î¾) ğ’¾ â‰¡ wk (lookup Î¾ ğ’¾)
lookupwks Î¾ ğ’¾ = lookuprens (drop idâŠ‡) Î¾ ğ’¾

lookupids : âˆ€ {Î“ A} â†’ (ğ’¾ : Î“ âˆ‹ A true)
                    â†’ lookup ids ğ’¾ â‰¡ var ğ’¾
lookupids zero    = refl
lookupids (suc ğ’¾) = lookupwks ids ğ’¾
                  â¦™ wk & lookupids ğ’¾
                  â¦™ var & (suc & idrenâˆ‹ ğ’¾)

idsub : âˆ€ {Î“ A} â†’ (ğ’Ÿ : Î“ âŠ¢ A true)
                â†’ sub ids ğ’Ÿ â‰¡ ğ’Ÿ
idsub (var ğ’¾)   = lookupids ğ’¾
idsub (lam ğ’Ÿ)   = lam & idsub ğ’Ÿ
idsub (app ğ’Ÿ â„°) = app & idsub ğ’Ÿ âŠ— idsub â„°


--------------------------------------------------------------------------------


wksrens : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î)
                       â†’ rens (drop Î·) Î¾ â‰¡ wks {A} (rens Î· Î¾)
wksrens Î· âˆ™       = refl
wksrens Î· (Î¾ , ğ’Ÿ) = _,_ & wksrens Î· Î¾ âŠ— ( (\ Î·â€² â†’ ren (drop Î·â€²) ğ’Ÿ) & ridâˆ˜âŠ‡ Î· â»Â¹
                                        â¦™ assocren Î· (drop idâŠ‡) ğ’Ÿ â»Â¹
                                        )

wksrensâ€² : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î)
                        â†’ rens (keep Î·) (wks Î¾) â‰¡ wks {A} (rens Î· Î¾)
wksrensâ€² Î· âˆ™       = refl
wksrensâ€² Î· (Î¾ , ğ’Ÿ) = _,_ & wksrensâ€² Î· Î¾ âŠ— ( assocren (drop idâŠ‡) (keep Î·) ğ’Ÿ
                                          â¦™ (\ Î·â€² â†’ ren (drop Î·â€²) ğ’Ÿ) & (lidâˆ˜âŠ‡ Î· â¦™ ridâˆ˜âŠ‡ Î· â»Â¹)
                                          â¦™ assocren Î· (drop idâŠ‡) ğ’Ÿ â»Â¹
                                          )

liftsrens : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î)
                         â†’ rens (keep Î·) (lifts Î¾) â‰¡ lifts {A} (rens Î· Î¾)
liftsrens Î· Î¾ = (_, vz) & wksrensâ€² Î· Î¾

mutual
  subrens : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’Ÿ : Î âŠ¢ A true)
                         â†’ ren Î· (sub Î¾ ğ’Ÿ) â‰¡ sub (rens Î· Î¾) ğ’Ÿ
  subrens Î· Î¾ (var ğ’¾)   = lookuprens Î· Î¾ ğ’¾ â»Â¹
  subrens Î· Î¾ (lam ğ’Ÿ)   = lam & subliftsrens Î· Î¾ ğ’Ÿ
  subrens Î· Î¾ (app ğ’Ÿ â„°) = app & subrens Î· Î¾ ğ’Ÿ âŠ— subrens Î· Î¾ â„°

  subliftsrens : âˆ€ {Î“ Î“â€² Î A B} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’Ÿ : Î , B true âŠ¢ A true)
                                â†’ ren (keep Î·) (sub (lifts Î¾) ğ’Ÿ) â‰¡ sub (lifts {B} (rens Î· Î¾)) ğ’Ÿ
  subliftsrens Î· Î¾ ğ’Ÿ = subrens (keep Î·) (lifts Î¾) ğ’Ÿ
                     â¦™ (\ Î¾â€² â†’ sub Î¾â€² ğ’Ÿ) & liftsrens Î· Î¾


--------------------------------------------------------------------------------


lookupsubs : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’¾ : Î¨ âˆ‹ A true)
                         â†’ lookup (subs Î¾ Ïˆ) ğ’¾ â‰¡ sub Î¾ (lookup Ïˆ ğ’¾)
lookupsubs Î¾ (Ïˆ , ğ’Ÿ) zero    = refl
lookupsubs Î¾ (Ïˆ , â„°) (suc ğ’¾) = lookupsubs Î¾ Ïˆ ğ’¾

wkssubs : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨)
                      â†’ subs (wks Î¾) Ïˆ â‰¡ wks {A} (subs Î¾ Ïˆ)
wkssubs Î¾ âˆ™       = refl
wkssubs Î¾ (Ïˆ , ğ’Ÿ) = _,_ & wkssubs Î¾ Ïˆ âŠ— subrens (drop idâŠ‡) Î¾ ğ’Ÿ â»Â¹

liftssubs : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨)
                        â†’ subs (lifts Î¾) (lifts Ïˆ) â‰¡ lifts {A} (subs Î¾ Ïˆ)
liftssubs Î¾ Ïˆ = (_, vz) & ( zapsubs (wks Î¾) Ïˆ vz
                          â¦™ wkssubs Î¾ Ïˆ
                          )

mutual
  assocsub : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î¨ âŠ¢ A true)
                         â†’ sub Î¾ (sub Ïˆ ğ’Ÿ) â‰¡ sub (subs Î¾ Ïˆ) ğ’Ÿ
  assocsub Î¾ Ïˆ (var ğ’¾)   = lookupsubs Î¾ Ïˆ ğ’¾ â»Â¹
  assocsub Î¾ Ïˆ (lam ğ’Ÿ)   = lam & subliftssubs Î¾ Ïˆ ğ’Ÿ
  assocsub Î¾ Ïˆ (app ğ’Ÿ â„°) = app & assocsub Î¾ Ïˆ ğ’Ÿ âŠ— assocsub Î¾ Ïˆ â„°

  subliftssubs : âˆ€ {Î“ Î Î¨ A B} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î¨ , B true âŠ¢ A true)
                               â†’ sub (lifts Î¾) (sub (lifts Ïˆ) ğ’Ÿ) â‰¡ sub (lifts {B} (subs Î¾ Ïˆ)) ğ’Ÿ
  subliftssubs Î¾ Ïˆ ğ’Ÿ = assocsub (lifts Î¾) (lifts Ïˆ) ğ’Ÿ
                     â¦™ (\ Î¾â€² â†’ sub Î¾â€² ğ’Ÿ) & liftssubs Î¾ Ïˆ





--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

_âˆ‹â‹†_ = _âŠ‡_

-- putáµ£

getáµ£ = renâˆ‹

pattern wkáµ£ = _âŠ‡_.drop

pattern liftáµ£ = _âŠ‡_.keep

idáµ£ = idâŠ‡

renâ€² = ren

wkâ€² = wk

_â—‹_ = _âˆ˜âŠ‡_

--------------------------------------------------------------------------------

-- natgetáµ£

idgetáµ£ = idrenâˆ‹

idrenâ€² = idren

--------------------------------------------------------------------------------

-- postulate
--   nope : âˆ€ {X A} â†’ {Î“ Î“â€² : List X}
--                  â†’ Î“â€² âŠ‡ Î“ â†’ Î“â€² âˆ‹ A
--                  â†’ Î“â€² âŠ‡ Î“ , A

-- postulate
--   zapâ—‹ : âˆ€ {X A} â†’ {Î“ Î“â€² Î“â€³ : List X}
--                  â†’ (Î·â‚ : Î“â€² âŠ‡ Î“) (Î·â‚‚ : Î“â€³ âŠ‡ Î“â€²) (ğ’¾ : Î“â€³ âˆ‹ A)
--                  â†’ drop Î·â‚ âˆ˜âŠ‡ nope Î·â‚‚ ğ’¾ â‰¡ Î·â‚ âˆ˜âŠ‡ Î·â‚‚

lidâ—‹ = lidâˆ˜âŠ‡

ridâ—‹ = ridâˆ˜âŠ‡

--------------------------------------------------------------------------------

getâ—‹ = assocrenâˆ‹

-- wkâ—‹

-- liftâ—‹

-- wklidâ—‹

-- wkridâ—‹

-- liftwkridâ—‹

renâ—‹ = assocren

-- renliftâ—‹

-- renwkâ—‹

-- renliftwkâ—‹

--------------------------------------------------------------------------------

assocâ—‹ = assocâˆ˜âŠ‡

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------




--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

_âŠ¢â‹†â€²_ = _âŠ¢â‹†_

-- putâ‚›

getâ‚› = lookup

wkâ‚› = wks

liftâ‚› = lifts

idâ‚› = ids

subâ€² = sub

cutâ€² = cut

_â—_ : âˆ€ {Î“ Î Î¨} â†’ Î âŠ¢â‹† Î¨ â†’ Î“ âŠ¢â‹† Î
                â†’ Î“ âŠ¢â‹† Î¨
Ïˆ â— Î¾ = subs Î¾ Ïˆ

--------------------------------------------------------------------------------

natgetâ‚› = lookupwks

idgetâ‚› = lookupids

idsubâ€² = idsub

--------------------------------------------------------------------------------

âŒŠ_âŒ‹ = hyps

_â—_ : âˆ€ {Î“ Î Îâ€²} â†’ Î“ âŠ¢â‹† Îâ€² â†’ Îâ€² âŠ‡ Î
                 â†’ Î“ âŠ¢â‹† Î
Î¾ â— Î· = lookups Î¾ Î·

_â—‘_ : âˆ€ {Î“ Î“â€² Î} â†’ Î“â€² âŠ‡ Î“ â†’ Î“ âŠ¢â‹† Î
                 â†’ Î“â€² âŠ¢â‹† Î
Î· â—‘ Î¾ = rens Î· Î¾

-- âŒŠgetâŒ‹
-- âŒŠwkâŒ‹
-- âŒŠliftâŒ‹
-- âŒŠidâŒ‹
-- âŒŠsubâŒ‹
-- âŒŠâ—‹âŒ‹

--------------------------------------------------------------------------------

postulate
  zapâ— : âˆ€ {Î“ Î Îâ€² A} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’Ÿ : Î“ âŠ¢ A true)
                      â†’ lookups (Î¾ , ğ’Ÿ) (drop Î·) â‰¡ lookups Î¾ Î·

ridâ— : âˆ€ {Î“ Î} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
               â†’ lookups Î¾ idâŠ‡ â‰¡ Î¾
ridâ— Î¾ = idlookups Î¾

--------------------------------------------------------------------------------

postulate
  getâ— : âˆ€ {Î“ Î Îâ€² A} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’¾ : Î âˆ‹ A true)
                      â†’ lookup (lookups Î¾ Î·) ğ’¾ â‰¡ lookup Î¾ (renâˆ‹ Î· ğ’¾)

postulate
  wkâ— : âˆ€ {Î“ Î Îâ€² A} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î)
                     â†’ wks {A} (lookups Î¾ Î·) â‰¡ lookups (wks Î¾) Î·

postulate
  liftâ— : âˆ€ {Î“ Î Îâ€² A} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î)
                       â†’ lifts {A} (lookups Î¾ Î·) â‰¡ lookups (lifts Î¾) (keep Î·)

postulate
  wkridâ— : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                     â†’ lookups (wks {A} Î¾) idâŠ‡ â‰¡ wks Î¾

postulate
  liftwkridâ— : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                         â†’ lookups (lifts {A} Î¾) (drop idâŠ‡) â‰¡ wks Î¾

subâ— : âˆ€ {Î“ Î Îâ€² A} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’Ÿ : Î âŠ¢ A true)
                    â†’ sub (lookups Î¾ Î·) ğ’Ÿ â‰¡ sub Î¾ (ren Î· ğ’Ÿ)
subâ— Î¾ Î· ğ’Ÿ = sublookups Î¾ Î· ğ’Ÿ â»Â¹

postulate
  subliftâ— : âˆ€ {Î“ Î Îâ€² A B} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’Ÿ : Î , B true âŠ¢ A true)
                            â†’ sub (lifts {B} (lookups Î¾ Î·)) ğ’Ÿ â‰¡ sub (lifts Î¾) (ren (keep Î·) ğ’Ÿ)

postulate
  subwkâ— : âˆ€ {Î“ Î Îâ€² A B} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’Ÿ : Î âŠ¢ A true)
                          â†’ sub (wks {B} (lookups Î¾ Î·)) ğ’Ÿ â‰¡ sub (wks Î¾) (ren Î· ğ’Ÿ)

postulate
  subliftwkâ— : âˆ€ {Î“ Î Îâ€² A B} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (ğ’Ÿ : Î âŠ¢ A true)
                              â†’ sub (wks {B} (lookups Î¾ Î·)) ğ’Ÿ â‰¡ sub (lifts Î¾) (ren (drop Î·) ğ’Ÿ)

--------------------------------------------------------------------------------

-- postulate
--   zapâ—‘ : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’¾ : Î“â€² âˆ‹ A true)
--                       â†’ rens (nope Î· ğ’¾) (wks Î¾) â‰¡ rens Î· Î¾

postulate
  lidâ—‘ : âˆ€ {Î“ Î} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                 â†’ rens idâŠ‡ Î¾ â‰¡ Î¾

--------------------------------------------------------------------------------

zapâ— : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î“ âŠ¢ A true)
                   â†’ subs (Î¾ , ğ’Ÿ) (wks Ïˆ) â‰¡ subs Î¾ Ïˆ
zapâ— = zapsubs

postulate
  lidâ— : âˆ€ {Î“ Î} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                 â†’ subs ids Î¾ â‰¡ Î¾

postulate
  ridâ— : âˆ€ {Î“ Î} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                 â†’ subs Î¾ ids â‰¡ Î¾

--------------------------------------------------------------------------------

getâ—‘ : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’¾ : Î âˆ‹ A true)
                    â†’ lookup (rens Î· Î¾) ğ’¾ â‰¡ ren Î· (lookup Î¾ ğ’¾)
getâ—‘ = lookuprens

wkâ—‘ : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î)
                   â†’ wks {A} (rens Î· Î¾) â‰¡ rens (drop Î·) Î¾
wkâ—‘ Î· Î¾ = wksrens Î· Î¾ â»Â¹

liftâ—‘ : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î)
                     â†’ lifts {A} (rens Î· Î¾) â‰¡ rens (keep Î·) (lifts Î¾)
liftâ—‘ Î· Î¾ = liftsrens Î· Î¾ â»Â¹

postulate
  wklidâ—‘ : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                     â†’ rens (drop {A = A} idâŠ‡) Î¾ â‰¡ wks Î¾

postulate
  liftwklidâ—‘ : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                         â†’ rens (keep {A = A} idâŠ‡) (wks Î¾) â‰¡ wks Î¾

subâ—‘ : âˆ€ {Î“ Î“â€² Î A} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’Ÿ : Î âŠ¢ A true)
                    â†’ sub (rens Î· Î¾) ğ’Ÿ â‰¡ ren Î· (sub Î¾ ğ’Ÿ)
subâ—‘ Î· Î¾ ğ’Ÿ = subrens Î· Î¾ ğ’Ÿ â»Â¹

subliftâ—‘ : âˆ€ {Î“ Î“â€² Î A B} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’Ÿ : Î , B true âŠ¢ A true)
                          â†’ sub (lifts {B} (rens Î· Î¾)) ğ’Ÿ â‰¡ ren (keep Î·) (sub (lifts Î¾) ğ’Ÿ)
subliftâ—‘ Î· Î¾ ğ’Ÿ = subliftsrens Î· Î¾ ğ’Ÿ â»Â¹

postulate
  subwkâ—‘ : âˆ€ {Î“ Î“â€² Î A B} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’Ÿ : Î âŠ¢ A true)
                          â†’ sub (wks {B} (rens Î· Î¾)) ğ’Ÿ â‰¡ ren (drop Î·) (sub Î¾ ğ’Ÿ)

postulate
  subliftwkâ—‘ : âˆ€ {Î“ Î“â€² Î A B} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (ğ’Ÿ : Î âŠ¢ A true)
                              â†’ sub (wks {B} (rens Î· Î¾)) ğ’Ÿ â‰¡ ren (keep Î·) (sub (wks Î¾) ğ’Ÿ)

--------------------------------------------------------------------------------

getâ— : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’¾ : Î¨ âˆ‹ A true)
                   â†’ lookup (subs Î¾ Ïˆ) ğ’¾ â‰¡ sub Î¾ (lookup Ïˆ ğ’¾)
getâ— = lookupsubs

wkâ— : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨)
                  â†’ wks {A} (subs Î¾ Ïˆ) â‰¡ subs (wks Î¾) Ïˆ
wkâ— Î¾ Ïˆ = wkssubs Î¾ Ïˆ â»Â¹

liftâ— : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨)
                    â†’ lifts {A} (subs Î¾ Ïˆ) â‰¡ subs (lifts Î¾) (lifts Ïˆ)
liftâ— Î¾ Ïˆ = liftssubs Î¾ Ïˆ â»Â¹

postulate
  wklidâ— : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                     â†’ subs (wks {A} ids) Î¾ â‰¡ wks Î¾

postulate
  wkridâ— : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                     â†’ subs (wks {A} Î¾) ids â‰¡ wks Î¾

postulate
  liftwkridâ— : âˆ€ {Î“ Î A} â†’ (Î¾ : Î“ âŠ¢â‹† Î)
                         â†’ subs (lifts {A} Î¾) (wks ids) â‰¡ wks Î¾

subâ— : âˆ€ {Î“ Î Î¨ A} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î¨ âŠ¢ A true)
                   â†’ sub (subs Î¾ Ïˆ) ğ’Ÿ â‰¡ sub Î¾ (sub Ïˆ ğ’Ÿ)
subâ— Î¾ Ïˆ ğ’Ÿ = assocsub Î¾ Ïˆ ğ’Ÿ â»Â¹

subliftâ— : âˆ€ {Î“ Î Î¨ A B} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î¨ , B true âŠ¢ A true)
                         â†’ sub (lifts {B} (subs Î¾ Ïˆ)) ğ’Ÿ â‰¡ sub (lifts Î¾) (sub (lifts Ïˆ) ğ’Ÿ)
subliftâ— Î¾ Ïˆ ğ’Ÿ = subliftssubs Î¾ Ïˆ ğ’Ÿ â»Â¹

postulate
  subwkâ— : âˆ€ {Î“ Î Î¨ A B} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î¨ âŠ¢ A true)
                         â†’ sub (wks {B} (subs Î¾ Ïˆ)) ğ’Ÿ â‰¡ sub (wks Î¾) (sub Ïˆ ğ’Ÿ)

postulate
  subliftwkâ— : âˆ€ {Î“ Î Î¨ A B} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (ğ’Ÿ : Î¨ âŠ¢ A true)
                             â†’ sub (wks {B} (subs Î¾ Ïˆ)) ğ’Ÿ â‰¡ sub (lifts Î¾) (sub (wks Ïˆ) ğ’Ÿ)

--------------------------------------------------------------------------------

postulate
  compâ—â—‹ : âˆ€ {Î“ Î Îâ€² Îâ€³} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€³) (Î·â‚ : Îâ€² âŠ‡ Î) (Î·â‚‚ : Îâ€³ âŠ‡ Îâ€²)
                         â†’ lookups Î¾ (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) â‰¡ lookups (lookups Î¾ Î·â‚‚) Î·â‚

postulate
  compâ—‘â—‹ : âˆ€ {Î“ Î“â€² Î“â€³ Î} â†’ (Î·â‚ : Î“â€² âŠ‡ Î“) (Î·â‚‚ : Î“â€³ âŠ‡ Î“â€²) (Î¾ : Î“ âŠ¢â‹† Î)
                         â†’ rens Î·â‚‚ (rens Î·â‚ Î¾) â‰¡ rens (Î·â‚ âˆ˜âŠ‡ Î·â‚‚) Î¾

postulate
  compâ—‘â— : âˆ€ {Î“ Î“â€² Î Îâ€²} â†’ (Î·â‚ : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î·â‚‚ : Îâ€² âŠ‡ Î)
                         â†’ rens Î·â‚ (lookups Î¾ Î·â‚‚) â‰¡ lookups (rens Î·â‚ Î¾) Î·â‚‚

postulate
  compâ—‘â— : âˆ€ {Î“ Î“â€² Î Î¨} â†’ (Î· : Î“â€² âŠ‡ Î“) (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨)
                        â†’ rens Î· (subs Î¾ Ïˆ) â‰¡ subs (rens Î· Î¾) Ïˆ

postulate
  compâ—â— : âˆ€ {Î“ Î Î¨ Î¨â€²} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨â€²) (Î· : Î¨â€² âŠ‡ Î¨)
                        â†’ subs Î¾ (lookups Ïˆ Î·) â‰¡ lookups (subs Î¾ Ïˆ) Î·

postulate
  compâ—â—‘ : âˆ€ {Î“ Î Îâ€² Î¨} â†’ (Î¾ : Î“ âŠ¢â‹† Îâ€²) (Î· : Îâ€² âŠ‡ Î) (Ïˆ : Î âŠ¢â‹† Î¨)
                        â†’ subs Î¾ (rens Î· Ïˆ) â‰¡ subs (lookups Î¾ Î·) Ïˆ

--------------------------------------------------------------------------------

postulate
  assocâ— : âˆ€ {Î“ Î Î¨ Î¦} â†’ (Î¾ : Î“ âŠ¢â‹† Î) (Ïˆ : Î âŠ¢â‹† Î¨) (Ï† : Î¨ âŠ¢â‹† Î¦)
                       â†’ subs Î¾ (subs Ïˆ Ï†) â‰¡ subs (subs Î¾ Ïˆ) Ï†
