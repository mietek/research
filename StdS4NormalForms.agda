module StdS4NormalForms where

open import Prelude
open import List
open import List2
open import StdS4


--------------------------------------------------------------------------------


mutual
  infix 3 _âŠ¢â‚™â‚˜_
  data _âŠ¢â‚™â‚˜_ : ListÂ² Validity Truth â†’ Truth â†’ Set
    where
      lam : âˆ€ {A B Î” Î“} â†’ Î” â¨¾ Î“ , A true âŠ¢â‚™â‚˜ B true
                        â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ A âŠƒ B true

      box : âˆ€ {A Î” Î“} â†’ Î” â¨¾ âˆ™ âŠ¢ A true
                      â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ â–¡ A true

      letbox : âˆ€ {A B Î” Î“} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ â–¡ A true â†’ Î” , A valid â¨¾ Î“ âŠ¢â‚™â‚˜ B true
                           â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ B true

      nt : âˆ€ {Î” Î“} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ BASE true
                   â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ BASE true

  infix 3 _âŠ¢â‚™â‚œ_
  data _âŠ¢â‚™â‚œ_ : ListÂ² Validity Truth â†’ Truth â†’ Set
    where
      var : âˆ€ {A Î” Î“} â†’ Î“ âˆ‹ A true
                      â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true

      app : âˆ€ {A B Î” Î“} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A âŠƒ B true â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ A true
                        â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ B true

      mvar : âˆ€ {A Î” Î“} â†’ Î” âˆ‹ A valid
                       â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true


--------------------------------------------------------------------------------


mutual
  embâ‚™â‚˜ : âˆ€ {Î” Î“ A} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ A true
                    â†’ Î” â¨¾ Î“ âŠ¢ A true
  embâ‚™â‚˜ (lam ğ’Ÿ)      = lam (embâ‚™â‚˜ ğ’Ÿ)
  embâ‚™â‚˜ (box ğ’Ÿ)      = box ğ’Ÿ
  embâ‚™â‚˜ (letbox ğ’Ÿ â„°) = letbox (embâ‚™â‚œ ğ’Ÿ) (embâ‚™â‚˜ â„°)
  embâ‚™â‚˜ (nt ğ’Ÿ)       = embâ‚™â‚œ ğ’Ÿ

  embâ‚™â‚œ : âˆ€ {Î” Î“ A} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true
                    â†’ Î” â¨¾ Î“ âŠ¢ A true
  embâ‚™â‚œ (var ğ’¾)   = var ğ’¾
  embâ‚™â‚œ (app ğ’Ÿ â„°) = app (embâ‚™â‚œ ğ’Ÿ) (embâ‚™â‚˜ â„°)
  embâ‚™â‚œ (mvar ğ’¾)  = mvar ğ’¾


--------------------------------------------------------------------------------


mutual
  renâ‚™â‚˜ : âˆ€ {Î” Î“ Î“â€² A} â†’ Î“â€² âŠ‡ Î“ â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ A true
                       â†’ Î” â¨¾ Î“â€² âŠ¢â‚™â‚˜ A true
  renâ‚™â‚˜ Î· (lam ğ’Ÿ)      = lam (renâ‚™â‚˜ (keep Î·) ğ’Ÿ)
  renâ‚™â‚˜ Î· (box ğ’Ÿ)      = box ğ’Ÿ
  renâ‚™â‚˜ Î· (letbox ğ’Ÿ â„°) = letbox (renâ‚™â‚œ Î· ğ’Ÿ) (renâ‚™â‚˜ Î· â„°)
  renâ‚™â‚˜ Î· (nt ğ’Ÿ)       = nt (renâ‚™â‚œ Î· ğ’Ÿ)

  renâ‚™â‚œ : âˆ€ {Î” Î“ Î“â€² A} â†’ Î“â€² âŠ‡ Î“ â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true
                       â†’ Î” â¨¾ Î“â€² âŠ¢â‚™â‚œ A true
  renâ‚™â‚œ Î· (var ğ’¾)   = var (renâˆ‹ Î· ğ’¾)
  renâ‚™â‚œ Î· (app ğ’Ÿ â„°) = app (renâ‚™â‚œ Î· ğ’Ÿ) (renâ‚™â‚˜ Î· â„°)
  renâ‚™â‚œ Î· (mvar ğ’¾)  = mvar ğ’¾


wkâ‚™â‚œ : âˆ€ {B A Î” Î“} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true
                   â†’ Î” â¨¾ Î“ , B true âŠ¢â‚™â‚œ A true
wkâ‚™â‚œ ğ’Ÿ = renâ‚™â‚œ (drop idâŠ‡) ğ’Ÿ


vzâ‚™â‚œ : âˆ€ {A Î” Î“} â†’ Î” â¨¾ Î“ , A true âŠ¢â‚™â‚œ A true
vzâ‚™â‚œ = var zero


--------------------------------------------------------------------------------


mutual
  mrenâ‚™â‚˜ : âˆ€ {Î” Î”â€² Î“ A} â†’ Î”â€² âŠ‡ Î” â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚˜ A true
                        â†’ Î”â€² â¨¾ Î“ âŠ¢â‚™â‚˜ A true
  mrenâ‚™â‚˜ Î· (lam ğ’Ÿ)      = lam (mrenâ‚™â‚˜ Î· ğ’Ÿ)
  mrenâ‚™â‚˜ Î· (box ğ’Ÿ)      = box (mren Î· ğ’Ÿ)
  mrenâ‚™â‚˜ Î· (letbox ğ’Ÿ â„°) = letbox (mrenâ‚™â‚œ Î· ğ’Ÿ) (mrenâ‚™â‚˜ (keep Î·) â„°)
  mrenâ‚™â‚˜ Î· (nt ğ’Ÿ)       = nt (mrenâ‚™â‚œ Î· ğ’Ÿ)

  mrenâ‚™â‚œ : âˆ€ {Î” Î”â€² Î“ A} â†’ Î”â€² âŠ‡ Î” â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true
                        â†’ Î”â€² â¨¾ Î“ âŠ¢â‚™â‚œ A true
  mrenâ‚™â‚œ Î· (var ğ’¾)   = var ğ’¾
  mrenâ‚™â‚œ Î· (app ğ’Ÿ â„°) = app (mrenâ‚™â‚œ Î· ğ’Ÿ) (mrenâ‚™â‚˜ Î· â„°)
  mrenâ‚™â‚œ Î· (mvar ğ’¾)  = mvar (renâˆ‹ Î· ğ’¾)


mwkâ‚™â‚œ : âˆ€ {B A Î” Î“} â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true
                    â†’ Î” , B valid â¨¾ Î“ âŠ¢â‚™â‚œ A true
mwkâ‚™â‚œ ğ’Ÿ = mrenâ‚™â‚œ (drop idâŠ‡) ğ’Ÿ


mvzâ‚™â‚œ : âˆ€ {A Î” Î“} â†’ Î” , A valid â¨¾ Î“ âŠ¢â‚™â‚œ A true
mvzâ‚™â‚œ = mvar zero


--------------------------------------------------------------------------------


renâ‚™â‚œÂ² : âˆ€ {Î” Î”â€² Î“ Î“â€² A} â†’ Î”â€² â¨¾ Î“â€² âŠ‡Â² Î” â¨¾ Î“ â†’ Î” â¨¾ Î“ âŠ¢â‚™â‚œ A true
                         â†’ Î”â€² â¨¾ Î“â€² âŠ¢â‚™â‚œ A true
renâ‚™â‚œÂ² Î· ğ’Ÿ = mrenâ‚™â‚œ (projâ‚ Î·) (renâ‚™â‚œ (projâ‚‚ Î·) ğ’Ÿ)


--------------------------------------------------------------------------------
