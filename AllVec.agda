module A201801.AllVec where

open import A201801.Prelude
open import A201801.Vec


--------------------------------------------------------------------------------


data All {X} (P : X â†’ Set) : âˆ€ {n} â†’ Vec X n â†’ Set
  where
    âˆ™   : All P âˆ™
    _,_ : âˆ€ {n Î A} â†’ All P {n} Î â†’ P A â†’ All P (Î , A)


maps : âˆ€ {X P Q n} â†’ {Î : Vec X n}
                   â†’ (âˆ€ {A} â†’ P A â†’ Q A) â†’ All P Î
                   â†’ All Q Î
maps f âˆ™       = âˆ™
maps f (Î¾ , a) = maps f Î¾ , f a


--------------------------------------------------------------------------------


get : âˆ€ {X P A n I} â†’ {Î : Vec X n}
                    â†’ All P Î â†’ Î âˆ‹âŸ¨ I âŸ© A
                    â†’ P A
get (Î¾ , a) zero    = a
get (Î¾ , b) (suc i) = get Î¾ i


gets : âˆ€ {X P n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²}
                      â†’ All P Îâ€² â†’ Îâ€² âŠ‡âŸ¨ e âŸ© Î
                      â†’ All P Î
gets Î¾       done     = âˆ™
gets (Î¾ , b) (drop Î·) = gets Î¾ Î·
gets (Î¾ , a) (keep Î·) = gets Î¾ Î· , a


--------------------------------------------------------------------------------


infix 4 _âŠ‡â—‡âŸ¨_âŸ©_
data _âŠ‡â—‡âŸ¨_âŸ©_ {X P} : âˆ€ {n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²}
                                â†’ All P Îâ€² â†’ Îâ€² âŠ‡âŸ¨ e âŸ© Î â†’ All P Î â†’ Set
  where
    done : âˆ™ âŠ‡â—‡âŸ¨ done âŸ© âˆ™

    drop : âˆ€ {A n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²} {Î· : Îâ€² âŠ‡âŸ¨ e âŸ© Î}
                           {a : P A} {Î¾ : All P Î} {Î¾â€² : All P Îâ€²}
                        â†’ Î¾â€² âŠ‡â—‡âŸ¨ Î· âŸ© Î¾
                        â†’ Î¾â€² , a âŠ‡â—‡âŸ¨ drop Î· âŸ© Î¾

    keep : âˆ€ {A n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²} {Î· : Îâ€² âŠ‡âŸ¨ e âŸ© Î}
                           {a : P A} {Î¾ : All P Î} {Î¾â€² : All P Îâ€²}
                        â†’ Î¾â€² âŠ‡â—‡âŸ¨ Î· âŸ© Î¾
                        â†’ Î¾â€² , a âŠ‡â—‡âŸ¨ keep Î· âŸ© Î¾ , a


botâŠ‡â—‡ : âˆ€ {X P n} â†’ {Î : Vec X n} {Î¾ : All P Î}
                 â†’ Î¾ âŠ‡â—‡âŸ¨ botâŠ‡ âŸ© âˆ™
botâŠ‡â—‡ {Î¾ = âˆ™}     = done
botâŠ‡â—‡ {Î¾ = Î¾ , a} = drop botâŠ‡â—‡


idâŠ‡â—‡ : âˆ€ {X P n} â†’ {Î : Vec X n} {Î¾ : All P Î}
                 â†’ Î¾ âŠ‡â—‡âŸ¨ idâŠ‡ âŸ© Î¾
idâŠ‡â—‡ {Î¾ = âˆ™}     = done
idâŠ‡â—‡ {Î¾ = Î¾ , a} = keep idâŠ‡â—‡


_âˆ˜âŠ‡â—‡_ : âˆ€ {X P n nâ€² nâ€³ eâ‚ eâ‚‚} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²} {Îâ€³ : Vec X nâ€³}
                                 {Î·â‚ : Îâ€² âŠ‡âŸ¨ eâ‚ âŸ© Î} {Î·â‚‚ : Îâ€³ âŠ‡âŸ¨ eâ‚‚ âŸ© Îâ€²}
                                 {Î¾ : All P Î} {Î¾â€² : All P Îâ€²} {Î¾â€³ : All P Îâ€³}
                              â†’ Î¾â€² âŠ‡â—‡âŸ¨ Î·â‚ âŸ© Î¾ â†’ Î¾â€³ âŠ‡â—‡âŸ¨ Î·â‚‚ âŸ© Î¾â€²
                              â†’ Î¾â€³ âŠ‡â—‡âŸ¨ Î·â‚ âˆ˜âŠ‡ Î·â‚‚ âŸ© Î¾
ğœ‚â‚      âˆ˜âŠ‡â—‡ done    = ğœ‚â‚
ğœ‚â‚      âˆ˜âŠ‡â—‡ drop ğœ‚â‚‚ = drop (ğœ‚â‚ âˆ˜âŠ‡â—‡ ğœ‚â‚‚)
drop ğœ‚â‚ âˆ˜âŠ‡â—‡ keep ğœ‚â‚‚ = drop (ğœ‚â‚ âˆ˜âŠ‡â—‡ ğœ‚â‚‚)
keep ğœ‚â‚ âˆ˜âŠ‡â—‡ keep ğœ‚â‚‚ = keep (ğœ‚â‚ âˆ˜âŠ‡â—‡ ğœ‚â‚‚)


--------------------------------------------------------------------------------


infix 4 _âˆ‹â—‡âŸ¨_âŸ©_
data _âˆ‹â—‡âŸ¨_âŸ©_ {X P} : âˆ€ {A n I} â†’ {Î : Vec X n}
                               â†’ All P Î â†’ Î âˆ‹âŸ¨ I âŸ© A â†’ P A â†’ Set
  where
    zero : âˆ€ {n A} â†’ {Î : Vec X n} {Î¾ : All P Î} {a : P A}
                   â†’ Î¾ , a âˆ‹â—‡âŸ¨ zero âŸ© a

    suc : âˆ€ {B n I A} â†’ {Î : Vec X n} {i : Î âˆ‹âŸ¨ I âŸ© A}
                         {a : P A} {b : P B} {Î¾ : All P Î}
                      â†’ Î¾ âˆ‹â—‡âŸ¨ i âŸ© a
                      â†’ Î¾ , b âˆ‹â—‡âŸ¨ suc i âŸ© a


renâˆ‹â—‡ : âˆ€ {X P A n nâ€² e I} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²}
                              {Î· : Îâ€² âŠ‡âŸ¨ e âŸ© Î} {i : Î âˆ‹âŸ¨ I âŸ© A}
                              {a : P A} {Î¾ : All P Î} {Î¾â€² : All P Îâ€²}
                           â†’ Î¾â€² âŠ‡â—‡âŸ¨ Î· âŸ© Î¾ â†’ Î¾ âˆ‹â—‡âŸ¨ i âŸ© a
                           â†’ Î¾â€² âˆ‹â—‡âŸ¨ renâˆ‹ Î· i âŸ© a
renâˆ‹â—‡ done     ğ‘–       = ğ‘–
renâˆ‹â—‡ (drop ğœ‚) ğ‘–       = suc (renâˆ‹â—‡ ğœ‚ ğ‘–)
renâˆ‹â—‡ (keep ğœ‚) zero    = zero
renâˆ‹â—‡ (keep ğœ‚) (suc ğ‘–) = suc (renâˆ‹â—‡ ğœ‚ ğ‘–)


--------------------------------------------------------------------------------


-- zips : âˆ€ {X Y P Q n} â†’ {Î : Vec X n} {Î¨ : Vec Y n}
--                      â†’ All P Î â†’ All Q Î¨
--                      â†’ All (\ { (A , B) â†’ P A Ã— Q B }) (zip Î Î¨)
-- zips âˆ™       âˆ™       = âˆ™
-- zips (Î¾ , a) (Ïˆ , b) = zips Î¾ Ïˆ , (a , b)


-- zipsâˆ‹â‚ : âˆ€ {X Y P Q n I A} â†’ {Î : Vec X n} {Î¨ : Vec Y n} {i : Î âˆ‹âŸ¨ I âŸ© A}
--                               {Î¾ : All P Î} {Ïˆ : All Q Î¨} {a : P A}
--                            â†’ Î¾ âˆ‹â—‡âŸ¨ i âŸ© a
--                            â†’ zips Î¾ Ïˆ âˆ‹â—‡âŸ¨ zipâˆ‹â‚ i âŸ© (a , get Ïˆ (within Î¨ i))
-- zipsâˆ‹â‚ {Î¾ = Î¾ , a} {Ïˆ , b} zero    = zero
-- zipsâˆ‹â‚ {Î¾ = Î¾ , b} {Ïˆ , c} (suc ğ‘–) = suc (zipsâˆ‹â‚ ğ‘–)


-- zipsâˆ‹â‚‚ : âˆ€ {X Y P Q n I A} â†’ {Î : Vec X n} {Î¨ : Vec Y n} {i : Î¨ âˆ‹âŸ¨ I âŸ© A}
--                               {Î¾ : All P Î} {Ïˆ : All Q Î¨} {a : Q A}
--                            â†’ Ïˆ âˆ‹â—‡âŸ¨ i âŸ© a
--                            â†’ zips Î¾ Ïˆ âˆ‹â—‡âŸ¨ zipâˆ‹â‚‚ i âŸ© (get Î¾ (within Î i) , a)
-- zipsâˆ‹â‚‚ {Î¾ = Î¾ , b} {Ïˆ , a} zero    = zero
-- zipsâˆ‹â‚‚ {Î¾ = Î¾ , b} {Ïˆ , c} (suc ğ‘–) = suc (zipsâˆ‹â‚‚ ğ‘–)


-- --------------------------------------------------------------------------------


-- data Allâ—‡ {X P} (ğ‘ƒ : âˆ€ {A : X} â†’ P A â†’ Set)
--               : âˆ€ {n} â†’ {Î : Vec X n} â†’ All P Î â†’ Set
--   where
--     âˆ™ : Allâ—‡ ğ‘ƒ âˆ™

--     _,_ : âˆ€ {A n} â†’ {Î : Vec X n}
--                      {Î¾ : All P Î} {a : P A}
--                   â†’ Allâ—‡ ğ‘ƒ Î¾ â†’ ğ‘ƒ a
--                   â†’ Allâ—‡ ğ‘ƒ (Î¾ , a)


-- getâ—‡ : âˆ€ {X P n I A} â†’ {Î : Vec X n} {a : P A}
--                         {Î¾ : All P Î} {i : Î âˆ‹âŸ¨ I âŸ© A}
--                         {ğ‘ƒ : âˆ€ {A} â†’ P A â†’ Set}
--                      â†’ Allâ—‡ ğ‘ƒ Î¾ â†’ Î¾ âˆ‹â—‡âŸ¨ i âŸ© a
--                      â†’ ğ‘ƒ a
-- getâ—‡ (ğœ‰ , ğ‘) zero    = ğ‘
-- getâ—‡ (ğœ‰ , ğ‘) (suc ğ‘–) = getâ—‡ ğœ‰ ğ‘–


-- getsâ—‡ : âˆ€ {X P n nâ€² e} â†’ {Î : Vec X n} {Îâ€² : Vec X nâ€²} {Î· : Îâ€² âŠ‡âŸ¨ e âŸ© Î}
--                           {Î¾ : All P Î} {Î¾â€² : All P Îâ€²}
--                           {ğ‘ƒ : âˆ€ {A} â†’ P A â†’ Set}
--                        â†’ Allâ—‡ ğ‘ƒ Î¾â€² â†’ Î¾â€² âŠ‡â—‡âŸ¨ Î· âŸ© Î¾
--                        â†’ Allâ—‡ ğ‘ƒ Î¾
-- getsâ—‡ âˆ™       done     = âˆ™
-- getsâ—‡ (ğœ‰ , ğ‘) (drop ğœ‚) = getsâ—‡ ğœ‰ ğœ‚
-- getsâ—‡ (ğœ‰ , ğ‘) (keep ğœ‚) = getsâ—‡ ğœ‰ ğœ‚ , ğ‘


-- mapsâ—‡ : âˆ€ {X P n} â†’ {Î : Vec X n} {Q : X â†’ Set}
--                      {f : âˆ€ {A} â†’ P A â†’ Q A} {Î¾ : All P Î}
--                      {ğ‘ƒ : âˆ€ {A} â†’ P A â†’ Set} {ğ‘„ : âˆ€ {A} â†’ Q A â†’ Set}
--                   â†’ (âˆ€ {A} â†’ {a : P A} â†’ ğ‘ƒ a â†’ ğ‘„ (f a)) â†’ Allâ—‡ ğ‘ƒ Î¾
--                   â†’ Allâ—‡ ğ‘„ (maps f Î¾)
-- mapsâ—‡ ğ‘“ âˆ™       = âˆ™
-- mapsâ—‡ ğ‘“ (ğœ‰ , ğ‘) = mapsâ—‡ ğ‘“ ğœ‰ , ğ‘“ ğ‘


-- --------------------------------------------------------------------------------
