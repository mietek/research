module StdIPLNormalForms where

open import Prelude
open import List
open import AllList
open import StdIPL


--------------------------------------------------------------------------------


mutual
  infix 3 _âŠ¢â‚™â‚˜_
  data _âŠ¢â‚™â‚˜_ : Context â†’ Truth â†’ Set
    where
      lam : âˆ€ {A B Î“} â†’ Î“ , A true âŠ¢â‚™â‚˜ B true
                      â†’ Î“ âŠ¢â‚™â‚˜ A âŠƒ B true

      nt : âˆ€ {Î“} â†’ Î“ âŠ¢â‚™â‚œ BASE true
                 â†’ Î“ âŠ¢â‚™â‚˜ BASE true

  infix 3 _âŠ¢â‚™â‚œ_
  data _âŠ¢â‚™â‚œ_ : Context â†’ Truth â†’ Set
    where
      var : âˆ€ {A Î“} â†’ Î“ âˆ‹ A true
                    â†’ Î“ âŠ¢â‚™â‚œ A true

      app : âˆ€ {A B Î“} â†’ Î“ âŠ¢â‚™â‚œ A âŠƒ B true â†’ Î“ âŠ¢â‚™â‚˜ A true
                      â†’ Î“ âŠ¢â‚™â‚œ B true


--------------------------------------------------------------------------------


mutual
  embâ‚™â‚˜ : âˆ€ {Î“ A} â†’ Î“ âŠ¢â‚™â‚˜ A true
                  â†’ Î“ âŠ¢ A true
  embâ‚™â‚˜ (lam ğ’Ÿ) = lam (embâ‚™â‚˜ ğ’Ÿ)
  embâ‚™â‚˜ (nt ğ’Ÿ)  = embâ‚™â‚œ ğ’Ÿ

  embâ‚™â‚œ : âˆ€ {Î“ A} â†’ Î“ âŠ¢â‚™â‚œ A true
                  â†’ Î“ âŠ¢ A true
  embâ‚™â‚œ (var ğ’¾)   = var ğ’¾
  embâ‚™â‚œ (app ğ’Ÿ â„°) = app (embâ‚™â‚œ ğ’Ÿ) (embâ‚™â‚˜ â„°)


--------------------------------------------------------------------------------


mutual
  renâ‚™â‚˜ : âˆ€ {Î“ Î“â€² A} â†’ Î“â€² âŠ‡ Î“ â†’ Î“ âŠ¢â‚™â‚˜ A true
                     â†’ Î“â€² âŠ¢â‚™â‚˜ A true
  renâ‚™â‚˜ Î· (lam ğ’Ÿ) = lam (renâ‚™â‚˜ (keep Î·) ğ’Ÿ)
  renâ‚™â‚˜ Î· (nt ğ’Ÿ)  = nt (renâ‚™â‚œ Î· ğ’Ÿ)

  renâ‚™â‚œ : âˆ€ {Î“ Î“â€² A} â†’ Î“â€² âŠ‡ Î“ â†’ Î“ âŠ¢â‚™â‚œ A true
                     â†’ Î“â€² âŠ¢â‚™â‚œ A true
  renâ‚™â‚œ Î· (var ğ’¾)   = var (renâˆ‹ Î· ğ’¾)
  renâ‚™â‚œ Î· (app ğ’Ÿ â„°) = app (renâ‚™â‚œ Î· ğ’Ÿ) (renâ‚™â‚˜ Î· â„°)


wkâ‚™â‚œ : âˆ€ {B A Î“} â†’ Î“ âŠ¢â‚™â‚œ A true
                 â†’ Î“ , B true âŠ¢â‚™â‚œ A true
wkâ‚™â‚œ ğ’Ÿ = renâ‚™â‚œ (drop idâŠ‡) ğ’Ÿ


vzâ‚™â‚œ : âˆ€ {A Î“} â†’ Î“ , A true âŠ¢â‚™â‚œ A true
vzâ‚™â‚œ = var zero


--------------------------------------------------------------------------------
