module FullS4Propositions where

open import Prelude
open import Category
open import List


--------------------------------------------------------------------------------


infixr 8 _âŠƒ_
data Form : Set
  where
    Î¹_  : String â†’ Form
    _âŠƒ_ : Form â†’ Form â†’ Form
    _âˆ§_ : Form â†’ Form â†’ Form
    ğŸ   : Form
    ğŸ   : Form
    _âˆ¨_ : Form â†’ Form â†’ Form
    â–¡_  : Form â†’ Form


instance
  FormVar : IsString Form
  FormVar =
    record
      { Constraint = \ s â†’ âŠ¤
      ; fromString = \ s â†’ Î¹ s
      }


--------------------------------------------------------------------------------


record Assert : Set
  where
    constructor âŸªâŠ«_âŸ«
    field
      A : Form


--------------------------------------------------------------------------------


injÎ¹ : âˆ€ {Pâ‚ Pâ‚‚} â†’ Î¹ Pâ‚ â‰¡ Î¹ Pâ‚‚
                 â†’ Pâ‚ â‰¡ Pâ‚‚
injÎ¹ refl = refl


injâŠƒâ‚ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚} â†’ Aâ‚ âŠƒ Bâ‚ â‰¡ Aâ‚‚ âŠƒ Bâ‚‚
                        â†’ Aâ‚ â‰¡ Aâ‚‚
injâŠƒâ‚ refl = refl


injâŠƒâ‚‚ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚} â†’ Aâ‚ âŠƒ Bâ‚ â‰¡ Aâ‚‚ âŠƒ Bâ‚‚
                        â†’ Bâ‚ â‰¡ Bâ‚‚
injâŠƒâ‚‚ refl = refl


injâˆ§â‚ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚} â†’ Aâ‚ âˆ§ Bâ‚ â‰¡ Aâ‚‚ âˆ§ Bâ‚‚
                        â†’ Aâ‚ â‰¡ Aâ‚‚
injâˆ§â‚ refl = refl


injâˆ§â‚‚ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚} â†’ Aâ‚ âˆ§ Bâ‚ â‰¡ Aâ‚‚ âˆ§ Bâ‚‚
                        â†’ Bâ‚ â‰¡ Bâ‚‚
injâˆ§â‚‚ refl = refl


injâˆ¨â‚ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚} â†’ Aâ‚ âˆ¨ Bâ‚ â‰¡ Aâ‚‚ âˆ¨ Bâ‚‚
                        â†’ Aâ‚ â‰¡ Aâ‚‚
injâˆ¨â‚ refl = refl


injâˆ¨â‚‚ : âˆ€ {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚} â†’ Aâ‚ âˆ¨ Bâ‚ â‰¡ Aâ‚‚ âˆ¨ Bâ‚‚
                        â†’ Bâ‚ â‰¡ Bâ‚‚
injâˆ¨â‚‚ refl = refl


injâ–¡ : âˆ€ {Aâ‚ Aâ‚‚} â†’ â–¡ Aâ‚ â‰¡ â–¡ Aâ‚‚
                 â†’ Aâ‚ â‰¡ Aâ‚‚
injâ–¡ refl = refl


_â‰Ÿâ‚š_ : (Aâ‚ Aâ‚‚ : Form) â†’ Dec (Aâ‚ â‰¡ Aâ‚‚)
(Î¹ Pâ‚) â‰Ÿâ‚š (Î¹ Pâ‚‚)       with Pâ‚ â‰Ÿâ‚› Pâ‚‚
...                    | yes refl = yes refl
...                    | no Pâ‚â‰¢Pâ‚‚ = no (Pâ‚â‰¢Pâ‚‚ âˆ˜ injÎ¹)
(Î¹ Pâ‚) â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚)    = no (\ ())
(Î¹ Pâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚)    = no (\ ())
(Î¹ Pâ‚) â‰Ÿâ‚š ğŸ            = no (\ ())
(Î¹ Pâ‚) â‰Ÿâ‚š ğŸ            = no (\ ())
(Î¹ Pâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚)    = no (\ ())
(Î¹ Pâ‚)    â‰Ÿâ‚š (â–¡ Aâ‚‚)    = no (\ ())
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š (Î¹ Pâ‚‚)    = no (\ ())
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚) with Aâ‚ â‰Ÿâ‚š Aâ‚‚ | Bâ‚ â‰Ÿâ‚š Bâ‚‚
...                    | yes refl | yes refl = yes refl
...                    | yes refl | no Bâ‚â‰¢Bâ‚‚ = no (Bâ‚â‰¢Bâ‚‚ âˆ˜ injâŠƒâ‚‚)
...                    | no Aâ‚â‰¢Aâ‚‚ | _        = no (Aâ‚â‰¢Aâ‚‚ âˆ˜ injâŠƒâ‚)
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚) = no (\ ())
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š ğŸ         = no (\ ())
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š ğŸ         = no (\ ())
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚) = no (\ ())
(Aâ‚ âŠƒ Bâ‚) â‰Ÿâ‚š (â–¡ Aâ‚‚)    = no (\ ())
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š (Î¹ Pâ‚‚)    = no (\ ())
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚) = no (\ ())
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚) with Aâ‚ â‰Ÿâ‚š Aâ‚‚ | Bâ‚ â‰Ÿâ‚š Bâ‚‚
...                    | yes refl | yes refl = yes refl
...                    | yes refl | no Bâ‚â‰¢Bâ‚‚ = no (Bâ‚â‰¢Bâ‚‚ âˆ˜ injâˆ§â‚‚)
...                    | no Aâ‚â‰¢Aâ‚‚ | _        = no (Aâ‚â‰¢Aâ‚‚ âˆ˜ injâˆ§â‚)
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š ğŸ         = no (\ ())
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š ğŸ         = no (\ ())
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚) = no (\ ())
(Aâ‚ âˆ§ Bâ‚) â‰Ÿâ‚š (â–¡ Aâ‚‚)    = no (\ ())
ğŸ         â‰Ÿâ‚š (Î¹ Pâ‚‚)    = no (\ ())
ğŸ         â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚) = no (\ ())
ğŸ         â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚) = no (\ ())
ğŸ         â‰Ÿâ‚š ğŸ         = yes refl
ğŸ         â‰Ÿâ‚š ğŸ         = no (\ ())
ğŸ         â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚) = no (\ ())
ğŸ         â‰Ÿâ‚š (â–¡ Aâ‚‚)    = no (\ ())
ğŸ         â‰Ÿâ‚š (Î¹ Pâ‚‚)    = no (\ ())
ğŸ         â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚) = no (\ ())
ğŸ         â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚) = no (\ ())
ğŸ         â‰Ÿâ‚š ğŸ         = no (\ ())
ğŸ         â‰Ÿâ‚š ğŸ         = yes refl
ğŸ         â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚) = no (\ ())
ğŸ         â‰Ÿâ‚š (â–¡ Aâ‚‚)    = no (\ ())
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š (Î¹ Pâ‚‚)    = no (\ ())
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚) = no (\ ())
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚) = no (\ ())
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š ğŸ         = no (\ ())
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š ğŸ         = no (\ ())
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚) with Aâ‚ â‰Ÿâ‚š Aâ‚‚ | Bâ‚ â‰Ÿâ‚š Bâ‚‚
...                    | yes refl | yes refl = yes refl
...                    | yes refl | no Bâ‚â‰¢Bâ‚‚ = no (Bâ‚â‰¢Bâ‚‚ âˆ˜ injâˆ¨â‚‚)
...                    | no Aâ‚â‰¢Aâ‚‚ | _        = no (Aâ‚â‰¢Aâ‚‚ âˆ˜ injâˆ¨â‚)
(Aâ‚ âˆ¨ Bâ‚) â‰Ÿâ‚š (â–¡ Aâ‚‚)    = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š (Î¹ Pâ‚‚)    = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š (Aâ‚‚ âŠƒ Bâ‚‚) = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š (Aâ‚‚ âˆ§ Bâ‚‚) = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š ğŸ         = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š ğŸ         = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š (Aâ‚‚ âˆ¨ Bâ‚‚) = no (\ ())
(â–¡ Aâ‚)    â‰Ÿâ‚š (â–¡ Aâ‚‚)    with Aâ‚ â‰Ÿâ‚š Aâ‚‚
...                    | yes refl = yes refl
...                    | no Aâ‚â‰¢Aâ‚‚ = no (Aâ‚â‰¢Aâ‚‚ âˆ˜ injâ–¡)


--------------------------------------------------------------------------------


_âŠƒâ‹¯âŠƒ_ : List Form â†’ Form â†’ Form
âˆ™       âŠƒâ‹¯âŠƒ A = A
(Î , B) âŠƒâ‹¯âŠƒ A = Î âŠƒâ‹¯âŠƒ (B âŠƒ A)


--------------------------------------------------------------------------------
